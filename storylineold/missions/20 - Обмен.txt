//-------------Mission 20---------------
// Название: Обмен

:MISS20
thread 'MISS20'
gosub @KOD_MISSII19 
if 
wasted_or_busted
Jf @PROPUSK_KODA19 
gosub @KOD_PROVALA19 

:PROPUSK_KODA19 
if
GAME_OVER_FLAG == 0
jf @PROPUSK_KODA19_2 
fade 0 0
gosub @UDALENIE_KODA19

HARDCORE_DANGER_FLAG_SCRIPTED = 0
if
GAME_OVER_FLAG == 1
then
HARDCORE_DANGER_ANTIFLAG_SCRIPTED = 1
end

end_thread

:PROPUSK_KODA19_2 
gosub @UDALENIE_KODA19

HARDCORE_DANGER_FLAG_SCRIPTED = 0
if
GAME_OVER_FLAG == 1
then
HARDCORE_DANGER_ANTIFLAG_SCRIPTED = 1
end

if
GAME_OVER_FLAG == 1
then
repeat
wait 0
until BLACK_POLOSKI_ON == 1
end

{$INCLUDE checkpoints_write.txt}

end_thread

:KOD_MISSII19 
increment_mission_attempts

text.ClearAll()
text.RemoveTextBox()

cinema.Widescreen(1)
if
MIKE_SHIZA_FLAG == 1
then
$RANDOM_MODE_MODEL = 170

while not model.Available($RANDOM_MODE_MODEL)
wait 0
model.Load($RANDOM_MODE_MODEL)
mload
end

09C7: change_player PLAYER_CHAR model_to $RANDOM_MODE_MODEL 

end
BLACK_POLOSKI_ON = 1
0A48: enable_menu_access_in_widescreen_mode 0  
$SOUND_OFF_1 = 1
0629: change_integer_stat 258 to 20

MAIN_QUEST_MUSIC_FLAG = 1
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 1
MAIN_QUEST_TEAMMATES_REMOVE_FLAG = 1

if and
$CHEATS_ON == 1
0AB0:   key_pressed 49
then
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19DS"
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 50
then
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19DS"
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19BK"
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 51
then
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19DS"
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19BK"
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19TR"
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 52
then
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19DS"
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19BK"
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19TR"
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19JD"
end

32@ = 0

repeat
wait 0
fade 0 0
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 255
until 32@ > 1000

while true
wait 0
$END_FADING_MUSIC_FAST = 1

if and
$MUSIC_FADE_ENDED[0] == 1
$MUSIC_FADE_ENDED[1] == 1
$MUSIC_FADE_ENDED[2] == 1
$MUSIC_FADE_ENDED[3] == 1
$MUSIC_FADE_ENDED[4] == 1
then
$END_FADING_MUSIC_FAST = 0
break
end

end

ZOMBIES_NOTSPAWN = 1

$ONMISSION = 1  
fade 0 0

wait 500

ZOMBIES_NOTSPAWN = 1

$SAVESTATUS = 1
$HUD_REMOVE = 1
$BANDITS_ZONE3_CAPTURED = 1
ENEX_OFF = 1
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 384.9752 2522.0 16.5146
cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

if
MIKE_SHIZA_FLAG == 1
then
048F: actor PLAYER_ACTOR remove_weapons
end         

$INF_EFF_END = 0 

$MIKE_MUTED = 1   

$WEATHER_LOCK_NUMBER = 19

$LOCK_TIME_FLAG = 1

$HOURS_LOCK = 0
$MINUTES_LOCK = 0  

$NOTSPAWN_ETC = 1     

$SPECIAL_INFECTED_NOT_SPAWN_FLAG = 1

create_thread @WTH_LCK   

32@ = 0
repeat
wait 0
fade 0 0
$SAVESTATUS = 1
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 255
until 32@ > 100

fade 0 0
wait 1  

while $MODEL_LOADING_END_FLAG == 0
wait 0
end  

$PREPARING_LOADING = 0    
$PREPARING_CHECKPOINT = 0  
$PREPARING_INITIAL = 0

ZOMBIES_NOTSPAWN = 1

wait 500

ZOMBIES_NOTSPAWN = 1
       
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DS" 
0AF0: 1@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19BK"

0AF0: 2@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19TR"
2@ += 1
0AF1: write_int 2@ to_ini_file "data\survival.set" section "SCR" key "M19TR"   

if or
0@ == 1   
1@ == 1   
    then        
    $PREPARING_TEXT_OFF = 0
    $PREPARING_CHECKPOINT = 1
    create_thread @PTL_TXT      
    end 
    
if
0@ == 1   
    then    
    100@ = 1
    end 
    
if
1@ == 1   
    then    
    101@ = 1
    end       

00C0: set_current_time 23 0
set_weather 19
$WEATHER_SYNC_FLAG = 1

model.Load(#BOXVILLE)
model.Load(#M4) 
model.Load(#CHROMEGUN)   
model.Load(#SHOTGSPA)  
model.Load(#DESERT_EAGLE)
model.Load(98)
model.Load(250)
model.Load(158)
model.Load(216)
model.Load(#MOLOTOV)
Model.Load(#WMYST)
Model.Load(15402)
Model.Load(15403)
Model.Load(#FCR900)
model.Load(#HUNTER)
mload

////////////////////////////////////////////// 

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 3 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 24 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 24, 1)
else
2@ += 1
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

$SAVE_PREPARE_OFF = 0
PLAYER_DONT_HAVE_BACKPACK = 0
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1

if
MIKE_SHIZA_FLAG == 1
then
32@ = 0
repeat
wait 0
fade 0 0
$SAVESTATUS = 1
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 255
until 32@ > 3100
end   
       
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19BK"

if
0@ == 0
jf @SKIP_KILLING_MISSION19

0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DS"

if
0@ == 0
jf @SKIP_DIALOG_MISSION19  

fade 0 0

if and
MIKE_SHIZA_FLAG == 1
MIKE_CLASSIC_STORY_VOICES_ON == 1
then

///////////////////////////////////////////////

{$INCLUDE noise2_on.txt}

VOICE_SKIP_LONG_SET = 0          

for $ACHIV_NUMBER = 316 to 331

create_thread @VOI_SHO
          
repeat
wait 0

if
VOICE_SKIP_LONG_SET > VOICE_SKIP_LONG_SKIP_SET
    then
    break
    end

until $ACHIV_SHOW_ENDED == 1

end

{$INCLUDE noise2_off.txt} 

///////////////////////////////////////////////

end

00BF: CURRENT_TIME_HOURS = current_time_hours, CURRENT_TIME_MINUTES = current_time_minutes        

renderer 382.9752 2522.0
03CB: set_rendering_origin_at 382.9752 from 2522.0 16.5146

player.CanMove(PLAYER_CHAR) = false       
actor.PutAtNoOffset(PLAYER_ACTOR,384.9752, 2522.0, 16.5146)
actor.Angle(PLAYER_ACTOR) = 91.3773
camera.Restore_WithJumpCut()
       
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DS" 
0AF0: 1@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19BK"   

if and
0@ == 0
1@ == 0
    then
    
    if
    CLASSIC_MUSIC == 0
    then    
    $MUSIC_MISSION = Audiostream.Load(MUSIC_22A)
    else
    $MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_22A)
    end
    
    Audiostream.PerformAction($MUSIC_MISSION, PLAY)
    Audiostream.Loop($MUSIC_MISSION, 0)
    Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME
    
    /////////////////////Плавное нарастание/////////////////////
//
//    $MUSIC_FADE_NUMBER += 1
//    if
//    $MUSIC_FADE_NUMBER > 4
//        then
//        $MUSIC_FADE_NUMBER = 0 
//        end    
//    
//    0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//    0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//    
//    $MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
//    $MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//    $MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//    create_thread @MUS_FAD
//    
//    wait 1
    250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
    2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 1000    
    
    //////////////////////////////////////////////////////////
    
    end
    
if and
MIKE_SHIZA_FLAG == 1
0@ == 0
then    
    
0A0E: disable_text_with_style 1

0391: release_textures
0390: load_txd_dictionary 'miss4' 
wait 1
038F: load_texture "chapter8" as 1 // Load dictionary with 0390 first 
wait 1

1@ = 0

 repeat    
wait 0
1@ += 5
03F0: enable_text_draw 1
038D: draw_texture 1 position 320.0 220.0 size 600.0 400.0 RGBA 255 255 255 1@
03E3: set_texture_to_be_drawn_antialiased 1 
 until 1@ == 255

32@ = 0 

 repeat 
wait 0
03F0: enable_text_draw 1
038D: draw_texture 1 position 320.0 220.0 size 600.0 400.0 RGBA 255 255 255 1@
03E3: set_texture_to_be_drawn_antialiased 1 

if
32@ > 3500
    then
    break
    end
    
 until 00E1: key_pressed 0 17

 repeat
wait 0
1@ -= 5
03F0: enable_text_draw 1
038D: draw_texture 1 position 320.0 220.0 size 600.0 400.0 RGBA 255 255 255 1@
03E3: set_texture_to_be_drawn_antialiased 1 
 until 1@ == 0
 
wait 1
03F0: enable_text_draw 0
wait 1
0391: release_textures 

0A0E: disable_text_with_style 0

end             

:CAR_CREATE_MISSION20_1
if
model.Available(#BOXVILLE)
then

$MISSION_CAR1 = car.Create(#BOXVILLE,237.0, 2522.0, 17.0765)
car.Angle($MISSION_CAR1) = 270.0

if
model.Available(#BOXVILLE)
then
//model.Destroy(#BOXVILLE)
end

else
model.Load(#BOXVILLE)
mload
wait 0
jump to @CAR_CREATE_MISSION20_1
end

car.Health($MISSION_CAR1) = CAR_HEALTH_MAX

0229: set_car $MISSION_CAR1 primary_color_to 0 secondary_color_to 0

:CAR_CREATE_MISSION20_2
if
model.Available(15422)
then

207@ = car.Create(15422,237.0, 2526.0, 16.9021)
car.Angle(207@) = 270.0

if
model.Available(15422)
then
//model.Destroy(15422)
end

else
model.Load(15422)
mload
wait 0
jump to @CAR_CREATE_MISSION20_2
end

car.Health(207@) = CAR_HEALTH_MAX

0229: set_car 207@ primary_color_to 0 secondary_color_to 0

:CAR_CREATE_MISSION20_3
if
model.Available(15422)
then

208@ = car.Create(15422,237.0, 2517.0, 16.7937)

if
model.Available(15422)
then
//model.Destroy(15422)
end

else
model.Load(15422)
mload
wait 0
jump to @CAR_CREATE_MISSION20_3
end

car.Angle(208@) = 270.0
car.Health(208@) = CAR_HEALTH_MAX

0229: set_car 208@ primary_color_to 0 secondary_color_to 0    

while not model.Available(98)
wait 0
model.Load(98)
mload
end

$SURVIVER[0] = actor.Create(26,98,0.0,0.0,0.0)

/////////////////////////////////////////////////////////////////////////////////////////////////

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
    then
    if
    0AA2: 0@ = load_library "PedFuncs.asi" // IF and SET
        then
        if
        0AA4: 1@ = get_proc_address "Ext_GetPedRemap" library 0@ // IF and SET
            then
            0A96: 2@ = actor $SURVIVER[0] struct
            3@ = 1
            0AA7: call_function 1@ num_params 2 pop 2 3@ 2@ 4@
            0AA3: free_library 0@      
            0AF1: write_int 4@ to_ini_file "data\survival.set" section "SCR" key "JOE_REMAP_NUM"  
            create_thread @REMAPSET $SURVIVER[0] 4@ 3@   
            end
        end
    end
    
/////////////////////////////////////////////////////////////////////////////////////////////////

while not model.Available(BANDIT1_SKIN_ID)
wait 0
model.Load(BANDIT1_SKIN_ID)
mload
end

$SURVIVER[1] = actor.Create(26,BANDIT1_SKIN_ID,0.0,0.0,0.0)

while not model.Available(BANDIT2_SKIN_ID)
wait 0
model.Load(BANDIT2_SKIN_ID)
mload
end

209@ = actor.Create(26,BANDIT2_SKIN_ID,0.0,0.0,0.0)

while not model.Available(BANDIT3_SKIN_ID)
wait 0
model.Load(BANDIT3_SKIN_ID)
mload
end

210@ = actor.Create(26,BANDIT3_SKIN_ID,0.0,0.0,0.0)

while not model.Available(BANDIT4_SKIN_ID)
wait 0
model.Load(BANDIT4_SKIN_ID)
mload
end

211@ = actor.Create(26,BANDIT4_SKIN_ID,0.0,0.0,0.0)

while not model.Available(BANDIT1_SKIN_ID)
wait 0
model.Load(BANDIT1_SKIN_ID)
mload
end

212@ = actor.Create(26,BANDIT1_SKIN_ID,0.0,0.0,0.0)

create_thread @PED_BKP $SURVIVER[1] 371

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($SURVIVER[1],30,9999)

create_thread @PED_BKP 210@ 371

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(210@,30,9999)

create_thread @PED_BKP 212@ 371

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(212@,30,9999)

create_thread @PED_BKP $SURVIVER[0] 371 

0781: get_weapon_with_ID 27 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($SURVIVER[0],27,9999)  

036A: put_actor $SURVIVER[1] in_car $MISSION_CAR1
0430: put_actor $SURVIVER[0] into_car $MISSION_CAR1 passenger_seat 0

036A: put_actor 209@ in_car 207@
0430: put_actor 210@ into_car 207@ passenger_seat 0

036A: put_actor 211@ in_car 208@
0430: put_actor 212@ into_car 208@ passenger_seat 0

car.SetAnimation($MISSION_CAR1,9,9000)
car.SetAnimation(207@,9,6800)
car.SetAnimation(208@,9,6800)
088B: set_car $MISSION_CAR1 form_drag_multiplier_to -1.0

camera.SetPosition(393.8708, 2515.8115, 16.4844,0.0,0.0,0.0)
camera.PointAt(379.1963, 2520.8645, 16.5331,2)
wait 1
camera.SetPosition(369.1812, 2520.4441, 18.582,0.0,0.0,0.0)
camera.PointAt(392.6186, 2522.0693, 16.4844,1)
0460: set_camera_transverse_delay 1.0 time 80000

0A48: enable_menu_access_in_widescreen_mode 1  
$SOUND_OFF_1 = 0
wait 0
Cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

wait 500
create_thread @REFR_3D
fade 1 2000
wait 2000   
05BF: AS_actor PLAYER_ACTOR look_at_actor $SURVIVER[0] -1 ms
wait 8000

04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor PLAYER_ACTOR with_offset 0.0 2.2 0.0
0615: define_AS_pack_begin 15@
05D3: AS_actor -1 goto_point $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 mode 4 time 30000 ms // versionA
0639: AS_actor -1 rotate_to_actor PLAYER_ACTOR
05BF: AS_actor -1 look_at_actor PLAYER_ACTOR 99999 ms
0616: define_AS_pack_end 15@
0618: assign_actor $SURVIVER[0] to_AS_pack 15@
061B: remove_references_to_AS_pack 15@

04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor PLAYER_ACTOR with_offset 1.0 2.2 0.0
0615: define_AS_pack_begin 15@
05D3: AS_actor -1 goto_point $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 mode 4 time 30000 ms // versionA
0639: AS_actor -1 rotate_to_actor PLAYER_ACTOR
05BF: AS_actor -1 look_at_actor PLAYER_ACTOR 99999 ms
0616: define_AS_pack_end 15@
0618: assign_actor 210@ to_AS_pack 15@
061B: remove_references_to_AS_pack 15@

04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor PLAYER_ACTOR with_offset -1.0 2.2 0.0
0615: define_AS_pack_begin 15@
05D3: AS_actor -1 goto_point $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 mode 4 time 30000 ms // versionA
0639: AS_actor -1 rotate_to_actor PLAYER_ACTOR
05BF: AS_actor -1 look_at_actor PLAYER_ACTOR 99999 ms
0616: define_AS_pack_end 15@
0618: assign_actor 212@ to_AS_pack 15@
061B: remove_references_to_AS_pack 15@
wait 1000
wait 3000

repeat
wait 0

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

until actor.Stopped($SURVIVER[0])

0635: AS_actor PLAYER_ACTOR aim_at_actor $SURVIVER[0] 99999999 ms
wait 500
0635: AS_actor $SURVIVER[0] aim_at_actor PLAYER_ACTOR 99999999 ms
0635: AS_actor $SURVIVER[1] aim_at_actor PLAYER_ACTOR 99999999 ms
0635: AS_actor 210@ aim_at_actor PLAYER_ACTOR 99999999 ms
0635: AS_actor 212@ aim_at_actor PLAYER_ACTOR 99999999 ms

wait 2000
v$ST_DIALOG[0] = "MSN757"
v$ST_DIALOG[1] = "MSN758"
v$ST_DIALOG[2] = "MSN759"
v$ST_DIALOG[3] = "MSN760"
v$ST_DIALOG[4] = "MSN761"
v$ST_DIALOG[5] = "MSN762"
v$ST_DIALOG[6] = "MSN763"
v$ST_DIALOG[7] = "MSN764"
v$ST_DIALOG[8] = "MSN765"
0084: $DIALOG_ACTOR[0] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[1] = $SURVIVER[0] // (int)
0084: $DIALOG_ACTOR[2] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[3] = $SURVIVER[0] // (int)
0084: $DIALOG_ACTOR[4] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[5] = $SURVIVER[0] // (int)
0084: $DIALOG_ACTOR[6] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[7] = $SURVIVER[0] // (int)
0084: $DIALOG_ACTOR[8] = $SURVIVER[0] // (int)
$DIALOG_COUNT = 8  
$DIALOG_NOT_ANIMS_FLAG = 1              
create_thread @DG_SYS   

repeat
wait 0
until $DIALOG_END == 1

actor.StorePos(PLAYER_ACTOR,10@,11@,12@)

0668: AS_actor $SURVIVER[0] rotate_and_shoot_at 10@ 11@ 12@ 2000 ms

wait 100

05BB: AS_actor PLAYER_ACTOR fall_down 1 time_on_ground 99999

fade 0 100
wait 100
05BF: AS_actor PLAYER_ACTOR look_at_actor $SURVIVER[0] 0 ms
cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 700
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 700
wait 700
audiostream.Release($MUSIC_MISSION)

//////////////////////////////////////////////////////////

actor.DestroyInstantly($SURVIVER[0])
actor.DestroyInstantly($SURVIVER[1])
actor.DestroyInstantly(209@)
actor.DestroyInstantly(210@)
actor.DestroyInstantly(211@)
actor.DestroyInstantly(212@) 

actor.RemoveReferences($SURVIVER[0])
actor.RemoveReferences($SURVIVER[1])
actor.RemoveReferences(209@)
actor.RemoveReferences(210@)
actor.RemoveReferences(211@)
actor.RemoveReferences(212@)

car.Destroy($MISSION_CAR1)
car.Destroy(207@)
car.Destroy(208@)

car.RemoveReferences($MISSION_CAR1)
car.RemoveReferences(207@)
car.RemoveReferences(208@)

0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DS"

if
0@ == 0
then

0AF1: write_int 0 to_ini_file "saves\ZACM.set" section "SCR" key "VOICE_SHOWED"

if
MIKE_CLASSIC_STORY_VOICES_ON == 1
then

///////////////////////////////////////////////

{$INCLUDE noise2_on.txt}

VOICE_SKIP_LONG_SET = 0          

for $ACHIV_NUMBER = 332 to 335

create_thread @VOI_SHO
          
repeat
wait 0

if
VOICE_SKIP_LONG_SET > VOICE_SKIP_LONG_SKIP_SET
    then
    break
    end

until $ACHIV_SHOW_ENDED == 1

end

{$INCLUDE noise2_off.txt} 

///////////////////////////////////////////////

end

end

0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19DS"
0AF1: write_int $SECOND_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19DSSP"
0AF1: write_int $MINUTES_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19DSMP"
0AF1: write_int $HOURS_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19DSHP"
00BF: CURRENT_TIME_HOURS = current_time_hours, CURRENT_TIME_MINUTES = current_time_minutes
0AF1: write_int CURRENT_TIME_HOURS to_ini_file "data\survival.set" section "SCR" key "M19DSTM1"
0AF1: write_int CURRENT_TIME_MINUTES to_ini_file "data\survival.set" section "SCR" key "M19DSTM2"       

:SKIP_DIALOG_MISSION19

0A48: enable_menu_access_in_widescreen_mode 1  
$SOUND_OFF_1 = 0

0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DS"

if
0@ == 1
jf @SKIP_DIALOG_MISSION19_22


0AF0: $SECOND_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DSSP"
0AF0: $MINUTES_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DSMP"
0AF0: $HOURS_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DSHP"
0AF0: CURRENT_TIME_HOURS = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DSTM1"
0AF0: CURRENT_TIME_MINUTES = get_int_from_ini_file "data\survival.set" section "SCR" key "M19DSTM2"
00C0: set_current_time CURRENT_TIME_HOURS CURRENT_TIME_MINUTES
$WEATHER_SYNC_FLAG = 1

:SKIP_DIALOG_MISSION19_22

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

select_interior 3
0860: link_actor PLAYER_ACTOR to_interior 3

renderer 191.1585 157.5333
03CB: set_rendering_origin_at 191.1585 157.5333 1003.0234

CURRENT_TIME_HOURS += 6
00C0: set_current_time CURRENT_TIME_HOURS CURRENT_TIME_MINUTES
$WEATHER_SYNC_FLAG = 1

actor.PutAtNoOffset(PLAYER_ACTOR,190.662, 157.4216, 1003.0234)
camera.Restore_WithJumpCut()
actor.Angle(PLAYER_ACTOR) = 279.1691

if
not MIKE_SHIZA_FLAG == 1
then
create_thread @PLA_LOM
else
0555: remove_weapon 24 from_actor PLAYER_ACTOR
end

PLAYER_DONT_HAVE_BACKPACK = 1
PLAYER_NO_ITEMS_FLAG = 1

$FATIGUE_LEVEL = 0.0

actor.AddArmour(PLAYER_ACTOR,200)
035F: actor PLAYER_ACTOR armour += -200

032B: 1@ = create_weapon_pickup #KNIFECUR type 3 ammo 1 at 189.0268 159.3112 1003.0234
032B: 1@ = create_weapon_pickup #MICRO_UZI type 3 ammo 320 at 223.5082 185.7977 1003.0312
032B: 1@ = create_weapon_pickup #DESERT_EAGLE type 3 ammo 60 at 221.5497 150.9691 1003.0234
032B: 1@ = create_weapon_pickup #GRENADE type 3 ammo 3 at 209.5799 151.3025 1003.0234
032B: 1@ = create_weapon_pickup #MOLOTOV type 3 ammo 1 at 209.5054 150.1977 1003.0234
1@ = Pickup.Create(#BODYARMOUR, 3, 215.5043, 187.4095, 1003.0312)
1@ = Pickup.Create(#BODYARMOUR, 3, 208.7637, 146.4305, 1003.0234)

wait 500 

player.CanMove(PLAYER_CHAR) = false

05BB: AS_actor PLAYER_ACTOR fall_down 0 time_on_ground 999999

$WEATHER_LOCK_NUMBER = 0

///////////////////////////////////////////

while not model.Available(BANDIT1_SKIN_ID)
wait 0
model.Load(BANDIT1_SKIN_ID)
mload
end

$ARMY69_2[0] =  actor.Create(25,BANDIT1_SKIN_ID,198.5907, 158.2838, 1003.0234)

actor.Angle($ARMY69_2[0]) = 270.7481

while not model.Available(BANDIT2_SKIN_ID)
wait 0
model.Load(BANDIT2_SKIN_ID)
mload
end

$ARMY69_2[1] =  actor.Create(25,BANDIT2_SKIN_ID,226.9404, 158.1586, 1003.03)

actor.Angle($ARMY69_2[1]) = 88.3707

while not model.Available(BANDIT3_SKIN_ID)
wait 0
model.Load(BANDIT3_SKIN_ID)
mload
end

$ARMY69_2[2] =  actor.Create(25,BANDIT3_SKIN_ID,210.0338, 142.3039, 1003.0234)

actor.Angle($ARMY69_2[2]) = 270.1404

while not model.Available(BANDIT4_SKIN_ID)
wait 0
model.Load(BANDIT4_SKIN_ID)
mload
end

$ARMY69_2[3] =  actor.Create(25,BANDIT4_SKIN_ID,238.536, 196.3278, 1008.1719)
actor.Angle($ARMY69_2[3]) = 181.6982

while not model.Available(BANDIT5_SKIN_ID)
wait 0
model.Load(BANDIT5_SKIN_ID)
mload
end

$ARMY69_2[4] =  actor.Create(25,BANDIT5_SKIN_ID,267.4201, 191.4491, 1008.1719)
actor.Angle($ARMY69_2[4]) = 1.063

while not model.Available(BANDIT6_SKIN_ID)
wait 0
model.Load(BANDIT6_SKIN_ID)
mload
end

$ARMY69_2[5] =  actor.Create(25,BANDIT6_SKIN_ID,275.5188, 177.6608, 1007.1719)
actor.Angle($ARMY69_2[5]) = 1.063

while not model.Available(BANDIT7_SKIN_ID)
wait 0
model.Load(BANDIT7_SKIN_ID)
mload
end

$ARMY69_2[6] =  actor.Create(25,BANDIT7_SKIN_ID,300.7526, 176.0542, 1007.1719)
actor.Angle($ARMY69_2[6]) = 91.3063

while not model.Available(BANDIT8_SKIN_ID)
wait 0
model.Load(BANDIT8_SKIN_ID)
mload
end

$ARMY69_2[7] =  actor.Create(25,BANDIT8_SKIN_ID,242.2399, 162.344, 1003.03)
actor.Angle($ARMY69_2[7]) = 89.7628

while not model.Available(BANDIT1_SKIN_ID)
wait 0
model.Load(BANDIT1_SKIN_ID)
mload
end

$ARMY69_2[8] =  actor.Create(25,BANDIT1_SKIN_ID,230.5677, 164.9775, 1003.0234)
actor.Angle($ARMY69_2[8]) = 271.3701

while not model.Available(BANDIT2_SKIN_ID)
wait 0
model.Load(BANDIT2_SKIN_ID)
mload
end

$ARMY69_2[9] =  actor.Create(25,BANDIT2_SKIN_ID,226.0586, 184.7563, 1003.0312)
actor.Angle($ARMY69_2[9]) = 190.2972

while not model.Available(BANDIT3_SKIN_ID)
wait 0
model.Load(BANDIT3_SKIN_ID)
mload
end

$ARMY69_2[10] =  actor.Create(25,BANDIT3_SKIN_ID,217.8415, 187.0375, 1003.0312)
actor.Angle($ARMY69_2[10]) = 184.9472

while not model.Available(BANDIT4_SKIN_ID)
wait 0
model.Load(BANDIT4_SKIN_ID)
mload
end

$ARMY69_2[11] =  actor.Create(25,BANDIT4_SKIN_ID,212.42, 185.3506, 1003.0312)
actor.Angle($ARMY69_2[11]) = 270.5691

while not model.Available(BANDIT5_SKIN_ID)
wait 0
model.Load(BANDIT5_SKIN_ID)
mload
end

$ARMY69_2[12] =  actor.Create(25,BANDIT5_SKIN_ID,199.2554, 168.0014, 1003.0234)
actor.Angle($ARMY69_2[12]) = 269.219

while not model.Available(BANDIT6_SKIN_ID)
wait 0
model.Load(BANDIT6_SKIN_ID)
mload
end

$ARMY69_2[13] =  actor.Create(25,BANDIT6_SKIN_ID,221.5779, 166.4392, 1003.0234)
actor.Angle($ARMY69_2[13]) = 92.6656

while not model.Available(BANDIT7_SKIN_ID)
wait 0
model.Load(BANDIT7_SKIN_ID)
mload
end

$ARMY69_2[14] =  actor.Create(25,BANDIT7_SKIN_ID,225.1814, 166.2739, 1003.0253)
actor.Angle($ARMY69_2[14]) = 276.6751

while not model.Available(BANDIT8_SKIN_ID)
wait 0
model.Load(BANDIT8_SKIN_ID)
mload
end

$ARMY69_2[15] =  actor.Create(25,BANDIT8_SKIN_ID,227.7982, 155.4182, 1003.03)
actor.Angle($ARMY69_2[15]) = 85.181

while not model.Available(BANDIT1_SKIN_ID)
wait 0
model.Load(BANDIT1_SKIN_ID)
mload
end

$ARMY69_2[16] =  actor.Create(25,BANDIT1_SKIN_ID,251.5484, 182.7249, 1003.0234)
actor.Angle($ARMY69_2[16]) = 180.0631

while not model.Available(BANDIT2_SKIN_ID)
wait 0
model.Load(BANDIT2_SKIN_ID)
mload
end

$ARMY69_2[17] =  actor.Create(25,BANDIT2_SKIN_ID,260.3655, 170.2058, 1003.0234)
actor.Angle($ARMY69_2[17]) = 359.3725

while not model.Available(BANDIT3_SKIN_ID)
wait 0
model.Load(BANDIT3_SKIN_ID)
mload
end

$ARMY69_2[18] =  actor.Create(25,BANDIT3_SKIN_ID,282.4084, 189.8448, 1007.1719)
actor.Angle($ARMY69_2[18]) = 356.9557

while not model.Available(98)
wait 0
model.Load(98)
mload
end

$ARMY69_2[19] =  actor.Create(25,98,238.6533, 184.149, 1003.0234)
actor.Angle($ARMY69_2[19]) = 179.8673

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
then
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "JOE_REMAP_NUM" 
create_thread @REMAPSET $ARMY69_2[19] 0@ 1
end  

for 213@ = 0 to 19
Actor.SetWalkStyle($ARMY69_2[213@], "MAN")
060B: set_actor $ARMY69_2[213@] decision_maker_to $DEC_PEOPLE
0446: set_actor $ARMY69_2[213@] dismemberment_possible 1
0860: link_actor $ARMY69_2[213@] to_interior 3
create_thread @PED_BKP $ARMY69_2[213@] 371
create_thread @ANT_PRE $ARMY69_2[213@]
end

for 213@ = 0 to 18
actor.Health($ARMY69_2[213@]) = $MISSION19_BANDITS_HP
Actor.WeaponAccuracy($ARMY69_2[213@]) = $MISSION19_BANDITS_ACCURACY
0350: set_actor $ARMY69_2[213@] maintain_position_when_attacked 0
0816: set_actor $ARMY69_2[213@] dont_chase_victim 0
end

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[0],30,9999)

0781: get_weapon_with_ID 25 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
actor.GiveWeaponAndAmmo($ARMY69_2[1],25,9999)

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[2],28,9999)

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[3],30,9999)

0781: get_weapon_with_ID 25 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
actor.GiveWeaponAndAmmo($ARMY69_2[4],25,9999)

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[5],28,9999)

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[6],30,9999)

0781: get_weapon_with_ID 25 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
actor.GiveWeaponAndAmmo($ARMY69_2[7],25,9999)

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[8],28,9999)

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[9],30,9999)

0781: get_weapon_with_ID 25 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
actor.GiveWeaponAndAmmo($ARMY69_2[10],25,9999)

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[11],28,9999)

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[12],30,9999)

0781: get_weapon_with_ID 25 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
actor.GiveWeaponAndAmmo($ARMY69_2[13],25,9999)

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[14],28,9999)

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[15],30,9999)

0781: get_weapon_with_ID 25 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
actor.GiveWeaponAndAmmo($ARMY69_2[16],25,9999)

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($ARMY69_2[17],28,9999)

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
actor.GiveWeaponAndAmmo($ARMY69_2[18],30,9999)

create_thread @PED_BKP $ARMY69_2[19] 371

0781: get_weapon_with_ID 27 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
actor.GiveWeaponAndAmmo($ARMY69_2[19],27,9999)

actor.Health($ARMY69_2[19]) = $BOSS_DGO_HP
Actor.WeaponAccuracy($ARMY69_2[19]) = $BOSS_DGO_ACC
07DD: set_actor $ARMY69_2[19] attack_rate 80 // previously known as temper_to
081A: set_actor $ARMY69_2[19] weapon_skill_to 2
actor.SetImmunities($ARMY69_2[19],1,1,1,1,1)
Actor.SetWalkStyle($ARMY69_2[19], "GANG2")      

077A: set_actor $ARMY69_2[19] acquaintance 0 to_actors_pedtype 0 // see ped.dat
0446: set_actor $ARMY69_2[19] dismemberment_possible 0

0350: set_actor $ARMY69_2[19] maintain_position_when_attacked 1
0816: set_actor $ARMY69_2[19] dont_chase_victim 1 

099F: AS_actor $ARMY69_2[19] ignore_weapon_range 1 

0A96: 0@ = actor $ARMY69_2[19] struct
0A8E: 0@ = 0@ + 1376
0A8C: write_memory 0@ size 4 value 128.0 virtual_protect 1

0754: define_new_animation_path                                                   
0755: add_animation_path_3D_coord 214.6607 158.2589 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 214.713 179.4322 1003.0312 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 226.7678 179.3721 1003.0312 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 226.5554 158.3219 1003.0234 animation "none" IFP_file "none"
0817: assign_actor $ARMY69_2[1] to_animation_path_with_walk_mode 4 route_mode 3

0754: define_new_animation_path
0755: add_animation_path_3D_coord 226.5163 142.0663 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 226.3527 150.7917 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 248.0087 151.2006 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 226.4808 151.3428 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 226.3025 141.9352 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 208.7497 142.4172 1003.03 animation "none" IFP_file "none"
0817: assign_actor $ARMY69_2[2] to_animation_path_with_walk_mode 4 route_mode 3

0754: define_new_animation_path
0755: add_animation_path_3D_coord 238.6376 143.2622 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 246.476 142.7551 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 245.9697 177.8566 1003.03 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 238.9331 182.3166 1003.03 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 238.6632 195.4897 1008.1719 animation "none" IFP_file "none"
0817: assign_actor $ARMY69_2[3] to_animation_path_with_walk_mode 4 route_mode 3

0754: define_new_animation_path
0755: add_animation_path_3D_coord 267.3888 195.9053 1008.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 247.2414 195.5971 1008.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 247.138 190.8498 1008.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 267.4201 191.4491 1008.1719 animation "none" IFP_file "none"
0817: assign_actor $ARMY69_2[4] to_animation_path_with_walk_mode 4 route_mode 3

0754: define_new_animation_path
0755: add_animation_path_3D_coord 275.6816 191.217 1007.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 296.4805 191.1625 1007.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 296.5892 186.7945 1007.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 296.6783 191.3977 1007.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 275.679 191.2577 1007.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 275.5188 177.6608 1007.1719 animation "none" IFP_file "none"
0817: assign_actor $ARMY69_2[5] to_animation_path_with_walk_mode 4 route_mode 3

0754: define_new_animation_path
0755: add_animation_path_3D_coord 273.1638 179.9888 1007.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 251.2666 179.6354 1003.0234 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 272.6863 179.6227 1007.1719 animation "none" IFP_file "none"
0755: add_animation_path_3D_coord 299.7379 174.8177 1007.1719 animation "none" IFP_file "none"
0817: assign_actor $ARMY69_2[6] to_animation_path_with_walk_mode 4 route_mode 3

if
100@ == 1
then
wait 3000
end

$WEATHER_LOCK_NUMBER = 19

//create_thread @RGN_HP3

$PREPARING_CHECKPOINT_OFF = 1

$WEATHER_LOCK_NUMBER = 0

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0
   
wait 500    
cinema.Widescreen(0)
HARDCORE_DANGER_FLAG_SCRIPTED = 1

if
MIKE_SHIZA_FLAG == 1
then
create_thread @RGN_HP3
$DRAW_RED = 1
end  

create_thread @REFR_3D  
fade 1 11000 
$HUD_REMOVE = 0   
wait 1000
cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

if
CLASSIC_MUSIC == 0
then 
$MUSIC_MISSION = Audiostream.Load(MUSIC_22B)
else
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_22B)
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 1000

////////////////////////////////////////////////////////// 

wait 10000
player.CanMove(PLAYER_CHAR) = true
wait 1
player.CanMove(PLAYER_CHAR) = false

text.ShowH('MSN754',2000,1) 
wait 2000           
   
v$OBJECTIVE = "MSN137" 
   
player.CanMove(PLAYER_CHAR) = true
04EB: AS_actor PLAYER_ACTOR crouch 1
214@ = marker.CreateAboveActor($ARMY69_2[0])

:FUCK_CHECK
wait 0

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

if 
8184:   actor $ARMY69_2[0] health < 1
jf @FUCK_CHECK2
v$OBJECTIVE = "MSN86" 
048F: actor $ARMY69_2[0] remove_weapons

$SAVE_PREPARE_OFF = 0
PLAYER_DONT_HAVE_BACKPACK = 0
PLAYER_NO_ITEMS_FLAG = 0
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1

$BANKA += 2
$HEAL += 6
$BINT += 3

////////////////////////////////////////////// 

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 6 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 30, 200)
else
2@ += 200
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

$MIKE_MUTED = 0
jump to @FUCK_CHECK22

:FUCK_CHECK2
if
00A4:   actor PLAYER_ACTOR sphere 0 in_cube_cornerA 203.9766 156.5859 1000.0234 cornerB 200.6959 163.5411 1010.0234
jf @FUCK_CHECK

$SAVE_PREPARE_OFF = 0
PLAYER_DONT_HAVE_BACKPACK = 0
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1
jump to @FUCK_CHECK22

:FUCK_CHECK22

//////////////////////////////////////////////////////////////////////////////////////////

$SOUND_EFFECT1 = Audiostream.Load("AUDIO\SOUNDS\AlarmBanditBase.mp3")

Audiostream.PerformAction($SOUND_EFFECT1, PLAY)
Audiostream.Volume($SOUND_EFFECT1) = $SOUNDS_VOLUME
Audiostream.Loop($SOUND_EFFECT1, 1)

$SOUND_EFFECT1_FLAG = 1

marker.Disable(214@)  

0084: $TIMER = $FIND_TIME2 // (int)
//03C3: set_timer_to $TIMER type 1 GXT 'BB_19' // global_variable  // Time   

v$ST_DIALOG[0] = "MSN773"
v$ST_DIALOG[1] = "DUMMY"
v$ST_DIALOG[2] = "DUMMY"
v$ST_DIALOG[3] = "DUMMY"
v$ST_DIALOG[4] = "DUMMY"
v$ST_DIALOG[5] = "NDG82"
v$ST_DIALOG[6] = "DUMMY"
v$ST_DIALOG[7] = "NDG83"
v$ST_DIALOG[8] = "DUMMY"
v$ST_DIALOG[9] = "NDG84"
v$ST_DIALOG[10] = "DUMMY"
v$ST_DIALOG[11] = "NDG85"
v$ST_DIALOG[12] = "DUMMY"
v$ST_DIALOG[13] = "NDG86"
v$ST_DIALOG[14] = "DUMMY"
v$ST_DIALOG[15] = "NDG87"
v$ST_DIALOG[16] = "DUMMY"
v$ST_DIALOG[17] = "NDG88"
v$ST_DIALOG[18] = "DUMMY"
v$ST_DIALOG[19] = "NDG89"
v$ST_DIALOG[20] = "DUMMY"
v$ST_DIALOG[21] = "NDG90"
$DIALOG_COUNT = 21
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2 

081A: set_actor $ARMY69_2[19] weapon_skill_to 2
04EB: AS_actor $ARMY69_2[19] crouch 1
0ED9: set_char_ignore_damage_anims $ARMY69_2[19] 1

repeat
wait 0

///////////////////////////////////

TEMPVAR_INT = 180
008D: TEMPVAR_INT = integer TEMPVAR_INT to_float
0069: TEMPVAR_INT *= GENERAL_FPS_TIMER_DIVIDER2 // (float)
008C: TEMPVAR_INT = float TEMPVAR_INT to_integer
if
TEMPVAR_INT < 1
then
TEMPVAR_INT = 1
end

if
0E45: frame_mod TEMPVAR_INT
then

for 0@ = 0 to 18
if
056D:   actor $ARMY69_2[0@] defined
    then
    if and
    not actor.Dead($ARMY69_2[0@])
    0364:   actor $ARMY69_2[0@] spotted_actor PLAYER_ACTOR
        then
        actor.SetImmunities($ARMY69_2[0@],1,1,1,1,1)
        0ED9: set_char_ignore_damage_anims $ARMY69_2[0@] 1
        random_int 1@ 0 2
        06E3: AS_actor $ARMY69_2[0@] roll_sideways 1@
        end
    end
end

end

TEMPVAR_INT = 240
008D: TEMPVAR_INT = integer TEMPVAR_INT to_float
0069: TEMPVAR_INT *= GENERAL_FPS_TIMER_DIVIDER2 // (float)
008C: TEMPVAR_INT = float TEMPVAR_INT to_integer
if
TEMPVAR_INT < 1
then
TEMPVAR_INT = 1
end

if
0E45: frame_mod TEMPVAR_INT
then

for 0@ = 0 to 18
if
056D:   actor $ARMY69_2[0@] defined
    then
    if
    not actor.Dead($ARMY69_2[0@])
        then
        actor.SetImmunities($ARMY69_2[0@],0,0,0,0,0)
        0ED9: set_char_ignore_damage_anims $ARMY69_2[0@] 1
        actor.StorePos(PLAYER_ACTOR,1@,2@,3@)
        0687: clear_actor $ARMY69_2[0@] task
        0792: disembark_instantly_actor $ARMY69_2[0@]
        
        if or
        0364:   actor $ARMY69_2[0@] spotted_actor PLAYER_ACTOR
        00F2:   actor $ARMY69_2[0@] near_actor PLAYER_ACTOR radius 10.0 10.0 sphere 0
        then
        0637: AS_actor $ARMY69_2[0@] goto 1@ 2@ 3@ mode 6 turn_radius 1.0 stop_radius 5.0 look_at_actor PLAYER_ACTOR
        end
        
        Actor.SetWalkStyle($ARMY69_2[0@], "SURV5")
        end
    end
end

end

TEMPVAR_INT = 280
008D: TEMPVAR_INT = integer TEMPVAR_INT to_float
0069: TEMPVAR_INT *= GENERAL_FPS_TIMER_DIVIDER2 // (float)
008C: TEMPVAR_INT = float TEMPVAR_INT to_integer
if
TEMPVAR_INT < 1
then
TEMPVAR_INT = 1
end

if
0E45: frame_mod TEMPVAR_INT
then

for 0@ = 0 to 18
if
056D:   actor $ARMY69_2[0@] defined
    then
    if
    not actor.Dead($ARMY69_2[0@])
        then
        0ED9: set_char_ignore_damage_anims $ARMY69_2[0@] 1
        0687: clear_actor $ARMY69_2[0@] task
        0792: disembark_instantly_actor $ARMY69_2[0@]
        Actor.SetWalkStyle($ARMY69_2[0@], "SURV5")
        05E2: AS_actor $ARMY69_2[0@] kill_actor PLAYER_ACTOR
        end
    end
end

end

///////////////////////////////////

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

if
not $TIMER < 1
jf @KOD_PROVALA19_TIME

if or
00A3:   actor PLAYER_ACTOR sphere 0 in_rectangle_cornerA 248.7554 140.0481 cornerB 234.9521 182.8831
051A:   actor $ARMY69_2[19] damaged_by_actor PLAYER_ACTOR
    then
    break
    end

until false

$END_DIALOG_INST = 1

054E: clear_actor $ARMY69_2[19] damage

text.ShowH('MSN798',2000,1) 

215@ = marker.CreateAboveActor($ARMY69_2[19])  

v$OBJECTIVE = "MSN87"    

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 700
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 700
wait 700
audiostream.Release($MUSIC_MISSION)

//////////////////////////////////////////////////////////

if and
$CHEATS_ON == 1
$DEBUG_MENU_ON == 1
    then
    for 0@ = 0 to 18
    if
    056D:   actor $ARMY69_2[0@] defined
        then
        actor.PutAtNoOffset($ARMY69_2[0@],0.0,0.0,0.0)
        end
    end
end

actor.SetImmunities($ARMY69_2[19],0,1,1,1,1)      
create_thread @JAME_HP
04F7: vagina_text STATUS_TEXT type 1 line 1 GXT 'MSN823' // global_variable  // Scor

if
CLASSIC_MUSIC == 0
then 
$MUSIC_MISSION = Audiostream.Load(MUSIC_22B2)
else
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_12B)
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 200
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 250

//////////////////////////////////////////////////////////

077A: set_actor $ARMY69_2[19] acquaintance 4 to_actors_pedtype 0 // see ped.dat
04EB: AS_actor $ARMY69_2[19] crouch 0
0637: AS_actor $ARMY69_2[19] goto 238.6191 195.1583 1008.1719 mode 6 turn_radius 1.0 stop_radius 5.0 look_at_actor PLAYER_ACTOR

$END_DIALOG_INST = 1
wait 0
v$ST_DIALOG[0] = "MSN795"
v$ST_DIALOG[1] = "MSN820"
v$ST_DIALOG[2] = "MSN821"
v$ST_DIALOG[3] = "MSN797"
v$ST_DIALOG[4] = "DUMMY"
v$ST_DIALOG[5] = "DUMMY"
v$ST_DIALOG[6] = "DUMMY"
v$ST_DIALOG[7] = "DUMMY"
v$ST_DIALOG[8] = "MSN825"
v$ST_DIALOG[9] = "DUMMY"
v$ST_DIALOG[10] = "DUMMY"
v$ST_DIALOG[11] = "DUMMY"
v$ST_DIALOG[12] = "DUMMY"
v$ST_DIALOG[13] = "MSN826"
v$ST_DIALOG[14] = "DUMMY"
v$ST_DIALOG[15] = "DUMMY"
v$ST_DIALOG[16] = "DUMMY"
v$ST_DIALOG[17] = "DUMMY"
v$ST_DIALOG[18] = "MSN824"
$DIALOG_COUNT = 18
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2
  
05C1: AS_actor $ARMY69_2[19] speak_from_audio_table 89    
actor.SetImmunities($ARMY69_2[19],0,1,1,1,1)
077A: set_actor $ARMY69_2[19] acquaintance 4 to_actors_pedtype 0 // see ped.dat
04EB: AS_actor $ARMY69_2[19] crouch 1
05E2: AS_actor $ARMY69_2[19] kill_actor PLAYER_ACTOR
wait 2000
0350: set_actor $ARMY69_2[19] maintain_position_when_attacked 0
0816: set_actor $ARMY69_2[19] dont_chase_victim 0  

repeat
wait 0

TEMPVAR_INT = 180
008D: TEMPVAR_INT = integer TEMPVAR_INT to_float
0069: TEMPVAR_INT *= GENERAL_FPS_TIMER_DIVIDER2 // (float)
008C: TEMPVAR_INT = float TEMPVAR_INT to_integer
if
TEMPVAR_INT < 1
then
TEMPVAR_INT = 1
end

if
0E45: frame_mod TEMPVAR_INT
then
random_int 0@ 0 2
actor.SetImmunities($ARMY69_2[19],1,1,1,1,1)
0ED9: set_char_ignore_damage_anims $ARMY69_2[19] 1
06E3: AS_actor $ARMY69_2[19] roll_sideways 0@
wait 750
actor.SetImmunities($ARMY69_2[19],0,0,0,0,0)
end

TEMPVAR_INT = 240
008D: TEMPVAR_INT = integer TEMPVAR_INT to_float
0069: TEMPVAR_INT *= GENERAL_FPS_TIMER_DIVIDER2 // (float)
008C: TEMPVAR_INT = float TEMPVAR_INT to_integer
if
TEMPVAR_INT < 1
then
TEMPVAR_INT = 1
end

if
0E45: frame_mod TEMPVAR_INT
then
0ED9: set_char_ignore_damage_anims $ARMY69_2[19] 1
actor.StorePos(PLAYER_ACTOR,0@,1@,2@)
0687: clear_actor $ARMY69_2[19] task
0792: disembark_instantly_actor $ARMY69_2[19]
0637: AS_actor $ARMY69_2[19] goto 0@ 1@ 2@ mode 6 turn_radius 1.0 stop_radius 5.0 look_at_actor PLAYER_ACTOR
Actor.SetWalkStyle($ARMY69_2[19], "SURV5")
end

TEMPVAR_INT = 280
008D: TEMPVAR_INT = integer TEMPVAR_INT to_float
0069: TEMPVAR_INT *= GENERAL_FPS_TIMER_DIVIDER2 // (float)
008C: TEMPVAR_INT = float TEMPVAR_INT to_integer
if
TEMPVAR_INT < 1
then
TEMPVAR_INT = 1
end

if
0E45: frame_mod TEMPVAR_INT
then
0ED9: set_char_ignore_damage_anims $ARMY69_2[19] 1
0687: clear_actor $ARMY69_2[19] task
0792: disembark_instantly_actor $ARMY69_2[19]
Actor.SetWalkStyle($ARMY69_2[19], "SURV5")
05E2: AS_actor $ARMY69_2[19] kill_actor PLAYER_ACTOR
end   

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

until actor.Dead($ARMY69_2[19])

$END_DIALOG_INST = 1

:MISSION19_CHECK44

v$OBJECTIVE = "DUMMY"  

0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19BK"
0AF1: write_int $SECOND_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19BKSP"
0AF1: write_int $MINUTES_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19BKMP"
0AF1: write_int $HOURS_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19BKHP"
00BF: CURRENT_TIME_HOURS = current_time_hours, CURRENT_TIME_MINUTES = current_time_minutes
0AF1: write_int CURRENT_TIME_HOURS to_ini_file "data\survival.set" section "SCR" key "M19BKTM1"
0AF1: write_int CURRENT_TIME_MINUTES to_ini_file "data\survival.set" section "SCR" key "M19BKTM2"

$JAMES_SHOW_HP_END_FLAG = 1

0151: remove_status_text STATUS_TEXT
marker.Disable(215@)

text.ShowH('MSN794',2000,1)
player.CanMove(PLAYER_CHAR) = false

wait 1000

fade 0 1000   
$HUD_REMOVE = 1              
wait 1000
text.ClearAll()

if
09A8:   actor $ARMY69_2[19] headshoted
then
$SURVIVOR_MEET_FLAG[0] = 1
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19BKH"
else
$SURVIVOR_MEET_FLAG[0] = 0
0AF1: write_int 0 to_ini_file "data\survival.set" section "SCR" key "M19BKH"
end

for 213@ = 0 to 19
actor.DestroyInstantly($ARMY69_2[213@])
end

actor.PutAtNoOffset(PLAYER_ACTOR,288.6232, 173.1076, 1007.1794)
actor.Angle(PLAYER_ACTOR) = 169.7835

$SAVE_PREPARE_OFF = 0
PLAYER_DONT_HAVE_BACKPACK = 0
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1

////////////////////////////////////////////// 

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 6 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 30, 1)
else
2@ += 1
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

while not model.Available(98)
wait 0
model.Load(98)
mload
end

$SURVIVER[0] = actor.Create(26,98,289.3542, 169.4863, 1007.1719)
actor.Angle($SURVIVER[0]) = 17.2155
0332: set_actor $SURVIVER[0] bleeding 1

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
then
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "JOE_REMAP_NUM" 
create_thread @REMAPSET $SURVIVER[0] 0@ 1
end

while not animation.Available("CRACK")
wait 0
animation.Load("CRACK")
end

0605: actor $SURVIVER[0] perform_animation "crckidle1" IFP "CRACK" framedelta 4.0 loop 1 lockX 0 lockY 0 lockF 0 time 99999

if
$SURVIVOR_MEET_FLAG[0] == 1
then
cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
0321: AS_actor $SURVIVER[0] die_headshotted
jump to @JOE_DIALOG_SKIP
end

05BF: AS_actor $SURVIVER[0] look_at_actor PLAYER_ACTOR -1 ms
05BF: AS_actor PLAYER_ACTOR look_at_actor $SURVIVER[0] -1 ms
0635: AS_actor PLAYER_ACTOR aim_at_actor $SURVIVER[0] -1 ms
cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

camera.SetPosition(290.167358 174.832977 1007.472900,0.0,0.0,0.0)
camera.PointAt(289.756989 173.931412 1007.335815,2)

wait 1
camera.SetPosition(288.9685, 172.6739, 1007.1794,0.0,0.0,0.0)
camera.OnPed($SURVIVER[0],15,1)
0460: set_camera_transverse_delay 1.0 time 50000    

wait 1000
create_thread @REFR_3D
fade 1 1000
wait 1000

v$ST_DIALOG[0] = "MSN828"
v$ST_DIALOG[1] = "MSN829"
v$ST_DIALOG[2] = "MSN830"
v$ST_DIALOG[3] = "MSN831"
v$ST_DIALOG[4] = "MSN832"
v$ST_DIALOG[5] = "MSN833"
v$ST_DIALOG[6] = "MSN834"
v$ST_DIALOG[7] = "MSN835"
$DIALOG_COUNT = 7
create_thread @DG_SYS2

repeat
wait 0
until $DIALOG_END == 1

05BF: AS_actor PLAYER_ACTOR look_at_actor $SURVIVER[0] 1000 ms
0635: AS_actor PLAYER_ACTOR aim_at_actor $SURVIVER[0] 1000 ms
0829: actor $SURVIVER[0] perform_animation "crckdeth1" IFP_file "CRACK" rate 4.0 time -1 and_dies

wait 2000
fade 0 1000
wait 1000

05BF: AS_actor PLAYER_ACTOR look_at_actor $SURVIVER[0] 1 ms

:JOE_DIALOG_SKIP
actor.PutAtNoOffset(PLAYER_ACTOR,273.2996, 178.0413, 1007.1719)
actor.Angle(PLAYER_ACTOR) = 87.5116

while not model.Available(101)
wait 0
model.Load(101)
mload
end

$SURVIVER[1] = actor.Create(26,101,238.5447, 185.2499, 1003.0234)
actor.Angle($SURVIVER[1]) = 181.1192
actor.Health($SURVIVER[1]) = 5000
0446: set_actor $SURVIVER[1] dismemberment_possible 1
060B: set_actor $SURVIVER[1] decision_maker_to $DEC_PEOPLE
077A: set_actor $SURVIVER[1] acquaintance 0 to_actors_pedtype 0 // see ped.dat

create_thread @PED_BKP $SURVIVER[1] 371

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
then
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "JAMES_REMAP_NUM" 
create_thread @REMAPSET $SURVIVER[1] 0@
end

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($SURVIVER[1],28,9999)
05D3: AS_actor $SURVIVER[1] goto_point 238.7223 156.5769 1003.0234 mode 7 time 99999 ms // versionA
05BF: AS_actor PLAYER_ACTOR look_at_actor $SURVIVER[1] -1 ms

camera.OnPed($SURVIVER[1],15,2)
camera.SetPosition(275.359772 179.999390 1007.255859,0.0,0.0,0.0) 
 
wait 1000
07A5: AS_actor PLAYER_ACTOR attack_actor $SURVIVER[1] time 5000

create_thread @REFR_3D
fade 1 1000
wait 1000

text.ShowH('MSN836',3000,1)

wait 3000

05D3: AS_actor PLAYER_ACTOR goto_point 268.0337 178.5932 1004.4008 mode 6 time 99999 ms // versionA

fade 0 1000
wait 1000
0792: disembark_instantly_actor PLAYER_ACTOR

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0
camera.Restore_WithJumpCut()
actor.DestroyInstantly($SURVIVER[1])
actor.RemoveReferences($SURVIVER[1])

player.CanMove(PLAYER_CHAR) = true

wait 1000
create_thread @REFR_3D
fade 1 1000
$HUD_REMOVE = 0
018A: MISSION_CHECKPOINT = create_checkpoint_at 238.509 140.2325 1003.0234
03BC: MISSION_SPHERE = create_sphere_at 238.509 140.2325 1003.0234 radius 1.7
v$OBJECTIVE = "MSN89"  
jump @MISSION19_CHECK9

:SKIP_KILLING_MISSION19

0AF0: $SECOND_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19BKSP"
0AF0: $MINUTES_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19BKMP"
0AF0: $HOURS_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19BKHP"
0AF0: CURRENT_TIME_HOURS = get_int_from_ini_file "data\survival.set" section "SCR" key "M19BKTM1"
0AF0: CURRENT_TIME_MINUTES = get_int_from_ini_file "data\survival.set" section "SCR" key "M19BKTM2"
00C0: set_current_time CURRENT_TIME_HOURS CURRENT_TIME_MINUTES
$WEATHER_SYNC_FLAG = 1

$MIKE_MUTED = 0

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

$SAVE_PREPARE_OFF = 0
PLAYER_DONT_HAVE_BACKPACK = 0
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1

////////////////////////////////////////////// 

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 6 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 30, 200)
else
2@ += 200
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

01B9: set_actor PLAYER_ACTOR armed_weapon_to 30
PLAYER_DONT_HAVE_BACKPACK = 1

$FATIGUE_LEVEL = 0.0
actor.AddArmour(PLAYER_ACTOR,200)
035F: actor PLAYER_ACTOR armour += -200  

if
101@ == 1
then
wait 3000
end

0A48: enable_menu_access_in_widescreen_mode 1  
$SOUND_OFF_1 = 0

if
not MIKE_SHIZA_FLAG == 1
then
jump @SKIP_KILLING_MISSION19_2
else
jump @SKIP_KILLING_MISSION19_2_SHIZA
end

:MISSION19_CHECK9

repeat
wait 0

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

until 00EC:   actor PLAYER_ACTOR sphere 0 near_point 238.509 140.2325 radius 2.0 2.0

v$OBJECTIVE = "DUMMY" 

marker.Disable(MISSION_CHECKPOINT)
03BD: destroy_sphere MISSION_SPHERE
player.CanMove(PLAYER_CHAR) = false

fade 0 1000
$HUD_REMOVE = 1
wait 1000

0337: set_actor $SURVIVER[0] visibility 0

$SAVE_PREPARE_OFF = 0
PLAYER_DONT_HAVE_BACKPACK = 0
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1

////////////////////////////////////////////// 

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 6 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 30, 200)
else
2@ += 200
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

Audiostream.PerformAction($SOUND_EFFECT1, STOP)
audiostream.Release($SOUND_EFFECT1)

$SOUND_EFFECT1_FLAG = 0

if 
CLASSIC_MUSIC == 0
then  
gosub @MUSIC_MISSION19_OFF
end

if
MIKE_SHIZA_FLAG == 1
then
jump @SKIP_KILLING_MISSION19_2_SHIZA
end     

:SKIP_KILLING_MISSION19_2  

$WEATHER_LOCK_NUMBER = 19 
                            
select_interior 0
0860: link_actor PLAYER_ACTOR to_interior 0
camera.SetPosition(2370.79, 1540.9194, 10.8203,0.0,0.0,0.0)
actor.PutAtNoOffset(PLAYER_ACTOR, 2370.79, 1540.9194, 10.8203)
actor.Angle(PLAYER_ACTOR) = 179.1079 
renderer 2370.79 1540.9194 
renderer2 2370.79 1540.9194 10.8203
0A0B: set_rendering_origin_at_3D_coord 2370.79 1540.9194 10.8203 angle 179.1079                    
camera.Restore_WithJumpCut()  
00C0: set_current_time 22 0
$WEATHER_SYNC_FLAG = 1  

if
MIKE_SHIZA_FLAG == 1
then
random_int 0@ 0 3
else
0@ = 0
end

if
0@ == 0 
then    
$MISSION19_PATH_NUMBER = 901
$MISSION19_PATH_SPEED = 1.05
$M19_RADIUS_JAMES_SPEED_UP *= 0.75 
end

if 
0@ == 1 
then    
$MISSION19_PATH_NUMBER = 934 
$MISSION19_PATH_SPEED = 0.85
$M19_RADIUS_JAMES_SPEED_UP *= 0.4 
end

if 
0@ == 2 
then    
$MISSION19_PATH_NUMBER = 935 
$MISSION19_PATH_SPEED = 1.05
$M19_RADIUS_JAMES_SPEED_UP *= 1.15 
end      

wait 1000

if
not $MISSION19_PATH_NUMBER == 934
then

:CAR_CREATE_MISSION20_4
if
model.Available(15402)
then

$MISSION_CAR1 = Car.Create(15402, 2378.4573, 1530.6642, 10.3603)

if
model.Available(15402)
then
//model.Destroy(15402)
end

else
model.Load(15402)
mload
wait 0
jump to @CAR_CREATE_MISSION20_4
end

Car.Angle($MISSION_CAR1) = 270.4439
car.Health($MISSION_CAR1) = CAR_HEALTH_MAX
else
0506: set_car_model 15403 next_variation -1 4 // first param is useless

:CAR_CREATE_MISSION20_5
if
model.Available(15403)
then

$MISSION_CAR1 = Car.Create(15403, 2378.4573, 1530.6642, 10.3603)

if
model.Available(15403)
then
//model.Destroy(15403)
end

else
model.Load(15403)
mload
wait 0
jump to @CAR_CREATE_MISSION20_5
end

Car.Angle($MISSION_CAR1) = 270.4439
car.Health($MISSION_CAR1) = CAR_HEALTH_MAX
end

set_weather 19

AIR_ROCKET_TIME_MIN = 350
AIR_ROCKET_TIME_MAX = 850
create_thread @RND_RCK

0229: set_car $MISSION_CAR1 primary_color_to 0 secondary_color_to 0 
0A97: 11@ = car $MISSION_CAR1 struct 
11@ += 9
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
/////////////////////
0A97: 11@ = car $MISSION_CAR1 struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
random_float $BENZIN 30.0 50.0
0A97: 22@ = car $MISSION_CAR1 struct 
0A8E: 12@ = 22@ + 5 // int 
0A8C: write_memory 12@ size 4 value $BENZIN virtual_protect 0 
08C3: clear 12@ bit 1
08C3: clear 12@ bit 2
0A97: 11@ = car $MISSION_CAR1 struct 
11@ += 18
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2

0506: set_car_model 15403 next_variation -1 4 // first param is useless

:CAR_CREATE_MISSION20_8
if
model.Available(15403)
then

MISSION_CAR2 = Car.Create(15403, 2369.0996, 1537.4923, 10.7704)

if
model.Available(15403)
then
//model.Destroy(15403)
end

else
model.Load(15403)
mload
wait 0
jump to @CAR_CREATE_MISSION20_8
end

Car.Angle(MISSION_CAR2) = 89.6538 
car.Health(MISSION_CAR2) = CAR_HEALTH_MAX             

0229: set_car MISSION_CAR2 primary_color_to $BANDITS_CAR_COLOR1 secondary_color_to $BANDITS_CAR_COLOR2 

0A97: 11@ = car MISSION_CAR2 struct 
11@ += 9
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
/////////////////////
0A97: 11@ = car MISSION_CAR2 struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
random_float $BENZIN 30.0 50.0
0A97: 22@ = car MISSION_CAR2 struct 
0A8E: 12@ = 22@ + 5 // int 
0A8C: write_memory 12@ size 4 value $BENZIN virtual_protect 0
08C3: clear 12@ bit 1
08C3: clear 12@ bit 2
0A97: 11@ = car MISSION_CAR2 struct 
11@ += 18
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2

car.SetImmunities($MISSION_CAR1,1,1,1,1,1)
car.DoorStatus($MISSION_CAR1,4)

while not model.Available(101)
wait 0
model.Load(101)
mload
end

$SURVIVER[1] = actor.Createasdriver(26,101,$MISSION_CAR1)
actor.Angle($SURVIVER[1]) = 194.5013
0446: set_actor $SURVIVER[1] dismemberment_possible 0
060B: set_actor $SURVIVER[1] decision_maker_to $DEC_PEOPLE
077A: set_actor $SURVIVER[1] acquaintance 0 to_actors_pedtype 0 // see ped.dat

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
then
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "JAMES_REMAP_NUM" 
create_thread @REMAPSET $SURVIVER[1] 0@
end

while not model.Available(#SWMYCR)
wait 0
model.Load(#SWMYCR)
mload
end

$SURVIVER[2] = Actor.CreateAsPassenger(26, #SWMYCR, $MISSION_CAR1, 0)
0446: set_actor $SURVIVER[2] dismemberment_possible 0 
060B: set_actor $SURVIVER[2] decision_maker_to $DEC_PEOPLE 
Actor.Health($SURVIVER[2]) = 4000
081A: set_actor $SURVIVER[2] weapon_skill_to 2 
07DD: set_actor $SURVIVER[2] attack_rate 60 // previously known as temper_to 
077A: set_actor $SURVIVER[2] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
Actor.SetWalkStyle($SURVIVER[2], "GANG1")

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
then
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "CLEMMY_REMAP_NUM" 
create_thread @REMAPSET $SURVIVER[2] 0@
end

while not model.Available(#CWMOFR)
wait 0
model.Load(#CWMOFR)
mload
end

$SURVIVER[3] = Actor.CreateAsPassenger(26, #CWMOFR, $MISSION_CAR1, 1)
0446: set_actor $SURVIVER[3] dismemberment_possible 0 
077A: set_actor $SURVIVER[3] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
060B: set_actor $SURVIVER[3] decision_maker_to $DEC_PEOPLE 
Actor.Health($SURVIVER[3]) = 4000
081A: set_actor $SURVIVER[3] weapon_skill_to 2 
07DD: set_actor $SURVIVER[3] attack_rate 60 // previously known as temper_to 
077A: set_actor $SURVIVER[3] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
Actor.SetWalkStyle($SURVIVER[3], "GANG1")

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
then
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "TIM_REMAP_NUM" 
create_thread @REMAPSET $SURVIVER[2] 0@
end
                                          
while not model.Available(#SWFYRI)
wait 0
model.Load(#SWFYRI)
mload
end

$SURVIVER[4] = Actor.CreateAsPassenger(26, #SWFYRI, $MISSION_CAR1, 2)
0446: set_actor $SURVIVER[4] dismemberment_possible 0 
077A: set_actor $SURVIVER[4] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
060B: set_actor $SURVIVER[4] decision_maker_to $DEC_PEOPLE 
Actor.Health($SURVIVER[4]) = 4000
081A: set_actor $SURVIVER[4] weapon_skill_to 2 
07DD: set_actor $SURVIVER[4] attack_rate 60 // previously known as temper_to 
077A: set_actor $SURVIVER[4] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
Actor.SetWalkStyle($SURVIVER[4], "GANG1")

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
then
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "ALICE_REMAP_NUM" 
create_thread @REMAPSET $SURVIVER[4] 0@
end

actor.SetImmunities($SURVIVER[1],1,1,1,1,1)

create_thread @PED_BKP $SURVIVER[1] 371

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo($SURVIVER[1],28,9999)  

00C0: set_current_time 22 0
$WEATHER_SYNC_FLAG = 1

car.SetMaxSpeed($MISSION_CAR1,100.0)

$BANDITS_SPAWN_MIN = 1
$BANDITS_SPAWN_MAX = 3

$ARMY_SPAWN_MIN = 1
$ARMY_SPAWN_MAX = 3

actor.StorePos(PLAYER_ACTOR,20@,21@,22@)

0619: enable_actor PLAYER_ACTOR collision_detection 0
0337: set_actor PLAYER_ACTOR visibility 0

while not model.Available($RANDOM_MODE_MODEL)
wait 0
model.Load($RANDOM_MODE_MODEL)
mload
end

1@ = actor.CreateAsDriver(26,$RANDOM_MODE_MODEL,MISSION_CAR2)

create_thread @PED_BKP 1@ 371

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(1@,30,200)

22@ += 50.0

actor.LockInCurrentPosition(PLAYER_ACTOR) = true

actor.PutAtNoOffset(PLAYER_ACTOR,20@,21@,22@)

JAMES_LOST_RADIUS = 200.0

car.SetImmunities(MISSION_CAR2,1,1,1,1,1)

0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JD"  
if 
0@ == 0 
jf @SKIP_KILLING_MISSION19_3 

repeat
wait 0

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

07C0: load_path $MISSION19_PATH_NUMBER
until 07C1:   path $MISSION19_PATH_NUMBER available  

05EB: assign_car $MISSION_CAR1 to_path $MISSION19_PATH_NUMBER
wait 100

0407: store_coords_to 4@ 5@ 6@ from_car $MISSION_CAR1 with_offset 0.0 -20.0 0.0
car.PutAt(MISSION_CAR2,4@,5@,6@)
car.SetSpeedInstantly(MISSION_CAR2,5.0)
//05F1: set_car MISSION_CAR2 follow_car $MISSION_CAR1 keep_9o_clock
07F8: car MISSION_CAR2 follow_car $MISSION_CAR1 radius 0.1

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

0936: set_camera 2374.314453 1533.082764 11.358750 position_to 2344.819580 1533.228394 11.947911 time 5000 smooth_transition 1
0920: point_camera 2375.312256 1533.072144 11.294518 transverse_to 2345.817383 1533.234375 11.880792 time 5000 smooth_transition 1

$PREPARING_CHECKPOINT_OFF = 1

if 
CLASSIC_MUSIC == 0
then  
gosub @CHASE_MUSIC_SET
else
if
101@ == 1
    then
    $MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_12B)
    end
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 200
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 250

////////////////////////////////////////////////////////// 

wait 500

if
101@ == 1
then
//create_thread @RGN_HP3
end             

ZOMBIES_NOTSPAWN = 0

create_thread @REFR_3D
fade 1 500
32@ = 0

while not 32@ > 2000
wait 0       

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

end

01B9: set_actor 1@ armed_weapon_to 0            

wait 200
fade 0 200
wait 200

if
$MISSION19_PATH_NUMBER == 934
then
05ED: freeze_car $MISSION_CAR1 while_on_path
end

0936: set_camera 2374.314453 1533.082764 11.358750 position_to 2344.819580 1533.228394 11.947911 time 1 smooth_transition 1
0920: point_camera 2375.312256 1533.072144 11.294518 transverse_to 2345.817383 1533.234375 11.880792 time 1 smooth_transition 1

car.LockInCurrentPosition(MISSION_CAR2) = true

actor.DestroyInstantly(1@)
0619: enable_actor PLAYER_ACTOR collision_detection 1
0337: set_actor PLAYER_ACTOR visibility 1

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

wait 500

wait 1 

actor.LockInCurrentPosition(PLAYER_ACTOR) = false

036A: put_actor PLAYER_ACTOR in_car MISSION_CAR2

car.LockInCurrentPosition(MISSION_CAR2) = false
Car.Angle(MISSION_CAR2) = 89.6538  

wait 1

car.SetSpeedInstantly(MISSION_CAR2,45.0)
camera.Restore_WithJumpCut()

player.CanMove(PLAYER_CHAR) = true
cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

if
$MISSION19_PATH_NUMBER == 934
then
05EE: unfreeze_car $MISSION_CAR1 while_on_path
end

06FD: set_car $MISSION_CAR1 speed_on_path_to $MISSION19_PATH_SPEED
                      
wait 500

//if
//$MISSION19_PATH_NUMBER == 934
//then
create_thread @CAR_SP2 0 MISSION_CAR2
//end

create_thread @REFR_3D
fade 1 1000  
$HUD_REMOVE = 0   
wait 1000

v$OBJECTIVE = "MSN122" 
$SAVESTATUS = 0 
03AB: set_car $MISSION_CAR1 strong 1 
00AE: unknown_set_car $MISSION_CAR1 to_ignore_traffic_lights 2
09E9: car $MISSION_CAR1 add_single_nitro    
                      
jump @MISSION19_CHECK_CAR141

:CHASE_MUSIC_SET

if 
CLASSIC_MUSIC == 0
then 

if
$MISSION19_PATH_NUMBER == 935
    then
    $MUSIC_MISSION = Audiostream.Load(MUSIC_22C1)
    end
    
if
$MISSION19_PATH_NUMBER == 934
    then
    $MUSIC_MISSION = Audiostream.Load(MUSIC_22C3)
    end    

if
$MISSION19_PATH_NUMBER == 901
    then
    $MUSIC_MISSION = Audiostream.Load(MUSIC_22C2)
    end
    
else      
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_12B)    
end     

return

:SKIP_KILLING_MISSION19_3

0AF0: $MISSION19_PATH_NUMBER = get_int_from_ini_file "data\survival.set" section "SCR" key "M19PN"
0AF0: $SECOND_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDSP"
0AF0: $MINUTES_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDMP"
0AF0: $HOURS_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDHP"
0AF0: CURRENT_TIME_HOURS = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDTM1"
0AF0: CURRENT_TIME_MINUTES = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDTM2"
00C0: set_current_time CURRENT_TIME_HOURS CURRENT_TIME_MINUTES
$WEATHER_SYNC_FLAG = 1

$MISSION19_PATH_NUMBER = 935

$SAVE_PREPARE_OFF = 0
PLAYER_DONT_HAVE_BACKPACK = 0
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1

////////////////////////////////////////////// 

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 6 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 30, 200)
else
2@ += 200
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0        
PLAYER_DONT_HAVE_BACKPACK = 1
  
$FATIGUE_LEVEL = 0.0

player.CanMove(PLAYER_CHAR) = false

036A: put_actor PLAYER_ACTOR in_car MISSION_CAR2

$MISSION19_PATH_NUMBER = 901

:PATH_LOAD22
wait 0
07C0: load_path $MISSION19_PATH_NUMBER
if
07C1:   path $MISSION19_PATH_NUMBER available
jf @PATH_LOAD22
05EB: assign_car $MISSION_CAR1 to_path $MISSION19_PATH_NUMBER

if
$MISSION19_PATH_NUMBER == 901
then
216@ = 5250.0 
end

if
$MISSION19_PATH_NUMBER == 934
then
216@ = 4510.0 
end

if
$MISSION19_PATH_NUMBER == 935
then
216@ = 5550.0 
end

0706: advance_car $MISSION_CAR1 further_along_path 216@
create_thread @CAR_SP2 0 MISSION_CAR2

if
$MISSION19_PATH_NUMBER == 901
then
camera.SetPosition(1671.5775, 2589.4836, 10.7095,0.0,0.0,0.0)
renderer 1671.5775 2589.4836
03CB: set_rendering_origin_at 1671.5775 2589.4836 10.7095
actor.PutAtNoOffset(PLAYER_ACTOR, 1671.5775, 2589.4836, 10.7095)
car.Angle(MISSION_CAR2) = 260.0097
car.SetSpeedInstantly($MISSION_CAR1,30.0)
car.SetSpeedInstantly(MISSION_CAR2,30.0)
end

if
$MISSION19_PATH_NUMBER == 934
then
camera.SetPosition(2101.9648, 2385.3901, 45.2594,0.0,0.0,0.0)
renderer 2101.9648 2385.3901
03CB: set_rendering_origin_at 2101.9648 2385.3901 45.2594
actor.PutAtNoOffset(PLAYER_ACTOR, 2101.9648, 2385.3901, 45.2594)
car.PutAt(MISSION_CAR2,2075.5974, 2376.5732, 40.9851)
actor.Angle(PLAYER_ACTOR) = 284.796
car.SetSpeedInstantly($MISSION_CAR1,10.0)
car.SetSpeedInstantly(MISSION_CAR2,10.0)
end

if
$MISSION19_PATH_NUMBER == 935
then
camera.SetPosition(1166.3021, 1596.6454, 5.848,0.0,0.0,0.0)
renderer 1166.3021 1596.6454
03CB: set_rendering_origin_at 1166.3021 1596.6454 5.848
actor.PutAtNoOffset(PLAYER_ACTOR, 1166.3021, 1596.6454, 5.848)
car.Angle(MISSION_CAR2) = 3.7278
car.SetSpeedInstantly($MISSION_CAR1,20.0)
car.SetSpeedInstantly(MISSION_CAR2,20.0)
end

camera.Restore_WithJumpCut()
player.CanMove(PLAYER_CHAR) = true

$PREPARING_CHECKPOINT_OFF = 1

if 
CLASSIC_MUSIC == 0
then  
gosub @CHASE_MUSIC_SET
else
if
101@ == 1
    then
    $MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_12B)
    end
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 200
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 250

////////////////////////////////////////////////////////// 

wait 500

camera.Restore_WithJumpCut()   

ZOMBIES_NOTSPAWN = 0

AIR_ROCKET_TIME_MIN = 350
AIR_ROCKET_TIME_MAX = 850
create_thread @RND_RCK

wait 1
create_thread @REFR_3D
fade 1 1000   

$HUD_REMOVE = 0 
 
wait 1000
jump @MISSION19_CHECK_CAR141

:MISSION19_CHECK_CAR141
wait 2000

random_int 0@ 0 to 3

if
0@ == 0
then
v$ST_DIALOG[0] = "NDG92"
v$ST_DIALOG[1] = "NDG93"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
end

if
0@ == 1
then
v$ST_DIALOG[0] = "NDG94"
v$ST_DIALOG[1] = "NDG95"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
end

if
0@ == 2
then
v$ST_DIALOG[0] = "NDG96"
v$ST_DIALOG[1] = "NDG97"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
end

create_thread @DG_SYS2 

repeat
wait 0      

if
00F2:   actor $SURVIVER[1] near_actor PLAYER_ACTOR radius JAMES_LOST_RADIUS JAMES_LOST_RADIUS sphere 0   
jf @KOD_PROVALA19_DISTANCE 

if
not car.Wrecked($MISSION_CAR1)
jf @KOD_PROVALA19_CAR

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

if or
00FE:   actor $SURVIVER[1] sphere 0 in_sphere 2161.4258 2492.4163 10.8203 radius 5.0 5.0 3.0
00FE:   actor $SURVIVER[1] sphere 0 in_sphere 927.4657 2763.7673 19.1347 radius 5.0 5.0 3.0     
00FE:   actor $SURVIVER[1] sphere 0 in_sphere 1145.3333 1717.3793 10.8203 radius 5.0 5.0 3.0     
    then
    break
    end
    
//chaseskip
if and
$CHEATS_ON == 1
$DEBUG_MENU_ON == 1
0ADC:   test_cheat "SKIP"
    then
    break
    end    

until false

v$OBJECTIVE = "DUMMY" 

05EC: release_car $MISSION_CAR1 from_path
0873: release_path $MISSION19_PATH_NUMBER

0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "M19JD" 
0AF1: write_int $SECOND_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19JDSP" 
0AF1: write_int $MINUTES_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19JDMP" 
0AF1: write_int $HOURS_PLAYED to_ini_file "data\survival.set" section "SCR" key "M19JDHP" 
00BF: $TIME_HOURS = current_time_hours, $TIME_MINS = current_time_minutes 
0AF1: write_int $TIME_HOURS to_ini_file "data\survival.set" section "SCR" key "M19JDTM1" 
0AF1: write_int $TIME_MINS to_ini_file "data\survival.set" section "SCR" key "M19JDTM2" 
05BE: AS_actor $SURVIVER[1] die 

$INF_EFF_END = 1

$END_DIALOG_INST = 1

car.SetImmunities($MISSION_CAR1,1,0,0,0,0)
car.Health($MISSION_CAR1) = 400
car.DoorStatus($MISSION_CAR1,0)
$CAR_SPEED_OGR_OFF_FLAG = 1
0325: 49@ = create_car $MISSION_CAR1 fire

////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 500
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 500
wait 500
audiostream.Release($MUSIC_MISSION)

Car.Destroy($HELICOPTER)
Car.Destroy($HELICOPTER2)
$COMMAND_GRP_SEAT_IN_TEXT = 0
 
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_22D)
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = $MUSIC_VOLUME

0631: put_actor $SURVIVER[2] in_group PLAYER_GROUP 
0631: put_actor $SURVIVER[3] in_group PLAYER_GROUP 
0631: put_actor $SURVIVER[4] in_group PLAYER_GROUP 
0850: AS_actor $SURVIVER[2] follow_actor PLAYER_ACTOR 
if
not COOP_ACTIVE_FLAG == 1
then
0850: AS_actor $SURVIVER[3] follow_actor PLAYER_ACTOR
end 
0850: AS_actor $SURVIVER[4] follow_actor PLAYER_ACTOR 

/////////////////////////////////////////////////////////////////

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
      
Actor.GiveWeaponAndAmmo($SURVIVER[2], 30, 9999)

0781: get_weapon_with_ID 5 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo($SURVIVER[2], 5, 1)
01B9: set_actor $SURVIVER[2] armed_weapon_to 30

$SURVIVOR_MELEE_ID[2] = 5
$SURVIVOR_WEP_ID[2] = 30
create_thread @MEL_SRV $SURVIVER[2] 2

/////////////////////////////////////////////////////////////////

0781: get_weapon_with_ID 33 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

Actor.GiveWeaponAndAmmo($SURVIVER[3], 33, 9999)

0781: get_weapon_with_ID 6 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo($SURVIVER[3], 6, 1)
01B9: set_actor $SURVIVER[3] armed_weapon_to 33

$SURVIVOR_MELEE_ID[3] = 6
$SURVIVOR_WEP_ID[3] = 33
create_thread @MEL_SRV $SURVIVER[3] 3

/////////////////////////////////////////////////////////////////

0781: get_weapon_with_ID 28 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

Actor.GiveWeaponAndAmmo($SURVIVER[4], 28, 9999)

0781: get_weapon_with_ID 4 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo($SURVIVER[4], 4, 1)
01B9: set_actor $SURVIVER[4] armed_weapon_to 28

$SURVIVOR_MELEE_ID[4] = 4
$SURVIVOR_WEP_ID[4] = 28
create_thread @MEL_SRV $SURVIVER[4] 4

/////////////////////////////////////////////////////////////////

create_thread @PED_BKP $SURVIVER[2] 371
create_thread @PED_BKP $SURVIVER[3] 371
create_thread @PED_BKP $SURVIVER[4] 371
$BANKA += 3 
$HEAL += 2 
Text.ClearAll

if
COOP_ACTIVE_FLAG == 1
then
0687: clear_actor $SURVIVER[3] task
0EA0: set_actor_second_player $SURVIVER[3] enable_camera 1 separate_cars 0
0084: COOP_ACTOR = $SURVIVER[3] // (int)
end
 
wait 100 
05CD: AS_actor $SURVIVER[2] exit_car $MISSION_CAR1 
05CD: AS_actor $SURVIVER[3] exit_car $MISSION_CAR1 
05CD: AS_actor $SURVIVER[4] exit_car $MISSION_CAR1 
Text.ClearAll
06D1: v$ST_DIALOG[0] = "MSN771" // v$ = string 
06D1: v$ST_DIALOG[1] = "MSN774" // v$ = string 
06D1: v$ST_DIALOG[2] = "MSN775" // v$ = string 
06D1: v$ST_DIALOG[3] = "MSN776" // v$ = string 
06D1: v$ST_DIALOG[4] = "MSN777" // v$ = string 
06D1: v$ST_DIALOG[5] = "MSN778" // v$ = string 
06D1: v$ST_DIALOG[6] = "MSN779" // v$ = string 
$DIALOG_COUNT = 6 
$DIALOG_NOT_SKIP = 1 
create_thread @DG_SYS2 

:MISSION19_11137
wait 0 
if 
  $DIALOG_END == 1 
jf @MISSION19_11137 
v$OBJECTIVE = "MSN976"
018A: $MISSION_CHECKPOINT = create_checkpoint_at 2114.595 2416.805 10.8203 
03BC: $MISSION_SPHERE = create_sphere_at 2114.595 2416.805 10.8203 radius 1.7 

:MISSION19_11220
wait 0 
if 
   not Actor.Dead($SURVIVER[2])
jf @MISSION19_14170 
if 
   not Actor.Dead($SURVIVER[3])
jf @MISSION19_14145 
if 
   not Actor.Dead($SURVIVER[4])
jf @MISSION19_14195 
if 
00EC:   actor PLAYER_ACTOR sphere 0 near_point 2114.595 2416.805 radius 1.7 1.7 
jf @MISSION19_11220 
Player.CanMove(PLAYER_CHAR) = False
07B3: set_group PLAYER_GROUP give_command 2 
Marker.Disable($MISSION_CHECKPOINT)
03BD: destroy_sphere $MISSION_SPHERE 
fade 0 1000
$HUD_REMOVE = 1 
wait 1000
v$OBJECTIVE = "DUMMY"

////////////////////////////////////////////// 

0781: get_weapon_with_ID 18 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 18, 10)

////////////////////////////////////////////// 

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 2 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 6 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 6, 1)
else
//ass
end

//////////////////////////////////////////////  

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 6 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 31 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 31, 3170)
else
2@ += 3170
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

////////////////////////////////////////////// 

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 4 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 27 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 27, 120)
else
2@ += 120
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////
 
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 2097.801 2418.239 74.5786 
0362: remove_actor $SURVIVER[2] from_car_and_place_at 2096.545 2416.666 74.5786 
0362: remove_actor $SURVIVER[3] from_car_and_place_at 2091.268 2417.18 74.5786 
0362: remove_actor $SURVIVER[4] from_car_and_place_at 2096.01 2418.972 74.5786 
Actor.PutAtNoOffset(PLAYER_ACTOR, 2097.801, 2418.239, 74.5786)
Actor.Angle(PLAYER_ACTOR) = 151.3354
Actor.PutAtNoOffset($SURVIVER[2], 2095.7261, 2415.751, 74.5786)
Actor.Angle($SURVIVER[2]) = 127.1996
Actor.PutAtNoOffset($SURVIVER[3], 2091.268, 2417.18, 74.5786)
Actor.Angle($SURVIVER[3]) = 173.4944
Actor.PutAtNoOffset($SURVIVER[4], 2096.01, 2418.972, 74.5786)
Actor.Angle($SURVIVER[4]) = 269.6885
Camera.Restore_WithJumpCut
077A: set_actor $SURVIVER[2] acquaintance 4 to_actors_pedtype $ZOMBIE_SET_PEDTYPE // see ped.dat 
077A: set_actor $SURVIVER[3] acquaintance 4 to_actors_pedtype $ZOMBIE_SET_PEDTYPE // see ped.dat 
077A: set_actor $SURVIVER[4] acquaintance 4 to_actors_pedtype $ZOMBIE_SET_PEDTYPE // see ped.dat 
Actor.SetWalkStyle($SURVIVER[2], "GANG1")
Actor.SetWalkStyle($SURVIVER[3], "GANG1")
Actor.SetWalkStyle($SURVIVER[4], "GANG1")
$SAVESTATUS = 1 
$ZOMBIES_HORDE = 1 
$SAVING_PLACE_FLAG = 1 
wait 2000 
0792: disembark_instantly_actor $SURVIVER[2] 
0792: disembark_instantly_actor $SURVIVER[3] 
0792: disembark_instantly_actor $SURVIVER[4] 
06C9: remove_actor $SURVIVER[4] from_group 
$PEOPLE_DONT_ATTACK = 0 
077A: set_actor $SURVIVER[3] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
077A: set_actor $SURVIVER[4] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
Player.CanMove(PLAYER_CHAR) = True
060B: set_actor $SURVIVER[2] decision_maker_to $DEC_PEOPLE 
060B: set_actor $SURVIVER[3] decision_maker_to $DEC_PEOPLE 
060B: set_actor $SURVIVER[4] decision_maker_to $DEC_PEOPLE 
077A: set_actor $SURVIVER[2] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
077A: set_actor $SURVIVER[3] acquaintance 0 to_actors_pedtype 0 // see ped.dat 
077A: set_actor $SURVIVER[4] acquaintance 0 to_actors_pedtype 0 // see ped.dat
create_thread @REFR_3D 
fade 1 1000 
0615: define_AS_pack_begin 15@ 
05D3: AS_actor -1 goto_point 2086.9 2403.0 74.5786 mode 6 time 99999 ms // versionA 
05D4: AS_actor -1 rotate_angle 180.1788 
04EB: AS_actor -1 crouch 1 
0616: define_AS_pack_end 15@ 
0618: assign_actor $SURVIVER[2] to_AS_pack 15@ 
061B: remove_references_to_AS_pack 15@ 
if
not COOP_ACTIVE_FLAG == 1
then
0615: define_AS_pack_begin 15@ 
05D3: AS_actor -1 goto_point 2092.311 2403.134 74.5786 mode 6 time 99999 ms // versionA 
05D4: AS_actor -1 rotate_angle 167.2877 
04EB: AS_actor -1 crouch 1 
0616: define_AS_pack_end 15@ 
0618: assign_actor $SURVIVER[3] to_AS_pack 15@ 
061B: remove_references_to_AS_pack 15@ 
end
0350: set_actor $SURVIVER[2] maintain_position_when_attacked 1 
0350: set_actor $SURVIVER[3] maintain_position_when_attacked 1 
0816: set_actor $SURVIVER[2] dont_chase_victim 1 
0816: set_actor $SURVIVER[3] dont_chase_victim 1 
$SAVESTATUS = 0 
$HUD_REMOVE = 0 
$SPECIAL_INFECTED_NOT_SPAWN_FLAG = 1 
$ZOMBIE_SPAWN_ON_COORD = 1
$ZOMBIE_COORD_MAX = 1
$SALVATION_FLAG = 1         
$ZOMBIE_X[0] = 2093.9897
$ZOMBIE_Y[0] = 2401.4585
$ZOMBIE_Z[0] = 72.5692 
wait 1000  
Actor.SetWalkStyle($SURVIVER[2], "MAN")
Actor.SetWalkStyle($SURVIVER[3], "MAN")
Actor.SetWalkStyle($SURVIVER[4], "MAN")
0631: put_actor $SURVIVER[2] in_group PLAYER_GROUP
if
not COOP_ACTIVE_FLAG == 1
then 
0631: put_actor $SURVIVER[3] in_group PLAYER_GROUP 
end

///////////////////////////////////////////////////////////////////

0470: 9@ = actor $SURVIVER[4] current_weapon
01B9: set_actor $SURVIVER[4] armed_weapon_to 0

while not animation.Available("BOMBER")
wait 0
animation.Load("BOMBER")
end

0605: actor $SURVIVER[4] perform_animation "BOM_PLANT" IFP "BOMBER" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1

wait 100

while actor.Animation($SURVIVER[4]) == "BOM_PLANT"
wait 0

0613: 0@ = actor $SURVIVER[4] animation "BOM_PLANT" time

if
0@ > 0.85
then
break
end

end

actor.StorePos($SURVIVER[4],2@,3@,4@)
4@ -= 1.0
064B: 121@ = create_particle "SMOKE_FLARE" at 2@ 3@ 4@ type 1 
064C: make_particle 121@ visible

while actor.Animation($SURVIVER[4]) == "BOM_PLANT"
wait 0
end

01B9: set_actor $SURVIVER[4] armed_weapon_to 9@

04EF: release_animation "BOMBER"

///////////////////////////////////////////////////////////////////

05DC: AS_actor $SURVIVER[4] run_away_from_point 2@ 3@ 4@ stop_at_radius 3.0 timelimit 3000
wait 3000
0792: disembark_instantly_actor $SURVIVER[4]

Text.ShowH('MSN977', 4000, 1)
 
while not model.Available(#CELLPHONE)
wait 0
model.Load(#CELLPHONE)
mload
end
   
0729: AS_actor $SURVIVER[4] hold_cellphone 1 
wait 3000 
077A: set_actor $SURVIVER[4] acquaintance 0 to_actors_pedtype $ZOMBIE_SET_PEDTYPE // see ped.dat  
wait 3000

$RADIO_SOUND = Audiostream.Load3d("AUDIO\SOUNDS\Radio.mp3")
Audiostream.LinkToActor($RADIO_SOUND,$SURVIVER[2])
Audiostream.Loop($RADIO_SOUND, 1)  
Audiostream.Volume($RADIO_SOUND) = VERO_TIPA_VOLUME
Audiostream.PerformAction($RADIO_SOUND, PLAY)

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $RADIO_SOUND // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $SOUNDS_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 500
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1 
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 500

32@ = 0

////////////////////////////////////////////////////////

repeat
wait 0
$ZOMBIES_HORDE = 1
 
if 
00FE:   actor PLAYER_ACTOR sphere 0 in_sphere 2096.237 2417.919 74.5786 radius 60.0 60.0 30.0 
jf @KOD_PROVALA19_WALK 
if 
   not Actor.Dead($SURVIVER[2])
jf @MISSION19_14170 
if 
   not Actor.Dead($SURVIVER[3])
jf @MISSION19_14145 
if 
   not Actor.Dead($SURVIVER[4])
jf @MISSION19_14195
until 32@ > 30000
 
/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $RADIO_SOUND // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 150
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $RADIO_SOUND volume 0.0 time 250
wait 250
audiostream.Release($RADIO_SOUND)

//////////////////////////////////////////////////////////  
 
Text.ShowL('MSN978', 4000, 1)
wait 10000 
Text.ShowL('MSN980', 2500, 1)
wait 2500 
Model.Destroy(#CELLPHONE)
0729: AS_actor $SURVIVER[4] hold_cellphone 0 
077A: set_actor $SURVIVER[4] acquaintance 4 to_actors_pedtype $ZOMBIE_SET_PEDTYPE // see ped.dat 
0639: AS_actor $SURVIVER[4] rotate_to_actor PLAYER_ACTOR 
wait 1000
 
if
$EASY_MODE == 1
then
$SAVE_WAIT_TIME = 120000
$SAVE_WAIT_TIME2 = 2
end

if
$NORMAL_MODE == 1
then
$SAVE_WAIT_TIME = 180000
$SAVE_WAIT_TIME2 = 3
end

if
$HARD_MODE == 1
then
$SAVE_WAIT_TIME = 240000
$SAVE_WAIT_TIME2 = 4
end

if 
$NIGHTMARE_MODE == 1
then
$SAVE_WAIT_TIME = 300000
$SAVE_WAIT_TIME2 = 5
end
 
Text.Show1Number('MSN979', $SAVE_WAIT_TIME2, 3000, 1)
wait 3000
v$OBJECTIVE = "DLC999" 
03C3: set_timer_to $SAVE_WAIT_TIME type 1 GXT 'INV53' // global_variable 
077A: set_actor $SURVIVER[4] acquaintance 4 to_actors_pedtype $ZOMBIE_SET_PEDTYPE // see ped.dat 
06C9: remove_actor $SURVIVER[4] from_group 
0350: set_actor $SURVIVER[4] maintain_position_when_attacked 1 
0816: set_actor $SURVIVER[4] dont_chase_victim 1 
Actor.GiveWeaponAndAmmo($SURVIVER[4], MicroUzi, 9999)
0615: define_AS_pack_begin 15@ 
05D3: AS_actor -1 goto_point 2089.569 2403.118 74.5786 mode 6 time 99999 ms // versionA 
05D4: AS_actor -1 rotate_angle 200.5037 
04EB: AS_actor -1 crouch 1 
0616: define_AS_pack_end 15@ 
0618: assign_actor $SURVIVER[4] to_AS_pack 15@ 
061B: remove_references_to_AS_pack 15@ 
wait 6000 
0631: put_actor $SURVIVER[4] in_group PLAYER_GROUP 

:MISSION19_12690
wait 0 
if 
00FE:   actor PLAYER_ACTOR sphere 0 in_sphere 2096.237 2417.919 74.5786 radius 60.0 60.0 30.0 
jf @KOD_PROVALA19_WALK 
if 
   not Actor.Dead($SURVIVER[2])
jf @MISSION19_14170 
if 
   not Actor.Dead($SURVIVER[3])
jf @MISSION19_14145 
if 
   not Actor.Dead($SURVIVER[4])
jf @MISSION19_14195 
if 
   not $SAVE_WAIT_TIME >= 1 
jf @MISSION19_12690 
014F: stop_timer $SAVE_WAIT_TIME 
$SAVING_PLACE_FLAG = 0 
$NOTSPAWN = 1 

:MISSION19_12845
wait 0 
Model.Load(#MAVERICK)
Model.Load(#SWMYRI)
mload 
if and
   Model.Available(#MAVERICK)
   Model.Available(#SWMYRI)
jf @MISSION19_12845 
$SAVE_CAR_PLACE = Car.Create(#MAVERICK, 2177.149, 2471.268, 100.4533)
$SAVER = Actor.CreateAsDriver(Mission4, #SWMYRI, $SAVE_CAR_PLACE)
Actor.Health($SAVER) = 1000
Actor.SetImmunities($SAVER, 1, 1, 1, 1, 1)
036A: put_actor $SAVER in_car $SAVE_CAR_PLACE

0229: set_car $SAVE_CAR_PLACE primary_color_to 1 secondary_color_to 2

$SAVE_CAR_PLACE_MARK = marker.CreateAboveCar($SAVE_CAR_PLACE)
marker.SetColor($SAVE_CAR_PLACE_MARK,1)
marker.SetIconSize($SAVE_CAR_PLACE_MARK,2)
018B: set_marker $SAVE_CAR_PLACE_MARK radar_mode 0
018B: set_marker $SAVE_CAR_PLACE_MARK radar_mode 2 

:MISSION19_12979
wait 0 
07C0: load_path 904 
if 
07C1:   path 904 available 
jf @MISSION19_12979 
05EB: assign_car $SAVE_CAR_PLACE to_path 904 

repeat
wait 0 
if 
00FE:   actor PLAYER_ACTOR sphere 0 in_sphere 2096.237 2417.919 74.5786 radius 60.0 60.0 30.0 
jf @KOD_PROVALA19_WALK 
if 
   not Actor.Dead($SURVIVER[2])
jf @MISSION19_14170 
if 
   not Actor.Dead($SURVIVER[3])
jf @MISSION19_14145 
if 
   not Actor.Dead($SURVIVER[4])
jf @MISSION19_14195 
if 
   not Car.Wrecked($SAVE_CAR_PLACE)
jf @MISSION19_14120
 
02E3: 1@ = car $SAVE_CAR_PLACE speed  
until 1@ < 1.0

v$OBJECTIVE = "DUMMY" 
$HUD_REMOVE = 1
$SAVE_METHOD = 1  
$SAVER_GET_IN_START = 1 
create_thread @SV_GTN
$NOT_MUSIC_SAVING = 1 
fade 0 2000 
wait 2000 
$END_SAVING = 1 
05EC: release_car $SAVE_CAR_PLACE from_path 
0873: release_path 904
0650: destroy_particle 121@ 
$HUD_REMOVE = 1 
$SAVESTATUS = 1 
$ALLOW_HUNGER = 0 
$DELETE_SOUND = 1  
Player.CanMove(PLAYER_CHAR) = False
Cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
Actor.DestroyInstantly($SAVER)
Actor.RemoveReferences($SAVER)
Car.Destroy($SAVE_CAR_PLACE)
Car.RemoveReferences($SAVE_CAR_PLACE)

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 500
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 500
wait 500
audiostream.Release($MUSIC_MISSION)

wait 3000 
if
MIKE_SHIZA_FLAG == 1
then
0318: set_latest_mission_passed 'GME1213'
else
0318: set_latest_mission_passed 'MSN756B'
end

if
075C:   marker $SAVE_CAR_PLACE_MARK enabled
then
marker.Disable($SAVE_CAR_PLACE_MARK)
end

$SAVE_CAR_PLACE = Car.Create(#MAVERICK, 2118.704, 2703.443, 100.7676)
0229: set_car $SAVE_CAR_PLACE primary_color_to 1 secondary_color_to 2

while not model.Available(#SWMYRI)
wait 0
model.Load(#SWMYRI)
mload
end

404@ = Actor.Create(26, #SWMYRI, 0.0, 0.0, 0.0)
Car.Angle($SAVE_CAR_PLACE) = 359.5625
036A: put_actor 404@ in_car $SAVE_CAR_PLACE

$CARS_WORK_FLAG = 1
 
0430: put_actor PLAYER_ACTOR into_car $SAVE_CAR_PLACE passenger_seat 0 
0430: put_actor $SURVIVER[2] into_car $SAVE_CAR_PLACE passenger_seat 1 
0430: put_actor $SURVIVER[3] into_car $SAVE_CAR_PLACE passenger_seat 2
0430: put_actor $SURVIVER[4] into_car $SAVE_CAR_PLACE passenger_seat 3 
0825: set_helicopter $SAVE_CAR_PLACE instant_rotor_start  
04A2: set_heli $SAVE_CAR_PLACE fly_to 2119.936 30999.992 100.0 altitude_between 100.0 and 100.0 
Camera.SetPosition(2118.012, 2838.581, 99.0, 0.0, 0.0, 0.0)
Camera.PointAt(2118.709, 2841.787, 98.0, 2)
0936: set_camera 2118.012 2838.581 99.0 position_to 2129.271 3005.269 102.9391 time 120000 smooth_transition 1 
0920: point_camera 2118.709 2841.787 98.0 transverse_to 2129.91 3048.516 97.4222 time 120000 smooth_transition 1 
wait 1000
create_thread @REFR_3D 
fade 1 1000 
wait 1000 
wait 4000 
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_22F)
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 0)
Audiostream.Volume($MUSIC_MISSION) = $MUSIC_VOLUME
wait 3000 
Text.ShowH('DLC757', 4000, 1)
wait 4000

$STATS_SHOW_FLAG = 0
$STATS_SHOW_GAMEMODE = 1
create_thread @STS_SHW

:MCS_CHECKING_STATS1
wait 0
if
$STATS_CAN_BE_SKIPPED == 1
then
if or
$STATS_SHOW_END == 1
00E1:   player 0 pressed_key 17
jf @MCS_CHECKING_STATS1
else
jump to @MCS_CHECKING_STATS1
end

$STATS_SHOW_END = 1
$STATS_TOTAL_SHOW_OFF_FLAG = 1

32@ = 0

fade 0 3000

while 32@ < 3100
wait 0
$STATS_TOTAL_SHOW_OFF_FLAG = 1
end

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 1000
wait 1000
audiostream.Release($MUSIC_MISSION)

//////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////////////////

player.CanMove(PLAYER_CHAR) = false

fade 0 500
$HUD_REMOVE = 1
wait 500

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

PLAYER_DONT_HAVE_BACKPACK = 1

$SAVESTATUS = 1

if
COOP_ACTIVE_FLAG == 1
then
0EA1: disable_second_player_restore_camera 1
COOP_ACTOR = -69
end

Actor.DestroyInstantly($SURVIVER[2])
Actor.DestroyInstantly($SURVIVER[3])
Actor.DestroyInstantly($SURVIVER[4])
Actor.DestroyInstantly($SAVER)
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 2119.936 2199.992 1.4496 
wait 1000 
Car.Destroy($SAVE_CAR_PLACE)

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 700
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
//2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 1000
//wait 1000
//audiostream.Release($MUSIC_MISSION)

//////////////////////////////////////////////////////////

$COMMAND_GRP_SEAT_IN_TEXT = 0  

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "STATS_STORY_COMPLETED"
                
0@ += 1                
 
0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "STATS_STORY_COMPLETED"

$STATS_SHOW_GAMEMODE = 1
$STATS_SHOW_FLAG = 1
create_thread @STS_SHW 

////////////////////////////////Получение достижения "Незабываемая история"////////////////////////////////

0AF0: 1@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT30_GOT"

if and
1@ == 0
0@ >= 5
$CHEATED_FLAG == 0
    then
    v$ACHIEVEMNT = "ACH30"
    $ACHIEVEMENT_GOT_FLAG = 1    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT30_GOT"    
    end  
    
while $ACHIEVEMENT_GOT_FLAG == 1
wait 0
end     

////////////////////////////////Получение достижения "Начало конца"////////////////////////////////

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT2_GOT"

if and
0@ == 0
$CHEATED_FLAG == 0
    then
    v$ACHIEVEMNT = "ACH2"
    $ACHIEVEMENT_GOT_FLAG = 1    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT2_GOT"    
    end  
    
while $ACHIEVEMENT_GOT_FLAG == 1
wait 0
end     
    
////////////////////////////////Получение достижения "Максимальная боль"////////////////////////////////        

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT3_GOT"

if and
0@ == 0
$NIGHTMARE_MODE == 1
$CHEATED_FLAG == 0
    then
    v$ACHIEVEMNT = "ACH3"
    $ACHIEVEMENT_GOT_FLAG = 1    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT3_GOT"    
    end 
    
while $ACHIEVEMENT_GOT_FLAG == 1
wait 0
end          

////////////////////////////////Получение достижения "Неземная удача"////////////////////////////////               

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT24_GOT"
0AF0: 1@ = get_int_from_ini_file "data\survival.set" section "SCR" key "MIKE_STORY_MISSION20_FAILED"

if and
0@ == 0
1@ == 0
$CHEATED_FLAG == 0
    then
    v$ACHIEVEMNT = "ACH24"
    $ACHIEVEMENT_GOT_FLAG = 1    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT24_GOT"    
    end  
    
while $ACHIEVEMENT_GOT_FLAG == 1
wait 0
end      

$ACHIV_TOTAL_SHOW_OFF_FLAG = 0

$GODMODE_FLAG = 1
actor.SetImmunities(PLAYER_ACTOR,1,1,1,1,1)
0459: end_thread_named 'LOW_HEA'
0459: end_thread_named 'DED_CHK'
create_thread @FIN_CNM
create_thread @FIN_TIT

end_thread

jump @UDACHNO19 

:KOD_PROVALA19_WALK
text.ClearAll()
v$FAILED_TEXT = "MS_FL7"
jump @KOD_PROVALA19

:KOD_PROVALA19_DISTANCE
text.ClearAll()
v$FAILED_TEXT = "MS_FL18"
jump @KOD_PROVALA19

:KOD_PROVALA19_CAR
text.ClearAll()
v$FAILED_TEXT = "MS_FL19"
jump @KOD_PROVALA19

:KOD_PROVALA19_CAR2
text.ClearAll()
v$FAILED_TEXT = "MS_FL9"
jump @KOD_PROVALA19

:KOD_PROVALA19_TIME
text.ClearAll()
v$FAILED_TEXT = "MS_FL23"
jump @KOD_PROVALA19

:MISSION19_14170
Text.ClearAll
v$FAILED_TEXT = "MS_FL11"
jump @KOD_PROVALA19

:MISSION19_14145
Text.ClearAll
v$FAILED_TEXT = "MS_FL3"
jump @KOD_PROVALA19

:MISSION19_14195
Text.ClearAll
v$FAILED_TEXT = "MS_FL16"
jump @KOD_PROVALA19

:MISSION19_14120
Text.ClearAll
Text.ShowH('MS_FL9', 4000, 1)
jump @KOD_PROVALA19
         
:UDACHNO19 
fade 0 0
$ONMISSION = 0         
ENEX_OFF = 0
gosub @PROPUSK_KODA19
fade 0 0
return

:KOD_PROVALA19   
0AF1: write_int 1 to_ini_file "data\survival.set" section "SCR" key "MIKE_STORY_MISSION20_FAILED"
GAME_OVER_FLAG = 1
create_thread @GMV_OVR
$ONMISSION = 0
mission_cleanup
$JAMES_SHOW_HP_END_FLAG = 1

if
$SOUND_EFFECT1_FLAG == 1
then
Audiostream.PerformAction($SOUND_EFFECT1, STOP)
audiostream.Release($SOUND_EFFECT1)
end
     
06D0: enable_emergency_traffic 0 
06D7: enable_train_traffic 0 
096A: enable_flying_helis 0 
099E: enable_police_patrols 0   
0923: enable_air_traffic 0
ENEX_OFF = 0 
return

:UDALENIE_KODA19 
$ONMISSION = 0
$Z_DONT_CLIMB_FLAG = 0 
marker.Disable(MISSION_CHECKPOINT)
marker.Disable(214@)
03BD: destroy_sphere MISSION_SPHERE   

if and
GAME_OVER_FLAG == 0
$ACTOR_DEAD == 0
then
fade 0 0
end

mission_cleanup  

if and
GAME_OVER_FLAG == 0
$ACTOR_DEAD == 0
then
fade 0 0
end
   
06D0: enable_emergency_traffic 0 
06D7: enable_train_traffic 0 
096A: enable_flying_helis 0 
099E: enable_police_patrols 0   
0923: enable_air_traffic 0
ENEX_OFF = 0 
$SAVESTATUS = 1
if
GAME_OVER_FLAG == 0
jf @UDALENIE_KODA19_RETURN
fade 0 0 
return

:UDALENIE_KODA19_RETURN
return

:MUSIC_MISSION19_OFF   

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 700
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 1000
wait 1000
audiostream.Release($MUSIC_MISSION)

//////////////////////////////////////////////////////////

return

:SKIP_KILLING_MISSION19_2_SHIZA  

$WEATHER_LOCK_NUMBER = 19 
                            
select_interior 0
0860: link_actor PLAYER_ACTOR to_interior 0
camera.SetPosition(2370.79, 1540.9194, 10.8203,0.0,0.0,0.0)
actor.PutAtNoOffset(PLAYER_ACTOR, 2370.79, 1540.9194, 10.8203)
actor.Angle(PLAYER_ACTOR) = 179.1079 
renderer 2370.79 1540.9194 
renderer2 2370.79 1540.9194 10.8203
0A0B: set_rendering_origin_at_3D_coord 2370.79 1540.9194 10.8203 angle 179.1079                    
camera.Restore_WithJumpCut()  
00C0: set_current_time 22 0
$WEATHER_SYNC_FLAG = 1  

random_int 0@ 0 3

if
0@ == 0 
then    
$MISSION19_PATH_NUMBER = 901
$MISSION19_PATH_SPEED = 1.05
$M19_RADIUS_JAMES_SPEED_UP *= 0.75 
end

if 
0@ == 1 
then    
$MISSION19_PATH_NUMBER = 934 
$MISSION19_PATH_SPEED = 0.85
$M19_RADIUS_JAMES_SPEED_UP *= 0.4 
end

if 
0@ == 2 
then    
$MISSION19_PATH_NUMBER = 935 
$MISSION19_PATH_SPEED = 1.05
$M19_RADIUS_JAMES_SPEED_UP *= 1.15 
end      

wait 1000

if
not $MISSION19_PATH_NUMBER == 934
then

:CAR_CREATE_MISSION20_4_SHIZA
if
model.Available(15402)
then

$MISSION_CAR1 = Car.Create(15402, 2378.4573, 1530.6642, 10.3603)

if
model.Available(15402)
then
model.Destroy(15402)
end

else
model.Load(15402)
mload
wait 0
jump to @CAR_CREATE_MISSION20_4_SHIZA
end

Car.Angle($MISSION_CAR1) = 270.4439
car.Health($MISSION_CAR1) = CAR_HEALTH_MAX
else
0506: set_car_model 15403 next_variation -1 4 // first param is useless

:CAR_CREATE_MISSION20_5_SHIZA
if
model.Available(15403)
then

$MISSION_CAR1 = Car.Create(15403, 2378.4573, 1530.6642, 10.3603)

if
model.Available(15403)
then
model.Destroy(15403)
end

else
model.Load(15403)
mload
wait 0
jump to @CAR_CREATE_MISSION20_5_SHIZA
end

Car.Angle($MISSION_CAR1) = 270.4439
car.Health($MISSION_CAR1) = CAR_HEALTH_MAX
end

set_weather 19

AIR_ROCKET_TIME_MIN = 350
AIR_ROCKET_TIME_MAX = 850
create_thread @RND_RCK

0229: set_car $MISSION_CAR1 primary_color_to 0 secondary_color_to 0 
0A97: 11@ = car $MISSION_CAR1 struct 
11@ += 9
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
/////////////////////
0A97: 11@ = car $MISSION_CAR1 struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
random_float $BENZIN 30.0 50.0
0A97: 22@ = car $MISSION_CAR1 struct 
0A8E: 12@ = 22@ + 5 // int 
0A8C: write_memory 12@ size 4 value $BENZIN virtual_protect 0 
08C3: clear 12@ bit 1
08C3: clear 12@ bit 2
0A97: 11@ = car $MISSION_CAR1 struct 
11@ += 18
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2

0506: set_car_model 15403 next_variation -1 4 // first param is useless

:CAR_CREATE_MISSION20_8_SHIZA
if
model.Available(15403)
then

MISSION_CAR2 = Car.Create(15403, 2369.0996, 1537.4923, 10.7704)

if
model.Available(15403)
then
model.Destroy(15403)
end

else
model.Load(15403)
mload
wait 0
jump to @CAR_CREATE_MISSION20_8_SHIZA
end

Car.Angle(MISSION_CAR2) = 89.6538 
car.Health(MISSION_CAR2) = CAR_HEALTH_MAX             

0229: set_car MISSION_CAR2 primary_color_to $BANDITS_CAR_COLOR1 secondary_color_to $BANDITS_CAR_COLOR2 

0A97: 11@ = car MISSION_CAR2 struct 
11@ += 9
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
/////////////////////
0A97: 11@ = car MISSION_CAR2 struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
random_float $BENZIN 30.0 50.0
0A97: 22@ = car MISSION_CAR2 struct 
0A8E: 12@ = 22@ + 5 // int 
0A8C: write_memory 12@ size 4 value $BENZIN virtual_protect 0
08C3: clear 12@ bit 1
08C3: clear 12@ bit 2
0A97: 11@ = car MISSION_CAR2 struct 
11@ += 18
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2

car.SetImmunities($MISSION_CAR1,1,1,1,1,1)
car.DoorStatus($MISSION_CAR1,4)

while not model.Available(101)
wait 0
model.Load(101)
mload
end

$SURVIVER[1] = actor.Createasdriver(26,101,$MISSION_CAR1)
actor.Angle($SURVIVER[1]) = 194.5013
0446: set_actor $SURVIVER[1] dismemberment_possible 1
060B: set_actor $SURVIVER[1] decision_maker_to $DEC_PEOPLE
077A: set_actor $SURVIVER[1] acquaintance 0 to_actors_pedtype 0 // see ped.dat

0AF0: 0@ = get_int_from_ini_file "config.ini" section "EXTRA" key "PEDFUNCS_SUPPORT"
if
0@ == 1
then
0AF0: 0@ = get_int_from_ini_file "data\survival.set" section "SCR" key "JAMES_REMAP_NUM" 
create_thread @REMAPSET $SURVIVER[1] 0@
end

actor.SetImmunities($SURVIVER[1],1,1,1,1,1)

model.Load(#MICRO_UZI)
mload

actor.GiveWeaponAndAmmo($SURVIVER[1],28,9999)  

00C0: set_current_time 22 0
$WEATHER_SYNC_FLAG = 1

car.SetMaxSpeed($MISSION_CAR1,100.0)

$BANDITS_SPAWN_MIN = 1
$BANDITS_SPAWN_MAX = 3

$ARMY_SPAWN_MIN = 1
$ARMY_SPAWN_MAX = 3

actor.StorePos(PLAYER_ACTOR,20@,21@,22@)

0619: enable_actor PLAYER_ACTOR collision_detection 0
0337: set_actor PLAYER_ACTOR visibility 0

while not model.Available($RANDOM_MODE_MODEL)
wait 0
model.Load($RANDOM_MODE_MODEL)
mload
end

1@ = actor.CreateAsDriver(26,$RANDOM_MODE_MODEL,MISSION_CAR2)

create_thread @PED_BKP 1@ 371

0781: get_weapon_with_ID 30 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(1@,30,200)

22@ += 50.0

actor.LockInCurrentPosition(PLAYER_ACTOR) = true

actor.PutAtNoOffset(PLAYER_ACTOR,20@,21@,22@)

JAMES_LOST_RADIUS = 200.0

car.SetImmunities(MISSION_CAR2,1,1,1,1,1) 

repeat
wait 0

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

07C0: load_path $MISSION19_PATH_NUMBER
until 07C1:   path $MISSION19_PATH_NUMBER available  

05EB: assign_car $MISSION_CAR1 to_path $MISSION19_PATH_NUMBER
wait 100

0407: store_coords_to 4@ 5@ 6@ from_car $MISSION_CAR1 with_offset 0.0 -20.0 0.0
car.PutAt(MISSION_CAR2,4@,5@,6@)
car.SetSpeedInstantly(MISSION_CAR2,5.0)
//05F1: set_car MISSION_CAR2 follow_car $MISSION_CAR1 keep_9o_clock
07F8: car MISSION_CAR2 follow_car $MISSION_CAR1 radius 0.1

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

0936: set_camera 2374.314453 1533.082764 11.358750 position_to 2344.819580 1533.228394 11.947911 time 5000 smooth_transition 1
0920: point_camera 2375.312256 1533.072144 11.294518 transverse_to 2345.817383 1533.234375 11.880792 time 5000 smooth_transition 1

$PREPARING_CHECKPOINT_OFF = 1

if 
CLASSIC_MUSIC == 0
then  
gosub @CHASE_MUSIC_SET
else
if
101@ == 1
    then
    $MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_12B)
    end
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 200
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 250

////////////////////////////////////////////////////////// 

wait 500

if
101@ == 1
then
//create_thread @RGN_HP3
end             

ZOMBIES_NOTSPAWN = 0

create_thread @REFR_3D
fade 1 500
32@ = 0

while not 32@ > 2000
wait 0       

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

end

01B9: set_actor 1@ armed_weapon_to 0            

wait 200
fade 0 200
wait 200

if
$MISSION19_PATH_NUMBER == 934
then
05ED: freeze_car $MISSION_CAR1 while_on_path
end

0936: set_camera 2374.314453 1533.082764 11.358750 position_to 2344.819580 1533.228394 11.947911 time 1 smooth_transition 1
0920: point_camera 2375.312256 1533.072144 11.294518 transverse_to 2345.817383 1533.234375 11.880792 time 1 smooth_transition 1

car.LockInCurrentPosition(MISSION_CAR2) = true

actor.DestroyInstantly(1@)
0619: enable_actor PLAYER_ACTOR collision_detection 1
0337: set_actor PLAYER_ACTOR visibility 1

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

wait 500

wait 1 

actor.LockInCurrentPosition(PLAYER_ACTOR) = false

036A: put_actor PLAYER_ACTOR in_car MISSION_CAR2

car.LockInCurrentPosition(MISSION_CAR2) = false
Car.Angle(MISSION_CAR2) = 89.6538  

wait 1

car.SetSpeedInstantly(MISSION_CAR2,45.0)
camera.Restore_WithJumpCut()

player.CanMove(PLAYER_CHAR) = true
cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

if
$MISSION19_PATH_NUMBER == 934
then
05EE: unfreeze_car $MISSION_CAR1 while_on_path
end

06FD: set_car $MISSION_CAR1 speed_on_path_to $MISSION19_PATH_SPEED
                      
wait 500

//if
//$MISSION19_PATH_NUMBER == 934
//then
create_thread @CAR_SP2 0 MISSION_CAR2
//end

fade 1 1000  
$HUD_REMOVE = 0   
wait 1000

v$OBJECTIVE = "MSN122" 
$SAVESTATUS = 0 
03AB: set_car $MISSION_CAR1 strong 1 
00AE: unknown_set_car $MISSION_CAR1 to_ignore_traffic_lights 2
09E9: car $MISSION_CAR1 add_single_nitro    
                      
jump @MISSION19_CHECK_CAR141_SHIZA

:CHASE_MUSIC_SET_SHIZA

if 
CLASSIC_MUSIC == 0
then 

if
$MISSION19_PATH_NUMBER == 935
    then
    $MUSIC_MISSION = Audiostream.Load(MUSIC_22C1)
    end
    
if
$MISSION19_PATH_NUMBER == 934
    then
    $MUSIC_MISSION = Audiostream.Load(MUSIC_22C3)
    end    

if
$MISSION19_PATH_NUMBER == 901
    then
    $MUSIC_MISSION = Audiostream.Load(MUSIC_22C2)
    end  
    
end     

return

:SKIP_KILLING_MISSION19_3_SHIZA

0AF0: $MISSION19_PATH_NUMBER = get_int_from_ini_file "data\survival.set" section "SCR" key "M19PN"
0AF0: $SECOND_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDSP"
0AF0: $MINUTES_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDMP"
0AF0: $HOURS_PLAYED = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDHP"
0AF0: CURRENT_TIME_HOURS = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDTM1"
0AF0: CURRENT_TIME_MINUTES = get_int_from_ini_file "data\survival.set" section "SCR" key "M19JDTM2"
00C0: set_current_time CURRENT_TIME_HOURS CURRENT_TIME_MINUTES
$WEATHER_SYNC_FLAG = 1

$MISSION19_PATH_NUMBER = 935

048F: actor PLAYER_ACTOR remove_weapons

create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1
actor.GiveWeaponAndAmmo(PLAYER_ACTOR,30,200)

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0        
  
$FATIGUE_LEVEL = 0.0
$BANKA = 0
$BINT = 0
$HEAL = 0
$RADIO = 0
$KANISTRA = 0
$KANISTRA_FUEL = 0
$JIMMY = 0
$SAVESTATUS = 0

player.CanMove(PLAYER_CHAR) = false

$ROCKET_END = 1

036A: put_actor PLAYER_ACTOR in_car MISSION_CAR2

:PATH_LOAD22_SHIZA
wait 0
07C0: load_path $MISSION19_PATH_NUMBER
if
07C1:   path $MISSION19_PATH_NUMBER available
jf @PATH_LOAD22_SHIZA
05EB: assign_car $MISSION_CAR1 to_path $MISSION19_PATH_NUMBER

if
$MISSION19_PATH_NUMBER == 901
then
216@ = 4900.0 
end

if
$MISSION19_PATH_NUMBER == 934
then
216@ = 4510.0 
end

if
$MISSION19_PATH_NUMBER == 935
then
216@ = 5550.0 
end

0706: advance_car $MISSION_CAR1 further_along_path 216@

if
$MISSION19_PATH_NUMBER == 901
then
camera.SetPosition(1671.5775, 2589.4836, 10.7095,0.0,0.0,0.0)
renderer 1671.5775 2589.4836
03CB: set_rendering_origin_at 1671.5775 2589.4836 10.7095
actor.PutAtNoOffset(PLAYER_ACTOR, 1671.5775, 2589.4836, 10.7095)
actor.Angle(PLAYER_ACTOR) = 260.0097
car.SetSpeedInstantly($MISSION_CAR1,30.0)
car.SetSpeedInstantly(MISSION_CAR2,30.0)
end

if
$MISSION19_PATH_NUMBER == 934
then
camera.SetPosition(2101.9648, 2385.3901, 45.2594,0.0,0.0,0.0)
renderer 2101.9648 2385.3901
03CB: set_rendering_origin_at 2101.9648 2385.3901 45.2594
actor.PutAtNoOffset(PLAYER_ACTOR, 2101.9648, 2385.3901, 45.2594)
car.PutAt(MISSION_CAR2,2075.5974, 2376.5732, 40.9851)
actor.Angle(PLAYER_ACTOR) = 284.796
car.SetSpeedInstantly($MISSION_CAR1,10.0)
car.SetSpeedInstantly(MISSION_CAR2,10.0)
end

if
$MISSION19_PATH_NUMBER == 935
then
camera.SetPosition(1166.3021, 1596.6454, 5.848,0.0,0.0,0.0)
renderer 1166.3021 1596.6454
03CB: set_rendering_origin_at 1166.3021 1596.6454 5.848
actor.PutAtNoOffset(PLAYER_ACTOR, 1166.3021, 1596.6454, 5.848)
car.Angle(MISSION_CAR2) = 3.7278
car.SetSpeedInstantly($MISSION_CAR1,20.0)
car.SetSpeedInstantly(MISSION_CAR2,20.0)
end

camera.Restore_WithJumpCut()
player.CanMove(PLAYER_CHAR) = true

$PREPARING_CHECKPOINT_OFF = 1

gosub @CHASE_MUSIC_SET

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 200
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 250

////////////////////////////////////////////////////////// 

wait 500

camera.Restore_WithJumpCut()   

wait 1
fade 1 1000   

$HUD_REMOVE = 0 
 
wait 1000
jump @MISSION19_CHECK_CAR141_SHIZA

:MISSION19_CHECK_CAR141_SHIZA
wait 2000

random_int 0@ 0 to 3

if
0@ == 0
then
v$ST_DIALOG[0] = "NDG92"
v$ST_DIALOG[1] = "NDG93"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
end

if
0@ == 1
then
v$ST_DIALOG[0] = "NDG94"
v$ST_DIALOG[1] = "NDG95"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
end

if
0@ == 2
then
v$ST_DIALOG[0] = "NDG96"
v$ST_DIALOG[1] = "NDG97"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
end

create_thread @DG_SYS2 

repeat
wait 0      

if
00F2:   actor $SURVIVER[1] near_actor PLAYER_ACTOR radius JAMES_LOST_RADIUS JAMES_LOST_RADIUS sphere 0   
jf @KOD_PROVALA19_DISTANCE 

if
not car.Wrecked($MISSION_CAR1)
jf @KOD_PROVALA19_CAR

if 
not Actor.Dead(PLAYER_ACTOR)
jf @KOD_PROVALA19  

if or
00FE:   actor $SURVIVER[1] sphere 0 in_sphere 2161.4258 2492.4163 10.8203 radius 5.0 5.0 3.0
00FE:   actor $SURVIVER[1] sphere 0 in_sphere 927.4657 2763.7673 19.1347 radius 5.0 5.0 3.0     
00FE:   actor $SURVIVER[1] sphere 0 in_sphere 1145.3333 1717.3793 10.8203 radius 5.0 5.0 3.0     
    then
    break
    end
    
//chaseskip
if and
$CHEATS_ON == 1
$DEBUG_MENU_ON == 1
0ADC:   test_cheat "SKIP"
    then
    break
    end    

until false

v$OBJECTIVE = "DUMMY" 

05EC: release_car $MISSION_CAR1 from_path
0873: release_path $MISSION19_PATH_NUMBER

$INF_EFF_END = 1

$END_DIALOG_INST = 1

car.SetImmunities($MISSION_CAR1,1,0,0,0,0)
car.Health($MISSION_CAR1) = 400
car.DoorStatus($MISSION_CAR1,0)
$CAR_SPEED_OGR_OFF_FLAG = 1

0221: set_player PLAYER_CHAR apply_brakes_to_car 1
player.CanMove(PLAYER_CHAR) = false

fade 0 500
$HUD_REMOVE = 1
wait 500
0221: set_player PLAYER_CHAR apply_brakes_to_car 0

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
$ROCKET_END = 1

0555: remove_weapon 46 from_actor PLAYER_ACTOR

$SAVESTATUS = 1 
0325: 49@ = create_car $MISSION_CAR1 fire

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 700
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 1000
wait 1000
audiostream.Release($MUSIC_MISSION)

//////////////////////////////////////////////////////////

$COMMAND_GRP_SEAT_IN_TEXT = 0  

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "STATS_STORY_COMPLETED"

if
$CHEATED_FLAG == 0
then                
0@ += 1 
end               
 
0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "STATS_STORY_COMPLETED"

$STATS_SHOW_GAMEMODE = 0
$STATS_SHOW_FLAG = 1
create_thread @STS_SHW 

////////////////////////////////Получение достижения "Незабываемая история"////////////////////////////////

0AF0: 1@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT30_GOT"

if and
1@ == 0
0@ >= 5
$CHEATED_FLAG == 0
    then
    v$ACHIEVEMNT = "ACH30"
    $ACHIEVEMENT_GOT_FLAG = 1    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT30_GOT"    
    end  
    
while $ACHIEVEMENT_GOT_FLAG == 1
wait 0
end     

////////////////////////////////Получение достижения "Начало конца"////////////////////////////////

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT2_GOT"

if and
0@ == 0
$CHEATED_FLAG == 0
    then
    v$ACHIEVEMNT = "ACH2"
    $ACHIEVEMENT_GOT_FLAG = 1    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT2_GOT"    
    end  
    
while $ACHIEVEMENT_GOT_FLAG == 1
wait 0
end     
    
////////////////////////////////Получение достижения "Максимальная боль"////////////////////////////////        

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT3_GOT"

if and
0@ == 0
$NIGHTMARE_MODE == 1
$CHEATED_FLAG == 0
    then
    v$ACHIEVEMNT = "ACH3"
    $ACHIEVEMENT_GOT_FLAG = 1    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT3_GOT"    
    end 
    
while $ACHIEVEMENT_GOT_FLAG == 1
wait 0
end          

////////////////////////////////Получение достижения "Неземная удача"////////////////////////////////               

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT24_GOT"
0AF0: 1@ = get_int_from_ini_file "data\survival.set" section "SCR" key "MIKE_STORY_MISSION20_FAILED"

if and
0@ == 0
1@ == 0
$CHEATED_FLAG == 0
    then
    v$ACHIEVEMNT = "ACH24"
    $ACHIEVEMENT_GOT_FLAG = 1    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT24_GOT"    
    end  
    
while $ACHIEVEMENT_GOT_FLAG == 1
wait 0
end      

if
CLASSIC_MUSIC == 0
then 
$MUSIC_MISSION = Audiostream.Load(MUSIC_22D)
else
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_22D)
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 1000

//////////////////////////////////////////////////////////          

if
$MISSION19_PATH_NUMBER == 935
    then
    car.PutAt($MISSION_CAR1,1145.9823, 1719.4803, 10.5015)
    car.Angle($MISSION_CAR1) = 4.723
    
    car.PutAt(MISSION_CAR2,1143.6964, 1709.4669, 10.8558)
    car.Angle(MISSION_CAR2) = 19.9684
    
    05BE: AS_actor $SURVIVER[1] die
    
    0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1143.0294 1717.2316 10.8203
    
    actor.PutAtNoOffset(PLAYER_ACTOR,1141.3549, 1714.4233, 10.8203)
    actor.Angle(PLAYER_ACTOR) = 318.7415
    
    0936: set_camera 1141.274658 1711.602783 11.469737 position_to 1141.607788 1713.547974 11.531880 time 20000 smooth_transition 1
    0920: point_camera 1141.776367 1712.403320 11.142027 transverse_to 1142.033447 1714.439941 11.379457 time 20000 smooth_transition 1 
    end
    
if
$MISSION19_PATH_NUMBER == 934
    then
    car.PutAt($MISSION_CAR1,927.424, 2763.4768, 19.1298)
    car.Angle($MISSION_CAR1) = 83.4607
    
    car.PutAt(MISSION_CAR2,945.48, 2764.3203, 18.5926)
    car.Angle(MISSION_CAR2) = 101.7507
    
    05BE: AS_actor $SURVIVER[1] die
    
    0362: remove_actor PLAYER_ACTOR from_car_and_place_at 930.8284 2761.2312 19.0588
    
    actor.PutAtNoOffset(PLAYER_ACTOR,930.8284, 2761.2312, 19.0588)
    actor.Angle(PLAYER_ACTOR) = 63.0607
    
    actor.PutAtNoOffset($SURVIVER[1],927.8022, 2762.2705, 19.1611)
    actor.Angle($SURVIVER[1]) = 69.9933    
    
    0936: set_camera 933.501770 2757.589844 20.676624 position_to 931.367371 2759.456543 19.815655 time 20000 smooth_transition 1
    0920: point_camera 932.776367 2758.236816 20.441309 transverse_to 930.624512 2760.059326 19.524620 time 20000 smooth_transition 1 
    end  
    
if
$MISSION19_PATH_NUMBER == 901
    then
    
    car.PutAt($MISSION_CAR1,2160.4883, 2490.873, 10.4606)
    car.Angle($MISSION_CAR1) = 86.3
                                        
    car.PutAt(MISSION_CAR2,2178.553, 2487.5002, 10.8663)
    car.Angle(MISSION_CAR2) = 68.5666
    
    05BE: AS_actor $SURVIVER[1] die
    
    0362: remove_actor PLAYER_ACTOR from_car_and_place_at 2166.6841 2486.0625 10.8203        
    
    actor.PutAtNoOffset(PLAYER_ACTOR,2166.292, 2487.5381, 10.8203)
    actor.Angle(PLAYER_ACTOR) = 61.4505    
    
    0936: set_camera 2167.992188 2485.143311 11.532124 position_to 2166.996826 2485.845703 11.256170 time 20000 smooth_transition 1
    0920: point_camera 2167.309082 2485.646729 11.302906 transverse_to 2166.256836 2486.438965 10.938904 time 20000 smooth_transition 1 
    end      
    
$SPEED_05_FLAG = 1
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1
actor.GiveWeaponAndAmmo(PLAYER_ACTOR,30,1)
01B9: set_actor PLAYER_ACTOR armed_weapon_to 30  

wait 1000
fade 1 10000
wait 1
05BF: AS_actor PLAYER_ACTOR look_at_actor $SURVIVER[1] 10000 ms
wait 2000

v$ST_DIALOG[0] = "MSN774"
v$ST_DIALOG[1] = "MSN775"
v$ST_DIALOG[2] = "MSN776"
v$ST_DIALOG[3] = "MSN777"
v$ST_DIALOG[4] = "MSN778"
v$ST_DIALOG[5] = "MSN779"
$DIALOG_COUNT = 5
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2 
$HUD_REMOVE = 1

repeat
wait 0
until $DIALOG_END == 1

$DIALOG_END = 1

fade 0 100
wait 100

$SPEED_05_FLAG = 0 
015D: set_gamespeed 1.0 

0936: set_camera 1141.274658 1711.602783 11.469737 position_to 1141.607788 1713.547974 11.531880 time 1 smooth_transition 1
0920: point_camera 1141.776367 1712.403320 11.142027 transverse_to 1142.033447 1714.439941 11.379457 time 1 smooth_transition 1 

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

048F: actor PLAYER_ACTOR remove_weapons

$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
$DELETE_SOUND = 1

player.CanMove(PLAYER_CHAR) = true

repeat
wait 0
07C0: load_path 936
until 07C1:   path 936 available   

00C0: set_current_time 0 0
$WEATHER_SYNC_FLAG = 1

0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1126.9855 1709.9171 10.8203

wait 1

0881: set_player PLAYER_CHAR able_to_shoot_weapons 0

0464: put_actor PLAYER_ACTOR into_turret_on_car MISSION_CAR2 at_car_offset 0.0 0.5 0.15 position 0 shooting_angle_limit 40.0 with_weapon 22

while not model.Available($RANDOM_MODE_MODEL)
wait 0
model.Load($RANDOM_MODE_MODEL)
mload
end

actor.CreateAsDriver(21@,26,$RANDOM_MODE_MODEL,MISSION_CAR2)  

082A: set_player PLAYER_CHAR able_to_use_crouch_button 0

wait 1

041E: set_radio_station 12
    
05EB: assign_car MISSION_CAR2 to_path 936
06FD: set_car MISSION_CAR2 speed_on_path_to 1.025
099A: set_car MISSION_CAR2 collision_detection 0

0555: remove_weapon 46 from_actor PLAYER_ACTOR

wait 3000    

16@ = car.Angle(MISSION_CAR2)
16@ -= 90.0
0858: set_player PLAYER_CHAR scan_horizon_to_angle 16@ rotation_speed 16@   

wait 1

500@ = 0 //FADING_IN_FLAG
501@ = 1 //FADING_OUT_FLAG

fade 1 10000 
wait 5000      
fade 0 10000
06D1: v$ST_DIALOG[0] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[1] = "NDG111" // v$ = string 
06D1: v$ST_DIALOG[2] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[3] = "NDG112" // v$ = string 
06D1: v$ST_DIALOG[4] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[5] = "NDG113" // v$ = string 
06D1: v$ST_DIALOG[6] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[7] = "NDG114" // v$ = string 
06D1: v$ST_DIALOG[8] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[9] = "NDG115" // v$ = string 
06D1: v$ST_DIALOG[10] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[11] = "NDG116" // v$ = string 
06D1: v$ST_DIALOG[12] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[13] = "NDG117" // v$ = string 
06D1: v$ST_DIALOG[14] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[15] = "NDG118" // v$ = string 
06D1: v$ST_DIALOG[16] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[17] = "NDG119" // v$ = string 
06D1: v$ST_DIALOG[18] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[19] = "NDG120" // v$ = string 
06D1: v$ST_DIALOG[20] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[21] = "NDG121" // v$ = string 
06D1: v$ST_DIALOG[22] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[23] = "NDG122" // v$ = string 
06D1: v$ST_DIALOG[24] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[25] = "NDG123" // v$ = string 
$DIALOG_COUNT = 25 
$DIALOG_NOT_SKIP = 1 
create_thread @DG_SYS2 

repeat
wait 0

if and
32@ > 5000
500@ == 0
501@ == 1 
then
33@ = 0
500@ = 1
501@ = 0
fade 1 10000
end

if and
33@ > 5000
500@ == 1
501@ == 0 
then
32@ = 0
500@ = 0
501@ = 1
fade 0 10000
end

if or          
00EC:   actor PLAYER_ACTOR sphere 0 near_point 373.8303 -2041.2294 radius 100.0 100.0 
00E1:   player 0 pressed_key 17
00E1:   player 0 pressed_key 16
    then
    break
    end

until false  

$END_DIALOG_INST = 1

fade 0 2500
wait 2500
015D: set_gamespeed 1.0

player.CanMove(PLAYER_CHAR) = false

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 700
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 1000
wait 1000
audiostream.Release($MUSIC_MISSION)

////////////////////////////////////////////////////////// 

0881: set_player PLAYER_CHAR able_to_shoot_weapons 1

0465: remove_actor PLAYER_ACTOR from_turret_mode

082A: set_player PLAYER_CHAR able_to_use_crouch_button 1

0362: remove_actor PLAYER_ACTOR from_car_and_place_at 386.373 -2081.4414 7.8359

actor.PutAtNoOffset(PLAYER_ACTOR,386.373, -2081.4414, 7.8359)
actor.Angle(PLAYER_ACTOR) = 180.3525

0936: set_camera 388.5846 -2076.3237 8.8359 position_to 385.8317 -2088.5967 7.8359 time 92000 smooth_transition 1
0920: point_camera 386.4236 -2088.7983 8.8359 transverse_to 386.4236 -2088.7983 7.8359 time 92000 smooth_transition 1


Model.Load(#BFYRI)
mload

while not model.Available(#BFYRI)
wait 0
model.Load(#BFYRI)
mload
end
 
209@ = Actor.Create(5, #BFYRI, 385.5094, -2088.2502, 7.8359)
Actor.Angle(209@) = 180.0

0D10: set_actor 209@ alpha 150 // IF and SET 

wait 1 

while not animation.Available("GRAVEYARD")
wait 0
animation.Load("GRAVEYARD")
end

0605: actor 209@ perform_animation "mrnF_loop" IFP "GRAVEYARD" framedelta 4.0 loop 1 lockX 0 lockY 0 lockF 0 time 90000

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

wait 1

0605: actor PLAYER_ACTOR perform_animation "mrnM_loop" IFP "GRAVEYARD" framedelta 4.0 loop 1 lockX 0 lockY 0 lockF 0 time 90000

if
CLASSIC_MUSIC == 0
then 
$MUSIC_MISSION = Audiostream.Load(MUSIC_1A)
else
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_22E)
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 5000
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 5000

//////////////////////////////////////////////////////////

$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\AmandaCry.mp3")
Audiostream.LinkToActor($SHIT_FUCK, 209@)
Audiostream.PerformAction($SHIT_FUCK, PLAY)
Audiostream.Volume($SHIT_FUCK) = $SOUNDS_VOLUME   
Audiostream.Loop($SHIT_FUCK,1)   

fade 1 57000
06D1: v$ST_DIALOG[0] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[1] = "NDG166" // v$ = string 
06D1: v$ST_DIALOG[2] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[3] = "NDG167" // v$ = string 
06D1: v$ST_DIALOG[4] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[5] = "NDG168" // v$ = string 
06D1: v$ST_DIALOG[6] = "DUMMY" // v$ = string 
06D1: v$ST_DIALOG[7] = "NDG169" // v$ = string 
$DIALOG_COUNT = 7 
$DIALOG_NOT_SKIP = 1 
create_thread @DG_SYS2
wait 1

wait 10000 

fade 0 100
wait 100

audiostream.Release($SHIT_FUCK)

wait 5000

actor.DestroyInstantly(209@)
actor.DestroyInstantly($SURVIVER[0])

$ACHIV_TOTAL_SHOW_OFF_FLAG = 0

$DRAW_RED = 0

0AF1: write_int 0 to_ini_file "saves\ZACM.set" section "SCR" key "VOICE_SHOWED"

$GODMODE_FLAG = 1
actor.SetImmunities(PLAYER_ACTOR,1,1,1,1,1)
0459: end_thread_named 'LOW_HEA'
0459: end_thread_named 'DED_CHK'
create_thread @FIN_CNM
create_thread @FIN_TIT

end_thread 