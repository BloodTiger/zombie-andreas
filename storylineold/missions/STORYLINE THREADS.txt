//Mike Storyline Threads

:PLA_LOM
thread 'PLA_LOM'

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 2 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 188.7872 159.3233 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 3 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 197.8863 164.9621 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 4 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 197.1083 166.6452 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 5 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 198.0525 167.7492 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 6 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 197.0451 168.5548 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 7 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 198.3176 169.8285 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 8 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 197.2115 170.8227 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 9 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 198.3265 168.6538 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 10 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 196.817 170.1385 1003.0234
end
end

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 11 weapon 0@ ammo 1@ model 2@
if
not 2@ == -1
then
0E7F: get_model_type 2@ store_to 3@
if
3@ == 4
then
032B: 3@ = create_weapon_pickup 2@ group 15 ammo 1@ at 198.7885 166.7094 1003.0234
end
end

if
0491:   actor PLAYER_ACTOR has_weapon 92
    then
    032B: 3@ = create_weapon_pickup #M79 group 15 ammo 1 at 199.0903 169.5957 1003.0234
    end
    
if
0491:   actor PLAYER_ACTOR has_weapon 107
    then
    032B: 3@ = create_weapon_pickup #MGL group 15 ammo 1 at 199.0903 169.5957 1003.0234
    end

///////////////////////

048F: actor PLAYER_ACTOR remove_weapons

end_thread

:MCS_ASSES
thread 'MCS_ASSES'

while true
wait 0

if
$ENTERED_CAMP == 0
then
    
    for $CAMP_NUMBER = 0 to 13
    
    if and
    $CAMP_DEAD_FLAG[$CAMP_NUMBER] == 2  
    00FE:   actor PLAYER_ACTOR sphere 0 in_sphere $CAMP_X[$CAMP_NUMBER] $CAMP_Y[$CAMP_NUMBER] $CAMP_Z[$CAMP_NUMBER] radius 180.0 180.0 100.0
        then
        $ENTERED_CAMP = 1  
        jump to @FUCKMEPLEASE_MIKE
        end  
          
    end  

end

:FUCKMEPLEASE_MIKE

if and
$CAMP_DEAD_FLAG[$CAMP_NUMBER] == 2  
00FE:   actor PLAYER_ACTOR sphere 0 in_sphere $CAMP_SAVE_X[$CAMP_NUMBER] $CAMP_SAVE_Y[$CAMP_NUMBER] $CAMP_SAVE_Z[$CAMP_NUMBER] radius 180.0 180.0 100.0
$ENTERED_CAMP == 1
$ONMISSION == 0
BASE_TEAMMATE_AGRED == 0
not $SOUND_EFFECT1_FLAG == 1
    then
    if or
    ARMY_SAVES_ON == 1
    BANDITS_SAVES_ON == 1
    MCS_FLAG == 1    
        then     
        if and
        875C: not  marker $SURV_CMP_SAVE_MARKER enabled
        80EC: not  actor PLAYER_ACTOR sphere 0 near_point $CAMP_SAVE_X[$CAMP_NUMBER] $CAMP_SAVE_Y[$CAMP_NUMBER] radius 2.0 2.0
        $CAMP_DEAD_FLAG[$CAMP_NUMBER] == 2
            then
            wait 500
            $SURV_CMP_SAVE_MARKER = marker.CreateIconWithoutSphere(18,$CAMP_X[$CAMP_NUMBER], $CAMP_Y[$CAMP_NUMBER], $CAMP_Z[$CAMP_NUMBER])
            
            //////////////////////////////////////////

            BASE_TEMMATE_CAMP_FLAG_GIVE = 1
            BASE_TEAMMATES_TYPE_GIVE = 2
            0084: BASE_TEAMMATES_NUMBER_GIVE = $CAMP_NUMBER // (int)
            create_thread @BAS_TEA
            
            //////////////////////////////////////////
             
            end                
        end
    end    

if and 
80FE: not  actor PLAYER_ACTOR sphere 0 in_sphere $CAMP_X[$CAMP_NUMBER] $CAMP_Y[$CAMP_NUMBER] $CAMP_Z[$CAMP_NUMBER] radius 180.0 180.0 100.0
$ENTERED_CAMP == 1
    then
    $ENTERED_CAMP = 0
    BASE_TEAMMATES_DESTORY_FLAG = 1
    if
    075C:   marker $SURV_CMP_SAVE_MARKER enabled
        then             
        
        if
        075C:   marker $SURV_CMP_SAVE_MARKER enabled
        then 
        marker.Disable($SURV_CMP_SAVE_MARKER)
        end                
          
        end
    end
    
if
075C:   marker $SURV_CMP_SAVE_MARKER enabled
    then    
    if or
    $ONMISSION == 1
    BASE_TEAMMATE_AGRED == 1
        then        
            
        if
        075C:   marker $SURV_CMP_SAVE_MARKER enabled
        then 
        marker.Disable($SURV_CMP_SAVE_MARKER)
        end
        
        end    
    end
    
end    
    
return

:MCS_ASS_CREATE
thread 'MCS_ASS_CREATE'

if
MIKE_SHIZA_FLAG == 1
then
end_thread
end

BASE_TEMMATE_CREATE_WITH_FADE_GIVE = 0

$CAMP_DEAD_FLAG2 = 1
$CAMP_SPOTTED_FLAG = 0
$CAMP_SPOTTED_FLAG_SAVE = 0

if
075C:   marker $CAMP_MARKER[24@] enabled
then
marker.Disable($CAMP_MARKER[24@])
end

$CAMP_MARKER[24@] = marker.CreateIconWithoutSphere(107,$CAMP_X[24@], $CAMP_Y[24@], $CAMP_Z[24@])

gosub @CAMP_ZONE_CHECK2_DESTROY
0879: enable_gang_wars 0
076C: set_zone v$SFUCK gang 5 density_to 0
076C: set_zone v$SFUCK gang 4 density_to 100
0879: enable_gang_wars 1

$CAMP_DEAD_FLAG[24@] = 2
$CAMP_AGRED_FLAG[24@] = 1
$CAMP_AGRED_FLAG2 = 0
CAMP_SUSP_TIMES = 0
CAMP_SAW_SHIT = 0    
    
end_thread

:MCS_ASS_CREATE2
thread 'MCS_ASS_CREATE2'

fade 0 500
$HUD_REMOVE = 1
wait 500

00BF: 0@ = current_time_hours, 1@ = current_time_minutes
0@ += 2

if
0@ == 24
then
0@ = 0
end

if
0@ == 25
then
0@ = 1
end

00C0: set_current_time 0@ 1@

$CAMP_DEAD_FLAG2 = 0
$CAMP_SPOTTED_FLAG = 0
$CAMP_SPOTTED_FLAG_SAVE = 0

if
075C:   marker $CAMP_MARKER[24@] enabled
then
marker.Disable($CAMP_MARKER[24@])
end

if
075C:   marker $SURV_CMP_SAVE_MARKER enabled
then
marker.Disable($SURV_CMP_SAVE_MARKER)
end

$CAMP_MARKER[24@] = marker.CreateIconWithoutSphere(31,$CAMP_X[24@], $CAMP_Y[24@], $CAMP_Z[24@])
0980: extinguish_all_fires_at $CAMP_X[24@] $CAMP_Y[24@] $CAMP_Z[24@] radius 200.0    

gosub @CAMP_ZONE_CHECK2_DESTROY
0879: enable_gang_wars 0
076C: set_zone v$SFUCK gang 4 density_to 0
076C: set_zone v$SFUCK gang 5 density_to 100
0879: enable_gang_wars 1

$CAMP_DEAD_FLAG[24@] = 0
$CAMP_AGRED_FLAG[24@] = 0
$CAMP_AGRED_FLAG2 = 0
CAMP_SUSP_TIMES = 0
CAMP_SAW_SHIT = 0
gosub @TRADER_CHECK_FOR_RESPAWN

wait 0
create_thread @IPL_UNL

repeat
wait 0
until PEDIKS_OBJS_UNLOADED == 1

create_thread @IPL_CRT
wait 500

fade 1 500
$HUD_REMOVE = 0
wait 500
    
end_thread 

:TRADER_CHECK_FOR_RESPAWN

////////////////////////Пересоздаем торговца////////////////////////

if
UNITED_MAP == 0
then

if
24@ == 3
then
1@ = 11
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

if
24@ == 9
then
1@ = 13
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

end

if
UNITED_MAP == 1
then

if
24@ == 0
then
1@ = 0
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

if
24@ == 3
then
1@ = 1
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

if
24@ == 6
then
1@ = 4
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

if
24@ == 2
then
1@ = 5
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

if
24@ == 1
then
1@ = 8
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

if
24@ == 8
then
1@ = 9
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

if
24@ == 4
then
1@ = 10
gosub @TRADER_RESPAWN_IN_FREEIED_CAMP
end

end

return

:TRADER_RESPAWN_IN_FREEIED_CAMP
$TRADER_DEAD_FLAG[1@] = 0
$TRADER_ANGRY_FLAG[1@] = 0
marker.Disable($TRADER_ICON[1@])
$TRADER_ICON[1@] = Marker.CreateIconWithoutSphere(52, $TRADER_X[1@], $TRADER_Y[1@], $TRADER_Z[1@])
0879: enable_gang_wars 0
gosub @TRADER_ZONE_CHECKB
076C: set_zone v$TFUCK gang 3 density_to 40
076C: set_zone v$TFUCK gang 4 density_to 0
0879: enable_gang_wars 1
TRADER_GENERATE_NEW_SPISOK_FLAG = 1    
return                

:FINAL_MIKE
thread 'FINAL_MIKE'

0459: end_thread_named 'BNDT_SP'
$ALLOW_BANDIT_CONVOY = 0
wait 2000
text.ClearAll()
text.ShowTextBox('MSN27')
v$OBJECTIVE = "MSN987"

repeat
wait 0

if or
$ENTERED_BCAMP_NUMBER == 1
$ENTERED_BCAMP_NUMBER == 2
$ENTERED_BCAMP_NUMBER == 3
$ENTERED_BCAMP_NUMBER == 4
    then
    CANT_CAPTURE_SHIT = 1
    else
    CANT_CAPTURE_SHIT = 0
    end

//timerskip
if and
$CHEATS_ON == 1
$DEBUG_MENU_ON == 1
    then
    if
    0ADC:   test_cheat "FINALE"
        then
        break
        end
    end

if and
NESTS_CLEARED_TOTAL >= 12
$ZONE69_CAPTURED == 1
$ZONE2_CAPTURED == 1
$ZONE3_CAPTURED == 1
$ZONE4_CAPTURED == 1
$PANEL_OPEN == 0
$EATING_STATUS == 0
044B:   actor PLAYER_ACTOR on_foot
    then
    break
    end

until false

$RADIO_SOUND = Audiostream.Load("AUDIO\SOUNDS\Radio.mp3") 
Audiostream.Loop($RADIO_SOUND, 1)  
Audiostream.Volume($RADIO_SOUND) = VERO_TIPA_VOLUME
Audiostream.PerformAction($RADIO_SOUND, PLAY)

Audiostream.Loop($RADIO_ON_SOUND,0)
Audiostream.PerformAction($RADIO_ON_SOUND, PLAY)
Audiostream.Volume($RADIO_ON_SOUND) = $SOUNDS_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $RADIO_SOUND // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $SOUNDS_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 500
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1 
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $RADIO_SOUND volume $MUSIC_VOLUME time 500

////////////////////////////////////////////////////////

1@ = 12
gosub @TRADER_DEAD_TEST

00BC: show_text_highpriority GXT 'MSN983' time 4500 flag 1  // ~s~Come back between 9:00 and 17:00.
wait 4500
00BC: show_text_highpriority GXT 'MSN984' time 3500 flag 1  // ~s~Come back between 9:00 and 17:00.
wait 3500
           
1@ = marker.CreateIconAndSphere(33,417.1938, 2521.9702, 16.4844)
v$OBJECTIVE = "DUMMY"

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $RADIO_SOUND // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 150
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1 
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $RADIO_SOUND volume 0.0 time 250
wait 250
audiostream.Release($RADIO_SOUND)

/////////////////////////////////////////////////////////////////

Audiostream.Loop($RADIO_OFF_SOUND,0)
Audiostream.PerformAction($RADIO_OFF_SOUND, PLAY)
Audiostream.Volume($RADIO_OFF_SOUND) = $SOUNDS_VOLUME

jump to @FINAL_MISSION_MIKE_START_CHECK

:FINAL_MISSION_MIKE_START_CHECK
wait 0

if
875C: not  marker 1@ enabled
then
1@ = marker.CreateIconAndSphere(33,417.1938, 2521.9702, 16.4844)
end

if
0E45: frame_mod 60
then
0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "MIKE_STORY_MISSION20_FAILED"
end

if
not 0@ == 1
jf @FINAL_MISSION_MIKE_START_CHECK2
if 
00EC:   actor PLAYER_ACTOR sphere 0 near_point 417.1938 2521.9702 radius 1.0 1.0 
jf @FINAL_MISSION_MIKE_START_CHECK 
if and
not Actor.Driving(PLAYER_ACTOR)
not Actor.Dead(PLAYER_ACTOR)
jf @FINAL_MISSION_MIKE_START_CHECK

player.CanMove(PLAYER_CHAR) = false
00BA: text_styled 'MSN756' 3000 ms 2
Marker.Disable(1@)
fade 0 1000
$HUD_REMOVE = 1 
wait 1000
$DELETE_TEAMMATES = 1
wait 500 
start_mission 20 
end_thread

:FINAL_MISSION_MIKE_START_CHECK2
text.RemoveTextBox()
text.ShowTextBox('DLC981')

:FINAL_MISSION_MIKE_START_CHECK3
wait 0
if or
0AB0:   key_pressed 50
00EC:   actor PLAYER_ACTOR sphere 0 near_point 417.1938 2521.9702 radius 1.0 1.0            
jf @FINAL_MISSION_MIKE_START_CHECK3

player.CanMove(PLAYER_CHAR) = false
fade 0 1000
$HUD_REMOVE = 1
wait 1000
$DELETE_TEAMMATES = 1
wait 500
09BA: show_entered_zone_name 0
renderer 417.1938 2521.9702
03CB: set_rendering_origin_at 417.1938 2521.9702 16.4844
actor.PutAtNoOffset(PLAYER_ACTOR,417.1938, 2521.9702, 16.4844)
00BA: text_styled 'MSN756' 3000 ms 2
Marker.Disable(1@) 
wait 1000 
start_mission 20 
end_thread

:FINAL_MISSION_MIKE_START_CHECK4 
wait 0
if 
00EC:   actor PLAYER_ACTOR sphere 0 near_point 417.1938 2521.9702 radius 1.0 1.0 
jf @FINAL_MISSION_MIKE_START_CHECK4 
if and
not Actor.Driving(PLAYER_ACTOR)
not Actor.Dead(PLAYER_ACTOR)
jf @FINAL_MISSION_MIKE_START_CHECK4
player.CanMove(PLAYER_CHAR) = false
00BA: text_styled 'MSN756' 3000 ms 2
Marker.Disable(1@)
fade 0 1000
$HUD_REMOVE = 1 
wait 1000
$DELETE_TEAMMATES = 1
wait 500 
start_mission 20 
end_thread

:MISSION_START3
thread 'MISSION_START3' 
wait 3000 

:MISSION_START3_24
wait 0 
if and
03D9:   save_done 
   not fading 
  $SAVESTATUS == 0 
jf @MISSION_START3_24 
Text.ShowTextBox('MSN11')
v$OBJECTIVE = "MSN985"
random_int 3@ 360000 640000

32@ = 0

repeat
wait 0

//timerskip
if and
$CHEATS_ON == 1
$DEBUG_MENU_ON == 1
0ADC:   test_cheat "SKIP"
    then
    break
    end

until 002D:   32@ >= 3@  // (int)
 
gosub @MISSION_START3_460

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $RADIO_SOUND // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 150
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $RADIO_SOUND volume 0.0 time 250
wait 250
audiostream.Release($RADIO_SOUND)

/////////////////////////////////////////////////////////////////

Audiostream.Loop($RADIO_OFF_SOUND,0)
Audiostream.PerformAction($RADIO_OFF_SOUND, PLAY)
Audiostream.Volume($RADIO_OFF_SOUND) = $SOUNDS_VOLUME
 
1@ = Marker.CreateIconAndSphere($MISSION_ICON, $X_START, $Y_START, $Z_START)

v$OBJECTIVE = "MSN989"
28@ = 0

:MISSION_START3_105
wait 0

if
875C: not  marker 1@ enabled
then
1@ = Marker.CreateIconAndSphere($MISSION_ICON, $X_START, $Y_START, $Z_START)
end

if
28@ == 0
    then
    if and
    $BANKA > 9
    $KANISTRA_FUEL >= 24.9
        then
        if or
        $HEAL > 3 
        $BINT > 3
            then
            28@ = 1
            v$OBJECTIVE = "MSN988"
            end
        end
    end
    
if
28@ == 1
    then
    if or
    $BANKA < 10
    $KANISTRA_FUEL < 24.9
        then
        28@ = 0
        v$OBJECTIVE = "MSN986"
        else
        if or
        $HEAL > 3 
        $BINT > 3
            then
            else
            28@ = 0
            v$OBJECTIVE = "MSN986"
            end
        end
    end    
 
if 
0101:   actor PLAYER_ACTOR in_sphere $X_START $Y_START $Z_START radius 1.0 1.0 2.0 sphere 0 stopped 
jf @MISSION_START3_105 
if and
not Actor.Dead(PLAYER_ACTOR)
$PANEL_OPEN == 0
$EATING_STATUS == 0
jf @MISSION_START3_105 
if 
  $BANKA > 9 
jf @MISSION_START3_286 
if or
  $HEAL > 3 
  $BINT > 3 
jf @MISSION_START3_325 
if 
  $KANISTRA_FUEL >= 24.9 
jf @MISSION_START3_364 
Text.ShowStyled(v$MISSION_NAME, 3000, 2)
Marker.Disable(1@)
09A6: enable_interior_radar_blips 0 
Player.CanMove(PLAYER_CHAR) = False
v$OBJECTIVE = "DUMMY"
fade 0 1000
$HUD_REMOVE = 1 
wait 1000  
start_mission $MISSION_START 
end_thread 

:MISSION_START3_286
Text.ShowL('MSN12', 4000, 1)
wait 1000 
Text.ShowTextBox('MSN12C1')
v$OBJECTIVE = "MSN986"
jump @MISSION_START3_403 

:MISSION_START3_325
Text.ShowL('MSN12B', 4000, 1)
wait 1000 
Text.ShowTextBox('MSN12C2')
v$OBJECTIVE = "MSN986"
jump @MISSION_START3_403 

:MISSION_START3_364
Text.ShowL('MSN12C', 4000, 1)
wait 1000 
Text.ShowTextBox('MSN12C3')
v$OBJECTIVE = "MSN986"
jump @MISSION_START3_403 

:MISSION_START3_403
wait 0 
if 
8101:   not actor PLAYER_ACTOR in_sphere $X_START $Y_START $Z_START radius 1.0 1.0 2.0 sphere 0 stopped 
jf @MISSION_START3_403 
Text.RemoveTextBox
Text.ClearAll
jump @MISSION_START3_105 

:MISSION_START3_460 

$RADIO_SOUND = Audiostream.Load("AUDIO\SOUNDS\Radio.mp3") 
Audiostream.Loop($RADIO_SOUND, 1)  
Audiostream.Volume($RADIO_SOUND) = VERO_TIPA_VOLUME
Audiostream.PerformAction($RADIO_SOUND, PLAY)

Audiostream.Loop($RADIO_ON_SOUND,0)
Audiostream.PerformAction($RADIO_ON_SOUND, PLAY)
Audiostream.Volume($RADIO_ON_SOUND) = $SOUNDS_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $RADIO_SOUND // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $SOUNDS_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 500
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1 
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $RADIO_SOUND volume $MUSIC_VOLUME time 500

////////////////////////////////////////////////////////  

Text.RemoveTextBox
Text.ClearAll 
 
Text.ShowL('MSN12C5', 3000, 1)
wait 3000 
Text.ShowL('MSN12C6', 2000, 1)
wait 2000 
Text.ShowL('MSN12C7', 3000, 1)
wait 3000 
Text.ShowL('MSN12C8', 3000, 1)
wait 3000
 
return

:MSNSTRJ
thread 'MSNSTRJ'
 
1@ = Marker.CreateIconWithoutSphere($MISSION_ICON, 1134.2645, -747.52, 97.1622)

repeat
wait 0

if
DONT_DO_BURGLARY == 0
    then
    if or
    $MISSION_START == 6
    $MISSION_START == 9
        then
        
        while DONT_DO_BURGLARY == 0
        wait 0
        end
        
        end
    end
 
if and
$ONMISSION == 0 
0101:   actor PLAYER_ACTOR in_sphere $X_START $Y_START $Z_START radius 1.0 1.0 2.0 sphere 1 stopped 
not Actor.Driving(PLAYER_ACTOR)
not Actor.Dead(PLAYER_ACTOR)
    then
    break
    end
    
until false

MAIN_QUEST_MUSIC_FLAG = 1 
Text.ShowStyled(v$MISSION_NAME, 3000, 2)
Marker.Disable(1@)
Player.CanMove(PLAYER_CHAR) = False
fade 0 1000
$HUD_REMOVE = 1 
wait 1000  
start_mission $MISSION_START 
end_thread

:HOUSE_E
thread 'HOUSE_E'  

:HOUSE_ENTER_19
wait 0  
if and
//00EC:   actor PLAYER_ACTOR sphere 0 near_point 1134.362 -747.4501 radius 1.0 1.0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 1134.362 -747.4501 97.6622 radius 1.5
not actor.Driving(PLAYER_ACTOR)
$ONMISSION == 0  
jf @HOUSE_ENTER_182 
Player.CanMove(PLAYER_CHAR) = False
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 1
DONT_DO_BURGLARY = 1
$INT_ZMB_NOT = 1
fade 0 500
$HUD_REMOVE = 1 
wait 500  
select_interior 7 
0860: link_actor PLAYER_ACTOR to_interior 7
04F9: set_sky_color 1 fade 0
0776: create_objects_in_object_group "mike2" 
Actor.PutAtNoOffset(PLAYER_ACTOR, 226.3004, 1026.902, 1084.0)
Actor.Angle(PLAYER_ACTOR) = 359.9339
0A41: destroy_entrance_marker MAIN_QUEST1_COMPLETED_FLAG
0A40: MAIN_QUEST2_COMPLETED_FLAG = create_entrance_marker_at 225.6944 1021.7608 1084.5168 color 14
Camera.Restore_WithJumpCut
wait 500 
Player.CanMove(PLAYER_CHAR) = True
create_thread @REFR_3D
fade 1 500
$HUD_REMOVE = 0 
wait 500
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 0  
jump @HOUSE_ENTER_19 

:HOUSE_ENTER_182
wait 0 
if and
00A4:   actor PLAYER_ACTOR sphere 0 in_cube_cornerA 228.0172 1024.046 1080.008 cornerB 224.1166 1021.591 1090.017
not actor.Driving(PLAYER_ACTOR)
DONT_DO_BURGLARY == 1 
jf @HOUSE_ENTER_402 
Player.CanMove(PLAYER_CHAR) = False
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 1
fade 0 500
$HUD_REMOVE = 1 
wait 500  
Camera.SetPosition(1136.432, -747.0576, 97.0, 0.0, 0.0, 0.0)
renderer 1136.432 -747.0576 
Camera.SetAtPos(1136.432, -747.0576, 97.0)
select_interior 0 
0860: link_actor PLAYER_ACTOR to_interior 0 
04FA: reset_sky_colors_with_fade 0
0777: delete_objects_in_object_group "mike2"
Actor.PutAtNoOffset(PLAYER_ACTOR, 1136.432, -747.0576, 97.1)
Actor.Angle(PLAYER_ACTOR) = 270.225
0A41: destroy_entrance_marker MAIN_QUEST2_COMPLETED_FLAG
0A40: MAIN_QUEST1_COMPLETED_FLAG = create_entrance_marker_at 1134.362 -747.4501 97.6622 color 14
Camera.Restore_WithJumpCut
wait 500 
Player.CanMove(PLAYER_CHAR) = True
ZOMBIES_NOTSPAWN = 0
create_thread @REFR_3D
fade 1 500
$HUD_REMOVE = 0 
wait 500
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 0
DONT_DO_BURGLARY = 0
$INT_ZMB_NOT = 0  
jump @HOUSE_ENTER_19 

:HOUSE_ENTER_402
wait 0 
if and
//00EC:   actor PLAYER_ACTOR sphere 0 near_point 226.2954 1114.235 radius 1.0 1.0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 226.2954 1114.235 1081.492 radius 1.5
not actor.Driving(PLAYER_ACTOR)
DONT_DO_BURGLARY == 1 
$ONMISSION == 0 
jf @HOUSE_ENTER_619 
Player.CanMove(PLAYER_CHAR) = False
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 1
fade 0 500 
wait 500 
$HUD_REMOVE = 1 
Camera.SetPosition(1438.705, -928.6489, 39.2339, 0.0, 0.0, 0.0)
renderer 1438.705 -928.6489 
Camera.SetAtPos(1438.705, -928.6489, 39.2339)
select_interior 0 
0860: link_actor PLAYER_ACTOR to_interior 0
04FA: reset_sky_colors_with_fade 0 
Actor.PutAtNoOffset(PLAYER_ACTOR, 1438.705, -928.6489, 38.2339)
Actor.Angle(PLAYER_ACTOR) = 173.1704
0A41: destroy_entrance_marker MAIN_QUEST3_COMPLETED_FLAG
0A40: MAIN_QUEST4_COMPLETED_FLAG = create_entrance_marker_at 1440.626 -926.1309 39.7339 color 14
Camera.Restore_WithJumpCut
wait 500 
Player.CanMove(PLAYER_CHAR) = True
create_thread @REFR_3D
fade 1 500
$HUD_REMOVE = 0 
wait 500
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 0
DONT_DO_BURGLARY = 0
$INT_ZMB_NOT = 0  
jump @HOUSE_ENTER_19 

:HOUSE_ENTER_619
wait 0 
if and
//00EC:   actor PLAYER_ACTOR sphere 0 near_point 1440.626 -926.1309 radius 1.0 1.0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 1440.626 -926.1309 39.7339 radius 1.5
not actor.Driving(PLAYER_ACTOR) 
$ONMISSION == 0 
jf @HOUSE_ENTER_19 
Player.CanMove(PLAYER_CHAR) = False
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 1
DONT_DO_BURGLARY = 1
$INT_ZMB_NOT = 1
fade 0 500
$HUD_REMOVE = 1 
wait 500   
select_interior 5 
0860: link_actor PLAYER_ACTOR to_interior 5
04F9: set_sky_color 1 fade 0 
Camera.SetAtPos(228.9563, 1114.181, 1080.992)
Actor.PutAtNoOffset(PLAYER_ACTOR, 228.9563, 1114.181, 1080.992)
Actor.Angle(PLAYER_ACTOR) = 269.0461
0A41: destroy_entrance_marker MAIN_QUEST4_COMPLETED_FLAG
0A40: MAIN_QUEST3_COMPLETED_FLAG = create_entrance_marker_at 226.2954 1114.235 1081.492 color 14
Camera.Restore_WithJumpCut
wait 500 
Player.CanMove(PLAYER_CHAR) = True
create_thread @REFR_3D
fade 1 500
$HUD_REMOVE = 0 
wait 500
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 0  
jump @HOUSE_ENTER_19

:SVM5_2
thread 'SVM5_2'
0629: change_integer_stat 258 to 0                
player.CanMove(PLAYER_CHAR) = false
01B7: release_weather
set_weather 0
fade 0 0
$HUD_REMOVE = 0
$SAVESTATUS_TRUE = 1
$SAVESTATUS = 1
$SAVE_MISSION_START_FLAG = 1
create_thread @PTL_TXT                    
wait $GAME_SAVE_WAIT_TIME
$PREPARING_TEXT_OFF = 1
wait 10
$PLAYER_HEALTH = actor.Health(PLAYER_ACTOR)         

0A8D: 25@ = read_memory 6393978 size 4 virtual_protect 1 
0A8D: 26@ = read_memory 6393982 size 1 virtual_protect 1 

wait 1 

0A8C: write_memory 6393978 size 4 value -1869574000 virtual_protect 1 
0A8C: write_memory 6393982 size 1 value 144 virtual_protect 1 

065C: release_decision_maker $DEC_PEOPLE 
wait 10
03D8: show_save_screen 

wait 2 
0A8C: write_memory 6393978 size 4 value 25@ virtual_protect 1 
0A8C: write_memory 6393982 size 1 value 26@ virtual_protect 1 

:SAVE_MISSION5_222
wait 0
fade 0 0 
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
if
03D9:   save_done
jf @SAVE_MISSION5_222
actor.Angle(PLAYER_ACTOR) = 156.3324
fade 0 0

repeat
wait 0
until SAVESTATUS_MEGA_TRUE == 0

if and
HARDCORE_PLUS_MODE == 1
MIKE_SHIZA_FLAG == 1
not $MISSION_START_NUMBER == 1
not $MISSION_START_NUMBER == 4
then

//////////////////////////////////////////////////

gosub @MIKE_SHIZA_CHECK_HARDCORE_DANGER_FLAG2

if
not 2@ == 1
then

while true

wait 0
fade 0 0
03F0: enable_text_draw 1
0349: set_text_draw_font 2
0340: set_text_draw_RGBA 180 180 180 255
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end
 
033F: set_text_draw_letter_size 0.5 1.25      
0343: set_text_draw_linewidth 480.0
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 480.0 for_centered_text        

if
00E1: key_pressed 0 17
    then    
    break
    end
    
if
00E1: key_pressed 0 15
    then
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end_thread
    end    

if
$SAVING_DELAY == 0
then        
033E: set_draw_text_position 350.0 200.0 GXT 'GAME962'  // Push
else
033E: set_draw_text_position 350.0 150.0 GXT 'GAME962'  // Push
end

end

//////////////////////////////////////////////////

else
jump to @SAVE_CHECK_WRONG_MIKEOLD
end

end   

repeat
wait 0
until $SAVESTATUS == 0

if and
HARDCORE_PLUS_MODE == 1
MIKE_SHIZA_FLAG == 1
not $MISSION_START_NUMBER == 1
not $MISSION_START_NUMBER == 4
then
gosub @MCS_SHIZA_WRITE_HARDCORE_FLAG1
end

start_mission 6  // Обыск машин
end_thread

:MS_STAR
thread 'MS_STAR'

if
$SAVE_MISSION_START_FLAG == 2
then

repeat
wait 0         
until PLAY_TALK_ACTOR == -1

USHER_STORY_CREATE_NICOLS_FLAG = 2
BASE_TEAMMATES_DESTORY_FLAG = 1
wait 1000
actor.PutAtNoOffset(PLAYER_ACTOR,2396.2019, -2246.1375, 13.5469)
actor.Angle(PLAYER_ACTOR) = 134.2005 

CAMP_LEADER_DONT_SAY_BYE_FLAG = 0

$SAVE_MISSION_START_FLAG = 1

end

//gosub @MCS_SHIZA_WRITE_HARDCORE_FLAG0_FIRST
0629: change_integer_stat 258 to 0    
               
fade 0 0 
$SAVESTATUS = 1

if
$SAVE_MISSION_NOT_SAVE_FLAG == 0
then
$SAVESTATUS_TRUE = 1   
end

$SAVE_MISSION_START_FLAG = 1 

:MISSION2_ONMISSION_CHECK
wait 0    
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 255
fade 0 0 
if
$ONMISSION == 0
jf @MISSION2_ONMISSION_CHECK  

if
$SAVE_MISSION_NOT_SAVE_FLAG == 0
jf @FUCKMEAHAHA

create_thread @PTL_TXT
wait $GAME_SAVE_WAIT_TIME   
$PREPARING_TEXT_OFF = 1   
wait 10
$PLAYER_HEALTH = actor.Health(PLAYER_ACTOR)
 
0A8D: 25@ = read_memory 6393978 size 4 virtual_protect 1 
0A8D: 26@ = read_memory 6393982 size 1 virtual_protect 1 

wait 1 

0A8C: write_memory 6393978 size 4 value -1869574000 virtual_protect 1 
0A8C: write_memory 6393982 size 1 value 144 virtual_protect 1 
                           
065C: release_decision_maker $DEC_PEOPLE 
wait 10
03D8: show_save_screen

wait 2 
0A8C: write_memory 6393978 size 4 value 25@ virtual_protect 1 
0A8C: write_memory 6393982 size 1 value 26@ virtual_protect 1                               
 
:CHECKING_SAVE_MISSION2
wait 0
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 255
fade 0 0 
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
if
03D9:   save_done
jf @CHECKING_SAVE_MISSION2 

while $SAVING_DELAY == 1
wait 0
end

:FUCKMEAHAHA

if
$SAVE_MISSION_NOT_SAVE_FLAG == 1
then
$SAVESTATUS_TRUE = 0   
end

fade 0 0
camera.Restore_WithJumpCut()       
fade 0 0

if and
HARDCORE_PLUS_MODE == 1
MIKE_SHIZA_FLAG == 1
not $MISSION_START_NUMBER == 1
not $MISSION_START_NUMBER == 4
then

//////////////////////////////////////////////////

gosub @MIKE_SHIZA_CHECK_HARDCORE_DANGER_FLAG2

if
not 2@ == 1
then

while true

wait 0
fade 0 0
03F0: enable_text_draw 1
0349: set_text_draw_font 2
0340: set_text_draw_RGBA 180 180 180 255
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end
 
033F: set_text_draw_letter_size 0.5 1.25      
0343: set_text_draw_linewidth 480.0
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 480.0 for_centered_text        

if
00E1: key_pressed 0 17
    then    
    break
    end
    
if
00E1: key_pressed 0 15
    then
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end_thread
    end    

if
$SAVING_DELAY == 0
then        
033E: set_draw_text_position 350.0 200.0 GXT 'GAME962'  // Push
else
033E: set_draw_text_position 350.0 150.0 GXT 'GAME962'  // Push
end

end

//////////////////////////////////////////////////

else
jump to @SAVE_CHECK_WRONG_MIKEOLD
end

end    

if
not $SAVE_MISSION_NOT_SAVE_FLAG == 1
then

repeat
wait 0
until $SAVESTATUS == 0

end

if and
HARDCORE_PLUS_MODE == 1
MIKE_SHIZA_FLAG == 1
not $MISSION_START_NUMBER == 1
not $MISSION_START_NUMBER == 4
then
gosub @MCS_SHIZA_WRITE_HARDCORE_FLAG1
end

if
$MISSION_START_NUMBER == 110
then
0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_NIGHTMARE1_CHECKPOINT"
if
0@ == 1
    then
    $MISSION_START_NUMBER = 111
    end
end
  
start_mission $MISSION_START_NUMBER

$SAVE_MISSION_NOT_SAVE_FLAG = 0
end_thread

:SAVE_CHECK_WRONG_MIKEOLD
wait 0
fade 0 0

32@ = 0

while 32@ < 5000  
wait 0
fade 0 0     

$HUD_REMOVE = 1
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
$PREPARING_LOADING = 1  

$SAVING_TEXT_SIZE_X = 0.5
$SAVING_TEXT_SIZE_Y = 1.25

$SAVING_TEXT_X = 335.0
$SAVING_TEXT_Y = 200.0  

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

033F: set_text_draw_letter_size $SAVING_TEXT_SIZE_X $SAVING_TEXT_SIZE_Y
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 350.0 for_centered_text

if
HARDCORE_MODE == 0
then

if
$CARL_STORY == 0
then
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME129'
else
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME754'
end

else
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME826'
end

end

0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME

end_thread           

:JAME_HP
thread 'JAME_HP'        
        
$JAMES_SHOW_HP_END_FLAG = 0

:JAMES_HP_CHECK
wait 0
if
$JAMES_SHOW_HP_END_FLAG == 0
jf @JAMES_HP_CHECK_END
if
056D:   actor $ARMY69_2[19] defined
jf @JAMES_HP_CHECK_END
MIKE_CAR = actor.Health($ARMY69_2[19])
MIKE_CAR /= 240
0084: STATUS_TEXT = MIKE_CAR
jump to @JAMES_HP_CHECK

:JAMES_HP_CHECK_END
end_thread

:MS15_HP
thread 'MS15_HP'        
        
MIKE_AND_TIM_HEALTH_MISSION15_REMOVE_FLAG = 0

:MISSION15_HP_CHECK
wait 0
if and
MIKE_AND_TIM_HEALTH_MISSION15_REMOVE_FLAG == 0
$ONMISSION == 1
056D:   actor $SURVIVER[0] defined
056D:   actor $SURVIVER[1] defined
jf @MISSION15_HP_CHECK_END
MIKE_CAR = actor.Health($SURVIVER[1])
MIKE_CAR /= 20
0084: TIM_HEALTH_STATUS_TEXT = MIKE_CAR

MIKE_CAR = actor.Health($SURVIVER[0])
MIKE_CAR /= 20
0084: CLEMMY_HEALTH_STATUS_TEXT = MIKE_CAR
jump to @MISSION15_HP_CHECK

:MISSION15_HP_CHECK_END
0151: remove_status_text TIM_HEALTH_STATUS_TEXT
0151: remove_status_text CLEMMY_HEALTH_STATUS_TEXT
end_thread

:MS12_HP
thread 'MS12_HP'        
        
MIKE_AND_TIM_HEALTH_MISSION15_REMOVE_FLAG = 0

:MISSION12_HP_CHECK
wait 0
if and
MIKE_AND_TIM_HEALTH_MISSION15_REMOVE_FLAG == 0
$ONMISSION == 1
056D:   actor $SURVIVER[0] defined
jf @MISSION12_HP_CHECK_END
MIKE_CAR = actor.Health($SURVIVER[0])
MIKE_CAR /= 75
0084: TIM_HEALTH_STATUS_TEXT = MIKE_CAR

jump to @MISSION12_HP_CHECK

:MISSION12_HP_CHECK_END
0151: remove_status_text TIM_HEALTH_STATUS_TEXT
end_thread

:MS10_HP
thread 'MS10_HP'        
        
MIKE_AND_TIM_HEALTH_MISSION15_REMOVE_FLAG = 0

:MISSION10_HP_CHECK
wait 0
if and
MIKE_AND_TIM_HEALTH_MISSION15_REMOVE_FLAG == 0
$ONMISSION == 1
056D:   actor $SURVIVER[0] defined
jf @MISSION10_HP_CHECK_END
MIKE_CAR = actor.Health($SURVIVER[0])
MIKE_CAR /= 30
0084: TIM_HEALTH_STATUS_TEXT = MIKE_CAR

jump to @MISSION10_HP_CHECK

:MISSION10_HP_CHECK_END
0151: remove_status_text TIM_HEALTH_STATUS_TEXT
end_thread

:MS14_HP
thread 'MS14_HP'        
        
MIKE_AND_TIM_HEALTH_MISSION15_REMOVE_FLAG = 0

:MISSION14_HP_CHECK
wait 0
if and
MIKE_AND_TIM_HEALTH_MISSION15_REMOVE_FLAG == 0
$ONMISSION == 1
056D:   actor $SURVIVER[0] defined
jf @MISSION14_HP_CHECK_END
MIKE_CAR = actor.Health($SURVIVER[0])
MIKE_CAR /= 30
0084: CLEMMY_HEALTH_STATUS_TEXT = MIKE_CAR

jump to @MISSION14_HP_CHECK

:MISSION14_HP_CHECK_END
0151: remove_status_text CLEMMY_HEALTH_STATUS_TEXT
end_thread

:TIM_LCK
thread 'TIM_LCK'                
$TIME_LOCK_OFF = 69

:TIME_LOCK_CHECK
wait 0
if
$TIME_LOCK_OFF == 69
jf @TIME_LOCK_OFF
00C0: set_current_time $TIME_LOCK_HOUR $TIME_LOCK_MINUTES
jump @TIME_LOCK_CHECK

:TIME_LOCK_OFF
end_thread

:TIME_00
thread 'TIME_00'                
$TIME_00_OFF = 0

:TIME_00_CHECK
wait 0
if
$TIME_00_OFF == 0
jf @TIME_00_OFF
random_int 0@ 0 to 5
if
BRIGHT_ATMOSPHERE == 1
then
set_weather 61
00C0: set_current_time 23 0
else
set_weather 210
00C0: set_current_time 20 20
end
$HUD_REMOVE = 1       
cinema.Widescreen(1)
0A48: enable_menu_access_in_widescreen_mode 0
player.SetDrunkVisuals(PLAYER_CHAR,0@)
camera.Shake(5)
jump @TIME_00_CHECK

:TIME_00_OFF
0A48: enable_menu_access_in_widescreen_mode 1
player.SetDrunkVisuals(PLAYER_CHAR,0)
end_thread

:FU_MIKE
thread 'FU_MIKE'

:FUCK_MIKE_IDLE_CHECK
wait 0

if
$FUCK_MIKE_OFF == 1
    then
    $SLOWMODE_ANIMS_SPEED = 1.0
    end_thread
    end
    
if
$CHEATS_ON == 1
then
04C4: store_coords_to 2@ 3@ 4@ from_actor $MISSION_CHAR with_offset 0.0 5.0 2.0
actor.PutAtNoOffset(PLAYER_ACTOR,2@,3@,4@)
end

04C4: store_coords_to 2@ 3@ 4@ from_actor $MISSION_CHAR with_offset 0.0 0.0 1.5
0D54: draw_corona_with_extra_params_texture 0 color 255 0 0 155 on_entity 0 at 2@ 3@ 4@ size 1.0 far_clip 500.0 near_clip 0.5 flare 0 enable_reflection 1 check_obstacles 1 flash_while_fading 1 fade_speed 1.0 only_from_below 0    

$SLOWMODE_ANIMS_SPEED = 1.0

1@ = 1.0  

if 
0611: actor $MISSION_CHAR performing_animation "sprint_civi"
    then   
    0393: actor $MISSION_CHAR perform_animation "sprint_civi" at 1.0 times_normal_rate  
    end 

while 00F2:   actor PLAYER_ACTOR near_actor $MISSION_CHAR radius 10.0 10.0 sphere 0
wait 0

if
$FUCK_MIKE_OFF == 1
    then
    $SLOWMODE_ANIMS_SPEED = 1.0
    end_thread
    end
    
if
$CHEATS_ON == 1
then
04C4: store_coords_to 2@ 3@ 4@ from_actor $MISSION_CHAR with_offset 0.0 5.0 2.0
actor.PutAtNoOffset(PLAYER_ACTOR,2@,3@,4@)
end 

04C4: store_coords_to 2@ 3@ 4@ from_actor $MISSION_CHAR with_offset 0.0 0.0 1.5
0D54: draw_corona_with_extra_params_texture 0 color 255 0 0 155 on_entity 0 at 2@ 3@ 4@ size 1.0 far_clip 500.0 near_clip 0.5 flare 0 enable_reflection 1 check_obstacles 1 flash_while_fading 1 fade_speed 1.0 only_from_below 0   

if
$CHEATS_ON == 1
then
//ass
1@ = 2.0
else
1@ += 0.05
end

if
0611: actor $MISSION_CHAR performing_animation "sprint_civi"
    then
    0393: actor $MISSION_CHAR perform_animation "sprint_civi" at 1@ times_normal_rate  
    end  
                                          
end

jump to @FUCK_MIKE_IDLE_CHECK

:RGN_HP3
thread 'RGN_HP3' 
$HP_REGEN_OFF = 0   

$ALLOW_BLEEDING = 0     

:REGEN_HP3_19
wait 0    
if 
$HP_REGEN_OFF == 0
jf @REGEN_HP3_END_THREAD 
$HEALING_FLAG = 0
1@ = Actor.Health(PLAYER_ACTOR) 
wait 20 
2@ = Actor.Health(PLAYER_ACTOR)
if 
003B:   1@ == 2@  // (int)
jf @REGEN_HP3_19

32@ = 0
:REGEN_HP3_CHECK
wait 0
if 
$HP_REGEN_OFF == 0
jf @REGEN_HP3_END_THREAD
if
32@ > 1500
jf @REGEN_HP3_CHECK

:REGEN_HP3_83
wait 0
if
$HP_REGEN_OFF == 0
jf @REGEN_HP3_END_THREAD 
$HEALING_FLAG = 1
0@ = Actor.Health(PLAYER_ACTOR)
0@ += 3 
Actor.Health(PLAYER_ACTOR) = 0@
wait 40 
4@ = Actor.Health(PLAYER_ACTOR)
if 
003B:   0@ == 4@ // (int) 
jf @REGEN_HP3_19 
jump @REGEN_HP3_83

:REGEN_HP3_END_THREAD
$ALLOW_BLEEDING = 1
end_thread

:RGN_HP4
thread 'RGN_HP4'   

$ALLOW_BLEEDING = 0      

:REGEN_HP4_19
wait 0    
if and
$HP_REGEN_OFF == 0
$END_ROUND_INF == 0
$INF_SIDE == 1
jf @REGEN_HP4_END_THREAD 
$HEALING_FLAG = 0
1@ = Actor.Health(PLAYER_ACTOR) 
wait 20 
2@ = Actor.Health(PLAYER_ACTOR)
if 
003B:   1@ == 2@  // (int)
jf @REGEN_HP4_19

32@ = 0
:REGEN_HP4_CHECK
wait 0
if and
$HP_REGEN_OFF == 0
$END_ROUND_INF == 0
$INF_SIDE == 1
jf @REGEN_HP4_END_THREAD
if
32@ > 50
jf @REGEN_HP4_CHECK

:REGEN_HP4_83
wait 0
if and
$HP_REGEN_OFF == 0
$END_ROUND_INF == 0
$INF_SIDE == 1
jf @REGEN_HP4_END_THREAD 
$HEALING_FLAG = 1
0@ = Actor.Health(PLAYER_ACTOR)
0@ += 3 
Actor.Health(PLAYER_ACTOR) = 0@
wait 40 
4@ = Actor.Health(PLAYER_ACTOR)
if 
003B:   0@ == 4@ // (int) 
jf @REGEN_HP4_19 
jump @REGEN_HP4_83

:REGEN_HP4_END_THREAD
$ALLOW_BLEEDING = 1
end_thread

:CAR_SP
thread 'CAR_SP'                
$CAR_SPEED_OGR_OFF_FLAG = 0

:CAR_SP_START_CHECK
wait 0
if
actor.InCar(PLAYER_ACTOR,1@)
jf @CAR_SP_START_CHECK
jump @CAR_SP_CHECK

:CAR_SP_CHECK
wait 0
car.SetMaxSpeed(1@,3@)
if
$CAR_SPEED_OGR_OFF_FLAG == 0
jf @CAR_SP_END_THREAD
02E3: 2@ = car 1@ speed
if
0027:   2@ > 3@ // (float)
jf @CAR_SP
2@ -= 0.001
Car.SetSpeedInstantly(1@, 2@)
jump @CAR_SP_CHECK

:CAR_SP_END_THREAD
player.SetDrunkVisuals(PLAYER_CHAR,0)
end_thread

:CAR_SP2
thread 'CAR_SP2'                
$CAR_SPEED_OGR_OFF_FLAG = 0

:CAR_SP2_START_CHECK
wait 0
if
actor.InCar(PLAYER_ACTOR,1@)
jf @CAR_SP2_START_CHECK
jump @CAR_SP2_CHECK

:CAR_SP2_CHECK
wait 0
if
056E:   car $MISSION_CAR1 defined
jf @CAR_SP2_END_THREAD
if
0204:   actor PLAYER_ACTOR near_car $MISSION_CAR1 radius $M19_RADIUS_JAMES_SPEED_UP $M19_RADIUS_JAMES_SPEED_UP sphere 0 in_car
jf @CAR_SP2_START_CHECK

0086: $MISSION19_PATH_SPEED2 = $MISSION19_PATH_SPEED // (float)
06FD: set_car $MISSION_CAR1 speed_on_path_to $MISSION19_PATH_SPEED2

:CAR_SP2_CHECK2
wait 0
if
056E:   car $MISSION_CAR1 defined
jf @CAR_SP2_END_THREAD
$MISSION19_PATH_SPEED2 += 0.025
06FD: set_car $MISSION_CAR1 speed_on_path_to $MISSION19_PATH_SPEED2
if
056E:   car $MISSION_CAR1 defined
jf @CAR_SP2_END_THREAD
if
8204:   actor PLAYER_ACTOR near_car $MISSION_CAR1 radius $M19_RADIUS_JAMES_SPEED_UP $M19_RADIUS_JAMES_SPEED_UP sphere 0 in_car
jf @CAR_SP2_CHECK2
06FD: set_car $MISSION_CAR1 speed_on_path_to $MISSION19_PATH_SPEED 
jump @CAR_SP2_START_CHECK

:CAR_SP2_END_THREAD
player.SetDrunkVisuals(PLAYER_CHAR,0)
end_thread  

:CAR_SP3
thread 'CAR_SP3'                
$CAR_SPEED_OGR_OFF_FLAG = 0

:CAR_SP3_START_CHECK
wait 0
if
actor.InCar(PLAYER_ACTOR,1@)
jf @CAR_SP3_START_CHECK
jump @CAR_SP3_CHECK

:CAR_SP3_CHECK
wait 0
if
056E:   car $AMANDA_BIKE defined
jf @CAR_SP3_END_THREAD
if
0204:   actor PLAYER_ACTOR near_car $AMANDA_BIKE radius $M4_RADIUS_AMANDA_SPEED_UP $M4_RADIUS_AMANDA_SPEED_UP sphere 0 in_car
jf @CAR_SP3_START_CHECK

0086: $MISSION4_PATH_SPEED2 = $MISSION4_PATH_SPEED // (float)
06FD: set_car $AMANDA_BIKE speed_on_path_to $MISSION4_PATH_SPEED2

:CAR_SP3_CHECK2
wait 0
if
056E:   car $AMANDA_BIKE defined
jf @CAR_SP3_END_THREAD
$MISSION4_PATH_SPEED2 += 0.025
06FD: set_car $AMANDA_BIKE speed_on_path_to $MISSION4_PATH_SPEED2
if
056E:   car $AMANDA_BIKE defined
jf @CAR_SP3_END_THREAD
if
8204:   actor PLAYER_ACTOR near_car $AMANDA_BIKE radius $M4_RADIUS_AMANDA_SPEED_UP $M4_RADIUS_AMANDA_SPEED_UP sphere 0 in_car
jf @CAR_SP3_CHECK2
06FD: set_car $AMANDA_BIKE speed_on_path_to $MISSION4_PATH_SPEED 
jump @CAR_SP3_START_CHECK

:CAR_SP3_END_THREAD
player.SetDrunkVisuals(PLAYER_CHAR,0)
end_thread

:NIGHT1
thread 'NIGHT1'

VOICE_SKIP_LONG_SET = 0

for $ACHIV_NUMBER = 336 to 387
wait 1850

if
GAME_OVER_FLAG == 0
then
create_thread @VOI_SHO
end
          
repeat
wait 0

if
GAME_OVER_FLAG == 1
    then
    break
    end

until $ACHIV_SHOW_ENDED == 1

end

end_thread

:NIGHT2
thread 'NIGHT2'

VOICE_SKIP_LONG_SET = 0

for $ACHIV_NUMBER = 388 to 416
wait 2800

if
GAME_OVER_FLAG == 0
then
create_thread @VOI_SHO
end
          
repeat
wait 0

if
GAME_OVER_FLAG == 1
    then
    break
    end

until $ACHIV_SHOW_ENDED == 1

end

end_thread

:M19_PRV
thread 'M19_PRV'                
32@ = 0

0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1126.9855 1709.9171 10.8203
renderer 1126.9855 1709.9171 
renderer2 1126.9855 1709.9171 10.8203

00C0: set_current_time 23 0
set_weather 19  

$SOUND_OFF_1 = 1

$NOTSPAWN_CARS = 1  

$ALLOW_HEADSHOOT = 0

$HEAL = 0   

while $SAVING_DELAY == 1
wait 0
end

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1 

:69DRAW_LOGO_IDLE2
wait 0
fade 0 0
$SAVESTATUS = 1
ZOMBIES_NOTSPAWN = 1
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 255
if
32@ > 3000
jf @69DRAW_LOGO_IDLE2
fade 0 0
wait 1

$SOUND_OFF_1 = 0   

0A0E: disable_text_with_style 1

0391: release_textures
0390: load_txd_dictionary 'miss4' 
wait 1
038F: load_texture "chapter7" as 1 // Load dictionary with 0390 first 
wait 1

1@ = 0

 repeat    
wait 0
1@ += 5
03F0: enable_text_draw 1
038D: draw_texture 1 position 320.0 220.0 size 600.0 400.0 RGBA 255 255 255 1@
03E3: set_texture_to_be_drawn_antialiased 1 
 until 1@ == 255

32@ = 0 

 repeat 
wait 0
03F0: enable_text_draw 1
038D: draw_texture 1 position 320.0 220.0 size 600.0 400.0 RGBA 255 255 255 1@
03E3: set_texture_to_be_drawn_antialiased 1 

if
32@ > 3500
    then
    break
    end
    
 until 00E1: key_pressed 0 17

 repeat
wait 0
1@ -= 5
03F0: enable_text_draw 1
038D: draw_texture 1 position 320.0 220.0 size 600.0 400.0 RGBA 255 255 255 1@
03E3: set_texture_to_be_drawn_antialiased 1 
 until 1@ == 0
 
wait 1
03F0: enable_text_draw 0
wait 1
0391: release_textures 

0A0E: disable_text_with_style 0 

if
CLASSIC_MUSIC == 0
then
$MUSIC_MISSION = Audiostream.Load(MUSIC_21and2A)
else
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_21and2A)
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 0)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 5000
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD    
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 500

//////////////////////////////////////////////////////////

0506: set_car_model #FCR900 next_variation -1 4 // first param is useless

:CAR_CREATE_MISSION20_PRE_1
if
model.Available(#FCR900)
then

0@ = car.Create(#FCR900,0.0,0.0,0.0)

if
model.Available(#FCR900)
then
model.Destroy(#FCR900)
end

else
model.Load(#FCR900)
mload
wait 0
jump to @CAR_CREATE_MISSION20_PRE_1
end

car.Health(0@) = CAR_HEALTH_MAX

0229: set_car 0@ primary_color_to $BANDITS_CAR_COLOR1 secondary_color_to $BANDITS_CAR_COLOR2 

while 87C1:   path 937 available
wait 0
07C0: load_path 937
end         

0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1126.9855 1709.9171 10.8203

0881: set_player PLAYER_CHAR able_to_shoot_weapons 0

0464: put_actor PLAYER_ACTOR into_turret_on_car 0@ at_car_offset 0.0 0.5 0.15 position 0 shooting_angle_limit 40.0 with_weapon 22

while not model.Available($RANDOM_MODE_MODEL)
wait 0
model.Load($RANDOM_MODE_MODEL)
mload
end

actor.CreateAsDriver(21@,26,$RANDOM_MODE_MODEL,0@)

082A: set_player PLAYER_CHAR able_to_use_crouch_button 0

16@ = car.Angle(0@)
16@ -= 90.0
0858: set_player PLAYER_CHAR scan_horizon_to_angle 16@ rotation_speed 16@

015D: set_gamespeed 0.9
0A8C: write_memory 0xC402B4 size 1 value 1 virtual_protect 0

player.CanMove(PLAYER_CHAR) = true

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

wait 1

041E: set_radio_station 12

05EB: assign_car 0@ to_path 937    
06FD: set_car 0@ speed_on_path_to 1.0  

30@ = 0
31@ = 1

32@ = 0 

25@ = 0

0A48: enable_menu_access_in_widescreen_mode 1  

fade 1 10000 
wait 5000      
fade 0 10000

repeat
wait 0

if and
32@ > 5000
30@ == 0
31@ == 1 
then
33@ = 0
30@ = 1
31@ = 0
fade 1 10000
end

if and
33@ > 5000
30@ == 1
31@ == 0 
then
32@ = 0
30@ = 0
31@ = 1
fade 0 10000
end

if or
00EC:   actor PLAYER_ACTOR sphere 0 near_point 194.0767 2119.4731 radius 30.0 30.0
00E1:   player 0 pressed_key 17
00E1:   player 0 pressed_key 16  
    then   
    fade 0 500
    wait 500
    25@ = 1
    0706: advance_car 0@ further_along_path 1000.0  
    break
    end

until false

if
25@ == 0
then

fade 0 5000
wait 5000

end

015D: set_gamespeed 1.0
0A8C: write_memory 0xC402B4 size 1 value 0 virtual_protect 0

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0 

0881: set_player PLAYER_CHAR able_to_shoot_weapons 1

0465: remove_actor PLAYER_ACTOR from_turret_mode

082A: set_player PLAYER_CHAR able_to_use_crouch_button 1

actor.DestroyInstantly(21@) 

06C5: release_car 0@ from_path
0873: release_path 937
car.Angle(0@) = 180.0 

:ZONE69_CAPTURE

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 1000
wait 1000
audiostream.Release($MUSIC_MISSION)

//////////////////////////////////////////////////////////

actor.PutAtNoOffset(PLAYER_ACTOR,179.3519, 2103.0701, 21.512)
actor.Angle(PLAYER_ACTOR) = 169.3737

renderer 179.3519 2103.0701
renderer2 179.3519 2103.0701 21.512

if
CLASSIC_MUSIC == 0
then
$MUSIC_MISSION = Audiostream.Load(MUSIC_21and5A)
else
$MUSIC_MISSION = Audiostream.Load(CLASSIC_MUSIC_21and5A)
end

Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = VERO_TIPA_VOLUME

/////////////////////Плавное нарастание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
//0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 5000
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
250A: SET_AUDIO_STREAM_TYPE $MUSIC_MISSION type 2
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume $MUSIC_VOLUME time 5000

//////////////////////////////////////////////////////////

00C0: set_current_time 23 0
set_weather 19                

actor.Health(PLAYER_ACTOR) = 200

048F: actor PLAYER_ACTOR remove_weapons

0781: get_weapon_with_ID 6 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,6,1)

0781: get_weapon_with_ID 92 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,92,1)

0781: get_weapon_with_ID 16 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,16,25)

0781: get_weapon_with_ID 105 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,105,350)

0781: get_weapon_with_ID 24 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,24,120)

0781: get_weapon_with_ID 34 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,34,90)

$SAVE_PREPARE_OFF = 0
PLAYER_DONT_HAVE_BACKPACK = 0
create_thread @PED_BKP PLAYER_ACTOR 371
$FP_BACKPACK_HAD = 1

$SAVESTATUS = 0
ZOMBIES_NOTSPAWN = 1

$DRAW_RED = 1
PLAYER_RESIST_MULT = 0.25

create_thread @RGN_HP3

04EB: AS_actor PLAYER_ACTOR crouch 1

wait 2000

camera.Restore_WithJumpCut() 

player.CanMove(PLAYER_CHAR) = true

fade 1 3000
$HUD_REMOVE = 0
wait 3000      

v$OBJECTIVE = "MSN85"    

:ZONE_69_CAPTURE_ILDE_CHECK
wait 0
ZOMBIES_NOTSPAWN = 1

if
8A29: not  player PLAYER_CHAR climbing
then
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0
else
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 1
end

if
00A4:   actor PLAYER_ACTOR sphere 0 in_cube_cornerA 429.69 2156.25 -100.0 cornerB -85.94 1632.81 1000.0
jf @ZONE_69_PROVAL_WALK

if
not actor.Dead(PLAYER_ACTOR)
jf @ZONE_69_CAPTURE_FAILED
if
$ZONE69_CAPTURED == 1
jf @ZONE_69_CAPTURE_ILDE_CHECK

0318: set_latest_mission_passed 'GME1212'  // Big Smoke
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 1

fade 0 3000
$HUD_REMOVE = 1

/////////////////////Плавное затухание/////////////////////
//
//$MUSIC_FADE_NUMBER += 1
//if
//$MUSIC_FADE_NUMBER > 4
//    then
//    $MUSIC_FADE_NUMBER = 0 
//    end    
//
//0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
//$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
//
//$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
//$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
//$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
//create_thread @MUS_FAD
//
//wait 1
//
//while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
//wait 0
//end
2504: SET_AUDIO_STREAM_VOLUME_WITH_TRANSITION $MUSIC_MISSION volume 0.0 time 1000
wait 1000
audiostream.Release($MUSIC_MISSION)

//////////////////////////////////////////////////////////

wait 3000

$DRAW_RED = 0

$INF_EFF_END = 1

$ALLOW_HEADSHOOT = 1

gosub @MCS_SHIZA_WRITE_HARDCORE_FLAG0
0629: change_integer_stat 258 to 0
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
$SAVE_MISSION_START_FLAG = 1
create_thread @PTL_TXT
wait $GAME_SAVE_WAIT_TIME 
$PREPARING_TEXT_OFF = 1 
wait 10  
$PLAYER_HEALTH = actor.Health(PLAYER_ACTOR)

065C: release_decision_maker $DEC_PEOPLE 
wait 10
03D8: show_save_screen
   
:CHECKING_SAVE_ZONE_69
wait 0
fade 0 0 
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
if
03D9:   save_done
jf @CHECKING_SAVE_ZONE_69 
$NOTSPAWN = 0

fade 0 0

if and
HARDCORE_PLUS_MODE == 1
MIKE_SHIZA_FLAG == 1
then

//////////////////////////////////////////////////

gosub @MIKE_SHIZA_CHECK_HARDCORE_DANGER_FLAG2

if
not 2@ == 1
then

while true

wait 0
fade 0 0
03F0: enable_text_draw 1
0349: set_text_draw_font 2
0340: set_text_draw_RGBA 180 180 180 255
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end
 
033F: set_text_draw_letter_size 0.5 1.25      
0343: set_text_draw_linewidth 480.0
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 480.0 for_centered_text        

if
00E1: key_pressed 0 17
    then    
    break
    end
    
if
00E1: key_pressed 0 15
    then
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end_thread
    end    

if
$SAVING_DELAY == 0
then        
033E: set_draw_text_position 350.0 200.0 GXT 'GAME962'  // Push
else
033E: set_draw_text_position 350.0 150.0 GXT 'GAME962'  // Push
end

end

//////////////////////////////////////////////////

else
jump to @SAVE_CHECK_WRONG_MIKEOLD_M20
end

end    

repeat
wait 0
until $SAVESTATUS == 0

if and
HARDCORE_PLUS_MODE == 1
MIKE_SHIZA_FLAG == 1
then
gosub @MCS_SHIZA_WRITE_HARDCORE_FLAG1
end
       
start_mission 20  // Обмен
end_thread

:ZONE_69_PROVAL_WALK
text.ClearAll()
v$FAILED_TEXT = "MS_FL7"
jump @ZONE_69_CAPTURE_FAILED    

:ZONE_69_CAPTURE_FAILED
create_thread @GMV_OVR
end_thread

:SAVE_CHECK_WRONG_MIKEOLD_M20
wait 0
fade 0 0

32@ = 0

while 32@ < 5000  
wait 0
fade 0 0     

$HUD_REMOVE = 1
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
$PREPARING_LOADING = 1  

$SAVING_TEXT_SIZE_X = 0.5
$SAVING_TEXT_SIZE_Y = 1.25

$SAVING_TEXT_X = 335.0
$SAVING_TEXT_Y = 200.0  

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

033F: set_text_draw_letter_size $SAVING_TEXT_SIZE_X $SAVING_TEXT_SIZE_Y
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 350.0 for_centered_text

if
HARDCORE_MODE == 0
then

if
$CARL_STORY == 0
then
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME129'
else
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME754'
end

else
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME826'
end

end

0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME

end_thread            

:MS19
thread 'MS19'               
fade 0 0
gosub @MCS_SHIZA_WRITE_HARDCORE_FLAG0
0629: change_integer_stat 258 to 0 
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1  
$SAVE_MISSION_START_FLAG = 1  

:MISSION19_ONMISSION_CHECK
wait 0    
fade 0 0 
if
$ONMISSION == 0
jf @MISSION19_ONMISSION_CHECK
create_thread @PTL_TXT
wait $GAME_SAVE_WAIT_TIME 
$PREPARING_TEXT_OFF = 1 
wait 10  
$PLAYER_HEALTH = actor.Health(PLAYER_ACTOR)

0A8D: 25@ = read_memory 6393978 size 4 virtual_protect 1 
0A8D: 26@ = read_memory 6393982 size 1 virtual_protect 1 

wait 1 

0A8C: write_memory 6393978 size 4 value -1869574000 virtual_protect 1 
0A8C: write_memory 6393982 size 1 value 144 virtual_protect 1 

065C: release_decision_maker $DEC_PEOPLE 
wait 10
03D8: show_save_screen 

wait 2 
0A8C: write_memory 6393978 size 4 value 25@ virtual_protect 1 
0A8C: write_memory 6393982 size 1 value 26@ virtual_protect 1 
   
:CHECKING_SAVE_MISSION19
wait 0
fade 0 0 
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
if
03D9:   save_done
jf @CHECKING_SAVE_MISSION19
player.CanMove(PLAYER_CHAR) = false
fade 0 0

if and
HARDCORE_PLUS_MODE == 1
MIKE_SHIZA_FLAG == 1
not $MISSION_START_NUMBER == 1
not $MISSION_START_NUMBER == 4
then

//////////////////////////////////////////////////

gosub @MIKE_SHIZA_CHECK_HARDCORE_DANGER_FLAG2

if
not 2@ == 1
then

while true

wait 0
fade 0 0
03F0: enable_text_draw 1
0349: set_text_draw_font 2
0340: set_text_draw_RGBA 180 180 180 255 
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

033F: set_text_draw_letter_size 0.5 1.25      
0343: set_text_draw_linewidth 480.0
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 480.0 for_centered_text        

if
00E1: key_pressed 0 17
    then    
    break
    end
    
if
00E1: key_pressed 0 15
    then
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end_thread
    end    

if
$SAVING_DELAY == 0
then        
033E: set_draw_text_position 350.0 200.0 GXT 'GAME962'  // Push
else
033E: set_draw_text_position 350.0 150.0 GXT 'GAME962'  // Push
end

end

//////////////////////////////////////////////////

else
jump to @SAVE_CHECK_WRONG_MIKEOLD_ZONE69
end

end    

repeat
wait 0
until $SAVESTATUS == 0

if and
HARDCORE_PLUS_MODE == 1
MIKE_SHIZA_FLAG == 1
then
gosub @MCS_SHIZA_WRITE_HARDCORE_FLAG1
end

camera.Restore_WithJumpCut()       
fade 0 0              
create_thread @M19_PRV
end_thread 

:SAVE_CHECK_WRONG_MIKEOLD_ZONE69
wait 0
fade 0 0

32@ = 0

while 32@ < 5000  
wait 0
fade 0 0     

$HUD_REMOVE = 1
$SAVESTATUS = 1
$SAVESTATUS_TRUE = 1
$PREPARING_LOADING = 1  

$SAVING_TEXT_SIZE_X = 0.5
$SAVING_TEXT_SIZE_Y = 1.25

$SAVING_TEXT_X = 335.0
$SAVING_TEXT_Y = 200.0  

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

033F: set_text_draw_letter_size $SAVING_TEXT_SIZE_X $SAVING_TEXT_SIZE_Y
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 350.0 for_centered_text

if
HARDCORE_MODE == 0
then

if
$CARL_STORY == 0
then
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME129'
else
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME754'
end

else
033E: set_draw_text_position $SAVING_TEXT_X $SAVING_TEXT_Y GXT 'GAME826'
end

end

0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME

end_thread

:MCS_SHIZA_WRITE_HARDCORE_FLAG1

0E2C: get_current_save_slot 1@
if
1@ == 0
then
0AF0: 1@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "SAVED_SLOT_NUM2"
end

/////////////////////////////////////////////////////////////////////////////////////////

if
1@ == 1
then
0AF1: write_int 1 to_ini_file "saves/GTAZAsf1.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 2
then
0AF1: write_int 1 to_ini_file "saves/GTAZAsf2.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 3
then
0AF1: write_int 1 to_ini_file "saves/GTAZAsf3.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 4
then
0AF1: write_int 1 to_ini_file "saves/GTAZAsf4.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 5
then
0AF1: write_int 1 to_ini_file "saves/GTAZAsf5.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 6
then
0AF1: write_int 1 to_ini_file "saves/GTAZAsf6.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 7
then
0AF1: write_int 1 to_ini_file "saves/GTAZAsf7.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 8
then
0AF1: write_int 1 to_ini_file "saves/GTAZAsf8.c" section "SCR" key "HARDCORE_DANGER2"
end

/////////////////////////////////////////////////////////////////////////////////////////

return

:MCS_SHIZA_WRITE_HARDCORE_FLAG0

0E2C: get_current_save_slot 1@
if
1@ == 0
then
0AF0: 1@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "SAVED_SLOT_NUM2"
end

/////////////////////////////////////////////////////////////////////////////////////////

if
1@ == 1
then
0AF1: write_int 0 to_ini_file "saves/GTAZAsf1.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 2
then
0AF1: write_int 0 to_ini_file "saves/GTAZAsf2.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 3
then
0AF1: write_int 0 to_ini_file "saves/GTAZAsf3.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 4
then
0AF1: write_int 0 to_ini_file "saves/GTAZAsf4.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 5
then
0AF1: write_int 0 to_ini_file "saves/GTAZAsf5.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 6
then
0AF1: write_int 0 to_ini_file "saves/GTAZAsf6.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 7
then
0AF1: write_int 0 to_ini_file "saves/GTAZAsf7.c" section "SCR" key "HARDCORE_DANGER2"
end

if
1@ == 8
then
0AF1: write_int 0 to_ini_file "saves/GTAZAsf8.c" section "SCR" key "HARDCORE_DANGER2"
end

/////////////////////////////////////////////////////////////////////////////////////////

return

:MIKE_SHIZA_CHECK_HARDCORE_DANGER_FLAG2

0E2C: get_current_save_slot 0@
if
0@ == 0
then
0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "SAVED_SLOT_NUM2"
end

if
0@ == 1
then
        
0AF0: 1@ = get_int_from_ini_file "saves\GTAZAsf1.c" section "SCR" key "HARDCORE_DANGER2"
if
1@ == 1
    then
    2@ = 1
    else
    2@ = 0
    end
        
if
2@ == 1
    then
    0B00: delete_file "saves\GTAZAsf1.b"  // IF and SET
    0B00: delete_file "saves\GTAZAsf1.c"  // IF and SET
    end
    
end

if
0@ == 2
then
        
0AF0: 1@ = get_int_from_ini_file "saves\GTAZAsf2.c" section "SCR" key "HARDCORE_DANGER2"
if
1@ == 1
    then
    2@ = 1
    else
    2@ = 0
    end
        
if
2@ == 1
    then
    0B00: delete_file "saves\GTAZAsf2.b"  // IF and SET
    0B00: delete_file "saves\GTAZAsf2.c"  // IF and SET
    end
    
end

if
0@ == 3
then
        
0AF0: 1@ = get_int_from_ini_file "saves\GTAZAsf3.c" section "SCR" key "HARDCORE_DANGER2"
if
1@ == 1
    then
    2@ = 1
    else
    2@ = 0
    end
        
if
2@ == 1
    then
    0B00: delete_file "saves\GTAZAsf3.b"  // IF and SET
    0B00: delete_file "saves\GTAZAsf3.c"  // IF and SET
    end
    
end

if
0@ == 4
then
        
0AF0: 1@ = get_int_from_ini_file "saves\GTAZAsf4.c" section "SCR" key "HARDCORE_DANGER2"
if
1@ == 1
    then
    2@ = 1
    else
    2@ = 0
    end
        
if
2@ == 1
    then
    0B00: delete_file "saves\GTAZAsf4.b"  // IF and SET
    0B00: delete_file "saves\GTAZAsf4.c"  // IF and SET
    end
    
end

if
0@ == 5
then
        
0AF0: 1@ = get_int_from_ini_file "saves\GTAZAsf5.c" section "SCR" key "HARDCORE_DANGER2"
if
1@ == 1
    then
    2@ = 1
    else
    2@ = 0
    end
        
if
2@ == 1
    then
    0B00: delete_file "saves\GTAZAsf5.b"  // IF and SET
    0B00: delete_file "saves\GTAZAsf5.c"  // IF and SET
    end
    
end

if
0@ == 6
then
        
0AF0: 1@ = get_int_from_ini_file "saves\GTAZAsf6.c" section "SCR" key "HARDCORE_DANGER2"
if
1@ == 1
    then
    2@ = 1
    else
    2@ = 0
    end
        
if
2@ == 1
    then
    0B00: delete_file "saves\GTAZAsf6.b"  // IF and SET
    0B00: delete_file "saves\GTAZAsf6.c"  // IF and SET
    end
    
end

if
0@ == 7
then
        
0AF0: 1@ = get_int_from_ini_file "saves\GTAZAsf7.c" section "SCR" key "HARDCORE_DANGER2"
if
1@ == 1
    then
    2@ = 1
    else
    2@ = 0
    end
        
if
2@ == 1
    then
    0B00: delete_file "saves\GTAZAsf7.b"  // IF and SET
    0B00: delete_file "saves\GTAZAsf7.c"  // IF and SET
    end
    
end 

if
0@ == 8
then
        
0AF0: 1@ = get_int_from_ini_file "saves\GTAZAsf8.c" section "SCR" key "HARDCORE_DANGER2"
if
1@ == 1
    then
    2@ = 1
    else
    2@ = 0
    end
        
if
2@ == 1
    then
    0B00: delete_file "saves\GTAZAsf8.b"  // IF and SET
    0B00: delete_file "saves\GTAZAsf8.c"  // IF and SET
    end
    
end   
    
return                  