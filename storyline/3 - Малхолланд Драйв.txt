const
USHER3_VICTORIA = 299@  
USHER3_SAVE_PICKUP = 310@
USHER3_SAVE_PICKUP_MARKER = 311@
USHER3_MISS_CHECKPOINT_NUM = 313@
USHER3_VICTORIA_GOT_BACK_FLAG = 314@
USHER3_QUEST_ACTOR = $SURVIVER[1]
USHER3_QUEST_RANDOM_X = 9@
USHER3_QUEST_RANDOM_Y = 10@
USHER3_QUEST_RANDOM_Z = 11@
USHER3_QUEST_MARKER_ON_MAP = MISSION_CHECKPOINT
USHER3_QUEST_MARKER_ON_MAP_SPHERE = 17@
USHER3_QUEST_ACTION_FLAG = 15@
USHER3_QUEST_POINT_X = 21@
USHER3_QUEST_POINT_Y = 22@
USHER3_QUEST_POINT_Z = 23@
USHER3_QUEST_ACTOR_MARKER = 128@
USHER3_SPOTTED_FLAG = 218@
USHER3_SPOTTED2_FLAG = 219@
USHER3_HINT_FLAG = 220@
USHER3_DIED_FLAG = 221@
USHER3_SPOTTED_FLAG = 222@
USHER3_QUEST_POINT2_X = $STALKER_QUEST_POINT2_X
USHER3_QUEST_POINT2_Y = $STALKER_QUEST_POINT2_Y
USHER3_QUEST_POINT2_Z = $STALKER_QUEST_POINT2_Z
USHER3_LATINOS_CAR = 301@
USHER3_LATINOS_MARKER = 320@
USHER3_TERRY = $SURVIVER[2]
USHER3_NIKOLS = $ARMY69_2[28]
USHER3_HUBERT_PHRASE_COUNT = 321@
end                  
                          
:USHS3
thread 'USHS3'
gosub @UKOD_MISSII3 
if 
wasted_or_busted 
jf @UPROPUSK_KODA3 
gosub @UKOD_PROVALA3 

:UPROPUSK_KODA3        
gosub @UUDALENIE_KODA3
end_thread

:UKOD_MISSII3
increment_mission_attempts 

cinema.Radar(1)
cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
0A48: enable_menu_access_in_widescreen_mode 0
0629: change_integer_stat 258 to 112
0776: create_objects_in_object_group "usher_h"
0459: end_thread_named 'ARMY_SP'
0459: end_thread_named 'BNDT_SP'
0459: end_thread_named 'FRMR_SP'
0459: end_thread_named 'SWAT_SP'
0459: end_thread_named 'C_MENU'

MAIN_QUEST_MUSIC_FLAG = 1
057E: set_radar_grey 0
SURVIVAL_STARTED_FULLY_FLAG = 1
CAMP_DONT_SAY_HELLO_FLAG = 1
USHER_STORY_FEATRUES_LOCKED = 2
USHER_STORY_CREATE_NICOLS_FLAG = 2
$TIME_LOCK_OFF = 1
$WEATHER_LOCK_OFF_FLAG = 1
0459: end_thread_named 'WTH_LCK'
0459: end_thread_named 'TIM_LCK'
BLACK_POLOSKI_ON = 0

actor.PutAtNoOffset(PLAYER_ACTOR,2178.51, -2254.9922, 14.77)
actor.Angle(PLAYER_ACTOR) = 225.6905
camera.Restore_WithJumpCut()
create_thread @3D_REFR
gosub @USHER3_HIDE_WEPS
actor.StorePos(PLAYER_ACTOR,USHER3_QUEST_POINT2_X,USHER3_QUEST_POINT2_Y,USHER3_QUEST_POINT2_Z)

CAMP_DONT_SAY_HELLO_FLAG = 0
$CAMP_SPOTTED_FLAG = 1
$CAMP_SPOTTED_FLAG_SAVE = 0

32@ = 0
repeat
wait 0
00C0: set_current_time 6 0
fade 0 0
$SAVESTATUS = 1
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 255
until 32@ > 3100

while true
wait 0
$END_FADING_MUSIC_FAST = 1

if and
$MUSIC_FADE_ENDED[0] == 1
$MUSIC_FADE_ENDED[1] == 1
$MUSIC_FADE_ENDED[2] == 1
$MUSIC_FADE_ENDED[3] == 1
$MUSIC_FADE_ENDED[4] == 1
then
$END_FADING_MUSIC_FAST = 0
break
end

end     

$SOUND_OFF_1 = 0  
$ONMISSION = 1 
$HUD_REMOVE = 1
$SAVESTATUS = 1   
$INT_ZMB_NOT = 1
$NOTSPAWN_ETC = 1
$SPECIAL_INFECTED_NOT_SPAWN_FLAG = 1
ZOMBIES_NOTSPAWN = 1
$ZOMBIES_COUNT = 20
$QUEST_CAMP_NUMBER = 6

ENEX_OFF = 1
PLAYER_DONT_HAVE_BACKPACK = 1

$SPECIAL_INFECTED_NOT_SPAWN_FLAG = 1
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 0

$SATIETY_LEVEL = 200.0

$DONT_CHANGE_MONTH_FLAG = 1
wait 100
0A8C: write_memory 0x00B70154 size 1 value 18 virtual_protect 0 //Day
0A8C: write_memory 0x00B70155 size 1 value 9 virtual_protect 0 //Month
wait 100
$DONT_CHANGE_MONTH_FLAG = 0

if and
$CHEATS_ON == 1
0AB0:   key_pressed 48
then //Удаление всех скипов
0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CHECKPOINT" 
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 49
then //Скип где мы заехали на территорию поисков
0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CHECKPOINT"  
0AF3: write_float 1110.1029 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CX"
0AF3: write_float -732.9307 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CY"
0AF3: write_float 99.9049 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CZ"
0AF3: write_float 89.1388 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CA"  
end

0AF0: USHER3_MISS_CHECKPOINT_NUM = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CHECKPOINT"

$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS3\theme2.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

////////////////////////////////////////////////////////

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

if
LATEST_CAR_SLOT_USED == -1
then
gosub @USHER3_CREATE_VICTORIA
create_thread @C_MENU 1
SUPPLY_QUEST_TRUCK = -1
end

//$CAR_SAVE_BANKA_COUNT[LATEST_CAR_SLOT_USED] = 2
//$CAR_SAVE_HEAL_COUNT[LATEST_CAR_SLOT_USED] = 2
//$CAR_SAVE_BINT_COUNT[LATEST_CAR_SLOT_USED] = 2
//$CAR_SAVE_RADIO_COUNT[LATEST_CAR_SLOT_USED] = 1
//0AD3: 4@s = format "CR%d" LATEST_CAR_SLOT_USED
//0AF1: write_int 88 to_ini_file "data\survival.set" section 4@s key "WEP_SLOT1_ID"
//0AF1: write_int 120 to_ini_file "data\survival.set" section 4@s key "WEP_SLOT1_AMMO"
//0AF1: write_int 18 to_ini_file "data\survival.set" section 4@s key "WEP_SLOT2_ID"
//0AF1: write_int 5 to_ini_file "data\survival.set" section 4@s key "WEP_SLOT2_AMMO"
//$RADIO = 0

$SAVESTATUS = 0
BASE_TEAMMATES_DESTORY_FLAG = 0

repeat
wait 0
until 056D:   actor USHER3_NIKOLS defined

repeat
wait 0
gosub @USHER3_HIDE_WEPS

if
8EEA: not locate_char_distance_to_coordinates PLAYER_ACTOR pos $SAVE_CAR_X[SAVE_CAR_CURRENT_NUMBER] $SAVE_CAR_Y[SAVE_CAR_CURRENT_NUMBER] $SAVE_CAR_Z[SAVE_CAR_CURRENT_NUMBER] radius 150.0
then
$SAVE_CAR_X[SAVE_CAR_CURRENT_NUMBER] = 2174.415527 
$SAVE_CAR_Y[SAVE_CAR_CURRENT_NUMBER] = -2265.320313 
$SAVE_CAR_Z[SAVE_CAR_CURRENT_NUMBER] = 13.308066
end

until 056E:   car $USED_CAR[LATEST_CAR_SLOT_USED] defined

$PREPARING_TEXT_OFF = 0
PLAYER_NO_ITEMS_FLAG = 0
PLAYER_DONT_HAVE_BACKPACK = 0
create_thread @PED_BKP PLAYER_ACTOR 371

if
8491: not  actor PLAYER_ACTOR has_weapon 151
then

0781: get_weapon_with_ID 151 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,151,1)
01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

end

06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0
0992: set_player PLAYER_CHAR weapons_scrollable 1

if
USHER3_MISS_CHECKPOINT_NUM == 1
then
:USHER3_LOAD_CHECKPOINT
036A: put_actor PLAYER_ACTOR in_car $USED_CAR[LATEST_CAR_SLOT_USED]
0AF2: 0@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CX"
0AF2: 1@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CY"
0AF2: 2@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CZ"
0AF2: 3@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CA"
car.PutAt($USED_CAR[LATEST_CAR_SLOT_USED],0@, 1@, 2@)
car.Angle($USED_CAR[LATEST_CAR_SLOT_USED]) = 3@
camera.Restore_WithJumpCut()
create_thread @3D_REFR    
USHER3_QUEST_RANDOM_X = 1112.500366
USHER3_QUEST_RANDOM_Y = -742.149658
USHER3_QUEST_RANDOM_Z = 100.132927
USHER3_QUEST_MARKER_ON_MAP = marker.CreateIconAndSphere2(9,1070.9635,-702.1729,115.5981)
jump to @RANDOM_USHER3_COORD_SET2  
else

if
not $CHEATS_ON == 1
then

06D1: v$BNS_TXT = "STRB1E" // v$ = string
$PORTRAIT_RELOAD_FLAG = 0
create_thread @DLC_TXT

repeat
wait 0
until $PORTRAIT_RELOAD_FLAG == 1

end

end

Text.ShowStyled('STRB77', 3000, 2)
v$OBJECTIVE = "STRB10"

player.CanMove(PLAYER_CHAR,true)
camera.Restore_WithJumpCut()
fade 1 1000
create_thread @3D_REFR
$HUD_REMOVE = 0
wait 1000

if
$NORMAL_MODE == 1
then
$SAVE_WAIT_TIME = 240000
else
$SAVE_WAIT_TIME = 360000
end

03C3: set_timer_to $SAVE_WAIT_TIME type 1 GXT 'STRB79'

32@ = 0        

MISSION_MARKER = marker.CreateAboveCar($USED_CAR[LATEST_CAR_SLOT_USED])
07E0: set_marker MISSION_MARKER type_to 1

//////////////////////////////////////////////////////////////////////////////////

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER3_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER3_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER3_FAILED_LDEAD
if
$SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
jf @USHER3_FAILED_CAR_WRECKED

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
$END_DIALOG_INST = 1
wait 0
036A: put_actor PLAYER_ACTOR in_car $USED_CAR[LATEST_CAR_SLOT_USED]
camera.Restore_WithJumpCut() 
break
end

if
actor.InCar(PLAYER_ACTOR,$USED_CAR[LATEST_CAR_SLOT_USED])
    then
    break
    end

until false

v$OBJECTIVE = "STRB70"
marker.Disable(MISSION_MARKER)

USHER3_QUEST_RANDOM_X = 1070.9635
USHER3_QUEST_RANDOM_Y = -702.1729
USHER3_QUEST_RANDOM_Z = 115.5981
USHER3_QUEST_MARKER_ON_MAP = marker.CreateIconAndSphere2(9,USHER3_QUEST_RANDOM_X,USHER3_QUEST_RANDOM_Y,USHER3_QUEST_RANDOM_Z)

//////////////////////////////////////////////////////////////////////////////////

111@ = 0

repeat
wait 0 

if
111@ == 0
then
v$ST_DIALOG[0] = "STRY305"
v$ST_DIALOG[1] = "STRY306"
v$ST_DIALOG[2] = "STRY307"
$DIALOG_COUNT = 2
create_thread @DG_SYS2
111@ = 1
end

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
014F: stop_timer $SAVE_WAIT_TIME
marker.Disable(USHER3_QUEST_MARKER_ON_MAP)
jump to @USHER3_LOAD_CHECKPOINT
end          

///////////////////////////////////////////////////

if and
056E:   car $USED_CAR[LATEST_CAR_SLOT_USED] defined
not USHER3_VICTORIA_GOT_BACK_FLAG == 1
then
        
if
not car.Wrecked($USED_CAR[LATEST_CAR_SLOT_USED])
jf @USHER3_FAILED_CAR_WRECKED
        
if
not actor.InCar(PLAYER_ACTOR,$USED_CAR[LATEST_CAR_SLOT_USED])
    then
    marker.Disable(USHER3_QUEST_MARKER_ON_MAP)         
    gosub @USHER3_GET_BACK_IN_CAR
    v$OBJECTIVE = "STRB70"        
    USHER3_QUEST_MARKER_ON_MAP = marker.CreateIconAndSphere2(9,USHER3_QUEST_RANDOM_X,USHER3_QUEST_RANDOM_Y,USHER3_QUEST_RANDOM_Z)    
    end
else
jump to @USHER3_FAILED_CAR_WRECKED
end
        
///////////////////////////////////////////////////

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER3_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER3_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER3_FAILED_LDEAD
if
$SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
jf @USHER3_FAILED_CAR_WRECKED
if                   
$SAVE_WAIT_TIME > 1
jf @USHER3_QUEST_FAILED_HUBERT_SLOYPOK

if
00EC:   actor PLAYER_ACTOR sphere 0 near_point USHER3_QUEST_RANDOM_X USHER3_QUEST_RANDOM_Y radius 120.0 120.0
    then            
    break
    end

until false   

USHER3_QUEST_RANDOM_X = 1112.500366
USHER3_QUEST_RANDOM_Y = -742.149658
USHER3_QUEST_RANDOM_Z = 100.132927

014F: stop_timer $SAVE_WAIT_TIME

if
actor.Driving(PLAYER_ACTOR)
then
0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CHECKPOINT"
4@ = actor.CurrentCar(PLAYER_ACTOR)  
car.StorePos(4@,0@,1@,2@)
3@ = car.Angle(4@)
0AF3: write_float 0@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CX"
0AF3: write_float 1@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CY"
0AF3: write_float 2@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CZ"
0AF3: write_float 3@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS3_CA" 
end              

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

:RANDOM_USHER3_COORD_SET2

if
USHER3_MISS_CHECKPOINT_NUM == 1
then
player.CanMove(PLAYER_CHAR,true)
camera.Restore_WithJumpCut()
fade 1 1000
create_thread @3D_REFR
$HUD_REMOVE = 0
wait 1000
end

0@ = 1326

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

USHER3_QUEST_ACTOR = actor.Create($TEAMMATES_PED_TYPE,0@,USHER3_QUEST_RANDOM_X,USHER3_QUEST_RANDOM_Y,USHER3_QUEST_RANDOM_Z)
     
0D10: set_actor USHER3_QUEST_ACTOR alpha 255 // IF and SET
    
create_thread @PED_BKP USHER3_QUEST_ACTOR 371

0D10: set_actor USHER3_QUEST_ACTOR alpha 255 // IF and SET
09F4: set_actor USHER3_QUEST_ACTOR ignore_height_difference_following_nodes $Z_IGNORE_HEIGHT     
Actor.SetWalkStyle(USHER3_QUEST_ACTOR, "SURV3")
0446: set_actor USHER3_QUEST_ACTOR dismemberment_possible 0
060B: set_actor USHER3_QUEST_ACTOR decision_maker_to $DEC_PEOPLE
07DD: set_actor USHER3_QUEST_ACTOR attack_rate 50 // previously known as temper_to
081A: set_actor USHER3_QUEST_ACTOR weapon_skill_to 2  
060F: set_actor USHER3_QUEST_ACTOR melee_accuracy_to 999.0
0946: set_actor USHER3_QUEST_ACTOR actions_uninterupted_by_weapon_fire 1
0770: set_actor USHER3_QUEST_ACTOR target_priority 1

if
UNITED_MAP == 0
then
04D8: set_actor USHER3_QUEST_ACTOR drowns_in_water 0 
end

09B5: set_actor USHER3_QUEST_ACTOR signal_after_kill 0  
0A96: 0@ = actor USHER3_QUEST_ACTOR struct
0A8E: 0@ = 0@ + 1376
0A8C: write_memory 0@ size 4 value $SURVIVORS_ROTATE_SPEED virtual_protect 1

08AF: set_actor USHER3_QUEST_ACTOR max_health_to $SURVIVER_MAX_HEALTH
Actor.WeaponAccuracy(USHER3_QUEST_ACTOR) = $SURV_ACCURACY

while not animation.Available("CRACK")
wait 0
animation.Load("CRACK")
end

if
USHER3_QUEST_ACTION_FLAG == 0
then
0332: set_actor USHER3_QUEST_ACTOR bleeding 1
actor.Angle(USHER3_QUEST_ACTOR) = 93.396904
wait 0
0812: AS_actor USHER3_QUEST_ACTOR perform_animation "crckidle1" IFP "CRACK" framedelta 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time 9999999  // versionB
0209: 0@ = random_int_in_ranges 100 200
actor.Health(USHER3_QUEST_ACTOR) = 0@
end

if
SHOW_HINTS_FLAG == 1
then
text.ShowTextBox('HINT48')
end

create_thread @ANT_PRE USHER3_QUEST_ACTOR

32@ = 0
33@ = 0

v$OBJECTIVE = "STRB71"

//////////////////////////////////////////////////////////////////////////////////

while true
wait 0

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1111.259 -742.2399 100.1329
actor.Angle(PLAYER_ACTOR) = 270.3388
camera.Restore_WithJumpCut()
$END_DIALOG_INST = 1
wait 0
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER3_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER3_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER3_FAILED_LDEAD
if
$SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
jf @USHER3_FAILED_CAR_WRECKED

if and
33@ > 120000
USHER3_DIED_FLAG == 0
USHER3_SPOTTED_FLAG == 0
056D:   actor USHER3_QUEST_ACTOR defined
    then        
    33@ = 0
    USHER3_DIED_FLAG = 1
    0829: actor USHER3_QUEST_ACTOR perform_animation "crckdeth1" IFP_file "CRACK" rate 4.0 time -1 and_dies
    
    0A96: 3@ = actor USHER3_QUEST_ACTOR struct
    3@ += 0x754
    0A8D: 1@ = read_memory 3@ size 4 virtual_protect 0
    2@ = 0    
    0ECE: get_time_char_is_dead USHER3_QUEST_ACTOR store_to 2@
    
//    if and
//    0104:   actor USHER3_QUEST_ACTOR near_actor PLAYER_ACTOR radius DEAD_TALK_RADIUS DEAD_TALK_RADIUS DEAD_TALK_RADIUS_Z 0
//    89A8: not  actor USHER3_QUEST_ACTOR headshoted 
//    $SPECTATING_FLAG == 0
//    $SCREWHUD_FLAG == 0
//    $PHRASES_OFF_FLAG == 0
//    not 1@ == 0x02
//    2@ > 500
//    then    
//    gosub @RANDOM_DIALOG_DEAD_STALKER           
//    gosub @USHER3_NAME_CHECK                    
//    09FD: get_gxt_string v$PHRASE3 width_to 3@
//    0093: 3@ = integer 3@ to_float
//    3@ *= 8.0
//    0092: 3@ = float 3@ to_integer                      
//    0384: show_text_1string GXT v$PHRASE3 string v$2NAME3 time 3@ 1            
//    end        
    
    end

if
056D:   actor USHER3_QUEST_ACTOR defined
then
if and
06EE:   actor USHER3_QUEST_ACTOR in_group PLAYER_GROUP
8104: not  actor PLAYER_ACTOR near_actor USHER3_QUEST_ACTOR radius 100.0 100.0 50.0 sphere 0
USHER3_DIED_FLAG == 0
USHER3_SPOTTED_FLAG == 1
not $INT_ENTERING_FLAG == 1
    then
    v$OBJECTIVE = "STRB80"
    
    if
    075C:   marker USHER3_QUEST_ACTOR_MARKER enabled
    then
    marker.Disable(USHER3_QUEST_ACTOR_MARKER)
    end
    
    USHER3_QUEST_ACTOR_MARKER = marker.CreateAboveActor(USHER3_QUEST_ACTOR)
    07E0: set_marker USHER3_QUEST_ACTOR_MARKER type_to 1
    
    while true
    wait 0
    
    if
    not actor.Dead(PLAYER_ACTOR)
    jf @USHER3_FAILED_PLAYER_DIED
    if and
    $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
    not BASE_TEAMMATE_AGRED == 1
    jf @USHER3_FAILED_AGRO
    if
    803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
    jf @USHER3_FAILED_LDEAD
    if
    $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
    jf @USHER3_FAILED_CAR_WRECKED
    
    if or
    8184:   actor USHER3_QUEST_ACTOR health < 1
    0104:   actor PLAYER_ACTOR near_actor USHER3_QUEST_ACTOR radius 100.0 100.0 50.0 sphere 0
    $INT_ENTERING_FLAG == 1
        then
        break
        end
    
    end
    
    marker.Disable(USHER3_QUEST_ACTOR_MARKER)
        
    v$OBJECTIVE = "STRB74"
    
    if
    075C:   marker USHER3_QUEST_MARKER_ON_MAP enabled
    then
    marker.Disable(USHER3_QUEST_MARKER_ON_MAP)
    end
    
    018A: USHER3_QUEST_MARKER_ON_MAP = create_checkpoint_at USHER3_QUEST_POINT2_X USHER3_QUEST_POINT2_Y USHER3_QUEST_POINT2_Z
    
    if
    8184:   actor USHER3_QUEST_ACTOR health < 1
    then
    jump to @USHER3_FAILED_HUBERT_DIED
    end    
        
    end
end

if and
USHER3_DIED_FLAG == 0
USHER3_SPOTTED_FLAG == 1
056D:   actor USHER3_QUEST_ACTOR defined
    then   
    
    if and
    USHER3_SPOTTED2_FLAG == 1
    SHOW_HINTS_FLAG == 1
    then
    
    if
    0A4B:   controls_set_to_joystick
        then    
        if
        8A2A: not  text_box 'HINT46B' displayed
            then
            0512: show_permanent_text_box 'HINT46B'
            end    
        else    
        if
        8A2A: not  text_box 'HINT46' displayed
            then
            0512: show_permanent_text_box 'HINT46'
            end    
        end 
    
    end
    
    if or
    8184:   actor USHER3_QUEST_ACTOR health < 1
    33@ > 30000
        then
        
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////      
        
        0A96: 0@ = actor USHER3_QUEST_ACTOR struct
        0A8E: 0@ = 0@ + 0x764
        0A8D: 1@ = read_memory 0@ size 2 virtual_protect 1
        0A8D: 2@ = read_memory 0xB6F5F0 size 2 virtual_protect 1
        
        if
        0800:   in_two_players_mode
        then
        0A8D: 0@ = read_memory 0xB7CF28 size 2 virtual_protect 1
        else
        0@ = -69
        end
        
        if or
        003B:   1@ == 2@  // (int)
        003B:   1@ == 0@  // (int)
        then
        CARMA_BAD_POINTS += 15
        Audiostream.Loop($KARMA_BAD,0)
        Audiostream.PerformAction($KARMA_BAD, PLAY)
        Audiostream.Volume($KARMA_BAD) = $SOUNDS_VOLUME
        end
        
        if
        00DF:   actor PLAYER_ACTOR driving
            then
            0@ = actor.CurrentCar(PLAYER_ACTOR)
            if
            051B:   actor USHER3_QUEST_ACTOR damaged_by_car 0@
                then
                CARMA_BAD_POINTS += 15
                Audiostream.Loop($KARMA_BAD,0)
                Audiostream.PerformAction($KARMA_BAD, PLAY)
                Audiostream.Volume($KARMA_BAD) = $SOUNDS_VOLUME
                end
            end
        
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
        
//        if and
//        0104:   actor USHER3_QUEST_ACTOR near_actor PLAYER_ACTOR radius DEAD_TALK_RADIUS DEAD_TALK_RADIUS DEAD_TALK_RADIUS_Z 0
//        89A8: not  actor USHER3_QUEST_ACTOR headshoted 
//        $SPECTATING_FLAG == 0
//        $SCREWHUD_FLAG == 0
//        $PHRASES_OFF_FLAG == 0
//        then    
//        gosub @RANDOM_DIALOG_DEAD_STALKER           
//        gosub @USHER3_NAME_CHECK                    
//        09FD: get_gxt_string v$PHRASE3 width_to 3@
//        0093: 3@ = integer 3@ to_float
//        3@ *= 8.0
//        0092: 3@ = float 3@ to_integer                      
//        0384: show_text_1string GXT v$PHRASE3 string v$2NAME3 time 3@ 1            
//        end     

        0829: actor USHER3_QUEST_ACTOR perform_animation "crckdeth1" IFP_file "CRACK" rate 4.0 time -1 and_dies
        USHER3_DIED_FLAG = 1
        wait 2000    

        if
        33@ > 30000
        then
        jump to @USHER3_FAILED_SLOYPOK3 
        else
        jump to @USHER3_FAILED_HUBERT_DIED
        end       
        
        end
    end
    
if and
USHER3_DIED_FLAG == 0
USHER3_SPOTTED_FLAG == 0
056D:   actor USHER3_QUEST_ACTOR defined
    then
    if
    8184:   actor USHER3_QUEST_ACTOR health < 1
        then            
        if
        actor.Animation(USHER3_QUEST_ACTOR) == "crckidle1"
            then
            0829: actor USHER3_QUEST_ACTOR perform_animation "crckdeth1" IFP_file "CRACK" rate 4.0 time -1 and_dies
            USHER3_DIED_FLAG = 1        
            
//            if and
//            0104:   actor USHER3_QUEST_ACTOR near_actor PLAYER_ACTOR radius DEAD_TALK_RADIUS DEAD_TALK_RADIUS DEAD_TALK_RADIUS_Z 0
//            89A8: not  actor USHER3_QUEST_ACTOR headshoted 
//            $SPECTATING_FLAG == 0
//            $SCREWHUD_FLAG == 0
//            $PHRASES_OFF_FLAG == 0
//            then    
//            gosub @RANDOM_DIALOG_DEAD_STALKER           
//            gosub @USHER3_NAME_CHECK                    
//            09FD: get_gxt_string v$PHRASE3 width_to 3@
//            0093: 3@ = integer 3@ to_float
//            3@ *= 8.0
//            0092: 3@ = float 3@ to_integer                      
//            0384: show_text_1string GXT v$PHRASE3 string v$2NAME3 time 3@ 1            
//            end
            
            end                                              
        end
    end    

if
056D:   actor USHER3_QUEST_ACTOR defined
then

if and
0364:   actor PLAYER_ACTOR spotted_actor USHER3_QUEST_ACTOR
02CB:   actor USHER3_QUEST_ACTOR bounding_sphere_visible
875C: not  marker USHER3_QUEST_ACTOR_MARKER enabled
86EE: not  actor USHER3_QUEST_ACTOR in_group PLAYER_GROUP
USHER3_SPOTTED_FLAG == 0
0104:   actor PLAYER_ACTOR near_actor USHER3_QUEST_ACTOR radius 80.0 80.0 50.0 sphere 0
    then
    
    USHER3_SPOTTED_FLAG = 1
    
    if
    075C:   marker USHER3_QUEST_MARKER_ON_MAP enabled
    then
    marker.Disable(USHER3_QUEST_MARKER_ON_MAP)
    end
    
    if
    0184:   actor USHER3_QUEST_ACTOR health > 0
    then
    USHER3_QUEST_ACTOR_MARKER = marker.CreateAboveActor(USHER3_QUEST_ACTOR)
    07E0: set_marker USHER3_QUEST_ACTOR_MARKER type_to 1
    v$OBJECTIVE = "STRB73"
    33@ = 0
    else
    jump to @USHER3_FAILED_SLOYPOK2
    end
    
    end
end

if
056D:   actor USHER3_QUEST_ACTOR defined
then
if and
USHER3_QUEST_ACTION_FLAG == 0
075C:   marker USHER3_QUEST_ACTOR_MARKER enabled
0104:   actor PLAYER_ACTOR near_actor USHER3_QUEST_ACTOR radius 100.0 100.0 10.0 sphere 0
86EE: not  actor USHER3_QUEST_ACTOR in_group PLAYER_GROUP
0184:   actor USHER3_QUEST_ACTOR health > 0
    then
    
    if
    USHER3_SPOTTED2_FLAG == 0
    then
    v$OBJECTIVE = "STRB73"
    USHER3_SPOTTED2_FLAG = 1
    
    $HEAL += 1
    $BINT += 1
    
    if
    SHOW_HINTS_FLAG == 1
    then
    
    if
    0A4B:   controls_set_to_joystick
    then
    0512: show_permanent_text_box 'HINT46B'
    else
    0512: show_permanent_text_box 'HINT46'
    end
    
    end 
    
    end                  
    
    if
    32@ > 5000
    then
    32@ = 0
    
    random_int 29@ 0 4
    if
    29@ == 0
    then
    v$PHRASE3 = "STRY309"
    end
            
    if
    29@ == 1
    then
    v$PHRASE3 = "STRY310"
    end
            
    if
    29@ == 2
    then
    v$PHRASE3 = "STRY311"
    end
            
    if
    29@ == 3
    then
    v$PHRASE3 = "STRY312"
    end
    
    if
    29@ == 4
    then
    v$PHRASE3 = "STRY313"
    end            
    
    09FD: get_gxt_string v$PHRASE3 width_to 29@
    0093: 29@ = integer 29@ to_float
    29@ *= 8.0
    0092: 29@ = float 29@ to_integer  
                                                                                
    0384: show_text_1string GXT v$PHRASE3 string v$2NAME3 time 29@ 1
    
    end
            
    0@ = actor.Health(USHER3_QUEST_ACTOR)
    if
    0@ > 300
        then
        v$OBJECTIVE = "DUMMY"        
        marker.Disable(USHER3_QUEST_ACTOR_MARKER)
        text.RemoveTextBox()
        
        0332: set_actor USHER3_QUEST_ACTOR bleeding 0
        
        v$ST_DIALOG[0] = "STRY314"
        v$ST_DIALOG[1] = "STRY315"
        v$ST_DIALOG[2] = "STRY316"
        v$ST_DIALOG[3] = "STRY317"
        v$ST_DIALOG[4] = "STRY318"
        $DIALOG_COUNT = 4
        create_thread @DG_SYS2
        
        repeat
        wait 0                
        
        if
        8184:   actor USHER3_QUEST_ACTOR health < 1
        then
        $END_DIALOG_INST = 1
        wait 0 
        jump to @USHER3_FAILED_HUBERT_DIED
        end
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED
        
        until $DIALOG_END == 1        
        
        0792: disembark_instantly_actor USHER3_QUEST_ACTOR        
        0687: clear_actor USHER3_QUEST_ACTOR task
//        0631: put_actor USHER3_QUEST_ACTOR in_group PLAYER_GROUP 

        v$ST_DIALOG[0] = "STRY319"
        $DIALOG_COUNT = 0
        $DIALOG_NOT_SKIP = 1
        create_thread @DG_SYS2           
        
        //IDEM DALSHE
        
        while not animation.Available("SWEET")
        wait 0
        animation.Load("SWEET")
        end
        
        0615: define_AS_pack_begin 51@
        07CD: AS_actor -1 walk_to 1111.725586 -734.342529 100.132927 stop_with_angle 16.324366 within_radius 1.0
        0812: AS_actor -1 perform_animation "Sweet_injuredloop" IFP "SWEET" framedelta 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time 9999999  // versionB
        0616: define_AS_pack_end 51@
        0618: assign_actor USHER3_QUEST_ACTOR to_AS_pack 51@
        061B: remove_references_to_AS_pack 51@
        
        repeat
        wait 0
        
        if and
        0E3E: is_button_just_pressed 0 button 17
        $CHEATS_ON == 1
        then
        036A: put_actor PLAYER_ACTOR in_car $USED_CAR[LATEST_CAR_SLOT_USED]
        camera.Restore_WithJumpCut()
        $END_DIALOG_INST = 1
        wait 0
        end
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED
           
        if
        8184:   actor USHER3_QUEST_ACTOR health < 1
        then
        $END_DIALOG_INST = 1
        wait 0 
        jump to @USHER3_FAILED_HUBERT_DIED
        end
        
        until actor.Animation(USHER3_QUEST_ACTOR) == "Sweet_injuredloop"
        
        $END_DIALOG_INST = 1
        wait 0 
        v$ST_DIALOG[0] = "STRY320" 
        $DIALOG_COUNT = 0
        create_thread @DG_SYS2 
        
        repeat
        wait 0
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED
        
        if
        8184:   actor USHER3_QUEST_ACTOR health < 1
        then
        $END_DIALOG_INST = 1
        wait 0 
        jump to @USHER3_FAILED_HUBERT_DIED
        end
        
        until $DIALOG_END == 1
        
        v$OBJECTIVE = "STRB81"        
        018A: MISSION_CHECKPOINT = create_checkpoint_at 1110.2479 -733.2706 99.8615
        03BC: MISSION_SPHERE = create_sphere_at 1110.2479 -733.2706 99.8615 radius 2.0
        
        $END_DIALOG_INST = 1
        wait 0 
        v$ST_DIALOG[0] = "STRY321" 
        $DIALOG_COUNT = 0
        create_thread @DG_SYS2 
        
        repeat
        wait 0
        
        if and
        0E3E: is_button_just_pressed 0 button 17
        $CHEATS_ON == 1
        then
        car.PutAt(USHER3_VICTORIA,1110.2479, -733.2706, 99.8615)
        wait 0
        end
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED
                     
        if
        8184:   actor USHER3_QUEST_ACTOR health < 1
        then
        $END_DIALOG_INST = 1
        wait 0 
        jump to @USHER3_FAILED_HUBERT_DIED
        end
        
        until 00F1:   actor PLAYER_ACTOR sphere 0 near_point 1110.2479 -733.2706 radius 3.0 3.0 stopped_in_car
                
        marker.Disable(MISSION_CHECKPOINT)
        03BD: destroy_sphere MISSION_SPHERE
        
        player.CanMove(PLAYER_CHAR,false)
        cinema.Widescreen(1)
        BLACK_POLOSKI_ON = 1
        $HUD_REMOVE = 1
        $HUD_OFF_INST = 1
        
        if
        $FP_ACTIVATED == 1
        then
        repeat
        wait 0
        until $FP_ACTIVATED == 0
        end
        
        USHER3_VICTORIA = actor.CurrentCar(PLAYER_ACTOR)
        0EB4: set_car_coordinates_simple USHER3_VICTORIA position 1110.2479 -733.2706 99.8615
        car.Angle(USHER3_VICTORIA) = 90.0
        
        0936: set_camera 1112.893677 -735.335327 100.050797 position_to 1111.381226 -735.382629 100.717392 time 15000 smooth_transition 1
        0920: point_camera 1112.637817 -734.406433 100.318558 transverse_to 1111.104858 -734.459656 100.985146 time 15000 smooth_transition 1
        
        ////////////////////////////////////////////////////////
        
        while not model.Available(1194)
        wait 0
        model.Load(1194)
        mload
        end
        
        $RNDM_HOUSE_WEAPON[23] = actor.Create(25,1194,1105.2593, -683.351, 113.772)
        actor.Angle($RNDM_HOUSE_WEAPON[23]) = 180.0
        actor.SetWalkStyle($RNDM_HOUSE_WEAPON[23],"GANG1")
        0446: set_actor $RNDM_HOUSE_WEAPON[23] dismemberment_possible 0
        060B: set_actor $RNDM_HOUSE_WEAPON[23] decision_maker_to $DEC_PEOPLE
        actor.Health($RNDM_HOUSE_WEAPON[23]) = $MISSION15_BANDITS_HP
        actor.WeaponAccuracy($RNDM_HOUSE_WEAPON[23]) = 60
        07DD: set_actor $RNDM_HOUSE_WEAPON[23] attack_rate 999 // previously known as temper_to
        099F: AS_actor $RNDM_HOUSE_WEAPON[23] ignore_weapon_range 1
        077A: set_actor $RNDM_HOUSE_WEAPON[23] acquaintance 4 to_actors_pedtype 26 // see ped.dat
        077A: set_actor $RNDM_HOUSE_WEAPON[23] acquaintance 4 to_actors_pedtype 0 // see ped.dat
        create_thread @PED_BKP $RNDM_HOUSE_WEAPON[23] 371
        create_thread @ANT_PRE $RNDM_HOUSE_WEAPON[23]
        0ED9: set_char_ignore_damage_anims $RNDM_HOUSE_WEAPON[23] 1
        
        0781: get_weapon_with_ID 28 model_to 1@
        
        while not model.Available(1@)
        wait 0
        model.Load(1@)
        mload
        end
        
        actor.GiveWeaponAndAmmo($RNDM_HOUSE_WEAPON[23],28,99999)
        
        while not model.Available(1195)
        wait 0
        model.Load(1195)
        mload
        end
        
        $RNDM_HOUSE_WEAPON[24] = actor.Create(25,1195,1089.242188, -688.667542, 113.648438)
        actor.Angle($RNDM_HOUSE_WEAPON[24]) = 180.0
        actor.SetWalkStyle($RNDM_HOUSE_WEAPON[24],"GANG1")
        0446: set_actor $RNDM_HOUSE_WEAPON[24] dismemberment_possible 0
        060B: set_actor $RNDM_HOUSE_WEAPON[24] decision_maker_to $DEC_PEOPLE
        actor.Health($RNDM_HOUSE_WEAPON[24]) = $MISSION15_BANDITS_HP
        actor.WeaponAccuracy($RNDM_HOUSE_WEAPON[24]) = 60
        07DD: set_actor $RNDM_HOUSE_WEAPON[24] attack_rate 999 // previously known as temper_to
        099F: AS_actor $RNDM_HOUSE_WEAPON[24] ignore_weapon_range 1
        077A: set_actor $RNDM_HOUSE_WEAPON[24] acquaintance 4 to_actors_pedtype 26 // see ped.dat
        077A: set_actor $RNDM_HOUSE_WEAPON[24] acquaintance 4 to_actors_pedtype 0 // see ped.dat
        create_thread @PED_BKP $RNDM_HOUSE_WEAPON[24] 371
        create_thread @ANT_PRE $RNDM_HOUSE_WEAPON[24]
        0ED9: set_char_ignore_damage_anims $RNDM_HOUSE_WEAPON[24] 1
        
        0781: get_weapon_with_ID 29 model_to 1@
        
        while not model.Available(1@)
        wait 0
        model.Load(1@)
        mload
        end
        
        actor.GiveWeaponAndAmmo($RNDM_HOUSE_WEAPON[24],29,99999)
        
        while not model.Available(1196)
        wait 0
        model.Load(1196)
        mload
        end
        
        $RNDM_HOUSE_WEAPON[25] = actor.Create(25,1196,1077.9218, -692.4915, 113.6484)
        actor.Angle($RNDM_HOUSE_WEAPON[25]) = 180.0
        actor.SetWalkStyle($RNDM_HOUSE_WEAPON[25],"GANG1")
        0446: set_actor $RNDM_HOUSE_WEAPON[25] dismemberment_possible 0
        060B: set_actor $RNDM_HOUSE_WEAPON[25] decision_maker_to $DEC_PEOPLE
        actor.Health($RNDM_HOUSE_WEAPON[25]) = $MISSION15_BANDITS_HP
        actor.WeaponAccuracy($RNDM_HOUSE_WEAPON[25]) = 150
        07DD: set_actor $RNDM_HOUSE_WEAPON[25] attack_rate 999 // previously known as temper_to
        099F: AS_actor $RNDM_HOUSE_WEAPON[25] ignore_weapon_range 1
        077A: set_actor $RNDM_HOUSE_WEAPON[25] acquaintance 4 to_actors_pedtype 26 // see ped.dat
        077A: set_actor $RNDM_HOUSE_WEAPON[25] acquaintance 4 to_actors_pedtype 0 // see ped.dat
        create_thread @PED_BKP $RNDM_HOUSE_WEAPON[25] 371
        create_thread @ANT_PRE $RNDM_HOUSE_WEAPON[25]
        0ED9: set_char_ignore_damage_anims $RNDM_HOUSE_WEAPON[25] 1
        
        0781: get_weapon_with_ID 101 model_to 1@
        
        while not model.Available(1@)
        wait 0
        model.Load(1@)
        mload
        end
        
        actor.GiveWeaponAndAmmo($RNDM_HOUSE_WEAPON[25],101,99999)
        
        /////////////////////Плавное затухание/////////////////////

        $MUSIC_FADE_NUMBER += 1
        if
        $MUSIC_FADE_NUMBER > 4
            then
            $MUSIC_FADE_NUMBER = 0 
            end    
                
        0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
        $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
                
        $MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
        $MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
        $MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
        create_thread @MUS_FAD
                
        wait 1
                
        while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
        wait 0
        end        
        
        $MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS3\theme3.wav")
        Audiostream.PerformAction($MUSIC_MISSION, PLAY)
        Audiostream.Loop($MUSIC_MISSION, 1)
        Audiostream.Volume($MUSIC_MISSION) = 0.0
        
        /////////////////////Плавное нарастание/////////////////////
        
        $MUSIC_FADE_NUMBER += 1
        if
        $MUSIC_FADE_NUMBER > 4
            then
            $MUSIC_FADE_NUMBER = 0 
            end    
        
        0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
        0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
        
        $MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
        $MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
        $MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
        create_thread @MUS_FAD
        
        wait 1             
        
        0350: set_actor $RNDM_HOUSE_WEAPON[23] maintain_position_when_attacked 1
        0350: set_actor $RNDM_HOUSE_WEAPON[24] maintain_position_when_attacked 1
        0350: set_actor $RNDM_HOUSE_WEAPON[25] maintain_position_when_attacked 1
        
        0615: define_AS_pack_begin 51@
        078F: AS_actor -1 climb 1
        05E2: AS_actor -1 kill_actor USHER3_QUEST_ACTOR
        0616: define_AS_pack_end 51@
//        0618: assign_actor $RNDM_HOUSE_WEAPON[23] to_AS_pack 51@   
//        0618: assign_actor $RNDM_HOUSE_WEAPON[24] to_AS_pack 51@
        0618: assign_actor $RNDM_HOUSE_WEAPON[25] to_AS_pack 51@
        061B: remove_references_to_AS_pack 51@
        
        0615: define_AS_pack_begin 51@
        078F: AS_actor -1 climb 1
//        05E2: AS_actor -1 kill_actor PLAYER_ACTOR
        0672: AS_actor -1 attack_car USHER3_VICTORIA
        0616: define_AS_pack_end 51@
        0618: assign_actor $RNDM_HOUSE_WEAPON[23] to_AS_pack 51@   
        0618: assign_actor $RNDM_HOUSE_WEAPON[24] to_AS_pack 51@
        061B: remove_references_to_AS_pack 51@        
        
        05CA: AS_actor USHER3_QUEST_ACTOR enter_car USHER3_VICTORIA passenger_seat -1 time 99000
        
        repeat
        wait 0
        gosub @PIDORS_CLIMB_SPEEDUP
        until actor.Animation(USHER3_QUEST_ACTOR) == "CAR_open_LHS"

        while actor.Animation(USHER3_QUEST_ACTOR) == "CAR_open_LHS"
        wait 0
        gosub @PIDORS_CLIMB_SPEEDUP                                                
        end
        
        0792: disembark_instantly_actor USHER3_QUEST_ACTOR        
        32@ = 0
        
        repeat
        wait 0
        
        if
        32@ > 1000
            then
            break
            end
        
        until 051A:  actor USHER3_QUEST_ACTOR damaged_by_actor $RNDM_HOUSE_WEAPON[25]
        
        04EB: AS_actor USHER3_QUEST_ACTOR crouch 1
        
        actor.WeaponAccuracy($RNDM_HOUSE_WEAPON[24]) = 50
        
        $END_DIALOG_INST = 1
        wait 0 
        v$ST_DIALOG[0] = "STRY322" 
        v$ST_DIALOG[1] = "STRY323"
        $DIALOG_COUNT = 1
        create_thread @DG_SYS2 
        
        repeat
        wait 0     
        
        if
        8184:   actor USHER3_QUEST_ACTOR health < 1
        then
        $END_DIALOG_INST = 1
        wait 0 
        jump to @USHER3_FAILED_HUBERT_DIED
        end
        
        until $DIALOG_END == 1
        
        player.CanMove(PLAYER_CHAR,true)
        cinema.Widescreen(0)        
        BLACK_POLOSKI_ON = 0
        $HUD_REMOVE = 0
        $HUD_ON_INST = 1
        068D: get_camera_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
        0936: set_camera $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 position_to 1111.381226 -735.382629 100.717392 time 250 smooth_transition 1
        068E: get_camera_target_point_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
        0920: point_camera $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 transverse_to 1111.104858 -734.459656 100.985146 time 250 smooth_transition 1
        07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0
        wait 250
        camera.Restore_WithJumpCut()
        
        04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 7 weapon 0@ ammo 1@ model 29@
        04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 6 weapon 0@ ammo 2@ model 29@
        04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 5 weapon 0@ ammo 3@ model 29@
        04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 3 weapon 0@ ammo 4@ model 29@
        
        if and
        1@ < 30
        2@ < 30
        3@ < 30
        4@ < 30
        then
        
        0781: get_weapon_with_ID 31 model_to 1@
        
        while not model.Available(1@)
        wait 0
        model.Load(1@)
        mload
        end
        
        actor.GiveWeaponAndAmmo(PLAYER_ACTOR,31,100)
        
        end
        
        v$OBJECTIVE = "STR95"
        
        repeat
        wait 0     
        015D: set_gamespeed 0.0
        07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0        
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED
                
        if
        0A4B:   controls_set_to_joystick
            then
            
            if
            SHOW_HINTS_FLAG == 1
            then
            text.ShowH('HINT47B',10,1)
            end
            
            if or
            00E1:   player 0 pressed_key 16
            00E1:   player 0 pressed_key 17
                then
                if
                0E3E: is_button_just_pressed 0 button 4
                    then
                    015D: set_gamespeed 1.0
                    break
                    end
                end
            
            else
            
            if
            SHOW_HINTS_FLAG == 1
            then
            text.ShowH('HINT47',10,1)
            end
            
            if
            0AB0:   key_pressed $KEY_SLOWMOTION
                then
                015D: set_gamespeed 1.0
                break
                end
                                
            end
        
        until false
                
        LAST_CHANCE_FLAG = 2
        
        v$OBJECTIVE = "STRB75"
        create_thread @PED_BKP $RNDM_HOUSE_WEAPON[23] 371 0 0 0 1 0 3 7 3
        create_thread @PED_BKP $RNDM_HOUSE_WEAPON[24] 371 0 0 0 1 0 3 7 3
        create_thread @PED_BKP $RNDM_HOUSE_WEAPON[25] 371 0 0 0 1 0 3 7 3
        
//        07DD: set_actor $RNDM_HOUSE_WEAPON[23] attack_rate 100 // previously known as temper_to
//        07DD: set_actor $RNDM_HOUSE_WEAPON[24] attack_rate 100 // previously known as temper_to        
//        05E2: AS_actor $RNDM_HOUSE_WEAPON[23] kill_actor PLAYER_ACTOR
//        05E2: AS_actor $RNDM_HOUSE_WEAPON[24] kill_actor PLAYER_ACTOR 
        
        repeat
        wait 0
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED   
        
        if and
        0E3E: is_button_just_pressed 0 button 17
        $CHEATS_ON == 1
        then
        05BE: AS_actor $RNDM_HOUSE_WEAPON[23] die
        05BE: AS_actor $RNDM_HOUSE_WEAPON[24] die
        05BE: AS_actor $RNDM_HOUSE_WEAPON[25] die
        wait 0
        end     
        
        if and
        actor.Dead($RNDM_HOUSE_WEAPON[23])
        actor.Dead($RNDM_HOUSE_WEAPON[24])
        actor.Dead($RNDM_HOUSE_WEAPON[25]) 
            then
            break
            end
               
        until false
        
        v$OBJECTIVE = "DUMMY"
        LAST_CHANCE_FLAG = 0
        015D: set_gamespeed 0.9
        wait 0
        015D: set_gamespeed 1.0
        player.CanMove(PLAYER_CHAR,false)
                
        05CA: AS_actor USHER3_QUEST_ACTOR enter_car USHER3_VICTORIA passenger_seat -1 time 99000
        
        repeat
        wait 0
        until actor.InCar(USHER3_QUEST_ACTOR,USHER3_VICTORIA)
        
        player.CanMove(PLAYER_CHAR,true)
        07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 1
                                 
        v$OBJECTIVE = "STRB76"        
        018A: MISSION_CHECKPOINT = create_checkpoint_at $CAMP_X[6] $CAMP_Y[6] $CAMP_Z[6]
        
        v$ST_DIALOG[0] = "STRY324"
        v$ST_DIALOG[1] = "STRY325"
        v$ST_DIALOG[2] = "STRY326"
        v$ST_DIALOG[3] = "STRY327"
        v$ST_DIALOG[4] = "STRY328"
        $DIALOG_COUNT = 4
        $DIALOG_NOT_SKIP = 1
        create_thread @DG_SYS2
               
        08AF: set_actor USHER3_QUEST_ACTOR max_health_to 1000
        actor.Health(USHER3_QUEST_ACTOR) = 630
        CLEMMY_HEALTH_STATUS_TEXT = 630
        04F7: vagina_text CLEMMY_HEALTH_STATUS_TEXT type 1 line 1 GXT 'STRB82' // global_variable  // Scor
        SUPPLY_TEXT_FLAG = 1
        $SURVIVOR_IN_PLAYER_TEAM[1] = 1
        
        :CAR_CREATE_USHER3_LATINOS_ATTACK
        if
        model.Available(#SENTINEL)
        then
           
        USHER3_LATINOS_CAR = Car.Create(#SENTINEL, 953.7305, -791.7077, 106.0669)
        Car.Angle(USHER3_LATINOS_CAR) = 253.1915
            
        if
        model.Available(#SENTINEL)
        then
        //model.Destroy(#SENTINEL)
        end
            
        else
        model.Load(#SENTINEL)
        mload
        wait 0
        jump to @CAR_CREATE_USHER3_LATINOS_ATTACK
        end
                
        gosub @USHER3_LATINOS_CREATE_INCAR        
        
        USHER3_LATINOS_MARKER = marker.CreateAboveCar(USHER3_LATINOS_CAR)
        0423: set_car USHER3_LATINOS_CAR improved_handling_to 2.0 // (float)
        088B: set_car USHER3_LATINOS_CAR form_drag_multiplier_to 0.0    
        car.SetDriverBehaviour(USHER3_LATINOS_CAR,KillThePlayer)
        50@ = 0
        
        repeat
        wait 0
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED
        if
        not actor.Dead(USHER3_QUEST_ACTOR)
        jf @USHER3_FAILED_HUBERT_DIED
        
        ///////////////////////////////////////////////////

        if and
        056E:   car $USED_CAR[LATEST_CAR_SLOT_USED] defined
        not USHER3_VICTORIA_GOT_BACK_FLAG == 1
        then
        
        if
        not car.Wrecked($USED_CAR[LATEST_CAR_SLOT_USED])
        jf @USHER3_FAILED_CAR_WRECKED
        
        if
        not actor.InCar(PLAYER_ACTOR,$USED_CAR[LATEST_CAR_SLOT_USED])
            then
            marker.Disable(MISSION_CHECKPOINT)         
            gosub @USHER3_GET_BACK_IN_CAR
            v$OBJECTIVE = "STRB76"        
            018A: MISSION_CHECKPOINT = create_checkpoint_at $CAMP_X[6] $CAMP_Y[6] $CAMP_Z[6]      
            end
        else
        jump to @USHER3_FAILED_CAR_WRECKED
        end
        
        ///////////////////////////////////////////////////
        
        if and
        0E3E: is_button_just_pressed 0 button 17
        $CHEATS_ON == 1
        then
        actor.PutAtNoOffset(PLAYER_ACTOR,2198.3838, -2165.4539, 13.3906)
        camera.Restore_WithJumpCut()
        create_thread @3D_REFR
        $END_DIALOG_INST = 1
        wait 0
        end
        
        gosub @USHER3_HUBERT_HP_SHOW
        
        if and
        056E:   car USHER3_LATINOS_CAR defined
        50@ == 0
            then
            
            if
            8185:   car USHER3_LATINOS_CAR health < 249
            then
            070C: explode_car_without_radius_damage USHER3_LATINOS_CAR
            marker.Disable(USHER3_LATINOS_MARKER)
            end
            
            if
            not car.Wrecked(USHER3_LATINOS_CAR)
                then
                if or
                car.Wrecked(USHER3_LATINOS_CAR)
                8EE5: not locate_char_distance_to_car PLAYER_ACTOR car USHER3_LATINOS_CAR radius 280.0
                    then            
                    
                    if
                    8EE5: not locate_char_distance_to_car PLAYER_ACTOR car USHER3_LATINOS_CAR radius 280.0
                    then
                    car.Destroy(USHER3_LATINOS_CAR)
                    end
                    
                    :HUYBERT_SHITS_IN_WOODS
                    
                    $END_DIALOG_INST = 1
                    wait 0
                    
                    v$ST_DIALOG[0] = "STR327B"
                    v$ST_DIALOG[1] = "STR327С"
                    $DIALOG_COUNT = 1
                    $DIALOG_NOT_SKIP = 1
                    create_thread @DG_SYS2
                    
                    50@ = 1
                    
                    end
                else
                if
                056E:   car USHER3_LATINOS_CAR defined
                    then
                    jump to @HUYBERT_SHITS_IN_WOODS
                    end
                end
            end        
        
        until 50@ == 1
        
        USHER_STORY_CREATE_NICOLS_FLAG = 1
        PLAYER_CANT_SPEAK_WITH_LEADER_FLAG = 1
        
        /////////////////////Плавное затухание/////////////////////

        $MUSIC_FADE_NUMBER += 1
        if
        $MUSIC_FADE_NUMBER > 4
            then
            $MUSIC_FADE_NUMBER = 0 
            end    
                
        0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
        $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
                
        $MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 500
        $MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
        $MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
        create_thread @MUS_FAD
                
        wait 1
                
        while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
        wait 0
        end
        
        $MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS3\theme4.wav")
        Audiostream.PerformAction($MUSIC_MISSION, PLAY)
        Audiostream.Loop($MUSIC_MISSION, 1)
        Audiostream.Volume($MUSIC_MISSION) = 0.0
        
        /////////////////////Плавное нарастание/////////////////////
        
        $MUSIC_FADE_NUMBER += 1
        if
        $MUSIC_FADE_NUMBER > 4
            then
            $MUSIC_FADE_NUMBER = 0 
            end    
        
        0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
        0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
        
        $MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
        $MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
        $MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
        create_thread @MUS_FAD
        
        wait 1 
        
        ////////////////////////////////////////////////////////  
        
        if
        SHOW_HINTS_FLAG == 1
        then
        text.ShowTextBox('HINT50')
        end 
        
        repeat
        wait 0
        
        if and
        0E3E: is_button_just_pressed 0 button 17
        $CHEATS_ON == 1
        then
        actor.PutAtNoOffset(PLAYER_ACTOR,2198.3838, -2165.4539, 13.3906)
        camera.Restore_WithJumpCut()
        create_thread @3D_REFR
        $END_DIALOG_INST = 1
        wait 0
        end
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED
        if
        not actor.Dead(USHER3_QUEST_ACTOR)
        jf @USHER3_FAILED_HUBERT_DIED
        
        ///////////////////////////////////////////////////

        if and
        056E:   car $USED_CAR[LATEST_CAR_SLOT_USED] defined
        not USHER3_VICTORIA_GOT_BACK_FLAG == 1
        then
        
        if
        not car.Wrecked($USED_CAR[LATEST_CAR_SLOT_USED])
        jf @USHER3_FAILED_CAR_WRECKED
        
        if
        not actor.InCar(PLAYER_ACTOR,$USED_CAR[LATEST_CAR_SLOT_USED])
            then
            marker.Disable(MISSION_CHECKPOINT)         
            gosub @USHER3_GET_BACK_IN_CAR
            v$OBJECTIVE = "STRB76"        
            018A: MISSION_CHECKPOINT = create_checkpoint_at $CAMP_X[6] $CAMP_Y[6] $CAMP_Z[6]      
            end
        else
        jump to @USHER3_FAILED_CAR_WRECKED
        end
        
        ///////////////////////////////////////////////////
        
        gosub @USHER3_HUBERT_HP_SHOW
        until 00EC:   actor PLAYER_ACTOR sphere 0 near_point $CAMP_X[6] $CAMP_Y[6] radius 180.0 180.0
        
        CAMP_DONT_SAY_HELLO_FLAG = 1
        $CAMP_SPOTTED_FLAG = 1
        $CAMP_SPOTTED_FLAG_SAVE = 0
        BOLVANS_DONT_DO_ACTIVITES = 1
        marker.Disable(MISSION_CHECKPOINT)
        $SURVIVOR_IN_PLAYER_TEAM[1] = 0
        v$OBJECTIVE = "DUMMY"
        0151: remove_status_text CLEMMY_HEALTH_STATUS_TEXT      
        
        fade 0 1000
        $HUD_REMOVE = 1
        wait 1000   
        
        $SAVESTATUS = 1
        ZOMBIES_NOTSPAWN = 1
        
        cinema.Widescreen(1)
        BLACK_POLOSKI_ON = 1        
        player.CanMove(PLAYER_CHAR,false)
        06AB: set_actor PLAYER_ACTOR all_weapons_hidden 1
        
        car.SetSpeedInstantly(USHER3_VICTORIA,0.0)
        car.PutAt(USHER3_VICTORIA,2186.3672, -2262.5732, 13.0041) 
        car.Angle(USHER3_VICTORIA) = 133.0
        0430: put_actor PLAYER_ACTOR into_car USHER3_VICTORIA passenger_seat 0
        
        /////////////////////Плавное затухание/////////////////////

        $MUSIC_FADE_NUMBER += 1
        if
        $MUSIC_FADE_NUMBER > 4
            then
            $MUSIC_FADE_NUMBER = 0 
            end    
                
        0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
        $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
                
        $MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 500
        $MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
        $MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
        create_thread @MUS_FAD
                
        wait 1
                
        while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
        wait 0
        end   
        
        repeat
        wait 0
        until 056D:   actor $ARMY69_2[13] defined
        
        camera.SetPosition(2195.204102 -2261.673584 16.168774,0.0,0.0,0.0)
        camera.PointAt(2194.225586 -2261.551514 16.003046,2)                
        
        wait 1000
        fade 1 1000
        wait 1000    
        
        0707: start_scene_skip_to @USHER3_SKIP_MEDIC_CUTSCENE
        
        05D6: clear_scmpath
        05D7: add_point_to_scmpath 2178.0278 -2255.2019 14.77
        05D7: add_point_to_scmpath 2167.8328 -2254.3403 13.3021
        05D7: add_point_to_scmpath 2161.7346 -2247.9561 13.2933    
                
        0615: define_AS_pack_begin 51@ 
        05CD: AS_actor -1 exit_car USHER3_VICTORIA
        05D8: AS_assign_scmpath to_actor -1 flags 7 0  
        05D4: AS_actor -1 rotate_angle 46.1976
        0616: define_AS_pack_end 51@                 
        0618: assign_actor PLAYER_ACTOR to_AS_pack 51@
        061B: remove_references_to_AS_pack 51@
        
        v$ST_DIALOG[0] = "STRY335"
        $DIALOG_COUNT = 0
        $DIALOG_NOT_SKIP = 1
        create_thread @DG_SYS2
        
        05BF: AS_actor $ARMY69_2[9] look_at_actor PLAYER_ACTOR 5000 ms
        
        repeat
        wait 0
        until not actor.InCar(PLAYER_ACTOR,USHER3_VICTORIA)
        
        01B9: set_actor PLAYER_ACTOR armed_weapon_to 0
        
        repeat
        wait 0
        until 0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 2167.8328 -2254.3403 13.3021 radius 5.0
        
        actor.PutAtNoOffset($ARMY69_2[13],2163.3574, -2244.406, 13.2875)
        actor.Angle($ARMY69_2[13]) = 135.9473        
        05D9: AS_actor $ARMY69_2[13] run_to_actor PLAYER_ACTOR timelimit 50000 stop_within_radius 2.0
        01B9: set_actor $ARMY69_2[13] armed_weapon_to 0                 
        
        repeat
        wait 0
        
        if 
        0EE4: locate_char_distance_to_char PLAYER_ACTOR char $ARMY69_2[13] radius 2.5
            then
            0E96: clear_char_primary_tasks PLAYER_ACTOR
            0E96: clear_char_primary_tasks $ARMY69_2[13]
            wait 2000
            break
            end
        
        until false     
        
        05D6: clear_scmpath
        05D7: add_point_to_scmpath 2166.8738 -2253.7546 13.3016
        05D7: add_point_to_scmpath 2176.8435 -2253.9941 14.1241
        05D7: add_point_to_scmpath 2187.933350 -2262.798096 13.469902
        
        0615: define_AS_pack_begin 51@
        05D8: AS_assign_scmpath to_actor -1 flags 7 0
        05CA: AS_actor -1 enter_car USHER3_VICTORIA passenger_seat 1 time 99000
        0616: define_AS_pack_end 51@                 
        0618: assign_actor $ARMY69_2[13] to_AS_pack 51@
        061B: remove_references_to_AS_pack 51@
        
        07A3: AS_actor PLAYER_ACTOR run_to_and_follow_actor $ARMY69_2[13] wait_radius_between 3.5 and 5.0                     
        
        repeat
        wait 0               
        until actor.Animation($ARMY69_2[13]) == "CAR_open_LHS"

        while actor.Animation($ARMY69_2[13]) == "CAR_open_LHS"
        wait 0                                             
        end       
        
        wait 0
        0430: put_actor USHER3_QUEST_ACTOR into_car USHER3_VICTORIA passenger_seat 1
        
        repeat
        wait 0
        08A6: set_car USHER3_VICTORIA door 4 rotation_to 180.0
        until actor.Animation($ARMY69_2[13]) == "CAR_pullout_LHS"
        
        0792: disembark_instantly_actor $ARMY69_2[13]
        0E96: clear_char_primary_tasks $ARMY69_2[13]
        0E97: clear_char_secondary_tasks $ARMY69_2[13]
        08A6: set_car USHER3_VICTORIA door 4 rotation_to 180.0
        0A1D: AS_actor $ARMY69_2[13] rotate_to_and_look_at_actor USHER3_QUEST_ACTOR        
        wait 500 
        
        ///////////////////////////////////////////////////////////////////////////////////////

        0470: 9@ = actor $ARMY69_2[13] current_weapon
        06AB: set_actor $ARMY69_2[13] all_weapons_hidden 1
        
        while not animation.Available("CAR_CHECKS")
        wait 0
        animation.Load("CAR_CHECKS")
        end
        
        32@ = 0
        
        03CF: load_wav 20802 as 4 
        
        while 83D0: not  wav 4 loaded 
        wait 0
        03CF: load_wav 20802 as 4 
        end
         
        0949: link_wav 4 to_actor $ARMY69_2[13]
        03D1: play_wav 4
        
        0605: actor $ARMY69_2[13] perform_animation "car_check" IFP "CAR_CHECKS" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1 
        
        v$ST_DIALOG[0] = "STRY336"
        $DIALOG_COUNT = 0
        $DIALOG_NOT_SKIP = 1
        create_thread @DG_SYS2
        
        while 83D2:   wav 4 ended 
        wait 0
        end
        
        040D: unload_wav 4 
        04EF: release_animation "CAR_CHECKS"
        
        06AB: set_actor $ARMY69_2[13] all_weapons_hidden 0
        
        01B9: set_actor $ARMY69_2[13] armed_weapon_to 9@
        
        v$ST_DIALOG[0] = "STRY337"
        v$ST_DIALOG[1] = "STRY338"
        $DIALOG_COUNT = 1
        $DIALOG_NOT_SKIP = 1
        create_thread @DG_SYS2
        
        05BF: AS_actor PLAYER_ACTOR look_at_actor USHER3_QUEST_ACTOR 3000 ms
        
//        0E96: clear_char_primary_tasks PLAYER_ACTOR
//        05D6: clear_scmpath
//        05D7: add_point_to_scmpath 2184.1638 -2260.5999 13.4099
//        05D7: add_point_to_scmpath 2178.2573 -2254.9746 14.77
//        05D7: add_point_to_scmpath 2167.4993 -2253.9353 13.3019
//        05D7: add_point_to_scmpath 2165.4878 -2251.9446 13.3005
//        05D8: AS_assign_scmpath to_actor PLAYER_ACTOR flags 6 0
        
        repeat
        wait 0
        until $DIALOG_END == 1 
        
        :USHER3_SKIP_MEDIC_CUTSCENE
        0701: end_scene_skip
        
        $END_DIALOG_INST = 1
        wait 0
        
        fade 0 500
        wait 500
        
        0337: set_actor $ARMY69_2[13] visibility 0
        0337: set_actor USHER3_QUEST_ACTOR visibility 0
        0362: remove_actor $ARMY69_2[13] from_car_and_place_at 2157.7446 -2229.5649 13.3023
        0362: remove_actor USHER3_QUEST_ACTOR from_car_and_place_at 2158.5293 -2228.7791 13.3023
        0619: enable_actor $ARMY69_2[13] collision_detection 0
        0619: enable_actor USHER3_QUEST_ACTOR collision_detection 0
        actor.LockInCurrentPosition($ARMY69_2[13],true)
        actor.LockInCurrentPosition(USHER3_QUEST_ACTOR,true)
        0508: car USHER3_VICTORIA close_all_doors                
        
        $MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS3\theme5.wav")
        Audiostream.PerformAction($MUSIC_MISSION, PLAY)
        Audiostream.Loop($MUSIC_MISSION, 1)
        Audiostream.Volume($MUSIC_MISSION) = 0.0
        
        /////////////////////Плавное нарастание/////////////////////
        
        $MUSIC_FADE_NUMBER += 1
        if
        $MUSIC_FADE_NUMBER > 4
            then
            $MUSIC_FADE_NUMBER = 0 
            end    
        
        0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
        0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 
        
        $MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
        $MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
        $MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
        create_thread @MUS_FAD
        
        wait 1 
        
        ////////////////////////////////////////////////////////   
        
        0E96: clear_char_primary_tasks PLAYER_ACTOR
        0362: remove_actor PLAYER_ACTOR from_car_and_place_at 2165.4878 -2251.9446 13.3005
        actor.PutAtNoOffset(PLAYER_ACTOR,2165.4878, -2251.9446, 13.3005)
        actor.Angle(PLAYER_ACTOR) = 45.1391
        
        wait 1000
        
        cinema.Widescreen(0)
        BLACK_POLOSKI_ON = 0  
        camera.Restore_WithJumpCut()      
        player.CanMove(PLAYER_CHAR,true)
        
        v$OBJECTIVE = "STRB59"
        
        fade 1 1000
        $HUD_REMOVE = 0
        wait 1000
        
        gosub @USHER3_TERRY_ACTOR_CREATE  
        
        //////////////////////////////////////////////////////////////////////////////

        repeat
        wait 0
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        if
        $SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
        jf @USHER3_FAILED_CAR_WRECKED  
        
        if and
        0E3E: is_button_just_pressed 0 button 17
        $CHEATS_ON == 1
        then
        actor.PutAtNoOffset(PLAYER_ACTOR,2129.2288, -2278.8098, 20.6643)
        $END_DIALOG_INST = 1
        wait 0
        end
                
        until 00A4:   actor PLAYER_ACTOR sphere 0 in_cube_cornerA 2121.8728 -2267.6924 20.2734 cornerB 2133.1223 -2289.1956 24.6259
        
        $END_DIALOG_INST = 1
        wait 0 
        
        player.CanMove(PLAYER_CHAR,false)
        fade 0 1000
        $HUD_REMOVE = 1
        wait 1000
        
        01B9: set_actor USHER3_NIKOLS armed_weapon_to 0        
        
        0E96: clear_char_primary_tasks PLAYER_ACTOR
        actor.PutAtNoOffset(PLAYER_ACTOR,2124.6914, -2276.0647, 20.6719)
        actor.Angle(PLAYER_ACTOR) = 70.4935
        
        if
        $FP_ACTIVATED == 1
        then
        repeat
        wait 0
        until $FP_ACTIVATED == 0
        end
        
        cinema.Widescreen(1)
        BLACK_POLOSKI_ON = 1
        camera.SetPosition(2125.195313 -2277.031250 21.355503,0.0,0.0,0.0)
        camera.PointAt(2124.511719 -2276.310791 21.239964,2)
        
        0A1D: AS_actor USHER3_NIKOLS rotate_to_and_look_at_actor PLAYER_ACTOR
        0A1D: AS_actor PLAYER_ACTOR rotate_to_and_look_at_actor USHER3_NIKOLS
        0A1D: AS_actor USHER3_TERRY rotate_to_and_look_at_actor USHER3_NIKOLS
        
        wait 1000
        
        fade 1 1000
        wait 1000
        
        v$ST_DIALOG[0] = "STRY339"
        v$ST_DIALOG[1] = "STRY340"
        v$ST_DIALOG[2] = "STRY341"
        v$ST_DIALOG[3] = "STRY342"
        v$ST_DIALOG[4] = "STRY343"
        v$ST_DIALOG[5] = "STRY344"
        v$ST_DIALOG[6] = "STRY345"
        v$ST_DIALOG[7] = "STRY346"
        v$ST_DIALOG[8] = "STRY347"        
        0084: $DIALOG_ACTOR[0] = USHER3_NIKOLS // (int)
        0084: $DIALOG_ACTOR[1] = USHER3_TERRY // (int)
        0084: $DIALOG_ACTOR[2] = PLAYER_ACTOR // (int)
        0084: $DIALOG_ACTOR[3] = USHER3_TERRY // (int)
        0084: $DIALOG_ACTOR[4] = USHER3_NIKOLS // (int)
        0084: $DIALOG_ACTOR[5] = USHER3_TERRY // (int)
        0084: $DIALOG_ACTOR[6] = USHER3_NIKOLS // (int)
        0084: $DIALOG_ACTOR[7] = USHER3_TERRY // (int)
        0084: $DIALOG_ACTOR[8] = USHER3_NIKOLS // (int)       
        $DIALOG_COUNT = 8
        $DIALOG_NOT_ANIMS_FLAG = 0
        create_thread @DG_SYS
        
        repeat
        wait 0
        
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
        
        until $DIALOG_END == 1
        
        0605: actor USHER3_NIKOLS perform_animation "habargive" IFP "CAMERA" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1
        05BF: AS_actor USHER3_NIKOLS look_at_actor PLAYER_ACTOR 1170 ms
        Audiostream.Volume($PICKUP_ITEM_SOUND) = $SOUNDS_VOLUME 
        Audiostream.Loop($PICKUP_ITEM_SOUND, 0)
        Audiostream.PerformAction($PICKUP_ITEM_SOUND, PLAY)
        wait 1170
        $BANKA += 2
        $HEAL += 2
        $KANISTRA = 1
        $KANISTRA_FUEL += 15.0
        
        v$ST_DIALOG[0] = "STRY348"
        v$ST_DIALOG[1] = "STRY349"
        0084: $DIALOG_ACTOR[0] = USHER3_NIKOLS // (int)
        0084: $DIALOG_ACTOR[1] = PLAYER_ACTOR // (int)
        $DIALOG_COUNT = 1
        $DIALOG_NOT_ANIMS_FLAG = 0
        create_thread @DG_SYS
                
        repeat
        wait 0
                
        if
        not actor.Dead(PLAYER_ACTOR)
        jf @USHER3_FAILED_PLAYER_DIED
        if and
        $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
        not BASE_TEAMMATE_AGRED == 1
        jf @USHER3_FAILED_AGRO
        if
        803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
        jf @USHER3_FAILED_LDEAD
                
        until $DIALOG_END == 1
        
        fade 0 1000
        $HUD_REMOVE = 1
        wait 1000
        
        CAMP_DONT_SAY_HELLO_FLAG = 0
        
        jump to @USHER3_SAVE_PICKUP_MOMENT
        
        ///////////////////////////////////////////////////////////////////////////////////////      
                                
        end
    
    end
end  

end

//////////////////////////////////////////////////////////////////////////////////

jump to @ASSUDALENIE_KODA28

:USHER3_TERRY_ACTOR_CREATE

$TEAMMATES_PED_TYPE = 26

while not model.Available(9199)
wait 0
model.Load(9199)
mload
end

USHER3_TERRY = actor.Create(26,9199,2124.278076, -2276.993896, 20.671875)
actor.Angle(USHER3_TERRY) = 258.282349
     
0D10: set_actor USHER3_TERRY alpha 255 // IF and SET
    
create_thread @PED_BKP USHER3_TERRY 371

actor.Health(USHER3_TERRY) = 1000

0D10: set_actor USHER3_TERRY alpha 255 // IF and SET
09F4: set_actor USHER3_TERRY ignore_height_difference_following_nodes $Z_IGNORE_HEIGHT     
Actor.SetWalkStyle(USHER3_TERRY, "SURV1")
0446: set_actor USHER3_TERRY dismemberment_possible 0
060B: set_actor USHER3_TERRY decision_maker_to $DEC_PEOPLE
07DD: set_actor USHER3_TERRY attack_rate 50 // previously known as temper_to
081A: set_actor USHER3_TERRY weapon_skill_to 2  
060F: set_actor USHER3_TERRY melee_accuracy_to 999.0
0946: set_actor USHER3_TERRY actions_uninterupted_by_weapon_fire 1

if
UNITED_MAP == 0
then
04D8: set_actor USHER3_TERRY drowns_in_water 0 
end

09B5: set_actor USHER3_TERRY signal_after_kill 0  
0A96: 0@ = actor USHER3_TERRY struct
0A8E: 0@ = 0@ + 1376
0A8C: write_memory 0@ size 4 value $SURVIVORS_ROTATE_SPEED virtual_protect 1

08AF: set_actor USHER3_TERRY max_health_to $SURVIVER_MAX_HEALTH
Actor.WeaponAccuracy(USHER3_TERRY) = 90

return


:USHER3_HUBERT_HP_SHOW

0@ = actor.Health(USHER3_QUEST_ACTOR)
0@ /= 10
008A: CLEMMY_HEALTH_STATUS_TEXT = 0@ // (int)
if
$EASY_MODE == 1
then
if
32@ >= 1500
    then
    32@ = 0
    0851: set_actor USHER3_QUEST_ACTOR decrease_health_by 3 affect_armour 0
    end
else
if
32@ >= 1000
    then
    32@ = 0
    0851: set_actor USHER3_QUEST_ACTOR decrease_health_by 3 affect_armour 0
    end
end

if and
33@ >= 35000
321@ < 6
    then
    33@ = 0
                    
    if
    321@ == 0
    then
    v$PHRASE3 = "STRY329"
    end
                
    if
    321@ == 1
    then
    v$PHRASE3 = "STRY330"
    end
                
    if
    321@ == 2
    then
    v$PHRASE3 = "STRY331"
    end
        
    if
    321@ == 3
    then
    v$PHRASE3 = "STRY332"
    end
    
    if
    321@ == 4
    then
    v$PHRASE3 = "STRY333"
    end      
    
    if
    321@ == 5
    then
    v$PHRASE3 = "STRY334"
    end
    
    321@ += 1      
        
    09FD: get_gxt_string v$PHRASE3 width_to 29@
    0093: 29@ = integer 29@ to_float
    29@ *= 8.0
    0092: 29@ = float 29@ to_integer  
                                                                                    
    0384: show_text_1string GXT v$PHRASE3 string v$2NAME3 time 29@ 1
    
    end

return

:PIDORS_CLIMB_SPEEDUP

for 0@ = 23 to 25

if
actor.Animation($RNDM_HOUSE_WEAPON[0@]) == "CLIMB_idle"
then
0393: actor $RNDM_HOUSE_WEAPON[0@] perform_animation "CLIMB_idle" at 2.0 times_normal_rate
end

if
actor.Animation($RNDM_HOUSE_WEAPON[0@]) == "CLIMB_jump"
then
0393: actor $RNDM_HOUSE_WEAPON[0@] perform_animation "CLIMB_jump" at 2.0 times_normal_rate
end

if
actor.Animation($RNDM_HOUSE_WEAPON[0@]) == "CLIMB_jump2fall"
then
0393: actor $RNDM_HOUSE_WEAPON[0@] perform_animation "CLIMB_jump2fall" at 2.0 times_normal_rate
end

if
actor.Animation($RNDM_HOUSE_WEAPON[0@]) == "CLIMB_jump_B"
then
0393: actor $RNDM_HOUSE_WEAPON[0@] perform_animation "CLIMB_jump_B" at 2.0 times_normal_rate
end

if
actor.Animation($RNDM_HOUSE_WEAPON[0@]) == "CLIMB_Pull"
then
0393: actor $RNDM_HOUSE_WEAPON[0@] perform_animation "CLIMB_Pull" at 2.0 times_normal_rate
end

if
actor.Animation($RNDM_HOUSE_WEAPON[0@]) == "CLIMB_Stand"
then
0393: actor $RNDM_HOUSE_WEAPON[0@] perform_animation "CLIMB_Stand" at 2.0 times_normal_rate
end

if
actor.Animation($RNDM_HOUSE_WEAPON[0@]) == "CLIMB_Stand_finish"
then
0393: actor $RNDM_HOUSE_WEAPON[0@] perform_animation "CLIMB_Stand_finish" at 2.0 times_normal_rate
end

end  

return

///////////////////////////////SAVE PICKUP MOMENT///////////////////////////////

:USHER3_SAVE_PICKUP_MOMENT

fade 0 1000
$HUD_REMOVE = 1
wait 1000

actor.PutAtNoOffset(PLAYER_ACTOR,2133.1814, -2277.8745, 20.6719)
actor.Angle(PLAYER_ACTOR) = 315.165
camera.Restore_WithJumpCut()
cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

player.CanMove(PLAYER_CHAR,true)
fade 1 1000
$HUD_REMOVE = 0
wait 1000

USHER3_SAVE_PICKUP = pickup.Create(#PICKUPSAVE,15,$CAMP_SAVE_X[6], $CAMP_SAVE_Y[6], $CAMP_SAVE_Z[6])
USHER3_SAVE_PICKUP_MARKER = marker.CreateIconWithoutSphere(35,$CAMP_SAVE_X[6], $CAMP_SAVE_Y[6], $CAMP_SAVE_Z[6])

v$OBJECTIVE = "STRB60"

03DC: MISSION_MARKER = create_marker_above_pickup USHER3_SAVE_PICKUP

repeat
wait 0 

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
actor.PutAtNoOffset(PLAYER_ACTOR,2231.562012 -2284.314697 14.375132)
$END_DIALOG_INST = 1
wait 0
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER3_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER3_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER3_FAILED_LDEAD

until pickup.Picked_up(USHER3_SAVE_PICKUP)

v$OBJECTIVE = "DUMMY"
player.CanMove(PLAYER_CHAR,false)

marker.Disable(MISSION_MARKER)
pickup.Destroy(USHER3_SAVE_PICKUP)
marker.Disable(USHER3_SAVE_PICKUP_MARKER)

fade 0 1000
wait 1000

BASE_TEAMMATES_DESTORY_FLAG = 1

0629: change_integer_stat 258 to 0
0318: set_latest_mission_passed 'STRB77'

0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS4_CHECKPOINT" 
0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_MISS4_CLETUS_DIED"

wait 1000                                             

$ZOMBIE_SPAWN_INT = 0 
$SAVESTATUS = 1
$ZOMBIES_HORDE = 0
$SAVESTATUS_TRUE = 1   
$MIKE_MUTED = 0
ENEX_OFF = 0
$QUEST_CAMP_NUMBER = -1

gosub @UMUSIC_MISSION3_OFF

$ACHIV_NUMBER = 5
FREEMODE_VOICE_START = 5
FREEMODE_VOICE_END = 6
MIKE_VOICE_CANNOT_SKIP_FLAG = 1
create_thread @VOI_SHO

repeat
wait 0
until $ACHIV_SHOW_ENDED == 1

create_thread @TERRYT2

jump @UUDACHNO3 

:UUDACHNO3        
gosub @UPROPUSK_KODA3 
return 

:UKOD_PROVALA3
$ONMISSION = 0 
mission_cleanup 
06D0: enable_emergency_traffic 0 
06D7: enable_train_traffic 0 
096A: enable_flying_helis 0 
099E: enable_police_patrols 0  
0923: enable_air_traffic 0 
08E7: disable_entrance_markers 0    
return 

:UUDALENIE_KODA3    
$ONMISSION = 0 
marker.Disable(MISSION_CHECKPOINT)
marker.Disable(MISSION_MARKER)

wait 0 

if and
GAME_OVER_FLAG == 0
$ACTOR_DEAD == 0
then
fade 0 0
end

mission_cleanup

if and
GAME_OVER_FLAG == 0
$ACTOR_DEAD == 0
then
fade 0 0
end

06D0: enable_emergency_traffic 0 
06D7: enable_train_traffic 0 
096A: enable_flying_helis 0 
099E: enable_police_patrols 0  
0923: enable_air_traffic 0 
08E7: disable_entrance_markers 0    
return

:USHER3_FAILED_HUBERT_DIED     

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MSFL113"
create_thread @GMV_OVR

return

:USHER3_QUEST_FAILED_HUBERT_SLOYPOK

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MSFL110"
create_thread @GMV_OVR

return

:USHER3_FAILED_WALK

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MSFL104"
create_thread @GMV_OVR

return

:UMUSIC_MISSION3_OFF

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 700
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1

while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
wait 0
end

//////////////////////////////////////////////////////////

return

:USHER3_GET_BACK_IN_CAR
$DIALOG_PAUSE = 1
v$OBJECTIVE = "STRB37"
    
MISSION_CHECKPOINT = marker.CreateAboveCar($USED_CAR[LATEST_CAR_SLOT_USED])
07E0: set_marker MISSION_CHECKPOINT type_to 1
    
///////////////////////////////////////////////////////////////////
    
while true
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER3_GET_BACK_IN_CAR_FAILED_OTHER_REASON
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER3_GET_BACK_IN_CAR_FAILED_OTHER_REASON
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER3_GET_BACK_IN_CAR_FAILED_OTHER_REASON
if
$SAVE_CAR_CREATED[LATEST_CAR_SLOT_USED] == 1
jf @USHER3_GET_BACK_IN_CAR_FAILED_OTHER_REASON
    
if and
056E:   car $USED_CAR[LATEST_CAR_SLOT_USED] defined
not car.Wrecked($USED_CAR[LATEST_CAR_SLOT_USED])
    then
    if
    actor.InCar(PLAYER_ACTOR,$USED_CAR[LATEST_CAR_SLOT_USED])   
        then
        :USHER3_GET_BACK_IN_CAR_FAILED_OTHER_REASON
        marker.Disable(MISSION_CHECKPOINT)
        USHER3_VICTORIA_GOT_BACK_FLAG = 0            
        $DIALOG_PAUSE = 0
        return
        end
    else
    USHER3_VICTORIA_GOT_BACK_FLAG = 1
    return
    end
    
end
    
///////////////////////////////////////////////////////////////////

:USHER3_FAILED_CAR_WRECKED

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MSFL103"
create_thread @GMV_OVR

return

:USHER3_FAILED_WALK2

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL7"
create_thread @GMV_OVR

return

:USHER3_HIDE_WEPS
$NOTSPAWN_ETC = 1
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 1
0992: set_player PLAYER_CHAR weapons_scrollable 0
return

:USHER3_FAILED_SLOYPOK3

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MSFL112"
create_thread @GMV_OVR

return

:USHER3_FAILED_SLOYPOK2

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MSFL111"
create_thread @GMV_OVR

return

:USHER3_FAILED_SLOYPOK

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MSFL100"
create_thread @GMV_OVR

return

:USHER3_FAILED_AGRO

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL5"
create_thread @GMV_OVR
mission_cleanup    
return

:USHER3_FAILED_LDEAD

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL43"
create_thread @GMV_OVR
mission_cleanup    
return

:USHER3_FAILED_PLAYER_DIED

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL80"
create_thread @GMV_OVR

return

:USHER3_FAILED_TERRY_DEAD

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL99"
create_thread @GMV_OVR

return

:USHER3_FAILED_GURZ_SPIZDILI_OR_OTHER

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MSFL101"
create_thread @GMV_OVR

return

:USHER3_CREATE_VICTORIA
if
model.Available(15590)
then

0674: set_car_model 15590 numberplate "MT2WH0L3"    
USHER3_VICTORIA = Car.Create(15590, 2174.415527, -2265.320313, 13.308066)
car.Angle(USHER3_VICTORIA) = 45.0
    
if
model.Available(15590)
then
//model.Destroy(15590)
end
    
else
model.Load(15590)
mload
wait 0
jump to @USHER3_CREATE_VICTORIA
end    
    
/////////////////////////////////////////

008A: $USED_CAR[0] = USHER3_VICTORIA // (int)
$CAR_ENTERED[0] = 1
$CAR_MARKER_CREATED[0] = 0
$CAR_HINT_FLAG[0] = 0
$SAVE_CAR_CREATED[0] = 1
$SAVE_CAR_MODEL[0] = car.Model(USHER3_VICTORIA)
CAR_AUTOSAVED_EVER_FLAG = 1
LATEST_CAR_SLOT_USED = 0

03ED: set_car USHER3_VICTORIA disable_flipped_explosion_when_empty 1              
            
////////////////////////////////////////////////////////////////
0A97: 11@ = car USHER3_VICTORIA struct 
11@ += 9 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
0A97: 11@ = car USHER3_VICTORIA struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
24@ = 25.0 
0A97: 22@ = car USHER3_VICTORIA struct 
0A8E: 23@ = 22@ + 5 // int 
0A8C: write_memory 23@ size 4 value 24@ virtual_protect 0 
08C3: clear 12@ bit 1 
08C3: clear 12@ bit 2 
0A97: 11@ = car USHER3_VICTORIA struct 
11@ += 18 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2
//////////////////////////////////////////////////////////////// 

car.LockInCurrentPosition(USHER3_VICTORIA,false) 

if
0E08: is_car_script_controlled USHER3_VICTORIA
then
car.RemoveReferences(USHER3_VICTORIA)
end          

return

:USHER3_LATINOS_CREATE_INCAR

while not model.Available(1194)
wait 0
model.Load(1194)
mload
end

$BANDIT[1] = Actor.CreateAsDriver(25, 1194, USHER3_LATINOS_CAR)

if
model.Available(1194)
then
//model.Destroy(1194)
end

wait 5

while not model.Available(1195)
wait 0
model.Load(1195)
mload
end

$BANDIT[2] = Actor.CreateAsPassenger(25, 1195, USHER3_LATINOS_CAR,0)

gosub @BANDITS_RANDOM_HP
Actor.Health($BANDIT[1]) = 0@
gosub @BANDITS_RANDOM_HP
Actor.Health($BANDIT[2]) = 0@

Actor.WeaponAccuracy($BANDIT[1]) = $BANDITS_ACCURACY
Actor.WeaponAccuracy($BANDIT[2]) = $BANDITS_ACCURACY

081A: set_actor $BANDIT[1] weapon_skill_to FRA_WEAP_SKILL
081A: set_actor $BANDIT[2] weapon_skill_to FRA_WEAP_SKILL
 
0946: set_actor $BANDIT[1] actions_uninterupted_by_weapon_fire ACT_UTIRPD_WEP_FIRE 
0946: set_actor $BANDIT[2] actions_uninterupted_by_weapon_fire ACT_UTIRPD_WEP_FIRE 
 
060B: set_actor $BANDIT[1] decision_maker_to $DEC_PEOPLE 
060B: set_actor $BANDIT[2] decision_maker_to $DEC_PEOPLE 

0648: unknown_actor $BANDIT[1] task_set 100.0 // float
0648: unknown_actor $BANDIT[2] task_set 100.0 // float

09B5: set_actor $BANDIT[1] signal_after_kill 0
09B5: set_actor $BANDIT[2] signal_after_kill 0

0446: set_actor $BANDIT[1] dismemberment_possible 0 
0446: set_actor $BANDIT[2] dismemberment_possible 0 
  
04D8: set_actor $BANDIT[1] drowns_in_water 0
04D8: set_actor $BANDIT[2] drowns_in_water 0

0A28: set_actor $BANDIT[1] swimming_speed_to 2.3
0A28: set_actor $BANDIT[2] swimming_speed_to 2.3

random_int 5@ $PEOPLE_MIN_MONEY $PEOPLE_MAX_MONEY  
03FE: set_actor $BANDIT[1] money 5@ 
random_int 5@ $PEOPLE_MIN_MONEY $PEOPLE_MAX_MONEY  
03FE: set_actor $BANDIT[2] money 5@ 

Actor.SetWalkStyle($BANDIT[1], "surv5")
Actor.SetWalkStyle($BANDIT[2], "surv5")

0781: get_weapon_with_ID 28 model_to 1@
        
while not model.Available(1@)
wait 0
model.Load(1@)
mload
end
        
actor.GiveWeaponAndAmmo($BANDIT[2],28,99999)

car.SetMaxSpeed(USHER3_LATINOS_CAR,50.0)  
00AE: set_car USHER3_LATINOS_CAR traffic_behaviour_to 2  
03AB: set_car USHER3_LATINOS_CAR strong 1
car.SetSpeedInstantly(USHER3_LATINOS_CAR,5.0)
car.SetDriverBehaviour(USHER3_LATINOS_CAR,KillThePlayer)

0713: actor $BANDIT[2] driveby_actor PLAYER_ACTOR car -1 point 0.0 0.0 0.0 radius 5000.0 8 1 firing_rate 360

return