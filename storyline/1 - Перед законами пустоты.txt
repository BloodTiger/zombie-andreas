const
USHER1_VICTORIA = $SUPPLY_QUEST_TRUCK
USHER1_VICTORIA_B = 302@
USHER1_BEDOLAGA = 301@
USHER1_COOL_PICKUP1 = 201@
USHER1_COOL_PICKUP2 = 202@
USHER1_COOL_PICKUP3 = 203@
USHER1_COOL_PICKUP4 = 204@
USHER1_COOL_PICKUP1_MARK = 205@
USHER1_COOL_PICKUP2_MARK = 206@
USHER1_COOL_PICKUP3_MARK = 207@
USHER1_COOL_PICKUP4_MARK = 208@
USHER1_PICKED_SHIT_COUNT = 209@
USHER1_MESA = 210@
USHER_PICKED_UP_SHIT = 211@
USHER_PICKED_UP_SHIT_PREV_WEP = 212@
USHER1_TERRY_CAR = 213@
USHER1_TERRY = 214@
USHER1_LATINOS = 215@
USHER1_OXRANNIK = $ARMY69_2[3]
USHER1_NIKOLS = $ARMY69_2[28]
USHER1_SAVE_PICKUP = 216@
USHER1_SAVE_PICKUP_MARKER = 217@
MISSION_CHECKPOINT2 = 218@
USHER1_VICTORIA_MARKER = 219@
USHER1_VICTORIA_GOT_BACK_FLAG = 220@
USHER1_SHKATULKA = 221@
USHER1_SHKATULKA_PICKED_UP_FLAG = 222@
USHER1_NIKOLS_CAR = 223@
USHER1_AMADNA_MANDA = 224@
end
                          
:USHS1
thread 'USHS1'
gosub @UKOD_MISSII1 
if 
wasted_or_busted 
jf @UPROPUSK_KODA1 
gosub @UKOD_PROVALA1 

:UPROPUSK_KODA1        
gosub @UUDALENIE_KODA1
end_thread

:UKOD_MISSII1
increment_mission_attempts 

cinema.Radar(1)
cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
0A48: enable_menu_access_in_widescreen_mode 0
0629: change_integer_stat 258 to 109
0776: create_objects_in_object_group "usher_h"
0459: end_thread_named 'ARMY_SP'
0459: end_thread_named 'BNDT_SP'
0459: end_thread_named 'FRMR_SP'
0459: end_thread_named 'SWAT_SP'
0459: end_thread_named 'C_MENU'

MAIN_QUEST_MUSIC_FLAG = 1
DELETE_AMBIENCE = 1
USHER_STORY_FEATRUES_LOCKED = 1

wait 1000

while true
wait 0
$END_FADING_MUSIC_FAST = 1

if and
$MUSIC_FADE_ENDED[0] == 1
$MUSIC_FADE_ENDED[1] == 1
$MUSIC_FADE_ENDED[2] == 1
$MUSIC_FADE_ENDED[3] == 1
$MUSIC_FADE_ENDED[4] == 1
then
$END_FADING_MUSIC_FAST = 0
break
end

end
  
$SOUND_OFF_1 = 1
$ONMISSION = 1 
$HUD_REMOVE = 1
$SAVESTATUS = 1   
$INT_ZMB_NOT = 1
$NOTSPAWN_ETC = 1
$SPECIAL_INFECTED_NOT_SPAWN_FLAG = 1
ZOMBIES_NOTSPAWN = 1
$ZOMBIES_COUNT = 20
$QUEST_CAMP_NUMBER = 6
$ALLOW_HUNGER = 0

ENEX_OFF = 1
PLAYER_DONT_HAVE_BACKPACK = 1

$SPECIAL_INFECTED_NOT_SPAWN_FLAG = 1
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 1

$SATIETY_LEVEL = 200.0

$DONT_CHANGE_MONTH_FLAG = 1
wait 100
0A8C: write_memory 0x00B70154 size 1 value 18 virtual_protect 0 //Day
0A8C: write_memory 0x00B70155 size 1 value 9 virtual_protect 0 //Month
wait 100
$DONT_CHANGE_MONTH_FLAG = 0  

0555: remove_weapon 46 from_actor PLAYER_ACTOR
PLAYER_DONT_HAVE_BACKPACK = 0
PLAYER_NO_ITEMS_FLAG = 1

USHER1_SHKATULKA = object.Init(15080,986.624, -1613.13, 7.41)
object.Angle(USHER1_SHKATULKA) = 180.0
0453: set_object USHER1_SHKATULKA XY_rotation 360.0 0.0 angle 180.0

while not animation.Available("INT_HOUSE")
wait 0
animation.Load("INT_HOUSE")
end

player.CanMove(PLAYER_CHAR) = false

$WEATHER_LOCK_NUMBER = 0 
0792: disembark_instantly_actor PLAYER_ACTOR
player.CanMove(PLAYER_CHAR) = false
set_weather 0
select_interior 1 
0860: link_actor PLAYER_ACTOR to_interior 1
04F9: set_sky_color 1 fade 0
 
0619: enable_actor PLAYER_ACTOR collision_detection 0
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 986.0 -1609.1931 7.33
0E32: set_char_coordinates_simple PLAYER_ACTOR coord 986.0 -1609.1931 7.33
actor.Angle(PLAYER_ACTOR) = 90.0 
04E4: unknown_refresh_game_renderer_at 986.0 -1609.1931
03CB: set_rendering_origin_at 986.0 -1609.1931 7.33
   
$TIME_LOCK_HOUR = 12
$TIME_LOCK_MINUTES = 12
create_thread @TIM_LCK
$WEATHER_SYNC_FLAG = 1
0A8C: write_memory 0xB7014E size 1 value 4 virtual_protect 1 

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

$SAVESTATUS_TRUE = 0
SURVIVAL_STARTED_FULLY_FLAG = 1 
   
0605: actor PLAYER_ACTOR perform_animation "BED_Out_L" IFP "INT_HOUSE" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1
0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 0
wait 0
0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 0 

if and
$CHEATS_ON == 1
0AB0:   key_pressed 48
then //Удаление всех скипов
0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT" 
0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_SLOYPOK_FLAG" 
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 49
then //Скип на выход на улицу
0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT" 
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 50
then //Скип после починки авто
0AF1: write_int 2 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 51
then //Скип после лутания интерьеров
0AF1: write_int 3 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 52
then //Скип после лутания домов
0AF1: write_int 4 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"  
0AF3: write_float 1712.1852 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CX"
0AF3: write_float -2109.8455 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CY"
0AF3: write_float 12.9611 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CZ"
0AF3: write_float 269.8765 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CA"  
0AF3: write_float 1711.4871 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PX"
0AF3: write_float -2103.9185 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PY"
0AF3: write_float 13.5469 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PZ"
0AF3: write_float 180.1665 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PA"
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 53
then //Скип после разговора с Терри
0AF1: write_int 5 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
end

if and
$CHEATS_ON == 1
0AB0:   key_pressed 54
then //Скип после момента с грабителем
0AF1: write_int 6 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
end

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"

if
0@ < 3
then
$ALLOW_PLAYER_SLOWMOTION = 0
end

if
0@ >= 1
then
jump to @USHER_SKIP_FIRST_CINEMA
end    

if
not $CHEATS_ON == 1
then

06D1: v$BNS_TXT = "STRB1" // v$ = string
$PORTRAIT_RELOAD_FLAG = 0
create_thread @DLC_TXT

repeat
wait 0
until $PORTRAIT_RELOAD_FLAG == 1

06D1: v$BNS_TXT = "STRB1B" // v$ = string
$PORTRAIT_RELOAD_FLAG = 0
create_thread @DLC_TXT

repeat
wait 0
until $PORTRAIT_RELOAD_FLAG == 1

06D1: v$BNS_TXT = "STRB1C" // v$ = string
$PORTRAIT_RELOAD_FLAG = 0
create_thread @DLC_TXT

repeat
wait 0
until $PORTRAIT_RELOAD_FLAG == 1

end

$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS1\theme1.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

////////////////////////////////////////////////////////

camera.SetPosition(982.812988 -1610.515259 7.172679,0.0,0.0,0.0)
camera.PointAt(983.712402 -1610.078613 7.154062,2)

$SHIT_FUCK = Audiostream.Load3d("AUDIO\SOUNDS\weapons\magnum.wav")
Audiostream.SetPosition($SHIT_FUCK,13.2574, 981.8758, -1596.6101) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)
0089: 0@ = $SOUNDS_VOLUME // (float)
0@ *= 0.35
Audiostream.Volume($SHIT_FUCK) = 0@

0@ = 0

repeat
random_int 1@ 250 750
wait 1@
Audiostream.PerformAction($SHIT_FUCK, PLAY)
0@ += 1 

if
00E1:   player 0 pressed_key 17
then
//$END_DIALOG_INST = 1
wait 0
jump to @USHER_SKIP_FIRST_CINEMA
break
end

until 0@ > 4

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK) 

0936: set_camera 982.812988 -1610.515259 7.172679 position_to 984.244690 -1610.102539 7.129434 time 12000 smooth_transition 1
0920: point_camera 983.712402 -1610.078613 7.154062 transverse_to 985.131531 -1609.645142 7.194839 time 12000 smooth_transition 1

0A48: enable_menu_access_in_widescreen_mode 1  
$SOUND_OFF_1 = 0
wait 0
cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
create_thread @REFR_3D

text.ClearAll()
text.RemoveTextBox()

fade 1 3000
create_thread @3D_REFR
 
Text.ShowStyled('STRB2', 3000, 2)   

v$ST_DIALOG[0] = "STRY1"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0 

if
0E3E: is_button_just_pressed 0 button 17
then
$END_DIALOG_INST = 1
wait 0 
break
end

until $DIALOG_END == 1

gosub @USHER1_TANK_RANDOM_YELL_SOUND
Audiostream.SetPosition($SHIT_FUCK,13.2574, 981.8758, -1596.6101) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)
0089: 0@ = $SOUNDS_VOLUME // (float)
0@ *= 0.5
Audiostream.Volume($SHIT_FUCK) = 0@
Audiostream.PerformAction($SHIT_FUCK, PLAY)

0@ = 0

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//$END_DIALOG_INST = 1
wait 0
break
end

0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

$SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\fallingcar.mp3")
Audiostream.SetPosition($SHIT_FUCK,13.2574, 981.8758, -1596.6101) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)
0089: 0@ = $SOUNDS_VOLUME // (float)
0@ *= 0.5
Audiostream.Volume($SHIT_FUCK) = 0@
Audiostream.PerformAction($SHIT_FUCK, PLAY)

0@ = 0

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//$END_DIALOG_INST = 1
wait 0
break
end

0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

v$ST_DIALOG[0] = "STRY2"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 1 
0619: enable_actor PLAYER_ACTOR collision_detection 1

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
fade 0 250
wait 250
0614: set_actor PLAYER_ACTOR animation "BED_Out_L" progress_to 1.0 // 0.0 to 1.0
wait 0
break
end

until not actor.Animation(PLAYER_ACTOR) == "BED_Out_L" 

03D6: remove_styled_text "STRB1"
03D6: remove_styled_text "STRB2"  

fade 0 500
wait 500

0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 1
0619: enable_actor PLAYER_ACTOR collision_detection 1

0792: disembark_instantly_actor PLAYER_ACTOR
04EF: release_animation "INT_HOUSE"   

0936: set_camera 982.812988 -1610.515259 7.172679 position_to 984.244690 -1610.102539 7.129434 time 1 smooth_transition 1
0920: point_camera 983.712402 -1610.078613 7.154062 transverse_to 985.131531 -1609.645142 7.194839 time 1 smooth_transition 1
camera.Restore_WithJumpCut()

05D3: AS_actor PLAYER_ACTOR goto_point 982.8779 -1609.5027 7.3406 mode 4 time 10000 ms // versionA

0936: set_camera 987.739929 -1609.385010 7.424954 position_to 984.981201 -1609.439331 7.339846 time 2500 smooth_transition 1
0920: point_camera 986.740479 -1609.399170 7.394132 transverse_to 983.982117 -1609.469238 7.309024 time 2500 smooth_transition 1

fade 1 1000

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
fade 0 250
wait 250
actor.PutAtNoOffset(PLAYER_ACTOR,982.8779, -1609.5027, 7.3406)
//$END_DIALOG_INST = 1
wait 0
break
end

until 0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 982.8779 -1609.5027 7.3406 radius 0.5

fade 0 500
wait 500

$SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\dresserdoor.mp3")  
Audiostream.SetPosition($SHIT_FUCK,7.3406, 982.3304, -1609.516) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)
Audiostream.Volume($SHIT_FUCK) = $SOUNDS_VOLUME
Audiostream.PerformAction($SHIT_FUCK, PLAY)

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//actor.PutAtNoOffset(PLAYER_ACTOR,982.8779, -1609.5027, 7.3406)
//$END_DIALOG_INST = 1
wait 0
break
end

0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

$SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\konserva_open.mp3")  
Audiostream.LinkToActor($SHIT_FUCK,PLAYER_ACTOR)
Audiostream.Loop($SHIT_FUCK, 0)
Audiostream.Volume($SHIT_FUCK) = $SOUNDS_VOLUME
Audiostream.PerformAction($SHIT_FUCK, PLAY)

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//actor.PutAtNoOffset(PLAYER_ACTOR,982.8779, -1609.5027, 7.3406)
//$END_DIALOG_INST = 1
wait 0
break
end

0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

$SHIT_FUCK = Audiostream.Load3d("audio\sounds\food_eat_sound.wav")  
Audiostream.LinkToActor($SHIT_FUCK,PLAYER_ACTOR)
Audiostream.Loop($SHIT_FUCK, 0)
Audiostream.Volume($SHIT_FUCK) = $SOUNDS_VOLUME
Audiostream.PerformAction($SHIT_FUCK, PLAY)

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//actor.PutAtNoOffset(PLAYER_ACTOR,982.8779, -1609.5027, 7.3406)
//$END_DIALOG_INST = 1
wait 0
break
end

0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

v$ST_DIALOG[0] = "STRY3"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0
0924: enable_screen_darkness 1 with_value 255
fade 1 1

if
0E3E: is_button_just_pressed 0 button 17
then
//actor.PutAtNoOffset(PLAYER_ACTOR,982.8779, -1609.5027, 7.3406)
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

0924: enable_screen_darkness 1 with_value 255
fade 0 0
wait 500
0924: enable_screen_darkness 0 with_value -1  

0936: set_camera 982.812988 -1610.515259 7.172679 position_to 984.244690 -1610.102539 7.129434 time 1 smooth_transition 1
0920: point_camera 983.712402 -1610.078613 7.154062 transverse_to 985.131531 -1609.645142 7.194839 time 1 smooth_transition 1
camera.Restore_WithJumpCut()

0615: define_AS_pack_begin 0@
05D3: AS_actor -1 goto_point 985.4669 -1609.2203 7.3406 mode 4 time 10000 ms // versionA
05D4: AS_actor -1 rotate_angle 0.0
0616: define_AS_pack_end 0@
0618: assign_actor PLAYER_ACTOR to_AS_pack 0@
061B: remove_references_to_AS_pack 0@

camera.SetPosition(983.984192 -1610.307495 7.643075,0.0,0.0,0.0)
camera.PointAt(984.603638 -1609.544189 7.459897,2)
0936: set_camera 981.167969 -1609.526733 7.744250 position_to 983.984192 -1610.307495 7.643075 time 2500 smooth_transition 1
0920: point_camera 982.167480 -1609.514038 7.715012 transverse_to 984.603638 -1609.544189 7.459897 time 2500 smooth_transition 1

fade 1 1000

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
fade 0 250
wait 250
actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
actor.Angle(PLAYER_ACTOR) = 0.0
//$END_DIALOG_INST = 1
wait 0
break
end

until 0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 985.4669 -1609.2203 7.3406 radius 0.5

fade 0 500
wait 500
0936: set_camera 981.167969 -1609.526733 7.744250 position_to 983.984192 -1610.307495 7.643075 time 1 smooth_transition 1
0920: point_camera 982.167480 -1609.514038 7.715012 transverse_to 984.603638 -1609.544189 7.459897 time 1 smooth_transition 1
camera.Restore_WithJumpCut()

wait 500

camera.SetPosition(985.647217 -1608.751831 7.598624,0.0,0.0,0.0)
camera.PointAt(985.339050 -1608.082520 6.922555,2)
0936: set_camera 986.080872 -1609.697021 8.553792 position_to 985.647217 -1608.751831 7.598624 time 6500 smooth_transition 1
0920: point_camera 985.772705 -1609.027710 7.877723 transverse_to 985.339050 -1608.082520 6.922555 time 6500 smooth_transition 1
fade 1 1000 

06A9: AS_actor PLAYER_ACTOR look_at_point 985.417460197 -1608.27008646 6.137 5000 ms
v$ST_DIALOG[0] = "STRY4"
v$ST_DIALOG[1] = "DUMMY"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1   

////////////////////////////////////////////////////////////////////////////

fade 0 500
wait 500
:USHER_SKIP_FIRST_CINEMA2
0792: disembark_instantly_actor PLAYER_ACTOR
0687: clear_actor PLAYER_ACTOR task
0936: set_camera 986.080872 -1609.697021 8.553792 position_to 985.647217 -1608.751831 7.598624 time 1 smooth_transition 1
0920: point_camera 985.772705 -1609.027710 7.877723 transverse_to 985.339050 -1608.082520 6.922555 time 1 smooth_transition 1
actor.Angle(PLAYER_ACTOR) = 180.0
camera.Restore_WithJumpCut()
cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 1
then
fade 1 1000
$HUD_REMOVE = 0
wait 1000
else
jump to @USHER1_SKIP_TO_STREET_PART1
end

if
SHOW_HINTS_FLAG == 1
then
text.ShowTextBox('HINT0')
end

player.CanMove(PLAYER_CHAR) = true

v$OBJECTIVE = "STRB3"
09A6: enable_interior_radar_blips 1 
28@ = Pickup.Create(6549, 3, 987.3351, -1611.0165, 7.3406)
03DC: MISSION_MARKER = create_marker_above_pickup 28@

0@ = 0
1@ = 0

repeat
wait 0

gosub @USHER_CHECK_SHKATULKA_PICKUP

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
wait 0
break
end
    
if and
0@ == 0
8A2A:   text_box 'HINT0' displayed
SHOW_HINTS_FLAG == 1
    then
    0@ = 1
    
    //////////////////////////////////////////////////////////////////
            
    if and
    $KEY_USE == 69
    8A4B: not  controls_set_to_joystick
    then
    text.ShowTextBox('HINT12') 
    else
            
    if
    8A4B: not  controls_set_to_joystick
        then            
        text.ShowTextBox('HINT12B')                
        else            
        text.ShowTextBox('HINT12C')            
        end   
                
    end
            
    ////////////////////////////////////////////////////////////////// 
    
    end    

until pickup.Picked_up(28@)

:USHER1_SKIP_TO_STREET_PART1

pickup.Destroy(28@)
Marker.Disable(MISSION_MARKER)
$PREPARING_TEXT_OFF = 0
PLAYER_NO_ITEMS_FLAG = 0
create_thread @PED_BKP PLAYER_ACTOR 371

if
8491: not  actor PLAYER_ACTOR has_weapon 151
then

0781: get_weapon_with_ID 151 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,151,1)
01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

end

$BANKA += 3
$HEAL += 1
$BINT += 2
$JIMMY += 3
$KANISTRA = 0
$KANISTRA_FUEL = 20.0
$REPAIR_KIT += 1

$FIST_HUD_ALWAYS = 1

//////////////////////////////////////////////

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 2 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 10 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 10, 1)
else
//ass
end

//////////////////////////////////////////////

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 3 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 22 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 22, 60)
else
2@ += 34
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 4 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 25 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 25, 50)
else
2@ += 50
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 5 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 32 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 32, 90)
else
2@ += 90
017B: set_actor PLAYER_ACTOR weapon 1@ ammo_to 2@
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end

//////////////////////////////////////////////

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 1
0992: set_player PLAYER_CHAR weapons_scrollable 0

$FIST_HUD_ALWAYS = 0

v$OBJECTIVE = "STRB4"
018A: MISSION_CHECKPOINT = create_checkpoint_at 988.1688 -1627.1482 7.8406
0A40: MISSION_MARKER = create_entrance_marker_at 988.1688 -1627.1482 7.8406 color 14

0@ = 0

0AF0: 1@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"

repeat
wait 0

gosub @USHER_CHECK_SHKATULKA_PICKUP

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
wait 0
break
end

if
1@ > 0
then
break
end

if and
0@ == 0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 986.6035 -1618.5444 7.3406 radius 5.0
    then
    0@ = 1
    v$ST_DIALOG[0] = "STRY5"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2
    end

until 00EC:   actor PLAYER_ACTOR sphere 0 near_point 988.1688 -1627.1482 radius 1.0 1.0 

marker.Disable(MISSION_CHECKPOINT)
0A41: destroy_entrance_marker MISSION_MARKER
player.CanMove(PLAYER_CHAR) = false
v$OBJECTIVE = "DUMMY"

0AF0: 1@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
1@ < 1
then
fade 0 1000
$HUD_REMOVE = 1
wait 1000
28@ = Audiostream.Load("AUDIO\SOUNDS\dooropcl.mp3")
Audiostream.PerformAction(28@, PLAY)
Audiostream.Loop(28@, 0)
Audiostream.Volume(28@) = $SOUNDS_VOLUME
gosub @UMUSIC_MISSION1_OFF
end

create_thread @NO_WAY
CANT_CAPTURE_SHIT = 1
PLAYER_CANT_SPEAK_WITH_LEADER_FLAG = 1
USHER_IS_SUS_IN_CAMPS = 1

DELETE_AMBIENCE = 0
select_interior 0
0860: link_actor PLAYER_ACTOR to_interior 0
04FA: reset_sky_colors_with_fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,986.8784, -1624.448, 14.9297)
actor.Angle(PLAYER_ACTOR) = 90.0
player.CanMove(PLAYER_CHAR) = true
camera.Restore_WithJumpCut()
create_thread @REFR_3D
wait 1000

057E: set_radar_grey 0

0AF0: 1@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
1@ < 5
then
$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS1\theme2.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

//////////////////////////////////////////////////////// 

end
    
:CAR_CREATE_USHER1_VIC
if
model.Available(15590)
then

0674: set_car_model 15590 numberplate "MT2WH0L3"    
USHER1_VICTORIA = Car.Create(15590, 981.8758, -1596.6101, 13.2574)
0EB4: set_car_coordinates_simple USHER1_VICTORIA position 981.8758 -1596.6101 13.2574
03ED: set_car USHER1_VICTORIA disable_flipped_explosion_when_empty 1
car.SetImmunities(USHER1_VICTORIA,1,1,1,1,1)
07C6: set_car USHER1_VICTORIA axis_angle_relation_to 0.003173 0.944281 -0.104570 0.028650
    
if
model.Available(15590)
then
//model.Destroy(15590)
end
    
else
model.Load(15590)
mload
wait 0
jump to @CAR_CREATE_USHER1_VIC
end    
    
/////////////////////////////////////////
    
0A97: 11@ = car USHER1_VICTORIA struct 
11@ += 9 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
0A97: 11@ = car USHER1_VICTORIA struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
24@ = 0.0 
0A97: 22@ = car USHER1_VICTORIA struct 
0A8E: 23@ = 22@ + 5 // int 
0A8C: write_memory 23@ size 4 value 24@ virtual_protect 0 
08C3: clear 12@ bit 1 
08C3: clear 12@ bit 2 
0A97: 11@ = car USHER1_VICTORIA struct 
11@ += 18 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2
car.Health(USHER1_VICTORIA) = 400

/////////////////////////////////////////

0A97: 11@ = car USHER1_VICTORIA struct 
11@ += 9
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2

02D4: car USHER1_VICTORIA turn_off_engine

0A97: 21@ = car USHER1_VICTORIA struct 
21@ += 17
08BD: set 24@ bit 4 
0A8C: write_memory 21@ size 1 value 24@ virtual_protect 0
08C3: clear 24@ bit 4

/////////////////////////////////////////

0407: store_coords_to 100@ 101@ 102@ from_car USHER1_VICTORIA with_offset 0.0 -1.0 -2.0
create_thread @RND_CRP 1 #MALE01 100@ 101@ 102@ 1 0 1 0 2 0 0 0 0 0 0 0 0 -1
PLAYER_YET_CANT_LOOT_SHIT = 1

USHER1_VICTORIA_MARKER = marker.CreateAboveCar(USHER1_VICTORIA)
marker.SetColor(USHER1_VICTORIA_MARKER,2)
marker.SetIconSize(USHER1_VICTORIA_MARKER,2)
07E0: set_marker USHER1_VICTORIA_MARKER type_to 1
018B: set_marker USHER1_VICTORIA_MARKER radar_mode 0
018B: set_marker USHER1_VICTORIA_MARKER radar_mode 2

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ > 1
then
gosub @USHER_CAR_INSTAFIX
036A: put_actor PLAYER_ACTOR in_car USHER1_VICTORIA
camera.Restore_WithJumpCut()
create_thread @3D_REFR

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 2
then
v$ST_DIALOG[0] = "STRY11"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2
end

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 3
then     
car.SetImmunities(USHER1_VICTORIA,0,0,0,0,0)
car.SetSpeedInstantly(USHER1_VICTORIA,10.0)
wait 500
fade 1 1000
$HUD_REMOVE = 0
end

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 3
then
$SAVESTATUS = 0
end

jump to @USHER_SKIP_CAR_T4AST
end

/////////////////////////////////////////   

fade 1 1000
$HUD_REMOVE = 0
$SAVESTATUS = 0

//dev shit
//gosub @USHER_CAR_INSTAFIX
//actor.PutAtNoOffset(PLAYER_ACTOR,955.0379, -1624.1713, 13.5494)
//actor.Angle(PLAYER_ACTOR) = 269.5656
//camera.Restore_WithJumpCut()
//jump to @JUMP_STRAIGHT_TO_TERRY_SHIT
//jump to @JUMP_STRAIGHT_TO_PORT_PART

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

07C6: set_car USHER1_VICTORIA axis_angle_relation_to 0.003173 0.944281 -0.104570 0.028650
until 816B: not  fading

car.LockInCurrentPosition(USHER1_VICTORIA,true)   

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 1
then
audiostream.PerformAction(28@,STOP)
audiostream.Release(28@)
end

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 1
then
0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
end

v$OBJECTIVE = "STRB5"

if
SHOW_HINTS_FLAG == 1
then
text.ShowTextBox('HINT0B')
end

v$ST_DIALOG[0] = "STRY6"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

//////////////////////////////////////////////

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD    

if and
0AB0:   key_pressed $KEY_USE
0AB0:   key_pressed 81
$CHEATS_ON == 1
then      
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
gosub @USHER_CAR_INSTAFIX
036A: put_actor PLAYER_ACTOR in_car USHER1_VICTORIA
//ass skip
0AD1: show_formatted_text_highpriority "SKIP CAR FIX SHIT" time 2000
wait 2000
jump to @USHER_SKIP_CAR_T4AST
end

if and
02CA:   car USHER1_VICTORIA bounding_sphere_visible
0EE5: locate_char_distance_to_car PLAYER_ACTOR car USHER1_VICTORIA radius 15.0
    then
    break
    end
     
until false

MISSION_MARKER = marker.CreateAboveCar(USHER1_VICTORIA)
07E0: set_marker MISSION_MARKER type_to 1

text.ClearAll()
$END_DIALOG_INST = 1
v$OBJECTIVE = "DUMMY"

v$ST_DIALOG[0] = "STRY7"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

until $DIALOG_END == 1

if
SHOW_HINTS_FLAG == 1
then
            
if
8A4B: not  controls_set_to_joystick
then            
text.ShowTextBox('HINT13')                
else            
text.ShowTextBox('HINT13B')            
end               

v$OBJECTIVE = "STRB5B"

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if and
8A2A: not  text_box 'HINT13' displayed
8A2A: not  text_box 'HINT13B' displayed
    then
    break
    end

until false

end  

v$OBJECTIVE = "STRB6"

car.RemoveReferences(USHER1_VICTORIA)
CURRENT_USHER_TUTORIAL_NUM = -999

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

gosub @USHER1_HIDE_WEPS

if 
$REPAIR_KIT == 0
then
$REPAIR_KIT = 1
end

if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

if and
not $JIMMY_USING == 1
8A2A: not  text_box 'INV306' displayed
SHOW_HINTS_FLAG == 1
then
text.ShowH('HINT14',10,1)
end

until 81F4: not  car USHER1_VICTORIA flipped

v$OBJECTIVE = "STRB7"

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

gosub @USHER1_HIDE_WEPS

if 
$REPAIR_KIT == 0
then
$REPAIR_KIT = 1
end

if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

0A97: 21@ = car USHER1_VICTORIA struct 
21@ += 17 
0A8D: 24@ = read_memory 21@ size 1 virtual_protect 0           
    if 
    88B4: not  test 24@ bit 4      
        then
        break
        end

until false

v$OBJECTIVE = "STRB8"

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

gosub @USHER1_HIDE_WEPS

if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

until 0185:   car USHER1_VICTORIA health > 999

CURRENT_USHER_TUTORIAL_NUM = 0
v$OBJECTIVE = "STRB11"

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

gosub @USHER1_HIDE_WEPS

if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

until $PANEL_OPEN == 0

if
SHOW_HINTS_FLAG == 1
then
text.ShowTextBox('HINT15')
end

v$OBJECTIVE = "STRB10"
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 1

repeat
wait 0     

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

gosub @USHER1_HIDE_WEPS

if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

until actor.InCar(PLAYER_ACTOR,USHER1_VICTORIA)

marker.Disable(MISSION_MARKER)
v$OBJECTIVE = "DUMMY"

v$ST_DIALOG[0] = "STRY8"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0    

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

until $DIALOG_END == 1

v$OBJECTIVE = "STRB9"

repeat
wait 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

until not actor.InCar(PLAYER_ACTOR,USHER1_VICTORIA)

MISSION_MARKER = marker.CreateAboveCar(USHER1_VICTORIA)
07E0: set_marker MISSION_MARKER type_to 1
$KANISTRA = 1

repeat
wait 0
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

if and
not $KANISTRA_USING == 1
8A2A: not  text_box 'INV229' displayed
SHOW_HINTS_FLAG == 1
then
text.ShowH('HINT16',10,1)
end

0A97: 22@ = car USHER1_VICTORIA struct 
0A8E: 23@ = 22@ + 5 // int
0A8D: 24@ = read_memory 23@ size 4 virtual_protect 0

until 24@ >= 19.9

v$OBJECTIVE = "STRB10"
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 1

repeat     
wait 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

until actor.InCar(PLAYER_ACTOR,USHER1_VICTORIA)

0E09: mark_car_as_needed USHER1_VICTORIA
car.SetImmunities(USHER1_VICTORIA,0,0,0,0,0)
marker.Disable(MISSION_MARKER)
v$OBJECTIVE = "STRB12"

if
SHOW_HINTS_FLAG == 1
then
text.ShowTextBox('HINT17')
end

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

///////////////////////////////////////////////////

if and
056E:   car SUPPLY_QUEST_TRUCK defined
not USHER1_VICTORIA_GOT_BACK_FLAG == 1
then

if
not car.Wrecked(SUPPLY_QUEST_TRUCK)
jf @USHER1_FAILED_CAR_WRECKED

if
not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
    then
    gosub @USHER1_GET_BACK_IN_CAR
    v$OBJECTIVE = "STRB12"           
    end
else
jump to @USHER1_FAILED_CAR_WRECKED
end

///////////////////////////////////////////////////

until 8EEB: not locate_car_distance_to_coordinates USHER1_VICTORIA pos 100@ 101@ 102@ radius 5.0

v$OBJECTIVE = "STRB13"
PLAYER_YET_CANT_LOOT_SHIT = 0
0221: set_player PLAYER_CHAR apply_brakes_to_car 1

repeat
wait 0   

if or
0A2A:  text_box 'INV70B' displayed
0A2A:  text_box 'INV70C' displayed
    then
    break
    end

until false

repeat
wait 0
until $PANEL_OPEN == 0

v$OBJECTIVE = "DUMMY"

v$ST_DIALOG[0] = "STRY10"
v$ST_DIALOG[1] = "STRY11"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0    

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

until $DIALOG_END == 1

MISSION_MARKER = marker.CreateAboveCar(USHER1_VICTORIA)
07E0: set_marker MISSION_MARKER type_to 1

v$OBJECTIVE = "STRB10"

repeat
wait 0

if
80A4: not  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855
then
gosub @USHER1_GTFO_TO_CAR
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

until actor.InCar(PLAYER_ACTOR,USHER1_VICTORIA)

0221: set_player PLAYER_CHAR apply_brakes_to_car 0
marker.Disable(MISSION_MARKER)

:USHER_SKIP_CAR_T4AST

PLAYER_YET_CANT_LOOT_SHIT = 0

//////////////////////////////////////////////////////// 
    
:CAR_CREATE_USHER1_MESA
if
model.Available(#MESA)
then

0506: set_car_model #MESA next_variation 0 0 // first param is useless    
USHER1_MESA = Car.Create(#MESA, 539.0198, -1795.0315, 5.9181)
car.Angle(USHER1_MESA) = 180.7966
car.SetImmunities(USHER1_MESA,1,1,1,1,1)
car.LockInCurrentPosition(USHER1_MESA,true)
car.Health(USHER1_MESA) = 50000
    
if
model.Available(#MESA)
then
//model.Destroy(#MESA)
end
    
else

model.Load(#MESA)
mload
wait 0
jump to @CAR_CREATE_USHER1_MESA
end    
    
/////////////////////////////////////////
    
0A97: 11@ = car USHER1_MESA struct 
11@ += 9 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
0A97: 11@ = car USHER1_MESA struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
24@ = 0.0 
0A97: 22@ = car USHER1_MESA struct 
0A8E: 23@ = 22@ + 5 // int 
0A8C: write_memory 23@ size 4 value 24@ virtual_protect 0 
08C3: clear 12@ bit 1 
08C3: clear 12@ bit 2 
0A97: 11@ = car USHER1_MESA struct 
11@ += 18 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2

0229: set_car USHER1_MESA primary_color_to 3 secondary_color_to 1

/////////////////////////////////////////

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ >= 3
then

$ALLOW_HUNGER = 1
$SAVESTATUS = 0
ZOMBIES_NOTSPAWN = 0
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0
0992: set_player PLAYER_CHAR weapons_scrollable 1
car.SetImmunities(USHER1_VICTORIA,0,0,0,0,0)

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
not 0@ == 4
then               
car.PutAt(USHER1_VICTORIA,1958.7236, -2039.0697, 12.9622)
car.Angle(USHER1_VICTORIA) = 181.3967
camera.Restore_WithJumpCut()
create_thread @3D_REFR
else
$TIME_LOCK_HOUR = 20
$TIME_LOCK_MINUTES = 12
$BANKA += 14
$BANKA_FIND += 14
$RADIO += 1
$RADIO_FIND += 1
$HEAL += 3
$HEAL_FIND += 3
$BINT += 4
$BINT_FIND += 4
$KANISTRA_FUEL = 0.0

0781: get_weapon_with_ID 103 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 103, 30)

0781: get_weapon_with_ID 85 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 85, 90)
 
0AF2: 0@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CX"
0AF2: 1@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CY"
0AF2: 2@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CZ"
0AF2: 3@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CA"
car.PutAt(USHER1_VICTORIA,0@, 1@, 2@)
car.Angle(USHER1_VICTORIA) = 3@
camera.Restore_WithJumpCut()
create_thread @3D_REFR  
0AF2: 0@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PX"
0AF2: 1@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PY"
0AF2: 2@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PZ"
0AF2: 3@ = get_float_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PA"
2@ -= 1.0
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 0@ 1@ 2@
actor.Angle(PLAYER_ACTOR) = 3@
camera.Restore_WithJumpCut()
create_thread @REFR_3D
fade 1 1000
$HUD_REMOVE = 0
player.CanMove(PLAYER_CHAR,true)   
jump to @JUMP_STRAIGHT_TO_TERRY_SHIT
end

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 5
then
fade 1 1000
$HUD_REMOVE = 0
player.CanMove(PLAYER_CHAR,true)
else
$HUD_REMOVE = 1
select_interior 1
0860: link_actor PLAYER_ACTOR to_interior 1
04F9: set_sky_color 1 fade 0
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 989.3699 -1626.8148 7.3406
actor.Angle(PLAYER_ACTOR) = 10.7252
camera.Restore_WithJumpCut()
create_thread @REFR_3D
cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
$TIME_LOCK_HOUR += 4
$BANKA += 14
$BANKA_FIND += 14
$RADIO += 1
$RADIO_FIND += 1
$HEAL += 3
$HEAL_FIND += 3
$BINT += 4
$BINT_FIND += 4
$KANISTRA_FUEL = 0.0

0781: get_weapon_with_ID 103 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 103, 30)

0781: get_weapon_with_ID 85 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 85, 90)
   
jump to @USHER1_SKIP_AFTERTERRY_DIALOG
end

$BANKA += 12
$BANKA_FIND += 12
$RADIO += 1
$RADIO_FIND += 1
$HEAL += 2
$HEAL_FIND += 2
$BINT += 1
$BINT_FIND += 1
$KANISTRA_FUEL = 0.0

0781: get_weapon_with_ID 103 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 103, 30)

0781: get_weapon_with_ID 85 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 85, 90)
  
jump to @SKIP_LOOTING_INTERIORS
end

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 2
then
0AF1: write_int 2 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
end

if and
0AB0:   key_pressed $KEY_USE
0AB0:   key_pressed 81
$CHEATS_ON == 1
then
//ass skip
0AD1: show_formatted_text_highpriority "SKIP INTERIORS LOOTING" time 2000
wait 2000
else
gosub @GO_LOOT_RESTORAN
gosub @GO_LOOT_BEACH_MEDIC
gosub @GO_LOOT_POLICE
gosub @GO_LOOT_SNACKS
gosub @GO_LOOT_BAR
end

:SKIP_LOOTING_INTERIORS

v$ST_DIALOG[0] = "STRY21"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED 

if
0E3E: is_button_just_pressed 0 button 17
then
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

0AF1: write_int 3 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"

if and
0AB0:   key_pressed $KEY_USE
0AB0:   key_pressed 81
$CHEATS_ON == 1
then    
//ass skip
0AD1: show_formatted_text_highpriority "SKIP HOUSE LOOTING" time 2000
wait 2000
else

v$OBJECTIVE = "STRB22"

CURRENT_USHER_TUTORIAL_NUM = 2
ENEX_OFF = 0
$INT_ZMB_NOT = 0
INT_ZOMBIE_OFF_FADING_AND_SHIT_FLAG = 0

0@ = 0
1@ = 0
2@ = 0
32@ = 0

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

if
0867:   unknown_in_burglary_interior 0
then

2@ = 1

if and
CURRENT_USHER_TUTORIAL_NUM == 3
0@ == 0
$WITCH_KILLED > 0
    then
    0@ = 1
    v$ST_DIALOG[0] = "STRY23"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2
    end
    
if
1@ == 0
    then    
        
    if and
    not $CAR_CHECKING_FLAG == 1
    SHOW_HINTS_FLAG == 1
    then
    if
    0A4B:   controls_set_to_joystick
        then
        text.ShowH('HINT21C',10,1)       
        else    
        if
        $KEY_USE == 69
            then
            text.ShowH('HINT21',10,1)
            else
            text.ShowH('HINT21B',10,1)
            end           
        end
    else
    1@ = 1       
    end                       
    
    end
    
else

if and
2@ == 0
32@ < 15000
SHOW_HINTS_FLAG == 1
    then
    text.ShowH('HINT22',10,1) 
    end 
    
if and
2@ == 0
32@ > 15000
    then
    2@ = 1 
    end         

end  

until CURRENT_USHER_TUTORIAL_NUM == -1

CURRENT_USHER_TUTORIAL_NUM = 0

end

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 5
then
0AF1: write_int 4 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
car.StorePos(USHER1_VICTORIA,0@,1@,2@)
3@ = car.Angle(USHER1_VICTORIA)
0AF3: write_float 0@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CX"
0AF3: write_float 1@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CY"
0AF3: write_float 2@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CZ"
0AF3: write_float 3@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_CA"  
actor.StorePos(PLAYER_ACTOR,0@,1@,2@)
3@ = actor.Angle(PLAYER_ACTOR)
0AF3: write_float 0@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PX"
0AF3: write_float 1@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PY"
0AF3: write_float 2@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PZ"
0AF3: write_float 3@ to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CP4_PA"    
end

:JUMP_STRAIGHT_TO_TERRY_SHIT

v$ST_DIALOG[0] = "STRY25"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED 

if
0E3E: is_button_just_pressed 0 button 17
then
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

//////////////////////////////////////////////////////// 
    
:CAR_CREATE_USHER1_TERRY
if
model.Available(15471)
then

0674: set_car_model 15471 numberplate "3SMGSTUS" 
USHER1_TERRY_CAR = Car.Create(15471, 975.7405, -1629.3739, 13.1556)
car.Angle(USHER1_TERRY_CAR) = 219.8358
car.SetImmunities(USHER1_TERRY_CAR,1,1,1,1,1)
car.LockInCurrentPosition(USHER1_TERRY_CAR,true)
car.DoorStatus(USHER1_TERRY_CAR,2)
    
if
model.Available(15471)
then
//model.Destroy(15471)
end
    
else
model.Load(15471)
mload
wait 0
jump to @CAR_CREATE_USHER1_TERRY
end    
    
/////////////////////////////////////////
    
0A97: 11@ = car USHER1_TERRY_CAR struct 
11@ += 9 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
0A97: 11@ = car USHER1_TERRY_CAR struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
24@ = 0.0 
0A97: 22@ = car USHER1_TERRY_CAR struct 
0A8E: 23@ = 22@ + 5 // int 
0A8C: write_memory 23@ size 4 value 24@ virtual_protect 0 
08C3: clear 12@ bit 1 
08C3: clear 12@ bit 2 
0A97: 11@ = car USHER1_TERRY_CAR struct 
11@ += 18 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2

///////////////////////////////////////////////////

if and
056E:   car SUPPLY_QUEST_TRUCK defined
not USHER1_VICTORIA_GOT_BACK_FLAG == 1
then

if
not car.Wrecked(SUPPLY_QUEST_TRUCK)
jf @USHER1_FAILED_CAR_WRECKED

if
not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
    then     
    gosub @USHER1_GET_BACK_IN_CAR      
    end
else
jump to @USHER1_FAILED_CAR_WRECKED
end

///////////////////////////////////////////////////

v$OBJECTIVE = "STRB27"

018A: MISSION_CHECKPOINT = create_checkpoint_at 986.8784 -1624.448 14.9297
0A40: MISSION_MARKER = create_entrance_marker_at 986.8784 -1624.448 15.4297 color 14

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_SLOYPOK_FLAG"
if or
0@ >= 1
$CHEATS_ON == 1
then                         
0950: set_trip_skip 919.7336 -1725.7646 12.9611 angle 0.3696
end

0@ = 0

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if
0@ == 0
then

///////////////////////////////////////////////////

if and
056E:   car SUPPLY_QUEST_TRUCK defined
not USHER1_VICTORIA_GOT_BACK_FLAG == 1
then

if
not car.Wrecked(SUPPLY_QUEST_TRUCK)
jf @USHER1_FAILED_CAR_WRECKED

if
not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
    then
    marker.Disable(MISSION_CHECKPOINT)         
    gosub @USHER1_GET_BACK_IN_CAR
    v$OBJECTIVE = "STRB27"  
    018A: MISSION_CHECKPOINT = create_checkpoint_at 986.8784 -1624.448 14.9297         
    end
else
jump to @USHER1_FAILED_CAR_WRECKED
end

///////////////////////////////////////////////////

end

if and
0AB0:   key_pressed $KEY_USE
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 986.8784 -1624.448 14.9297
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
end

if and
0@ == 0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 975.7405 -1629.3739 13.1556 radius 15.0
    then
    0@ = 1
    v$ST_DIALOG[0] = "STR26"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2
    end

until 00ED:   actor PLAYER_ACTOR sphere 0 near_point 986.8784 -1624.448 radius 1.0 1.0 on_foot

marker.Disable(MISSION_CHECKPOINT)
0A41: destroy_entrance_marker MISSION_MARKER
player.CanMove(PLAYER_CHAR) = false
v$OBJECTIVE = "DUMMY"
$SAVESTATUS = 1

$INT_ZMB_NOT = 1

fade 0 500
$HUD_REMOVE = 1
wait 500

gosub @UMUSIC_MISSION1_OFF

$END_DIALOG_INST = 1
text.ClearAll()
text.RemoveTextBox()
select_interior 1
0860: link_actor PLAYER_ACTOR to_interior 1
04F9: set_sky_color 1 fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,989.3699, -1626.8148, 7.3406)
actor.Angle(PLAYER_ACTOR) = 10.7252
camera.Restore_WithJumpCut()
create_thread @REFR_3D
02D4: car SUPPLY_QUEST_TRUCK turn_off_engine

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1      

v$ST_DIALOG[0] = "STRY26"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0
0924: enable_screen_darkness 1 with_value 255
fade 1 1

if
0E3E: is_button_just_pressed 0 button 17
then
//actor.PutAtNoOffset(PLAYER_ACTOR,982.8779, -1609.5027, 7.3406)
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

0924: enable_screen_darkness 1 with_value 255
fade 0 0
wait 500
0924: enable_screen_darkness 0 with_value -1   

gosub @USHER1_TERRY_ACTOR_CREATE

0615: define_AS_pack_begin 0@
05D3: AS_actor -1 goto_point 988.0034 -1620.8132 7.3481 mode 7 time 10000 ms // versionA
0635: AS_actor -1 aim_at_actor PLAYER_ACTOR -1 ms
0616: define_AS_pack_end 0@
0618: assign_actor USHER1_TERRY to_AS_pack 0@
061B: remove_references_to_AS_pack 0@

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 1
0992: set_player PLAYER_CHAR weapons_scrollable 0

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 4 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 25 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 25, 1)
01B9: set_actor PLAYER_ACTOR armed_weapon_to 25
else
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end    

camera.SetPosition(990.605042 -1627.296265 8.019741,0.0,0.0,0.0)
camera.PointAt(989.973450 -1626.532837 7.884564,2)
0936: set_camera 989.402405 -1624.703613 7.404504 position_to 989.295898 -1623.153931 7.471459 time 3000 smooth_transition 1
0920: point_camera 989.396362 -1625.703003 7.368904 transverse_to 988.807922 -1622.281860 7.434190 time 3000 smooth_transition 1

$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS1\theme3.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

//////////////////////////////////////////////////////// 

fade 1 1000

repeat
wait 0
until 0E46: is_char_using_gun USHER1_TERRY

v$ST_DIALOG[0] = "STRY27"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0
until $DIALOG_END == 1

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0
camera.SetPosition(990.605042 -1627.296265 8.019741,0.0,0.0,0.0)
camera.PointAt(989.973450 -1626.532837 7.884564,2)
0E69: set_player_control_pad_movement 0 0
//0E60: set_camera_control 0 1 
$HUD_REMOVE = 0
$HUD_ON_INST = 1
DONT_DRAW_CROSSHAIR_FLAG = 1                             

0@ = 0
1@ = 0
2@ = 0

repeat
wait 0

if
1@ > 300
then
015D: set_gamespeed 1.0
077A: set_actor USHER1_TERRY acquaintance 4 to_actors_pedtype 0 // see ped.dat
actor.StorePos(PLAYER_ACTOR,3@,4@,5@)
0668: AS_actor USHER1_TERRY rotate_and_shoot_at 3@ 4@ 5@ 99999 ms

player.CanMove(PLAYER_CHAR,true)
0E69: set_player_control_pad_movement 0 1

repeat
wait 0   

if
0E45: frame_mod 15
then
actor.StorePos(PLAYER_ACTOR,3@,4@,5@)
0668: AS_actor USHER1_TERRY rotate_and_shoot_at 3@ 4@ 5@ 99999 ms
end
    
until 051A:   actor PLAYER_ACTOR damaged_by_actor USHER1_TERRY 

05BE: AS_actor PLAYER_ACTOR die

0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_SLOYPOK_FLAG"

1@ = -9999999

else
1@ += 1
end

015D: set_gamespeed 0.0

if
0@ == 0
then

if
SHOW_HINTS_FLAG == 1
then
if
0A4B:   controls_set_to_joystick
    then
    
    if
    2@ == 0
    then
    text.ShowH('HINT23C',1100,1)
    else
    text.ShowH('HNT23C2',1100,1)
    end
           
    else            
    if
    $KEY_USE == 69
        then
        text.ShowH('HINT23',1100,1)
        else
        text.ShowH('HINT23B',1100,1)
        end           
    end
else
015D: set_gamespeed 1.0
0635: AS_actor PLAYER_ACTOR aim_at_actor USHER1_TERRY -2 ms
wait 1000
break
end

if
0A4B:   controls_set_to_joystick
    then
    if    
//    0AB0:   key_pressed $KEY_USE
    00E1:   player 0 pressed_key 11
        then
        
        if
        2@ == 0
        then
        text.ClearAll()
        end
        
        2@ = 1            
        if
        00E1:   player 0 pressed_key 6
            then
            0@ = 1
            015D: set_gamespeed 1.0
            0635: AS_actor PLAYER_ACTOR aim_at_actor USHER1_TERRY -2 ms
            wait 1000
            015D: set_gamespeed 0.0
            text.ClearAll()
            end
        else
        
        if
        2@ == 1
        then
        text.ClearAll()
        end
        
        2@ = 0            
        end        
    else
    if
    00E1:   player 0 pressed_key 6
        then
        0@ = 1
        015D: set_gamespeed 1.0
        0635: AS_actor PLAYER_ACTOR aim_at_actor USHER1_TERRY -2 ms
        wait 1000
        015D: set_gamespeed 0.0
        end
    end

else

if
SHOW_HINTS_FLAG == 1
then
if
0A4B:   controls_set_to_joystick
    then
    text.ShowH('HNT23C3',10,1)  
    
    if    
//    0AB0:   key_pressed $KEY_USE
    0E3E: is_button_just_pressed 0 button 11
    then
    015D: set_gamespeed 1.0
    break
    end
         
    else 
    
    if    
    0AB0:   key_pressed $KEY_USE
    then
    015D: set_gamespeed 1.0
    break
    end
       
    if
    $KEY_USE == 69
        then
        text.ShowH('HINT23',10,1)
        else
        text.ShowH('HINT23B',10,1)
        end           
    end
else
break
end
    
end               

until false  

$END_DIALOG_INST = 1
wait 0

v$ST_DIALOG[0] = "STRY28"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 0
create_thread @DG_SYS2

repeat
wait 0
until $DIALOG_END == 1

0687: clear_actor USHER1_TERRY task

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
0E69: set_player_control_pad_movement 0 0
//0E60: set_camera_control 0 0  
$HUD_REMOVE = 1
$HUD_OFF_INST = 1
DONT_DRAW_CROSSHAIR_FLAG = 0

if
$FP_ACTIVATED == 1
then

FP_TURNED_OFF_FOR_CUTSCENE = 1

repeat
wait 0
until $FP_ACTIVATED == 0

wait 250

camera.SetPosition(990.605042 -1627.296265 8.019741,0.0,0.0,0.0)
camera.PointAt(989.973450 -1626.532837 7.884564,2)

end

repeat
wait 0
until 8E46: not is_char_using_gun USHER1_TERRY

01B9: set_actor USHER1_TERRY armed_weapon_to 0
0687: clear_actor PLAYER_ACTOR task

repeat
wait 0
until 8E46: not is_char_using_gun PLAYER_ACTOR

01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

v$ST_DIALOG[0] = "STRY29"
v$ST_DIALOG[1] = "STRY30"
v$ST_DIALOG[2] = "STRY31"
v$ST_DIALOG[3] = "STRY32"
v$ST_DIALOG[4] = "STRY33"
v$ST_DIALOG[5] = "STRY34"
v$ST_DIALOG[6] = "STRY35"
0084: $DIALOG_ACTOR[0] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[1] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[2] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[3] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[4] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[5] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[6] = USHER1_TERRY // (int)
$DIALOG_COUNT = 6
create_thread @DG_SYS

repeat
wait 0
until $DIALOG_END == 1

05D9: AS_actor PLAYER_ACTOR run_to_actor USHER1_TERRY timelimit 5000 stop_within_radius 2.0

camera.SetPosition(988.894531 -1619.763184 8.182999,0.0,0.0,0.0)
camera.PointAt(988.547668 -1620.689697 8.037482,1)

repeat
wait 0

if and
0EE4: locate_char_distance_to_char PLAYER_ACTOR char USHER1_TERRY radius 2.0
02A0:   actor PLAYER_ACTOR stopped
    then
    break
    end

until false

v$ST_DIALOG[0] = "STRY36"
v$ST_DIALOG[1] = "STRY37"
v$ST_DIALOG[2] = "STRY38"
v$ST_DIALOG[3] = "STRY39"
0084: $DIALOG_ACTOR[0] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[1] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[2] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[3] = USHER1_TERRY // (int)
$DIALOG_COUNT = 3
create_thread @DG_SYS

repeat
wait 0
until $DIALOG_END == 1

0605: actor USHER1_TERRY perform_animation "habargive" IFP "CAMERA" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1
wait 585
0605: actor PLAYER_ACTOR perform_animation "habargive" IFP "CAMERA" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1
wait 585

v$ST_DIALOG[0] = "STRY40"
v$ST_DIALOG[1] = "STRY41"
0084: $DIALOG_ACTOR[0] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[1] = USHER1_TERRY // (int)
$DIALOG_COUNT = 1
create_thread @DG_SYS

repeat
wait 0
until $DIALOG_END == 1

0615: define_AS_pack_begin 0@
07CD: AS_actor -1 walk_to 987.6691 -1617.9053 7.3406 stop_with_angle 180.6366 within_radius 1.0
05BF: AS_actor -1 look_at_actor PLAYER_ACTOR 9999999 ms
06B0: AS_actor -1 sit_down 9999999 ms
0616: define_AS_pack_end 0@
0618: assign_actor USHER1_TERRY to_AS_pack 0@
061B: remove_references_to_AS_pack 0@

wait 2000

0615: define_AS_pack_begin 0@
07CD: AS_actor -1 walk_to 989.5244 -1618.3273 7.3406 stop_with_angle 104.0 within_radius 1.0
05BF: AS_actor -1 look_at_actor USHER1_TERRY 9999999 ms
06B0: AS_actor -1 sit_down 9999999 ms
0616: define_AS_pack_end 0@         
0618: assign_actor PLAYER_ACTOR to_AS_pack 0@
061B: remove_references_to_AS_pack 0@

0936: set_camera 987.483582 -1625.393677 7.789689 position_to 988.381470 -1620.637695 7.315185 time 10000 smooth_transition 1
0920: point_camera 987.682251 -1624.419922 7.679132 transverse_to 988.559998 -1619.656494 7.241866 time 10000 smooth_transition 1
camera.SetPosition(988.381470 -1620.637695 7.315185,0.0,0.0,0.0)
camera.PointAt(988.559998 -1619.656494 7.241866,2)

v$ST_DIALOG[0] = "STRY42"
v$ST_DIALOG[1] = "STRY43"
v$ST_DIALOG[2] = "STRY44"
v$ST_DIALOG[3] = "STRY45"
v$ST_DIALOG[4] = "STRY46"
v$ST_DIALOG[5] = "STRY47"
$DIALOG_COUNT = 5
$DIALOG_NOT_SKIP = 0
create_thread @DG_SYS2

repeat
wait 0

if
actor.Animation(PLAYER_ACTOR) == "SEAT_down"
then
PLAYER_DONT_HAVE_BACKPACK = 1
end

if
actor.Animation(USHER1_TERRY) == "SEAT_down"
then
008A: CHAR_TO_DEL_BACKPACK = USHER1_TERRY // (int)
end

if and
actor.Animation(PLAYER_ACTOR) == "SEAT_idle"
actor.Animation(USHER1_TERRY) == "SEAT_idle"
$DIALOG_END == 1
    then
    break
    end

until false

PLAYER_DONT_HAVE_BACKPACK = 0
fade 0 2000
wait 2000

0936: set_camera 987.483582 -1625.393677 7.789689 position_to 988.381470 -1620.637695 7.315185 time 1 smooth_transition 1
0920: point_camera 987.682251 -1624.419922 7.679132 transverse_to 988.559998 -1619.656494 7.241866 time 1 smooth_transition 1

gosub @UMUSIC_MISSION1_OFF

$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS1\theme4.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

//////////////////////////////////////////////////////// 

camera.SetPosition(990.051453 -1618.778198 7.548173,0.0,0.0,0.0)
camera.PointAt(989.375671 -1618.044678 7.476317,2)

fade 1 2000
wait 2000

v$ST_DIALOG[0] = "STRY48"
v$ST_DIALOG[1] = "STRY49"
v$ST_DIALOG[2] = "STRY50"
v$ST_DIALOG[3] = "STRY51"
v$ST_DIALOG[4] = "STRY52"
v$ST_DIALOG[5] = "STRY53"
v$ST_DIALOG[6] = "STRY54"
v$ST_DIALOG[7] = "STRY55"
v$ST_DIALOG[8] = "STRY56"
v$ST_DIALOG[9] = "STRY57"
v$ST_DIALOG[10] = "STRY58"
v$ST_DIALOG[11] = "STRY59"
0084: $DIALOG_ACTOR[0] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[1] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[2] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[3] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[4] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[5] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[6] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[7] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[8] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[9] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[10] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[11] = USHER1_TERRY // (int)
$DIALOG_COUNT = 11
$DIALOG_NOT_SKIP = 0
$DIALOG_NOT_ANIMS_FLAG = 1
create_thread @DG_SYS

repeat
wait 0
until $DIALOG_END == 1

0687: clear_actor PLAYER_ACTOR task
camera.SetPosition(987.162964 -1620.244141 8.027019,0.0,0.0,0.0)
camera.PointAt(987.627563 -1619.411011 7.726864,1)

v$ST_DIALOG[0] = "STRY60"
0084: $DIALOG_ACTOR[0] = PLAYER_ACTOR // (int)
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 0
$DIALOG_NOT_ANIMS_FLAG = 1
create_thread @DG_SYS

repeat
wait 0
until $DIALOG_END == 1

0687: clear_actor USHER1_TERRY task
camera.SetPosition(987.329468 -1618.597534 8.043133,0.0,0.0,0.0)
camera.PointAt(988.120056 -1617.988159 7.983142,1)

v$ST_DIALOG[0] = "STRY61"
0084: $DIALOG_ACTOR[0] = USHER1_TERRY // (int)
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 0
$DIALOG_NOT_ANIMS_FLAG = 1
create_thread @DG_SYS

repeat
wait 0
until $DIALOG_END == 1

0615: define_AS_pack_begin 0@
07CD: AS_actor -1 walk_to 988.2892 -1626.9575 7.3406 stop_with_angle 0.0 within_radius 1.0
05BF: AS_actor -1 look_at_actor PLAYER_ACTOR 9999999 ms
0616: define_AS_pack_end 0@
0618: assign_actor USHER1_TERRY to_AS_pack 0@
061B: remove_references_to_AS_pack 0@

wait 2000

0615: define_AS_pack_begin 0@
07CD: AS_actor -1 walk_to 988.2818 -1625.4775 7.3406 stop_with_angle 180.0 within_radius 1.0
05BF: AS_actor -1 look_at_actor USHER1_TERRY 9999999 ms
0616: define_AS_pack_end 0@         
0618: assign_actor PLAYER_ACTOR to_AS_pack 0@
061B: remove_references_to_AS_pack 0@

camera.SetPosition(988.912354 -1618.718750 7.313989,0.0,0.0,0.0)
camera.PointAt(988.838989 -1619.715698 7.288823,1)

repeat
wait 0
until 0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 989.613 -1627.1112 7.3406 radius 3.0

repeat
wait 0
until 02A0:   actor USHER1_TERRY stopped

camera.SetPosition(990.589600 -1623.072510 7.755933,0.0,0.0,0.0)
camera.PointAt(990.016785 -1623.890015 7.696456,1)

wait 1000

v$ST_DIALOG[0] = "STRY62"
v$ST_DIALOG[1] = "STRY63"
v$ST_DIALOG[2] = "STRY64"  
0084: $DIALOG_ACTOR[0] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[1] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[2] = USHER1_TERRY // (int)
$DIALOG_COUNT = 2
$DIALOG_NOT_SKIP = 0
$DIALOG_NOT_ANIMS_FLAG = 0
create_thread @DG_SYS

repeat
wait 0
until $DIALOG_END == 1

actor.DestroyInstantly(USHER1_TERRY)
car.Destroy(USHER1_TERRY_CAR)

camera.SetPosition(988.161499 -1628.087402 7.865304,0.0,0.0,0.0)
camera.OnPed(PLAYER_ACTOR,15,2)

$SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\closing_door.mp3")  
Audiostream.SetPosition($SHIT_FUCK,7.5561, 988.2092, -1628.4659) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)
0089: 0@ = $SOUNDS_VOLUME // (float)
0@ *= 0.5
Audiostream.Volume($SHIT_FUCK) = 0@
Audiostream.PerformAction($SHIT_FUCK, PLAY)

0@ = 0

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//$END_DIALOG_INST = 1
wait 0
break
end

0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

v$ST_DIALOG[0] = "STRY65"
v$ST_DIALOG[1] = "STRY66"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 0
$DIALOG_NOT_ANIMS_FLAG = 1
create_thread @DG_SYS2

repeat
wait 0
until $DIALOG_END == 1

0615: define_AS_pack_begin 0@
05D3: AS_actor -1 goto_point 986.974 -1618.6812 7.3406 mode 4 time 10000 ms // versionA
05D3: AS_actor -1 goto_point 984.5312 -1617.9927 7.3406 mode 4 time 10000 ms // versionA
0616: define_AS_pack_end 0@
0618: assign_actor PLAYER_ACTOR to_AS_pack 0@
061B: remove_references_to_AS_pack 0@

repeat
wait 0
until 0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 984.5312 -1617.9927 7.3406 radius 1.0

fade 0 2000
wait 2000

FP_TURNED_OFF_FOR_CUTSCENE = 0

gosub @UMUSIC_MISSION1_OFF

$ACHIV_TOTAL_SHOW_OFF_FLAG = 0

$ACHIV_NUMBER = 1
FREEMODE_VOICE_START = 1
FREEMODE_VOICE_END = 2
MIKE_VOICE_CANNOT_SKIP_FLAG = 1
create_thread @VOI_SHO

repeat
wait 0
until $ACHIV_SHOW_ENDED == 1

:USHER1_SKIP_AFTERTERRY_DIALOG

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ < 6
then
0AF1: write_int 5 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
end

$TIME_LOCK_HOUR = 23
$WEATHER_LOCK_NUMBER = 8
create_thread @WTH_LCK

$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS1\theme5.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

////////////////////////////////////////////////////////

PLAYER_DONT_HAVE_BACKPACK = 1 

while not animation.Available("INT_HOUSE")
wait 0
animation.Load("INT_HOUSE")
end

0619: enable_actor PLAYER_ACTOR collision_detection 0
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 986.0 -1609.1931 7.33
0E32: set_char_coordinates_simple PLAYER_ACTOR coord 986.0 -1609.1931 7.33
actor.Angle(PLAYER_ACTOR) = 90.0 
04E4: unknown_refresh_game_renderer_at 986.0 -1609.1931
03CB: set_rendering_origin_at 986.0 -1609.1931 7.33

0605: actor PLAYER_ACTOR perform_animation "BED_Out_L" IFP "INT_HOUSE" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1
0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 0
wait 0
0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 0 

0936: set_camera 983.669128 -1613.937256 7.366623 position_to 985.200256 -1611.769287 7.323680 time 13000 smooth_transition 1
0920: point_camera 984.246399 -1613.120850 7.350431 transverse_to 985.777527 -1610.952881 7.307488 time 13000 smooth_transition 1

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"
if
0@ == 6
then

0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 1
0619: enable_actor PLAYER_ACTOR collision_detection 1

0792: disembark_instantly_actor PLAYER_ACTOR
04EF: release_animation "INT_HOUSE"

actor.PutAtNoOffset(PLAYER_ACTOR,986.7803, -1612.4851, 7.3406)
actor.Angle(PLAYER_ACTOR) = 88.7809
04EB: AS_actor PLAYER_ACTOR crouch 1

0992: set_player PLAYER_CHAR weapons_scrollable 1
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0

0936: set_camera 983.669128 -1613.937256 7.366623 position_to 985.200256 -1611.769287 7.323680 time 1 smooth_transition 1
0920: point_camera 984.246399 -1613.120850 7.350431 transverse_to 985.777527 -1610.952881 7.307488 time 1 smooth_transition 1

jump to @JUMP_STRAIGHT_TO_PORT_PART
end

fade 1 3000

$SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\knock.mp3")  
Audiostream.SetPosition($SHIT_FUCK,7.5561, 988.2092, -1628.4659) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)
0089: 0@ = $SOUNDS_VOLUME // (float)
0@ *= 0.5
Audiostream.Volume($SHIT_FUCK) = 0@
Audiostream.PerformAction($SHIT_FUCK, PLAY)

0@ = 0

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//$END_DIALOG_INST = 1
wait 0
break
end

0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

v$ST_DIALOG[0] = "STRY67"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 0
$DIALOG_NOT_ANIMS_FLAG = 1
create_thread @DG_SYS2

repeat
wait 0
until $DIALOG_END == 1

$SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\knock.mp3")  
Audiostream.SetPosition($SHIT_FUCK,7.5561, 988.2092, -1628.4659) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)
0089: 0@ = $SOUNDS_VOLUME // (float)
0@ *= 0.5
Audiostream.Volume($SHIT_FUCK) = 0@
Audiostream.PerformAction($SHIT_FUCK, PLAY)

0@ = 0

repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
//$END_DIALOG_INST = 1
wait 0
break
end

0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

fade 0 250
wait 250

0936: set_camera 983.669128 -1613.937256 7.366623 position_to 985.200256 -1611.769287 7.323680 time 1 smooth_transition 1
0920: point_camera 984.246399 -1613.120850 7.350431 transverse_to 985.777527 -1610.952881 7.307488 time 1 smooth_transition 1

0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 1
0619: enable_actor PLAYER_ACTOR collision_detection 1

0792: disembark_instantly_actor PLAYER_ACTOR
04EF: release_animation "INT_HOUSE"

actor.PutAtNoOffset(PLAYER_ACTOR,986.7803, -1612.4851, 7.3406)
actor.Angle(PLAYER_ACTOR) = 88.7809
04EB: AS_actor PLAYER_ACTOR crouch 1

0992: set_player PLAYER_CHAR weapons_scrollable 1
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0

04B8: get_weapon_data_from_actor PLAYER_ACTOR slot 3 weapon 1@ ammo 2@ model 3@
if
2@ < 1
then

0781: get_weapon_with_ID 76 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end
 
Actor.GiveWeaponAndAmmo(PLAYER_ACTOR, 76, 1)
01B9: set_actor PLAYER_ACTOR armed_weapon_to 76
else
01B9: set_actor PLAYER_ACTOR armed_weapon_to 1@
end    

camera.Restore_WithJumpCut()
cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0
v$OBJECTIVE = "STRB28"

gosub @USHER1_LATINOS_ACTOR_CREATE

0E69: set_player_control_pad_movement 0 1
player.CanMove(PLAYER_CHAR,true)
fade 1 1000
$HUD_REMOVE = 0
wait 1000

0350: set_actor USHER1_LATINOS maintain_position_when_attacked 0
0816: set_actor USHER1_LATINOS dont_chase_victim 0
04EB: AS_actor USHER1_LATINOS crouch 0
0634: AS_actor USHER1_LATINOS attack_using_weapon_actor PLAYER_ACTOR flags 4 perform_actions_after_time 0 chance_of_action 100

player.CanMove(PLAYER_CHAR) = true 

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if or
0364:   actor USHER1_LATINOS spotted_actor PLAYER_ACTOR
0364:   actor PLAYER_ACTOR spotted_actor USHER1_LATINOS
    then
    break
    end

until false

05E2: AS_actor USHER1_LATINOS kill_actor PLAYER_ACTOR

v$OBJECTIVE = "STRB29"
MISSION_MARKER = marker.CreateAboveActor(USHER1_LATINOS)
marker.SetIconSize(MISSION_MARKER,2)

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

until actor.Dead(USHER1_LATINOS)

v$OBJECTIVE = "DUMMY"
marker.Disable(MISSION_MARKER)

gosub @UMUSIC_MISSION1_OFF

v$ST_DIALOG[0] = "STRY68"
v$ST_DIALOG[1] = "STRY69"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
$DIALOG_NOT_ANIMS_FLAG = 1
create_thread @DG_SYS2

32@ = 0

repeat
wait 0

if and
$DIALOG_NOT_SKIP == 1
32@ > 2000
    then
    $DIALOG_NOT_SKIP = 0
    end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

until $DIALOG_END == 1

$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS1\theme6.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

//////////////////////////////////////////////////////// 

v$OBJECTIVE = "STRB30"

0889: store_actor USHER1_LATINOS center_of_body_position_to 0@ 1@ 2@
018A: MISSION_CHECKPOINT = create_checkpoint_at 0@ 1@ 2@

///////////////////////////////////////////////////////////////////////////////////////

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if and
00FE:   actor PLAYER_ACTOR sphere 0 in_sphere 0@ 1@ 2@ radius 1.5 1.5 2.0
02A0:   actor PLAYER_ACTOR stopped
044B:   actor PLAYER_ACTOR on_foot
    then
    break
    end
 
until false

///////////////////////////////////////////////////////////////////////////////////////

v$ST_DIALOG[0] = "STRY70"
v$ST_DIALOG[1] = "STRY71"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

v$OBJECTIVE = "DUMMY"
marker.Disable(MISSION_CHECKPOINT)

0470: 9@ = actor PLAYER_ACTOR current_weapon
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 1
0992: set_player PLAYER_CHAR weapons_scrollable 0 

while not animation.Available("BOMBER")
wait 0
animation.Load("BOMBER")
end

32@ = 0

03CF: load_wav 20802 as 4 

while 83D0: not  wav 4 loaded 
wait 0
03CF: load_wav 20802 as 4 
end
 
0949: link_wav 4 to_actor PLAYER_ACTOR
03D1: play_wav 4

0605: actor PLAYER_ACTOR perform_animation "BOM_PLANT" IFP "BOMBER" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1 

while 83D2:   wav 4 ended 
wait 0
end

040D: unload_wav 4 
04EF: release_animation "BOMBER"

0992: set_player PLAYER_CHAR weapons_scrollable 1
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0

01B9: set_actor PLAYER_ACTOR armed_weapon_to 9@

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

until $DIALOG_END == 1

///////////////////////////////////////////////////////////////////////////////////////

player.CanMove(PLAYER_CHAR,false)

fade 0 500
$HUD_REMOVE = 1
wait 500

cinema.Widescreen(1)
0A48: enable_menu_access_in_widescreen_mode 0
    
////////////////////////////////////////////////////////        

0A0E: disable_text_with_style 1
    
0391: release_textures
0390: load_txd_dictionary 'usher1' 
wait 1
038F: load_texture "usher" as 1 // Load dictionary with 0390 first 
wait 1    
    
32@ = 0
$READING_NOTE_FLAG = 1
$SPEED_08_FLAG = 1

random_int 16@ 0 to 5 

if
16@ == 0
then
14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll1.mp3") 
end
    
if
16@ == 1
then
14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll2.mp3") 
end
    
if
16@ == 2
then
14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll3.mp3") 
end
    
if
16@ == 3
then
14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll4.mp3") 
end
    
if
16@ == 4
then
14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll5.mp3") 
end
       
Audiostream.PerformAction(14@, PLAY)
Audiostream.Volume(14@) = $SOUNDS_VOLUME
    
 repeat 
wait 0
03F0: enable_text_draw 1
038D: draw_texture 1 position 320.0 224.5 size 640.0 449.0 RGBA 255 255 255 255
03E3: set_texture_to_be_drawn_antialiased 1 
 until 0E3E: is_button_just_pressed 0 17

audiostream.PerformAction(14@,STOP)
audiostream.Release(14@)     
     
$SPEED_08_FLAG = 0
015D: set_gamespeed 1.0      
     
wait 1
03F0: enable_text_draw 0
wait 1
0391: release_textures 
    
0A0E: disable_text_with_style 0
    
//////////////////////////////////////////////////////// 

$READING_NOTE_FLAG = 0    
$SPEED_08_FLAG = 0

cinema.Widescreen(0)
0A48: enable_menu_access_in_widescreen_mode 1   
    
015D: set_gamespeed 1.0 
    
player.CanMove(PLAYER_CHAR) = true
    
fade 1 500
$HUD_REMOVE = 0
wait 500

v$ST_DIALOG[0] = "STRY72"
v$ST_DIALOG[1] = "STRY73"
v$ST_DIALOG[2] = "STRY74"
v$ST_DIALOG[3] = "STRY75"
v$ST_DIALOG[4] = "STRY76"
v$ST_DIALOG[5] = "STRY77"
$DIALOG_COUNT = 5
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2
         
wait 1000

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

until $DIALOG_END == 1

fade 0 2000
$HUD_REMOVE = 1
wait 2000
player.CanMove(PLAYER_CHAR) = false

$PREPARING_TEXT_OFF = 0
PLAYER_NO_ITEMS_FLAG = 0
create_thread @PED_BKP PLAYER_ACTOR 371

if
8491: not  actor PLAYER_ACTOR has_weapon 151
then

0781: get_weapon_with_ID 151 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,151,1)
01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

end

:JUMP_STRAIGHT_TO_PORT_PART

CAMP_DONT_SAY_HELLO_FLAG = 1

//////////////////////////////////////////////////////// 
    
:CAR_CREATE_USHER1_NIKOLS_CAR
if
model.Available(15591)
then

0674: set_car_model 15591 numberplate "4CT_0_PWR"    
USHER1_NIKOLS_CAR = Car.Create(15591, 2134.4553, -2297.2942, 13.1311)
car.Angle(USHER1_NIKOLS_CAR) = 134.2762
car.SetImmunities(USHER1_NIKOLS_CAR,1,1,1,1,1)
car.LockInCurrentPosition(USHER1_NIKOLS_CAR,true)
car.DoorStatus(USHER1_NIKOLS_CAR,2)
    
if
model.Available(15591)
then
//model.Destroy(15591)
end
    
else 
model.Load(15591)
mload
wait 0
jump to @CAR_CREATE_USHER1_NIKOLS_CAR
end    
    
/////////////////////////////////////////
    
0A97: 11@ = car USHER1_NIKOLS_CAR struct 
11@ += 9 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
0A97: 11@ = car USHER1_NIKOLS_CAR struct 
11@ += 4 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 1 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
24@ = 0.0 
0A97: 22@ = car USHER1_NIKOLS_CAR struct 
0A8E: 23@ = 22@ + 5 // int 
0A8C: write_memory 23@ size 4 value 24@ virtual_protect 0 
08C3: clear 12@ bit 1 
08C3: clear 12@ bit 2 
0A97: 11@ = car USHER1_NIKOLS_CAR struct 
11@ += 18 
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0 
08BD: set 12@ bit 2 
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0 
08C3: clear 12@ bit 2

0229: set_car USHER1_NIKOLS_CAR primary_color_to 3 secondary_color_to 3

$PREPARING_TEXT_OFF = 0
PLAYER_NO_ITEMS_FLAG = 0
create_thread @PED_BKP PLAYER_ACTOR 371

if
8491: not  actor PLAYER_ACTOR has_weapon 151
then

0781: get_weapon_with_ID 151 model_to 0@

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

actor.GiveWeaponAndAmmo(PLAYER_ACTOR,151,1)
01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

end

0AF1: write_int 6 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT"

gosub @UMUSIC_MISSION1_OFF

select_interior 0
0860: link_actor PLAYER_ACTOR to_interior 0
04FA: reset_sky_colors_with_fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,986.8784, -1624.448, 14.9297)
actor.Angle(PLAYER_ACTOR) = 90.0
camera.Restore_WithJumpCut()
create_thread @REFR_3D

32@ = 0

while 32@ < 1000
wait 0
$HUD_REMOVE = 1
end

//wait 1000

$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS1\theme7.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

//////////////////////////////////////////////////////// 
    
car.PutAt(USHER1_VICTORIA,974.8536, -1623.6497, 13.1276)
car.Angle(USHER1_VICTORIA) = 90.7155
036A: put_actor PLAYER_ACTOR in_car USHER1_VICTORIA
0E69: set_player_control_pad_movement 0 0

if
0AE3: 0@ = random_object_near_point 924.2084 -1623.735 13.5469 in_radius 5.0 find_next 0 //IF and SET 
then
0723: break_object 0@ intensity 1
end

$SHIT_FUCK = Audiostream.Load("audio\sounds\music\usher_music\MISS1\trunk_and_door.mp3")  
Audiostream.Loop($SHIT_FUCK, 0)
Audiostream.Volume($SHIT_FUCK) = $SOUNDS_VOLUME
Audiostream.PerformAction($SHIT_FUCK, PLAY)
0@ = 0

repeat
wait 0
$HUD_REMOVE = 1
0AB9: get_mp3 $SHIT_FUCK state_to 0@
until 0@ == -1

audiostream.PerformAction($SHIT_FUCK,STOP)
audiostream.Release($SHIT_FUCK)

v$ST_DIALOG[0] = "STRY78"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

repeat
wait 0
$HUD_REMOVE = 1
0924: enable_screen_darkness 1 with_value 255
fade 1 1

if
0E3E: is_button_just_pressed 0 button 17
then
//actor.PutAtNoOffset(PLAYER_ACTOR,982.8779, -1609.5027, 7.3406)
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

0924: enable_screen_darkness 1 with_value 255
fade 0 0
wait 500
0924: enable_screen_darkness 0 with_value -1

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0  

/////////////////////////////////////////

$SAVESTATUS = 0
$HUD_REMOVE = 0
car.SetSpeedInstantly(USHER1_VICTORIA,20.0)
0E69: set_player_control_pad_movement 0 1
player.CanMove(PLAYER_CHAR) = true
fade 1 2000

$INT_ZMB_NOT = 0

v$OBJECTIVE = "STRB31"
018A: MISSION_CHECKPOINT = create_checkpoint_at $CAMP_X[6] $CAMP_Y[6] $CAMP_Z[6]
USHER_STORY_CREATE_NICOLS_FLAG = 1

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
if or
0@ >= 4
$CHEATS_ON == 1
then                         
0950: set_trip_skip 2220.4563 -2020.5342 12.9301 angle 224.8604
end

0@ = 0

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

///////////////////////////////////////////////////

if and
056E:   car SUPPLY_QUEST_TRUCK defined
not USHER1_VICTORIA_GOT_BACK_FLAG == 1
then

if
not car.Wrecked(SUPPLY_QUEST_TRUCK)
jf @USHER1_FAILED_CAR_WRECKED

if
not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
    then
    marker.Disable(MISSION_CHECKPOINT)         
    gosub @USHER1_GET_BACK_IN_CAR
    v$OBJECTIVE = "STRB31"  
    018A: MISSION_CHECKPOINT = create_checkpoint_at $CAMP_X[6] $CAMP_Y[6] $CAMP_Z[6]         
    end
else
jump to @USHER1_FAILED_CAR_WRECKED
end

///////////////////////////////////////////////////

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
wait 0
break
end

if and
0@ == 0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos $CAMP_X[6] $CAMP_Y[6] $CAMP_Z[6] radius 5.0
    then
    0@ = 1
    v$ST_DIALOG[0] = "STRY5"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2
    end

until 00EC:   actor PLAYER_ACTOR sphere 0 near_point $CAMP_X[6] $CAMP_Y[6] radius 180.0 180.0

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
if
0@ < 4
then
0AF1: write_int 4 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
end
0951: disable_trip_skip 

BOLVANS_DONT_DO_ACTIVITES = 1
marker.Disable(MISSION_CHECKPOINT)
v$OBJECTIVE = "DUMMY"

fade 0 1000
$HUD_REMOVE = 1
wait 1000

$SAVESTATUS = 1
ZOMBIES_NOTSPAWN = 1 

player.CanMove(PLAYER_CHAR) = false  

0362: remove_actor PLAYER_ACTOR from_car_and_place_at 2236.969482 -2212.250244 13.546875
actor.Angle(PLAYER_ACTOR) = 136.528427
car.PutAt(USHER1_VICTORIA,2235.506104, -2205.487793, 13.277905)
car.Angle(USHER1_VICTORIA) = 225.195068
01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

if
$FP_ACTIVATED == 1
then
repeat
wait 0
until $FP_ACTIVATED == 0
end

camera.SetPosition(2233.222168 -2219.139404 14.127354,0.0,0.0,0.0)
camera.PointAt(2233.360352 -2218.150879 14.064605,2)

repeat
wait 0
until 056D:   actor USHER1_OXRANNIK defined

actor.PutAtNoOffset(USHER1_OXRANNIK,2232.801270, -2217.506104, 13.546875)
actor.Angle(USHER1_OXRANNIK) = 316.943726

repeat
wait 0
until 056D:   actor USHER1_NIKOLS defined

0084: CHAR_TO_DEL_BACKPACK = USHER1_NIKOLS // (int)

actor.PutAtNoOffset(USHER1_NIKOLS,2123.278564, -2275.642090, 20.671875)
actor.Angle(USHER1_NIKOLS) = 314.394836   

wait 1000
$SAVESTATUS = 0

06A9: AS_actor USHER1_NIKOLS look_at_point 2125.909668 -2273.878418 21.510433 999999 ms

$SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\a_football.ogg")    
Audiostream.SetPosition($SHIT_FUCK,20.6719, 2126.0645, -2273.7864) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)     
Audiostream.Volume($SHIT_FUCK) = 0.0
Audiostream.PerformAction($SHIT_FUCK, PLAY)

0635: AS_actor USHER1_OXRANNIK aim_at_actor PLAYER_ACTOR 9999999 ms
05C4: AS_actor PLAYER_ACTOR hands_up 9999999 ms 

create_thread @3D_REFR
fade 1 1000

v$ST_DIALOG[0] = "STRY79"
v$ST_DIALOG[1] = "STRY80"
v$ST_DIALOG[2] = "STRY81"
v$ST_DIALOG[3] = "STRY82"
$DIALOG_COUNT = 3
$DIALOG_NOT_SKIP = 0
create_thread @DG_SYS2

repeat
wait 0
until $DIALOG_END == 1

gosub @USHER1_TERRY_ACTOR_CREATE2

0615: define_AS_pack_begin 0@
05D3: AS_actor -1 goto_point 2236.676514 -2220.554688 13.546875 mode 7 time 10000 ms // versionA
0616: define_AS_pack_end 0@
0618: assign_actor USHER1_TERRY to_AS_pack 0@
061B: remove_references_to_AS_pack 0@  

repeat
wait 0
until 0EEA: locate_char_distance_to_coordinates USHER1_TERRY pos 2236.676514 -2220.554688 13.546875 radius 1.0

0687: clear_actor USHER1_OXRANNIK task
0A1D: AS_actor USHER1_TERRY rotate_to_and_look_at_actor USHER1_OXRANNIK
0A1D: AS_actor USHER1_OXRANNIK rotate_to_and_look_at_actor USHER1_TERRY 

camera.SetPosition(2238.217773 -2219.844482 14.314940,0.0,0.0,0.0)
camera.PointAt(2237.235596 -2220.004639 14.217644,1)

v$ST_DIALOG[0] = "STRY83"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 0
create_thread @DG_SYS2

repeat
wait 0
until $DIALOG_END == 1

v$ST_DIALOG[0] = "STRY84"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 0
create_thread @DG_SYS2 

0687: clear_actor PLAYER_ACTOR task
0A1D: AS_actor USHER1_TERRY rotate_to_and_look_at_actor PLAYER_ACTOR
0A1D: AS_actor PLAYER_ACTOR rotate_to_and_look_at_actor USHER1_TERRY
camera.SetPosition(2238.165771 -2211.482178 14.296892,0.0,0.0,0.0)
camera.PointAt(2237.773926 -2212.397217 14.201296,1)

repeat
wait 0
until $DIALOG_END == 1

v$ST_DIALOG[0] = "STRY85"
v$ST_DIALOG[1] = "STRY86"
v$ST_DIALOG[2] = "STRY87"
$DIALOG_COUNT = 2
$DIALOG_NOT_SKIP = 0
create_thread @DG_SYS2

0@ = 0

repeat
wait 0

if and
0@ == 0
$DIALOG_CURRENT_INT == 2
    then
    0A1D: AS_actor USHER1_TERRY rotate_to_and_look_at_actor USHER1_OXRANNIK
    0@ = 1
    end

until $DIALOG_END == 1

0781: get_weapon_with_ID 40 model_to 0@
while not model.Available(0@)
wait 0
model.Load(0@)
mload
end    
actor.GiveWeaponAndAmmo(USHER1_OXRANNIK,40,9999)
01B9: set_actor USHER1_OXRANNIK armed_weapon_to 40

0615: define_AS_pack_begin 0@
05D3: AS_actor -1 goto_point 2231.1831 -2220.7048 13.5469 mode 7 time 3000 ms // versionA
05D4: AS_actor -1 rotate_angle 306.2393
0616: define_AS_pack_end 0@
0618: assign_actor USHER1_TERRY to_AS_pack 0@
061B: remove_references_to_AS_pack 0@

0605: actor USHER1_OXRANNIK perform_animation "bomber" IFP "PED" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1
wait 600
CURRENT_USHER_TUTORIAL_NUM = -1

repeat
wait 0
//0AD1: show_formatted_text_highpriority "CURRENT_USHER_TUTORIAL_NUM: is %d, need CURRENT_USHER_TUTORIAL_NUM: -2" time 2000 CURRENT_USHER_TUTORIAL_NUM
until CURRENT_USHER_TUTORIAL_NUM == -2

camera.SetPosition(2235.060059 -2224.376953 17.508619,0.0,0.0,0.0)
camera.PointAt(2235.040771 -2223.422607 17.210812,1)

05CB: AS_actor PLAYER_ACTOR enter_car USHER1_VICTORIA as_driver 10000 ms
0631: put_actor USHER1_TERRY in_group PLAYER_GROUP

v$ST_DIALOG[0] = "STRY88"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 0
create_thread @DG_SYS2

repeat
wait 0
until $DIALOG_END == 1 

05CA: AS_actor USHER1_TERRY enter_car USHER1_VICTORIA passenger_seat 0 time 10000

repeat
wait 0

if and
actor.InCar(USHER1_TERRY,USHER1_VICTORIA)
actor.InCar(PLAYER_ACTOR,USHER1_VICTORIA)
    then
    break
    end

until false

fade 0 500
wait 500

cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0
player.CanMove(PLAYER_CHAR,true)
camera.Restore_WithJumpCut()
BOLVANS_DONT_DO_ACTIVITES = 0

fade 1 1000
$HUD_REMOVE = 0
wait 1000

v$ST_DIALOG[0] = "STRY89"
v$ST_DIALOG[1] = "STRY90"
v$ST_DIALOG[2] = "STRY91"
v$ST_DIALOG[3] = "STRY92"
v$ST_DIALOG[4] = "STRY93"
v$ST_DIALOG[5] = "STRY94"
v$ST_DIALOG[6] = "STRY95"
v$ST_DIALOG[7] = "STRY96"
$DIALOG_COUNT = 7
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

v$OBJECTIVE = "STRB32"
018A: MISSION_CHECKPOINT = create_checkpoint_at 2174.415527 -2265.320313 13.308066
03BC: MISSION_SPHERE = create_sphere_at 2174.415527 -2265.320313 13.308066 radius 2.0

0@ = 0

repeat
wait 0

///////////////////////////////////////////////////

if and
056E:   car SUPPLY_QUEST_TRUCK defined
not USHER1_VICTORIA_GOT_BACK_FLAG == 1
then

if
not car.Wrecked(SUPPLY_QUEST_TRUCK)
jf @USHER1_FAILED_CAR_WRECKED
if 
not actor.Dead(USHER1_TERRY) 
jf @USHER1_FAILED_TERRY_DEAD  

if
not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
    then
    marker.Disable(MISSION_CHECKPOINT)         
    gosub @USHER1_GET_BACK_IN_CAR
    v$OBJECTIVE = "STRB32"  
    018A: MISSION_CHECKPOINT = create_checkpoint_at 2174.415527 -2265.320313 13.308066        
    end
else
jump to @USHER1_FAILED_CAR_WRECKED
end

///////////////////////////////////////////////////

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if 
not actor.Dead(USHER1_TERRY) 
jf @USHER1_FAILED_TERRY_DEAD   

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
actor.PutAtNoOffset(PLAYER_ACTOR,2174.415527 -2265.320313 13.308066)
$END_DIALOG_INST = 1
wait 0
break
end    

until 00EC:   actor PLAYER_ACTOR sphere 0 near_point 2174.415527 -2265.320313 radius 1.0 1.0 

0221: set_player PLAYER_CHAR apply_brakes_to_car 1
marker.Disable(MISSION_CHECKPOINT)
03BD: destroy_sphere MISSION_SPHERE
player.CanMove(PLAYER_CHAR) = false
v$OBJECTIVE = "DUMMY"

$DIALOG_PAUSE = 1
wait 1000
0221: set_player PLAYER_CHAR apply_brakes_to_car 0
v$OBJECTIVE = "STRB41"
02D4: car USHER1_VICTORIA turn_off_engine
create_thread @C_MENU 1
008B: USHER1_VICTORIA_B = USHER1_VICTORIA // (int)
$SUPPLY_QUEST_TRUCK = -1
car.RemoveReferences(USHER1_VICTORIA)
player.CanMove(PLAYER_CHAR) = true

repeat     
wait 0   
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA_B)
jf @USHER1_FAILED_CAR_WRECKED
if 
not actor.Dead(USHER1_TERRY) 
jf @USHER1_FAILED_TERRY_DEAD
        
if and
8A2A: not  text_box 'GAME629' displayed
SHOW_HINTS_FLAG == 1
then
if
0A4B:   controls_set_to_joystick
    then
    text.ShowH('HINT33B',10,1)       
    else        
    text.ShowH('HINT33',10,1)         
    end      
end                       

if or
003C:   $USED_CAR[0] == USHER1_VICTORIA_B // (int)
003C:   $USED_CAR[1] == USHER1_VICTORIA_B // (int)
003C:   $USED_CAR[2] == USHER1_VICTORIA_B // (int)
003C:   $USED_CAR[3] == USHER1_VICTORIA_B // (int)
003C:   $USED_CAR[4] == USHER1_VICTORIA_B // (int)
    then
    text.ClearAll()
    break
    end
 
until false

$DIALOG_PAUSE = 0
v$OBJECTIVE = "STRB33"
068B: set_car USHER1_VICTORIA_B all_disembark
MISSION_MARKER = marker.CreateAboveActor(USHER1_NIKOLS)
07E0: set_marker MISSION_MARKER type_to 1

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA_B)
jf @USHER1_FAILED_CAR_WRECKED
if 
not actor.Dead(USHER1_TERRY) 
jf @USHER1_FAILED_TERRY_DEAD   

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
actor.PutAtNoOffset(PLAYER_ACTOR,2129.2288, -2278.8098, 20.6643)
$END_DIALOG_INST = 1
wait 0
break
end

if
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 2129.2288 -2278.8098 20.6643 radius 30.0
then
Audiostream.Volume($SHIT_FUCK) = $SOUNDS_VOLUME
end

until 00A4:   actor PLAYER_ACTOR sphere 0 in_cube_cornerA 2121.8728 -2267.6924 20.2734 cornerB 2133.1223 -2289.1956 24.6259

$END_DIALOG_INST = 1
wait 0

marker.Disable(MISSION_MARKER)
//0A96: 0@ = actor PLAYER_ACTOR struct
//0AA5: call 0x043F1F0 num_params 1 pop 0 0@ //CEntryExit::WarpGangWithPlayer
if
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 2132.6426 -2278.4111 20.6719 radius 5.0
then
actor.PutAtNoOffset(USHER1_TERRY,2135.0042, -2275.7876, 20.6719)
end

if
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 2118.8689 -2274.906 20.6719 radius 5.0
then
actor.PutAtNoOffset(USHER1_TERRY,2117.3757, -2276.3782, 20.676)
end
                              
Audiostream.PerformAction($SHIT_FUCK, STOP)
Audiostream.Release($SHIT_FUCK)
$SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\tv_off.mp3")    
Audiostream.SetPosition($SHIT_FUCK,20.6719, 2126.0645, -2273.7864) //ZXY
Audiostream.Loop($SHIT_FUCK, 0)     
Audiostream.Volume($SHIT_FUCK) = $SOUNDS_VOLUME
Audiostream.PerformAction($SHIT_FUCK, PLAY)

v$OBJECTIVE = "DUMMY"

gosub @UMUSIC_MISSION1_OFF

$MUSIC_MISSION = Audiostream.Load("audio\sounds\music\usher_music\MISS1\theme8.wav")
Audiostream.PerformAction($MUSIC_MISSION, PLAY)
Audiostream.Loop($MUSIC_MISSION, 1)
Audiostream.Volume($MUSIC_MISSION) = 0.0

/////////////////////Плавное нарастание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int) 
0086: $MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = $MUSIC_VOLUME // (float) 

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 1000
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 1  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1 

//////////////////////////////////////////////////////// 

v$ST_DIALOG[0] = "STRY97"
v$ST_DIALOG[1] = "STRY98"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

0A1D: AS_actor USHER1_NIKOLS rotate_to_and_look_at_actor PLAYER_ACTOR

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA_B)
jf @USHER1_FAILED_CAR_WRECKED

if
0E45: frame_mod 30
then
0A1D: AS_actor USHER1_NIKOLS rotate_to_and_look_at_actor PLAYER_ACTOR
end

until $DIALOG_END == 1

Audiostream.Release($SHIT_FUCK)

06C9: remove_actor USHER1_TERRY from_group

player.CanMove(PLAYER_CHAR,false)
fade 0 1000
$HUD_REMOVE = 1
wait 1000

01B9: set_actor USHER1_NIKOLS armed_weapon_to 0
01B9: set_actor PLAYER_ACTOR armed_weapon_to 0

actor.PutAtNoOffset(USHER1_TERRY,2134.382568, -2277.497803, 20.671881)
actor.Angle(USHER1_TERRY) = 123.3966

actor.PutAtNoOffset(PLAYER_ACTOR,2124.6914, -2276.0647, 20.6719)
actor.Angle(PLAYER_ACTOR) = 70.4935

cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1

if
$FP_ACTIVATED == 1
then
repeat
wait 0
until $FP_ACTIVATED == 0
end

camera.SetPosition(2125.195313 -2277.031250 21.355503,0.0,0.0,0.0)
camera.PointAt(2124.511719 -2276.310791 21.239964,2)

0A1D: AS_actor USHER1_NIKOLS rotate_to_and_look_at_actor PLAYER_ACTOR
0A1D: AS_actor PLAYER_ACTOR rotate_to_and_look_at_actor USHER1_NIKOLS

wait 1000

fade 1 1000
wait 1000

v$ST_DIALOG[0] = "STRY99"
v$ST_DIALOG[1] = "STRY100"
v$ST_DIALOG[2] = "STRY101"
v$ST_DIALOG[3] = "STRY102"
v$ST_DIALOG[4] = "STRY103"
v$ST_DIALOG[5] = "STRY104"
v$ST_DIALOG[6] = "STRY105"
v$ST_DIALOG[7] = "STRY106"
v$ST_DIALOG[8] = "STRY107"
v$ST_DIALOG[9] = "STRY108"
v$ST_DIALOG[10] = "STRY109"
v$ST_DIALOG[11] = "STRY110"
v$ST_DIALOG[12] = "STRY111"
v$ST_DIALOG[13] = "STR111"
v$ST_DIALOG[14] = "STR112"
v$ST_DIALOG[15] = "STRY112"
v$ST_DIALOG[16] = "STRY113"
v$ST_DIALOG[17] = "STRY114"
v$ST_DIALOG[18] = "STRY115"
0084: $DIALOG_ACTOR[0] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[1] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[2] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[3] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[4] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[5] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[6] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[7] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[8] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[9] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[10] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[11] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[12] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[13] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[14] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[15] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[16] = USHER1_NIKOLS // (int)
0084: $DIALOG_ACTOR[17] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[18] = USHER1_NIKOLS // (int)
$DIALOG_COUNT = 18
$DIALOG_NOT_ANIMS_FLAG = 0
create_thread @DG_SYS

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA_B)
jf @USHER1_FAILED_CAR_WRECKED

until $DIALOG_END == 1

fade 0 1000
$HUD_REMOVE = 1
wait 1000

actor.PutAtNoOffset(PLAYER_ACTOR,2133.1814, -2277.8745, 20.6719)
actor.Angle(PLAYER_ACTOR) = 315.165
camera.Restore_WithJumpCut()
cinema.Widescreen(0)
BLACK_POLOSKI_ON = 0

0631: put_actor USHER1_TERRY in_group PLAYER_GROUP
wait 1000

player.CanMove(PLAYER_CHAR,true)
fade 1 1000
$HUD_REMOVE = 0
wait 1000

v$OBJECTIVE = "STRB34"
018A: MISSION_CHECKPOINT = create_checkpoint_at 2231.562012 -2284.314697 14.375132
03BC: MISSION_SPHERE = create_sphere_at 2231.562012 -2284.314697 14.375132 radius 2.0

0@ = 0

v$ST_DIALOG[0] = "STRY116"
v$ST_DIALOG[1] = "STRY117"
v$ST_DIALOG[2] = "STRY118"
v$ST_DIALOG[3] = "STRY119"
v$ST_DIALOG[4] = "STRY120"
v$ST_DIALOG[5] = "STRY121"
v$ST_DIALOG[6] = "STRY122"
v$ST_DIALOG[7] = "STRY123"
v$ST_DIALOG[8] = "STRY124"
$DIALOG_COUNT = 8
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0

if
80F2: not  actor USHER1_TERRY near_actor PLAYER_ACTOR radius 15.0 15.0 0  
    then 
       
    marker.Disable(MISSION_CHECKPOINT)
    $DIALOG_PAUSE = 1
    
    MISSION_MARKER = marker.CreateAboveActor(USHER1_TERRY)
    07E0: set_marker MISSION_MARKER type_to 1
    
    v$OBJECTIVE = "STRB40"
    
    while 80F2: not  actor USHER1_TERRY near_actor PLAYER_ACTOR radius 15.0 15.0 0  
    wait 0  
    
    if
    not actor.Dead(PLAYER_ACTOR)
    jf @USHER1_FAILED_PLAYER_DIED
    if and
    $CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
    not BASE_TEAMMATE_AGRED == 1
    jf @USHER1_FAILED_AGRO
    if
    803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
    jf @USHER1_FAILED_LDEAD  
        
    if 
    not actor.Dead(USHER1_TERRY) 
    jf @USHER1_FAILED_TERRY_DEAD      
        
    end
    
    marker.Disable(MISSION_MARKER) 
                 
    v$OBJECTIVE = "STRB34"
    018A: MISSION_CHECKPOINT = create_checkpoint_at 2231.562012 -2284.314697 14.375132     
    $DIALOG_PAUSE = 0 
       
    end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA_B)
jf @USHER1_FAILED_CAR_WRECKED
if 
not actor.Dead(USHER1_TERRY) 
jf @USHER1_FAILED_TERRY_DEAD 

if and
0E3E: is_button_just_pressed 0 button 17
$CHEATS_ON == 1
then
actor.PutAtNoOffset(PLAYER_ACTOR,2231.562012 -2284.314697 14.375132)
$END_DIALOG_INST = 1
wait 0
break
end

if and
00EC:   actor PLAYER_ACTOR sphere 0 near_point 2231.562012 -2284.314697 radius 1.0 1.0
00EC:   actor USHER1_TERRY sphere 0 near_point 2231.562012 -2284.314697 radius 3.0 3.0
    then
    break
    end

until false

$END_DIALOG_INST = 1
wait 0

marker.Disable(MISSION_CHECKPOINT)
03BD: destroy_sphere MISSION_SPHERE
player.CanMove(PLAYER_CHAR,false) 

06C9: remove_actor USHER1_TERRY from_group
0639: AS_actor PLAYER_ACTOR rotate_to_actor USHER1_TERRY
0639: AS_actor USHER1_TERRY rotate_to_actor PLAYER_ACTOR

wait 1000

camera.Restore_WithJumpCut()

v$ST_DIALOG[0] = "STRY125"
v$ST_DIALOG[1] = "STRY126"
v$ST_DIALOG[2] = "STRY127"
$DIALOG_COUNT = 2
$DIALOG_NOT_SKIP = 0
0084: $DIALOG_ACTOR[0] = USHER1_TERRY // (int)
0084: $DIALOG_ACTOR[1] = PLAYER_ACTOR // (int)
0084: $DIALOG_ACTOR[2] = USHER1_TERRY // (int)
$DIALOG_COUNT = 2
create_thread @DG_SYS

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA_B)
jf @USHER1_FAILED_CAR_WRECKED
if 
not actor.Dead(USHER1_TERRY) 
jf @USHER1_FAILED_TERRY_DEAD 

until $DIALOG_END == 1

fade 0 1000
$HUD_REMOVE = 1
wait 1000

actor.DestroyInstantly(USHER1_TERRY)
wait 1000

player.CanMove(PLAYER_CHAR,true)
fade 1 1000
$HUD_REMOVE = 0
wait 1000

v$ST_DIALOG[0] = "STRY128"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA_B)
jf @USHER1_FAILED_CAR_WRECKED

until $DIALOG_END == 1 

player.CanMove(PLAYER_CHAR,false)

USHER1_SAVE_PICKUP = pickup.Create(#PICKUPSAVE,15,$CAMP_SAVE_X[6], $CAMP_SAVE_Y[6], $CAMP_SAVE_Z[6])
USHER1_SAVE_PICKUP_MARKER = marker.CreateIconWithoutSphere(35,$CAMP_SAVE_X[6], $CAMP_SAVE_Y[6], $CAMP_SAVE_Z[6])

if
SHOW_HINTS_FLAG == 0
then
jump to @FUCKING_SKIP_HINTS1
end

//////////////////////////////////////////////////////////////////////////

if
$FP_ACTIVATED == 1
then

FP_TURNED_OFF_FOR_CUTSCENE = 1

repeat
wait 0
until $FP_ACTIVATED == 0

wait 250

end

camera.SetPosition(2233.456055 -2282.531250 14.479597,0.0,0.0,0.0)
camera.PointAt(2232.736084 -2283.225342 14.482467,1)

text.ShowH('HINT24',6000,1)

32@ = 0
repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
text.ClearAll()
break
end

until 32@ > 6000

//wait 6000

//////////////////////////////////////////////////////////////////////////

camera.SetPosition(2236.124268 -2298.479248 16.194616,0.0,0.0,0.0)
camera.PointAt(2235.141357 -2298.363525 16.051365,1)

text.ShowH('HINT25',5000,1) 

32@ = 0
repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
text.ClearAll()
break
end

until 32@ > 5000

//wait 5000

////////////////////////////////////////////////////////////////////////// 

camera.SetPosition(2125.502441 -2276.159912 20.937138,0.0,0.0,0.0)
camera.PointAt(2124.557373 -2275.839844 20.872988,1)

text.ShowH('HINT29',3000,1)

32@ = 0
repeat
wait 0

if
0E3E: is_button_just_pressed 0 button 17
then
text.ClearAll()
break
end

until 32@ > 3000

//wait 3000              

////////////////////////////////////////////////////////////////////////// 

:FUCKING_SKIP_HINTS1

if
SHOW_HINTS_FLAG == 1
then
camera.Restore_WithJumpCut()
end

player.CanMove(PLAYER_CHAR,true)

FP_TURNED_OFF_FOR_CUTSCENE = 0

v$OBJECTIVE = "STRB35"

03DC: MISSION_MARKER = create_marker_above_pickup USHER1_SAVE_PICKUP

repeat
wait 0 

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA_B)
jf @USHER1_FAILED_CAR_WRECKED

if
SHOW_HINTS_FLAG == 1
then
text.ShowH('HINT30',10,1)
end

until pickup.Picked_up(USHER1_SAVE_PICKUP)

v$OBJECTIVE = "DUMMY"
player.CanMove(PLAYER_CHAR,false)

marker.Disable(MISSION_MARKER)
pickup.Destroy(USHER1_SAVE_PICKUP)
marker.Disable(USHER1_SAVE_PICKUP_MARKER)

fade 0 1000
wait 1000

0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_CHECKPOINT" 
0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_SLOYPOK_FLAG"
0AF1: write_int -1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_NIGHTMARE1_CHECKPOINT"

//////////////////////////////////////////////////////////

$TIME_LOCK_OFF = 1
$WEATHER_LOCK_OFF_FLAG = 1
0459: end_thread_named 'WTH_LCK'
0459: end_thread_named 'TIM_LCK'

//////////////////////////////////////////////////////////

$ZOMBIE_SPAWN_INT = 0 
$SAVESTATUS = 1
$ZOMBIES_HORDE = 0
$SAVESTATUS_TRUE = 1   
$MIKE_MUTED = 0
$QUEST_CAMP_NUMBER = -1
0629: change_integer_stat 258 to 0

wait 1000

BASE_TEAMMATES_DESTORY_FLAG = 1

gosub @UMUSIC_MISSION1_OFF

0318: set_latest_mission_passed 'STRB2B' 
actor.PutAtNoOffset(PLAYER_ACTOR,1068.9556, -1603.254, 20.4962)
actor.Angle(PLAYER_ACTOR) = 90.2083 

$MISSION_START_NUMBER = 110 
$SAVE_MISSION_START_FLAG = 1
$SAVE_MISSION_NOT_SAVE_FLAG = 0
create_thread @MS_STAR

jump @UUDACHNO1 

:UUDACHNO1        
gosub @UPROPUSK_KODA1 
return 

:UKOD_PROVALA1
$ONMISSION = 0 
mission_cleanup 
06D0: enable_emergency_traffic 0 
06D7: enable_train_traffic 0 
096A: enable_flying_helis 0 
099E: enable_police_patrols 0  
0923: enable_air_traffic 0 
08E7: disable_entrance_markers 0    
return 

:UUDALENIE_KODA1    
$ONMISSION = 0 
marker.Disable(MISSION_CHECKPOINT)
marker.Disable(MISSION_MARKER)

wait 0 

if and
GAME_OVER_FLAG == 0
$ACTOR_DEAD == 0
then
fade 0 0
end

mission_cleanup

if and
GAME_OVER_FLAG == 0
$ACTOR_DEAD == 0
then
fade 0 0
end

06D0: enable_emergency_traffic 0 
06D7: enable_train_traffic 0 
096A: enable_flying_helis 0 
099E: enable_police_patrols 0  
0923: enable_air_traffic 0 
08E7: disable_entrance_markers 0    
return

:UMUSIC_MISSION1_OFF

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_MISSION // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 700
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1

while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
wait 0
end

//////////////////////////////////////////////////////////

return

:USHER1_TANK_RANDOM_YELL_SOUND
random_int 0@ 0 12

if
0@ == 0
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL1.wav")
end 

if
0@ == 1
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL2.wav")
end 

if
0@ == 2
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL3.wav")
end 

if
0@ == 3
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL4.wav")
end 

if
0@ == 4
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL5.wav")
end 

if
0@ == 5
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL6.wav")
end 

if
0@ == 6
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL7.wav")
end 

if
0@ == 7
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL8.wav")
end 

if
0@ == 8
then                                      
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL9.wav")
end 

if
0@ == 9
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL10.wav")
end 

if
0@ == 10
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL11.wav")
end 

if
0@ == 11
then
$SHIT_FUCK = Audiostream.Load3D("AUDIO\SOUNDS\infected_sounds\TANK_sounds\TANK_YELL12.wav")
end      

return

:USHER1_FOOD_GIVE
$BANKA += 1
$BANKA_FIND += 1                        
$TEMP_XP = BANKA_FIND_XP
008D: $TEMP_XP = integer $TEMP_XP to_float
0069: $TEMP_XP *= $XP_COEFF // (float)
008C: $TEMP_XP = float $TEMP_XP to_integer
0058: $PLAYER_XP += $TEMP_XP // (int)
text.ShowTextBox('INV311')
return

:GO_LOOT_RESTORAN
v$OBJECTIVE = "STRB14"

018A: MISSION_CHECKPOINT2 = create_checkpoint_at 386.8068 -1817.8646 8.341
MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(50, 386.8068, -1817.8646, 8.341)
0A40: MISSION_MARKER = create_entrance_marker_at 386.8068 -1817.8646 8.341 color 14

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
if or
0@ >= 1
$CHEATS_ON == 1
then                         
0950: set_trip_skip 372.9917 -1746.7285 15.4115 angle 180.0
end

0@ = 0
1@ = 0
32@ = 0

repeat
wait 0

if and
$CHEATS_ON == 1
0AB0:   key_pressed 81
then  
marker.Disable(MISSION_CHECKPOINT)
marker.Disable(MISSION_CHECKPOINT2)
0A41: destroy_entrance_marker MISSION_MARKER
return
end

if and
32@ >= 15000
1@ == 0
    then
    1@ = 1
    v$ST_DIALOG[0] = "STR11"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2 
    end

gosub @USHER1_HIDE_WEPS

if
0@ == 0
    then
    
    ///////////////////////////////////////////////////
    
    if and
    056E:   car SUPPLY_QUEST_TRUCK defined
    not USHER1_VICTORIA_GOT_BACK_FLAG == 1
    then
    
    if
    not car.Wrecked(SUPPLY_QUEST_TRUCK)
    jf @USHER1_FAILED_CAR_WRECKED
    
    if
    not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
        then
        marker.Disable(MISSION_CHECKPOINT)
        marker.Disable(MISSION_CHECKPOINT2)
        gosub @USHER1_GET_BACK_IN_CAR
        v$OBJECTIVE = "STRB14"
        018A: MISSION_CHECKPOINT2 = create_checkpoint_at 386.8068 -1817.8646 8.341
        MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(50, 386.8068, -1817.8646, 8.341)           
        end
    else
    jump to @USHER1_FAILED_CAR_WRECKED
    end
    
    ///////////////////////////////////////////////////
    
    end

if and
0AB0:   key_pressed $KEY_USE
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 386.8068 -1817.8646 8.341
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
end

if and
0@ == 0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 386.8068 -1817.8646 8.341 radius 15.0
    then
    0@ = 1
    v$OBJECTIVE = "STRB15"
    v$ST_DIALOG[0] = "STRY13"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2  
    end

until 00ED:   actor PLAYER_ACTOR sphere 0 near_point 386.8068 -1817.8646 radius 1.0 1.0 on_foot

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
if
0@ < 1
then
0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
end
0951: disable_trip_skip

marker.Disable(MISSION_CHECKPOINT)
marker.Disable(MISSION_CHECKPOINT2)
0A41: destroy_entrance_marker MISSION_MARKER
player.CanMove(PLAYER_CHAR) = false
v$OBJECTIVE = "DUMMY"

fade 0 500
$HUD_REMOVE = 1
wait 500

$SAVESTATUS = 1
$END_DIALOG_INST = 1
text.ClearAll()
text.RemoveTextBox()
select_interior 1
0860: link_actor PLAYER_ACTOR to_interior 1
04F9: set_sky_color 1 fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,406.2639, -1810.7306, -4.3734)
actor.Angle(PLAYER_ACTOR) = 180.0
camera.Restore_WithJumpCut()
create_thread @REFR_3D 

while not model.Available(#ZMB5)
wait 0
model.Load(#ZMB5)
mload
end 

USHER1_AMADNA_MANDA = Actor.Create(23, #ZMB5, 405.4334, -1811.0779, -4.3734)
Actor.Angle(USHER1_AMADNA_MANDA) = 325.1546
0446: set_actor USHER1_AMADNA_MANDA dismemberment_possible $ZOMBIE_HEADSHOT 
060F: set_actor USHER1_AMADNA_MANDA melee_accuracy_to 150.0 
060B: set_actor USHER1_AMADNA_MANDA decision_maker_to $DEC_ZOMBIE  
077A: set_actor USHER1_AMADNA_MANDA acquaintance 0 to_actors_pedtype $ZOMBIE_SET_PEDTYPE // see ped.dat 
07DD: set_actor USHER1_AMADNA_MANDA attack_rate 999 // previously known as temper_to
0856: set_actor USHER1_AMADNA_MANDA enable_crouch 0
07FE: set_actor USHER1_AMADNA_MANDA fighting_style_to 5 moves 6    
09E8: 0@ = actor PLAYER_ACTOR active_interior
0860: link_actor USHER1_AMADNA_MANDA to_interior 0@
0946: set_actor USHER1_AMADNA_MANDA actions_uninterupted_by_weapon_fire 1
Actor.SetWalkStyle(USHER1_AMADNA_MANDA, "zombie1")  
0A09: set_actor USHER1_AMADNA_MANDA muted 1 // versionB
0967: actor USHER1_AMADNA_MANDA move_mouth -1 ms
actor.Health(USHER1_AMADNA_MANDA) = 10
0A96: 0@ = actor USHER1_AMADNA_MANDA struct
0A8E: 0@ = 0@ + 1376
0A8C: write_memory 0@ size 4 value $ZOMBIE_ROTATE_SPEED virtual_protect 1

/////////////////////////////////////////////////

ZOMBIES_NOTSPAWN = 0
ZOMBIE_INTERIOR_ALLOW_SPAWN = 1
ZOMBIE_INTERIOR_ALLOW_SPAWN2 = 1
$ZOMBIES_ALWAYS_VISIBLE = 1
$ZOMBIE_SPAWN_ON_COORD = 1
$ZOMBIE_COORD_MAX = 9
$ZOMBIE_DONT_ATTACK_PLAYER = 1
    
$ZOMBIE_X[0] = 411.2709
$ZOMBIE_Y[0] = -1812.4277
$ZOMBIE_Z[0] = -4.3734
    
$ZOMBIE_X[1] = 413.0033
$ZOMBIE_Y[1] = -1816.2898
$ZOMBIE_Z[1] = -4.3734
    
$ZOMBIE_X[2] = 414.2545
$ZOMBIE_Y[2] = -1823.1888
$ZOMBIE_Z[2] = -4.3734
    
$ZOMBIE_X[3] = 410.5193
$ZOMBIE_Y[3] = -1825.504
$ZOMBIE_Z[3] = -4.3734
    
$ZOMBIE_X[4] = 409.2838
$ZOMBIE_Y[4] = -1818.8635
$ZOMBIE_Z[4] = -6.1629
    
$ZOMBIE_X[5] = 405.9523
$ZOMBIE_Y[5] = -1815.7258
$ZOMBIE_Z[5] = -4.3734
    
$ZOMBIE_X[6] = 405.7105
$ZOMBIE_Y[6] = -1823.1166
$ZOMBIE_Z[6] = -4.3734
   
$ZOMBIE_X[7] = 405.7935
$ZOMBIE_Y[7] = -1828.1682
$ZOMBIE_Z[7] = -4.3734
    
$ZOMBIE_X[8] = 410.7626
$ZOMBIE_Y[8] = -1828.7479
$ZOMBIE_Z[8] = -4.3734

/////////////////////////////////////////////////

repeat
wait 0
until $ZOMBIE_SPAWNED_COUNT == 0

wait 500
$ZOMBIES_COUNT = 10
$SAVESTATUS = 0

repeat
wait 0
$ZOMBIES_COUNT = 10
until $ZOMBIE_SPAWNED_COUNT >= 9

ZOMBIE_INTERIOR_ALLOW_SPAWN = 0
ZOMBIE_INTERIOR_ALLOW_SPAWN2 = 0
ZOMBIES_NOTSPAWN = 1
$ZOMBIE_SPAWN_ON_COORD = 0

$ALLOW_PLAYER_SLOWMOTION = 0
player.CanMove(PLAYER_CHAR) = true
0E69: set_player_control_pad_movement 0 0
05E2: AS_actor USHER1_AMADNA_MANDA kill_actor PLAYER_ACTOR
$GODMODE_FLAG = 0
Actor.SetImmunities(PLAYER_ACTOR, 0, 0, 0, 0, 0)

repeat
wait 0
until 051A:   actor PLAYER_ACTOR damaged_by_actor USHER1_AMADNA_MANDA

0E69: set_player_control_pad_movement 0 1

fade 1 250
$HUD_REMOVE = 0
wait 250
05E2: AS_actor USHER1_AMADNA_MANDA kill_actor PLAYER_ACTOR

v$OBJECTIVE = "STRB16"

if
SHOW_HINTS_FLAG == 1
then
text.ShowTextBox('HINT18')
end

06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0
0992: set_player PLAYER_CHAR weapons_scrollable 1

1@ = 0
2@ = 0

repeat
wait 0     
015D: set_gamespeed 0.0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if
1@ == 0
then
2@ += 1
end

if
1@ == 0
then

if
SHOW_HINTS_FLAG == 1
then
text.ShowH('STRB42',10,1)
end

if or
2@ > 84
SHOW_HINTS_FLAG == 0
    then 
    text.ClearAll()
    1@ = 1
    end

else
$ALLOW_PLAYER_SLOWMOTION = 1
if
0A4B:   controls_set_to_joystick
    then
    
    if
    SHOW_HINTS_FLAG == 1
    then
    text.ShowH('HINT6B',10,1)
    end
    
    if or
    00E1:   player 0 pressed_key 16
    00E1:   player 0 pressed_key 17
    then
    if
    0E3E: is_button_just_pressed 0 button 4
        then
        015D: set_gamespeed 1.0
        break
        end
    end
    
    else
    
    if
    SHOW_HINTS_FLAG == 1
    then
    text.ShowH('HINT6',10,1)
    end
    
    if
    0AB0:   key_pressed $KEY_SLOWMOTION
        then
        015D: set_gamespeed 1.0
        break
        end
    
    end
end

until false

LAST_CHANCE_FLAG = 2
$ZOMBIE_DONT_ATTACK_PLAYER = 0
v$OBJECTIVE = "STRB17"

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

until $ZOMBIE_SPAWNED_COUNT == 0

LAST_CHANCE_FLAG = 0
015D: set_gamespeed 0.9
wait 0
015D: set_gamespeed 1.0

/////////////////////////////////////////

5@ = Actor.Health(PLAYER_ACTOR)
0D39: 6@ = actor PLAYER_ACTOR max_health
0092: 6@ = float 6@ to_integer
if and
803B: not  5@ == 6@  // (int)
SHOW_HINTS_FLAG == 1
then

/////////////////////////////////////////

v$OBJECTIVE = "STRB39"

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if and
not actor.Animation(PLAYER_ACTOR) == "BOM_PLANT"
SHOW_HINTS_FLAG == 1
then
text.ShowH('HINT20',10,1)
end

if or
$HEAL_USE > 0
$BINT_USE > 0
    then
    break
    end

until false

v$OBJECTIVE = "DUMMY"

if and
8A4B: not  controls_set_to_joystick
SHOW_HINTS_FLAG == 1
then
text.ShowTextBox('HINT31')
wait 2000
end

/////////////////////////////////////////

end

v$OBJECTIVE = "STRB18"

v$ST_DIALOG[0] = "DUMMY"
v$ST_DIALOG[1] = "STRY12"
$DIALOG_COUNT = 1
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

USHER1_COOL_PICKUP1 = pickup.Create(2663, 3, 414.3375, -1820.6079, -4.3734)
03DC: USHER1_COOL_PICKUP1_MARK = create_marker_above_pickup USHER1_COOL_PICKUP1
USHER1_COOL_PICKUP2 = pickup.Create(2663, 3, 414.3375, -1822.6128, -4.3734)
03DC: USHER1_COOL_PICKUP2_MARK = create_marker_above_pickup USHER1_COOL_PICKUP2
USHER1_COOL_PICKUP3 = pickup.Create(2663, 3, 414.3375, -1824.7078, -4.3734)
03DC: USHER1_COOL_PICKUP3_MARK = create_marker_above_pickup USHER1_COOL_PICKUP3
USHER1_COOL_PICKUP4 = pickup.Create(2663, 3, 414.3375, -1827.5948, -4.3734)
03DC: USHER1_COOL_PICKUP4_MARK = create_marker_above_pickup USHER1_COOL_PICKUP4
USHER1_PICKED_SHIT_COUNT = 0

repeat     
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if
09D1:   pickup USHER1_COOL_PICKUP1 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP1)
        then        
        marker.Disable(USHER1_COOL_PICKUP1_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP1)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end
    
if
09D1:   pickup USHER1_COOL_PICKUP2 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP2)
        then        
        marker.Disable(USHER1_COOL_PICKUP2_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP2)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end 
    
if
09D1:   pickup USHER1_COOL_PICKUP3 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP3)
        then        
        marker.Disable(USHER1_COOL_PICKUP3_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP3)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end 
    
if
09D1:   pickup USHER1_COOL_PICKUP4 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP4)
        then        
        marker.Disable(USHER1_COOL_PICKUP4_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP4)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end
    
if
USHER_PICKED_UP_SHIT == 1
then  
if
32@ > 100
    then
    USHER_PICKED_UP_SHIT = 0
    06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0 
    01B9: set_actor PLAYER_ACTOR armed_weapon_to USHER_PICKED_UP_SHIT_PREV_WEP  
    0992: set_player PLAYER_CHAR weapons_scrollable 1
    $CAR_CHECKING_FLAG = 0
    end
end              

until USHER1_PICKED_SHIT_COUNT == 4

if
USHER_PICKED_UP_SHIT == 1
then
USHER_PICKED_UP_SHIT = 0
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0 
01B9: set_actor PLAYER_ACTOR armed_weapon_to USHER_PICKED_UP_SHIT_PREV_WEP  
0992: set_player PLAYER_CHAR weapons_scrollable 1
$CAR_CHECKING_FLAG = 0
end 

/////////////////////////////////////////

$ALLOW_HUNGER = 1

if
SHOW_HINTS_FLAG == 1
then
v$OBJECTIVE = "STRB38"

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if and
not $EATING_STATUS == 1
SHOW_HINTS_FLAG == 1
then
text.ShowH('HINT3',10,1)
end

until $BANKA_USE > 0

v$OBJECTIVE = "DUMMY"

if and
8A4B: not  controls_set_to_joystick
SHOW_HINTS_FLAG == 1
then
text.ShowTextBox('HINT4')
wait 2000
end

/////////////////////////////////////////

end
v$OBJECTIVE = "STRB19"
018A: MISSION_CHECKPOINT = create_checkpoint_at 406.2639 -1810.7306 -4.3734
0A40: MISSION_MARKER = create_entrance_marker_at 406.2639 -1810.7306 -3.8734 color 14

repeat
wait 0  

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

until 00EC:   actor PLAYER_ACTOR sphere 0 near_point 406.2639 -1810.7306 radius 1.0 1.0

player.CanMove(PLAYER_CHAR) = false
marker.Disable(MISSION_CHECKPOINT)
0A41: destroy_entrance_marker MISSION_MARKER
v$OBJECTIVE = "DUMMY"

fade 0 1000
$HUD_REMOVE = 1
wait 1000 

select_interior 0
0860: link_actor PLAYER_ACTOR to_interior 0
04FA: reset_sky_colors_with_fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,386.8068, -1817.8646, 7.841)
actor.Angle(PLAYER_ACTOR) = 90.0
camera.Restore_WithJumpCut()
create_thread @REFR_3D
$TIME_LOCK_HOUR += 1
wait 1000

player.CanMove(PLAYER_CHAR) = true

fade 1 1000
$HUD_REMOVE = 0
ZOMBIES_NOTSPAWN = 0

return

:GO_LOOT_BEACH_MEDIC
v$OBJECTIVE = "STRB14B"

018A: MISSION_CHECKPOINT2 = create_checkpoint_at 539.0198 -1795.0315 5.918
MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(22, 539.0198, -1795.0315, 5.918)
//0A40: MISSION_MARKER = create_entrance_marker_at 539.0198 -1795.0315 5.918 color 14   

0@ = 0
1@ = 0

repeat
wait 0

if
0@ == 0
    then
    
    ///////////////////////////////////////////////////
    
    if and
    056E:   car SUPPLY_QUEST_TRUCK defined
    not USHER1_VICTORIA_GOT_BACK_FLAG == 1
    then
    
    if
    not car.Wrecked(SUPPLY_QUEST_TRUCK)
    jf @USHER1_FAILED_CAR_WRECKED
    
    if
    not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
        then
        marker.Disable(MISSION_CHECKPOINT)
        marker.Disable(MISSION_CHECKPOINT2)
        gosub @USHER1_GET_BACK_IN_CAR
        v$OBJECTIVE = "STRB14B"
        018A: MISSION_CHECKPOINT2 = create_checkpoint_at 539.0198 -1795.0315 5.918
        MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(22, 539.0198, -1795.0315, 5.918)       
        if and
        1@ == 0
        SHOW_HINTS_FLAG == 1
            then
            1@ = 1        
            if
            0A4B:   controls_set_to_joystick
                then
                text.ShowTextBox('HINT34B')
                else
                text.ShowTextBox('HINT34')
                end        
            end                 
        end
    else
    jump to @USHER1_FAILED_CAR_WRECKED
    end
    
    ///////////////////////////////////////////////////
    
    end

if and
0AB0:   key_pressed $KEY_USE
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 538.5701 -1790.082 5.9487
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
end

if and
0@ == 0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 539.0198 -1795.0315 5.918 radius 30.0
    then
    0@ = 1
    v$ST_DIALOG[0] = "STRY15"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2
    end

until 00ED:   actor PLAYER_ACTOR sphere 0 near_point 539.0198 -1795.0315 radius 15.0 15.0 on_foot

marker.Disable(MISSION_CHECKPOINT)
marker.Disable(MISSION_CHECKPOINT2)
v$OBJECTIVE = "STRB20"
MISSION_MARKER = marker.CreateAboveCar(USHER1_MESA)
07E0: set_marker MISSION_MARKER type_to 1
car.SetImmunities(USHER1_MESA,1,1,1,1,0) 
car.RemoveReferences(USHER1_MESA)

CURRENT_USHER_TUTORIAL_NUM = 1

repeat
wait 0

if and
not $CAR_CHECKING_FLAG == 1
056E:   car USHER1_MESA defined
then
if 
0D0C: get_car USHER1_MESA component "boot_dummy" matrix_pointer_to 1@ // IF and SET
    then
    0D06: get_matrix 1@ position_to 2@ 3@ 4@
    2@ += -0.6
    0D54: draw_corona_with_extra_params_texture 0 color 255 0 0 155 on_entity 0 at 2@ 3@ 4@ size 0.5 far_clip 25.0 near_clip 0.01 flare 0 enable_reflection 1 check_obstacles 1 flash_while_fading 1 fade_speed 1.0 only_from_below 0
    end
end

if
056E:   car USHER1_MESA defined
then
if
051C:   car USHER1_MESA damaged_by_actor PLAYER_ACTOR
    then
    wait 0
    054F: clear_car USHER1_MESA damage
    if
    89BB: not  car USHER1_MESA has_visible_damage_on_component 1
        then
        if
        02D8:   actor PLAYER_ACTOR current_weapon == 0
            then
            text.ClearAll()
            text.ShowH('HINT19E',2000,1)
            wait 2000
            else
            text.ClearAll()
            text.ShowH('HINT19D',2000,1)
            wait 2000
            end
        end
    end
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

if and
not $CAR_CHECKING_FLAG == 1
SHOW_HINTS_FLAG == 1
then
if
0A4B:   controls_set_to_joystick
    then
    text.ShowH('HINT19C',100,1)       
    else    
    if
    $KEY_USE == 69
        then
        text.ShowH('HINT19',100,1)
        else
        text.ShowH('HINT19B',100,1)
        end           
    end
end

until CURRENT_USHER_TUTORIAL_NUM == -1

CURRENT_USHER_TUTORIAL_NUM = 0

v$OBJECTIVE = "DUMMY"
marker.Disable(MISSION_MARKER)
car.SetImmunities(USHER1_MESA,1,1,1,1,1)
0E09: mark_car_as_needed USHER1_MESA

return

:GO_LOOT_POLICE
v$OBJECTIVE = "STRB14C"

018A: MISSION_CHECKPOINT2 = create_checkpoint_at 532.079102 -1806.776123 6.578127
MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(30, 532.079102, -1806.776123, 6.578127)
0A40: MISSION_MARKER = create_entrance_marker_at 532.079102 -1806.776123 7.078127 color 14 

repeat
wait 0

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD
if
not car.Wrecked(USHER1_VICTORIA)
jf @USHER1_FAILED_CAR_WRECKED

if and
0AB0:   key_pressed $KEY_USE
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 532.079102 -1806.776123 6.578127
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
end

until 00ED:   actor PLAYER_ACTOR sphere 0 near_point 532.079102 -1806.776123 radius 1.0 1.0 on_foot

marker.Disable(MISSION_CHECKPOINT)
marker.Disable(MISSION_CHECKPOINT2)
0A41: destroy_entrance_marker MISSION_MARKER
player.CanMove(PLAYER_CHAR) = false
v$OBJECTIVE = "DUMMY"

fade 0 500
$HUD_REMOVE = 1
wait 500

$END_DIALOG_INST = 1
text.ClearAll()
text.RemoveTextBox()
select_interior 1
0860: link_actor PLAYER_ACTOR to_interior 1
04F9: set_sky_color 1 fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,528.606201, -1809.265015, -6.060935)
actor.Angle(PLAYER_ACTOR) = 178.980194
camera.Restore_WithJumpCut()
create_thread @REFR_3D

player.CanMove(PLAYER_CHAR) = true
fade 1 250
$HUD_REMOVE = 0
wait 250

v$OBJECTIVE = "STRB21"

v$ST_DIALOG[0] = "STR15"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

032B: USHER1_COOL_PICKUP1 = create_weapon_pickup #XM1014 group 3 ammo 30 at 526.736450 -1819.370850 -6.060935
03DC: USHER1_COOL_PICKUP1_MARK = create_marker_above_pickup USHER1_COOL_PICKUP1
032B: USHER1_COOL_PICKUP2 = create_weapon_pickup #MP5K group 3 ammo 90 at 526.014038 -1818.653076 -6.060935
03DC: USHER1_COOL_PICKUP2_MARK = create_marker_above_pickup USHER1_COOL_PICKUP2                    
$RADIO_PICKUP[0] = pickup.Create(#CELLPHONE,3,530.195007, -1819.118042, -6.060935)       
03DC: USHER1_COOL_PICKUP3_MARK = create_marker_above_pickup $RADIO_PICKUP[0]
USHER1_PICKED_SHIT_COUNT = 0

repeat     
wait 0

if
SHOW_HINTS_FLAG == 1
then
if
0A2A:   text_box 'PU_CF1' displayed
    then
    if
    0A4B:   controls_set_to_joystick
        then
        text.ShowH('HINT59B',10,1)
        else
        text.ShowH('HINT59',10,1)
        end
    end
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_FAILED_PLAYER_DIED
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_FAILED_AGRO
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_FAILED_LDEAD

if
075C:  marker USHER1_COOL_PICKUP3_MARK enabled
then
if and
875C: not  marker USHER1_COOL_PICKUP1_MARK enabled
875C: not  marker USHER1_COOL_PICKUP2_MARK enabled
    then
    v$OBJECTIVE = "STRB21B"
    end
else
v$OBJECTIVE = "STRB21C"
end

if
09D1:   pickup USHER1_COOL_PICKUP1 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP1)
        then        
        marker.Disable(USHER1_COOL_PICKUP1_MARK)  
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end
    
if
09D1:   pickup USHER1_COOL_PICKUP2 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP2)
        then        
        marker.Disable(USHER1_COOL_PICKUP2_MARK)
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end 
    
if
09D1:   pickup $RADIO_PICKUP[0] created
    then
    if
    pickup.Picked_up($RADIO_PICKUP[0])
        then        
        marker.Disable(USHER1_COOL_PICKUP3_MARK)
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end      

until USHER1_PICKED_SHIT_COUNT == 3

v$OBJECTIVE = "STRB19"
018A: MISSION_CHECKPOINT = create_checkpoint_at 528.606201 -1809.265015 -5.560935
0A40: MISSION_MARKER = create_entrance_marker_at 528.606201 -1809.265015 -5.560935 color 14

repeat
wait 0
until 00EC:   actor PLAYER_ACTOR sphere 0 near_point 528.606201 -1809.265015 radius 1.0 1.0

if
SHOW_HINTS_FLAG == 1
then

if
0A4B:   controls_set_to_joystick
then
text.ShowTextBox('HINT2B')
else
text.ShowTextBox('HINT2')
end

end 

player.CanMove(PLAYER_CHAR) = false
marker.Disable(MISSION_CHECKPOINT)
0A41: destroy_entrance_marker MISSION_MARKER
v$OBJECTIVE = "DUMMY"

fade 0 1000
$HUD_REMOVE = 1
wait 1000 

select_interior 0
0860: link_actor PLAYER_ACTOR to_interior 0
04FA: reset_sky_colors_with_fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,533.2399, -1807.3796, 6.5781)
actor.Angle(PLAYER_ACTOR) = 236.6295
camera.Restore_WithJumpCut()
create_thread @REFR_3D
$TIME_LOCK_HOUR += 1
wait 1000

player.CanMove(PLAYER_CHAR) = true

fade 1 1000
$HUD_REMOVE = 0

return

:GO_LOOT_SNACKS
v$OBJECTIVE = "STRB14D"

018A: MISSION_CHECKPOINT2 = create_checkpoint_at 1592.3521 -1862.641 13.5273
MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(47, 1592.3521, -1862.641, 14.0273)
0A40: MISSION_MARKER = create_entrance_marker_at 1592.3521 -1862.641 14.0273 color 14

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
if or
0@ >= 2
$CHEATS_ON == 1
then                         
0950: set_trip_skip 1509.9529 -1869.1207 12.9613 angle 269.8932
end

0@ = 0
1@ = 0

repeat
wait 0

if
0@ == 0
    then
    
    ///////////////////////////////////////////////////
    
    if and
    056E:   car SUPPLY_QUEST_TRUCK defined
    not USHER1_VICTORIA_GOT_BACK_FLAG == 1
    then
    
    if
    not car.Wrecked(SUPPLY_QUEST_TRUCK)
    jf @USHER1_FAILED_CAR_WRECKED
    
    if
    not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
        then
        marker.Disable(MISSION_CHECKPOINT)
        marker.Disable(MISSION_CHECKPOINT2)
        gosub @USHER1_GET_BACK_IN_CAR
        v$OBJECTIVE = "STRB14D"
        018A: MISSION_CHECKPOINT2 = create_checkpoint_at 1592.3521 -1862.641 13.5273
        MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(47, 1592.3521, -1862.641, 14.0273)
        if and
        1@ == 0
        SHOW_HINTS_FLAG == 1
            then
            1@ = 1        
            if
            0A4B:   controls_set_to_joystick
                then
                text.ShowTextBox('HINT32B')
                else
                text.ShowTextBox('HINT32')
                end        
            end      
        end
    else
    jump to @USHER1_FAILED_CAR_WRECKED
    end
    
    ///////////////////////////////////////////////////
    
    end

if and
0AB0:   key_pressed $KEY_USE
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1592.3521 -1862.641 13.5273
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
end

if and
0@ == 0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 1592.3521 -1862.641 13.5273 radius 15.0
    then
    v$OBJECTIVE = "STRB15"
    0@ = 1
    v$ST_DIALOG[0] = "STRY14"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2
    end

until 00ED:   actor PLAYER_ACTOR sphere 0 near_point 1592.3521 -1862.641 radius 1.0 1.0 on_foot

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
if
0@ < 2
then
0AF1: write_int 2 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
end
0951: disable_trip_skip

marker.Disable(MISSION_CHECKPOINT)
marker.Disable(MISSION_CHECKPOINT2)
0A41: destroy_entrance_marker MISSION_MARKER
player.CanMove(PLAYER_CHAR) = false
v$OBJECTIVE = "DUMMY"

fade 0 500
$HUD_REMOVE = 1
wait 500

$END_DIALOG_INST = 1
text.ClearAll()
text.RemoveTextBox()
select_interior 1
0860: link_actor PLAYER_ACTOR to_interior 1
04F9: set_sky_color 1 fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,1597.2872, -1861.2382, 3.4844)
actor.Angle(PLAYER_ACTOR) = 0.0
camera.Restore_WithJumpCut()
create_thread @REFR_3D

player.CanMove(PLAYER_CHAR) = true
fade 1 250
$HUD_REMOVE = 0
wait 250

v$OBJECTIVE = "STRB18"

USHER1_COOL_PICKUP1 = pickup.Create(2663, 3, 1598.3745, -1854.6357, 3.4844)
03DC: USHER1_COOL_PICKUP1_MARK = create_marker_above_pickup USHER1_COOL_PICKUP1
USHER1_COOL_PICKUP2 = pickup.Create(2663, 3, 1596.7389, -1854.6357, 3.4917)
03DC: USHER1_COOL_PICKUP2_MARK = create_marker_above_pickup USHER1_COOL_PICKUP2
USHER1_COOL_PICKUP3 = pickup.Create(2663, 3, 1595.1354, -1854.6357, 3.4917)
03DC: USHER1_COOL_PICKUP3_MARK = create_marker_above_pickup USHER1_COOL_PICKUP3
USHER1_COOL_PICKUP4 = pickup.Create(2663, 3, 1590.0881, -1854.6357, 3.4917)
03DC: USHER1_COOL_PICKUP4_MARK = create_marker_above_pickup USHER1_COOL_PICKUP4
USHER1_PICKED_SHIT_COUNT = 0

repeat     
wait 0

if
09D1:   pickup USHER1_COOL_PICKUP1 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP1)
        then        
        marker.Disable(USHER1_COOL_PICKUP1_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP1)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1        
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end
    
if
09D1:   pickup USHER1_COOL_PICKUP2 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP2)
        then        
        marker.Disable(USHER1_COOL_PICKUP2_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP2)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end 
    
if
09D1:   pickup USHER1_COOL_PICKUP3 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP3)
        then        
        marker.Disable(USHER1_COOL_PICKUP3_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP3)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end 
    
if
09D1:   pickup USHER1_COOL_PICKUP4 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP4)
        then        
        marker.Disable(USHER1_COOL_PICKUP4_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP4)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end
    
if
USHER_PICKED_UP_SHIT == 1
then  
if
32@ > 100
    then
    USHER_PICKED_UP_SHIT = 0
    06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0 
    01B9: set_actor PLAYER_ACTOR armed_weapon_to USHER_PICKED_UP_SHIT_PREV_WEP  
    0992: set_player PLAYER_CHAR weapons_scrollable 1
    $CAR_CHECKING_FLAG = 0
    end
end              

until USHER1_PICKED_SHIT_COUNT == 4

if
USHER_PICKED_UP_SHIT == 1
then
USHER_PICKED_UP_SHIT = 0
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0 
01B9: set_actor PLAYER_ACTOR armed_weapon_to USHER_PICKED_UP_SHIT_PREV_WEP  
0992: set_player PLAYER_CHAR weapons_scrollable 1
$CAR_CHECKING_FLAG = 0
end  

v$OBJECTIVE = "STRB19"
018A: MISSION_CHECKPOINT = create_checkpoint_at 1597.2872 -1861.2382 3.4844
0A40: MISSION_MARKER = create_entrance_marker_at 1597.2872 -1861.2382 3.9844 color 14

repeat
wait 0
until 00EC:   actor PLAYER_ACTOR sphere 0 near_point 1597.2872 -1861.2382 radius 1.0 1.0

player.CanMove(PLAYER_CHAR) = false
marker.Disable(MISSION_CHECKPOINT)
0A41: destroy_entrance_marker MISSION_MARKER
v$OBJECTIVE = "DUMMY"

fade 0 1000
$HUD_REMOVE = 1
wait 1000 

select_interior 0
0860: link_actor PLAYER_ACTOR to_interior 0
04FA: reset_sky_colors_with_fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,1592.3521, -1862.641, 13.5273)
actor.Angle(PLAYER_ACTOR) = 179.943
camera.Restore_WithJumpCut()
create_thread @REFR_3D
$TIME_LOCK_HOUR += 1
wait 1000

player.CanMove(PLAYER_CHAR) = true

fade 1 1000
$HUD_REMOVE = 0 

return     

:GO_LOOT_BAR
v$OBJECTIVE = "STRB14E"

//////////////////////////////////////////////////////////////////////////////////////////////////

018A: MISSION_CHECKPOINT2 = create_checkpoint_at 1951.7271 -2041.3383 13.5469
MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(49, 1951.7271, -2041.3383, 13.5469)
0A40: MISSION_MARKER = create_entrance_marker_at 1951.7271 -2041.3383 14.0469 color 14

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
if or
0@ >= 3
$CHEATS_ON == 1
then                         
0950: set_trip_skip 1959.5322 -1964.8129 13.1878 angle 180.4182
end

0@ = 0

repeat
wait 0

if
0@ == 0
    then
    
    ///////////////////////////////////////////////////
    
    if and
    056E:   car SUPPLY_QUEST_TRUCK defined
    not USHER1_VICTORIA_GOT_BACK_FLAG == 1
    then
    
    if
    not car.Wrecked(SUPPLY_QUEST_TRUCK)
    jf @USHER1_FAILED_CAR_WRECKED
    
    if
    not actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)
        then
        marker.Disable(MISSION_CHECKPOINT)
        marker.Disable(MISSION_CHECKPOINT2)
        gosub @USHER1_GET_BACK_IN_CAR
        v$OBJECTIVE = "STRB14E"
        018A: MISSION_CHECKPOINT2 = create_checkpoint_at 1951.7271 -2041.3383 13.5469
        MISSION_CHECKPOINT = Marker.CreateIconAndSphere2(49, 1951.7271, -2041.3383, 13.5469)     
        end
    else
    jump to @USHER1_FAILED_CAR_WRECKED
    end
    
    ///////////////////////////////////////////////////
    
    end

if and
0AB0:   key_pressed $KEY_USE
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1951.7271 -2041.3383 13.5469
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
end

if and
0@ == 0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 1951.7271 -2041.3383 13.5469 radius 15.0
    then
    0@ = 1
    v$OBJECTIVE = "STRB15"
    v$ST_DIALOG[0] = "STRY17"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2
    end

until 00ED:   actor PLAYER_ACTOR sphere 0 near_point 1951.7271 -2041.3383 radius 1.0 1.0 on_foot

0AF0: 0@ = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
if
0@ < 3
then
0AF1: write_int 3 to_ini_file "saves\ZACM.set" section "SCR" key "USHER_INTRO_TRIP_SKIP"
end
0951: disable_trip_skip

marker.Disable(MISSION_CHECKPOINT)
marker.Disable(MISSION_CHECKPOINT2)
0A41: destroy_entrance_marker MISSION_MARKER

$END_DIALOG_INST = 1
wait 0
v$OBJECTIVE = "DUMMY"
v$ST_DIALOG[0] = "STRY18"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0 

if
0E3E: is_button_just_pressed 0 button 17
then
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

//////////////////////////////////////////////////////////////////////////////////////////////////

018A: MISSION_CHECKPOINT = create_checkpoint_at 1945.164063 -2042.876343 14.055894
0A40: MISSION_MARKER = create_entrance_marker_at 1945.164063 -2042.876343 14.055894 color 14

0@ = 0

repeat
wait 0

if and
0AB0:   key_pressed $KEY_USE
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1945.164063 -2042.876343 14.055894
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
end

until 00ED:   actor PLAYER_ACTOR sphere 0 near_point 1945.164063 -2042.876343 radius 1.0 1.0 on_foot

marker.Disable(MISSION_CHECKPOINT)
0A41: destroy_entrance_marker MISSION_MARKER

$END_DIALOG_INST = 1
wait 0
v$OBJECTIVE = "DUMMY"
v$ST_DIALOG[0] = "STRY19"
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0 

if
0E3E: is_button_just_pressed 0 button 17
then
$END_DIALOG_INST = 1
wait 0
break
end

until $DIALOG_END == 1

//////////////////////////////////////////////////////////////////////////////////////////////////

018A: MISSION_CHECKPOINT = create_checkpoint_at 1940.3339 -2032.634 13.5469
0A40: MISSION_MARKER = create_entrance_marker_at 1940.3339 -2032.634 13.5469 color 14

0@ = 0

repeat
wait 0

if and
0AB0:   key_pressed $KEY_USE
$CHEATS_ON == 1
then
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1940.3339 -2032.634 13.5469
//actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
//$END_DIALOG_INST = 1
end

until 00ED:   actor PLAYER_ACTOR sphere 0 near_point 1940.3339 -2032.634 radius 1.0 1.0 on_foot

marker.Disable(MISSION_CHECKPOINT)
0A41: destroy_entrance_marker MISSION_MARKER

player.CanMove(PLAYER_CHAR) = false

//////////////////////////////////////////////////////////////////////////////////////////////////

fade 0 500
$HUD_REMOVE = 1
wait 500

$END_DIALOG_INST = 1
text.ClearAll()
text.RemoveTextBox()
select_interior 1
0860: link_actor PLAYER_ACTOR to_interior 1
04F9: set_sky_color 1 fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,1927.0634, -2034.6089, -5.2438)
actor.Angle(PLAYER_ACTOR) = 180.0
camera.Restore_WithJumpCut()
create_thread @REFR_3D

player.CanMove(PLAYER_CHAR) = true
fade 1 250
$HUD_REMOVE = 0
wait 250

v$OBJECTIVE = "STRB18"

USHER1_COOL_PICKUP1 = pickup.Create(2663, 3, 1932.9288, -2036.4316, -5.2438)
03DC: USHER1_COOL_PICKUP1_MARK = create_marker_above_pickup USHER1_COOL_PICKUP1
USHER1_COOL_PICKUP2 = pickup.Create(2663, 3, 1933.4547, -2038.911, -5.2438)
03DC: USHER1_COOL_PICKUP2_MARK = create_marker_above_pickup USHER1_COOL_PICKUP2
USHER1_COOL_PICKUP3 = pickup.Create(2663, 3, 1940.2712, -2038.911, -5.2438)
03DC: USHER1_COOL_PICKUP3_MARK = create_marker_above_pickup USHER1_COOL_PICKUP3

if
0E4D: random_percent 50
then
USHER1_COOL_PICKUP4 = pickup.Create(1486, 3, 1936.9482, -2038.911, -5.2438)
else
USHER1_COOL_PICKUP4 = pickup.Create(1544, 3, 1936.9482, -2038.911, -5.2438)
end

03DC: USHER1_COOL_PICKUP4_MARK = create_marker_above_pickup USHER1_COOL_PICKUP4
USHER1_PICKED_SHIT_COUNT = 0

repeat     
wait 0

if
09D1:   pickup USHER1_COOL_PICKUP1 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP1)
        then        
        marker.Disable(USHER1_COOL_PICKUP1_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP1)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1        
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end
    
if
09D1:   pickup USHER1_COOL_PICKUP2 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP2)
        then        
        marker.Disable(USHER1_COOL_PICKUP2_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP2)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end 
    
if
09D1:   pickup USHER1_COOL_PICKUP3 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP3)
        then        
        marker.Disable(USHER1_COOL_PICKUP3_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP3)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
        end
    end 
    
if
09D1:   pickup USHER1_COOL_PICKUP4 created
    then
    if
    pickup.Picked_up(USHER1_COOL_PICKUP4)
        then        
        marker.Disable(USHER1_COOL_PICKUP4_MARK)
        pickup.Destroy(USHER1_COOL_PICKUP4)
        gosub @USHER1_FOOD_GIVE
        gosub @PICKUP_ANIMATION_USHER1
        USHER1_PICKED_SHIT_COUNT += 1
                
        v$ST_DIALOG[0] = "STRY20"
        $DIALOG_COUNT = 0
        $DIALOG_NOT_SKIP = 1
        create_thread @DG_SYS2        
        
        end
    end
    
if
USHER_PICKED_UP_SHIT == 1
then  
if
32@ > 100
    then
    USHER_PICKED_UP_SHIT = 0
    06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0 
    01B9: set_actor PLAYER_ACTOR armed_weapon_to USHER_PICKED_UP_SHIT_PREV_WEP  
    0992: set_player PLAYER_CHAR weapons_scrollable 1
    $CAR_CHECKING_FLAG = 0
    end
end              

until USHER1_PICKED_SHIT_COUNT == 4

if
USHER_PICKED_UP_SHIT == 1
then
USHER_PICKED_UP_SHIT = 0
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 0 
01B9: set_actor PLAYER_ACTOR armed_weapon_to USHER_PICKED_UP_SHIT_PREV_WEP  
0992: set_player PLAYER_CHAR weapons_scrollable 1
$CAR_CHECKING_FLAG = 0
end  

v$OBJECTIVE = "STRB19"
018A: MISSION_CHECKPOINT = create_checkpoint_at 1927.0634 -2034.6089 -5.2438
0A40: MISSION_MARKER = create_entrance_marker_at 1927.0634 -2034.6089 -4.7438 color 14

repeat
wait 0
until 00EC:   actor PLAYER_ACTOR sphere 0 near_point 1927.0634 -2034.6089 radius 1.0 1.0

player.CanMove(PLAYER_CHAR) = false
marker.Disable(MISSION_CHECKPOINT)
0A41: destroy_entrance_marker MISSION_MARKER
v$OBJECTIVE = "DUMMY"

fade 0 1000
$HUD_REMOVE = 1
wait 1000 

select_interior 0
0860: link_actor PLAYER_ACTOR to_interior 0
04FA: reset_sky_colors_with_fade 0
actor.PutAtNoOffset(PLAYER_ACTOR,1940.3339, -2032.634, 13.5469)
actor.Angle(PLAYER_ACTOR) = 89.6734
camera.Restore_WithJumpCut()
create_thread @REFR_3D
$TIME_LOCK_HOUR += 1
wait 1000

player.CanMove(PLAYER_CHAR) = true

fade 1 1000
$HUD_REMOVE = 0
wait 1000 

return       

:PICKUP_ANIMATION_USHER1

if
0A32:  actor PLAYER_ACTOR on_turret_of_car
    then
    return
    end

USHER_PICKED_UP_SHIT = 1
$CAR_CHECKING_FLAG = 1

0470: USHER_PICKED_UP_SHIT_PREV_WEP = actor PLAYER_ACTOR current_weapon 
01B9: set_actor PLAYER_ACTOR armed_weapon_to 0
0992: set_player PLAYER_CHAR weapons_scrollable 0   
07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

while not animation.Available("BOMBER")
wait 0
04ED: load_animation "BOMBER"
end 

while 0818:  actor PLAYER_ACTOR in_air
wait 10
end
      
0792: disembark_instantly_actor PLAYER_ACTOR     
  
0605: actor PLAYER_ACTOR perform_animation "BOM_Plant_In" IFP "BOMBER" framedelta 4.0 loop 0 lockX 0 lockY 0 lockF 0 time -1
0629: change_integer_stat 280 to 1       

$FATIGUE_LEVEL += 0.5

wait 10

while actor.Animation(PLAYER_ACTOR) == "BOM_Plant_In"
wait 0
end

07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 1

animation.Release("BOMBER")

05B9: AS_actor PLAYER_ACTOR stay_idle 150 ms
0629: change_integer_stat 280 to 0

32@ = 0
33@ = 0

return   

:USHER_SKIP_FIRST_CINEMA
0A48: enable_menu_access_in_widescreen_mode 1  
$SOUND_OFF_1 = 0
wait 0
cinema.Widescreen(1)
BLACK_POLOSKI_ON = 1
create_thread @REFR_3D

text.ClearAll()
text.RemoveTextBox()
create_thread @3D_REFR

03D6: remove_styled_text "STRB1"
03D6: remove_styled_text "STRB2"

0612: set_actor PLAYER_ACTOR animation "BED_Out_L" paused 1
0619: enable_actor PLAYER_ACTOR collision_detection 1

0792: disembark_instantly_actor PLAYER_ACTOR
04EF: release_animation "INT_HOUSE"

actor.PutAtNoOffset(PLAYER_ACTOR,985.4669, -1609.2203, 7.3406)
actor.Angle(PLAYER_ACTOR) = 0.0

jump to @USHER_SKIP_FIRST_CINEMA2

:USHER1_TERRY_ACTOR_CREATE

$TEAMMATES_PED_TYPE = 26

while not model.Available(9199)
wait 0
model.Load(9199)
mload
end

USHER1_TERRY = actor.Create(26,9199,985.6038, -1618.0162, 7.3406)
actor.Angle(USHER1_TERRY) = 220.4007
0860: link_actor USHER1_TERRY to_interior 1
     
0D10: set_actor USHER1_TERRY alpha 255 // IF and SET
    
create_thread @PED_BKP USHER1_TERRY 371
create_thread @ANT_PRE USHER1_TERRY

0781: get_weapon_with_ID 25 model_to 1@

while not model.Available(1@)
wait 0
model.Load(1@)
mload
end

actor.GiveWeaponAndAmmo(USHER1_TERRY,25,99999)

actor.Health(USHER1_TERRY) = 1000

0D10: set_actor USHER1_TERRY alpha 255 // IF and SET
09F4: set_actor USHER1_TERRY ignore_height_difference_following_nodes $Z_IGNORE_HEIGHT     
Actor.SetWalkStyle(USHER1_TERRY, "SURV1")
0446: set_actor USHER1_TERRY dismemberment_possible 0
060B: set_actor USHER1_TERRY decision_maker_to $DEC_PEOPLE
07DD: set_actor USHER1_TERRY attack_rate 50 // previously known as temper_to
081A: set_actor USHER1_TERRY weapon_skill_to 2  
060F: set_actor USHER1_TERRY melee_accuracy_to 999.0
0946: set_actor USHER1_TERRY actions_uninterupted_by_weapon_fire 1

if
UNITED_MAP == 0
then
04D8: set_actor USHER1_TERRY drowns_in_water 0 
end

09B5: set_actor USHER1_TERRY signal_after_kill 0  
0A96: 0@ = actor USHER1_TERRY struct
0A8E: 0@ = 0@ + 1376
0A8C: write_memory 0@ size 4 value $SURVIVORS_ROTATE_SPEED virtual_protect 1

08AF: set_actor USHER1_TERRY max_health_to $SURVIVER_MAX_HEALTH
Actor.WeaponAccuracy(USHER1_TERRY) = $SURV_ACCURACY

return

:USHER1_TERRY_ACTOR_CREATE2

$TEAMMATES_PED_TYPE = 26

while not model.Available(9199)
wait 0
model.Load(9199)
mload
end

USHER1_TERRY = actor.Create(26,9199,2244.311279, -2227.273926, 13.546875)
actor.Angle(USHER1_TERRY) = 46.779701
0860: link_actor USHER1_TERRY to_interior 1
     
0D10: set_actor USHER1_TERRY alpha 255 // IF and SET
    
create_thread @PED_BKP USHER1_TERRY 371
create_thread @ANT_PRE USHER1_TERRY

0781: get_weapon_with_ID 25 model_to 1@

while not model.Available(1@)
wait 0
model.Load(1@)
mload
end

actor.GiveWeaponAndAmmo(USHER1_TERRY,25,99999)

actor.Health(USHER1_TERRY) = 1000

0D10: set_actor USHER1_TERRY alpha 255 // IF and SET
09F4: set_actor USHER1_TERRY ignore_height_difference_following_nodes $Z_IGNORE_HEIGHT     
Actor.SetWalkStyle(USHER1_TERRY, "SURV1")
0446: set_actor USHER1_TERRY dismemberment_possible 0
060B: set_actor USHER1_TERRY decision_maker_to $DEC_PEOPLE
07DD: set_actor USHER1_TERRY attack_rate 50 // previously known as temper_to
081A: set_actor USHER1_TERRY weapon_skill_to 2  
060F: set_actor USHER1_TERRY melee_accuracy_to 999.0
0946: set_actor USHER1_TERRY actions_uninterupted_by_weapon_fire 1

if
UNITED_MAP == 0
then
04D8: set_actor USHER1_TERRY drowns_in_water 0 
end

09B5: set_actor USHER1_TERRY signal_after_kill 0  
0A96: 0@ = actor USHER1_TERRY struct
0A8E: 0@ = 0@ + 1376
0A8C: write_memory 0@ size 4 value $SURVIVORS_ROTATE_SPEED virtual_protect 1

08AF: set_actor USHER1_TERRY max_health_to $SURVIVER_MAX_HEALTH
Actor.WeaponAccuracy(USHER1_TERRY) = $SURV_ACCURACY

return

:USHER1_LATINOS_ACTOR_CREATE

while not model.Available(9200)
wait 0
model.Load(9200)
mload
end

USHER1_LATINOS = actor.Create(29,9200,989.283, -1627.1527, 7.3406)
actor.Angle(USHER1_LATINOS) = 220.4007
0860: link_actor USHER1_LATINOS to_interior 1
     
0D10: set_actor USHER1_LATINOS alpha 255 // IF and SET
    
create_thread @PED_BKP USHER1_LATINOS 371
create_thread @ANT_PRE USHER1_LATINOS

0781: get_weapon_with_ID 89 model_to 1@

while not model.Available(1@)
wait 0
model.Load(1@)
mload
end

actor.GiveWeaponAndAmmo(USHER1_LATINOS,89,99999)

actor.Health(USHER1_LATINOS) = 1000

0D10: set_actor USHER1_LATINOS alpha 255 // IF and SET
09F4: set_actor USHER1_LATINOS ignore_height_difference_following_nodes $Z_IGNORE_HEIGHT     
Actor.SetWalkStyle(USHER1_LATINOS, "SURV1")
0446: set_actor USHER1_LATINOS dismemberment_possible 0
060B: set_actor USHER1_LATINOS decision_maker_to $DEC_PEOPLE
07DD: set_actor USHER1_LATINOS attack_rate 50 // previously known as temper_to
081A: set_actor USHER1_LATINOS weapon_skill_to 2  
060F: set_actor USHER1_LATINOS melee_accuracy_to 999.0
0946: set_actor USHER1_LATINOS actions_uninterupted_by_weapon_fire 1

if
UNITED_MAP == 0
then
04D8: set_actor USHER1_LATINOS drowns_in_water 0 
end

09B5: set_actor USHER1_LATINOS signal_after_kill 0  
0A96: 0@ = actor USHER1_LATINOS struct
0A8E: 0@ = 0@ + 1376
0A8C: write_memory 0@ size 4 value $SURVIVORS_ROTATE_SPEED virtual_protect 1

08AF: set_actor USHER1_LATINOS max_health_to $SURVIVER_MAX_HEALTH
Actor.WeaponAccuracy(USHER1_LATINOS) = $SURV_ACCURACY

return

:USHER_CAR_INSTAFIX

0407: store_coords_to 0@ 1@ 2@ from_car USHER1_VICTORIA with_offset 0.0 0.0 3.0
car.PutAt(USHER1_VICTORIA,0@,1@,2@)
0840: link_car USHER1_VICTORIA to_interior 0

car.Health(USHER1_VICTORIA) = 1000

////////////////////////////////////////////////////////////////
0A97: 19@ = car USHER1_VICTORIA struct 
19@ += 17 
0A8D: 24@ = read_memory 19@ size 1 virtual_protect 0
0A97: 11@ = car USHER1_VICTORIA struct 
11@ += 9
0A8D: 12@ = read_memory 11@ size 1 virtual_protect 0
08BD: set 12@ bit 2
0A8C: write_memory 11@ size 1 value 12@ virtual_protect 0
08C3: clear 12@ bit 2
0A97: 19@ = car USHER1_VICTORIA struct 
19@ += 17 
0A8D: 24@ = read_memory 19@ size 1 virtual_protect 0
0A97: 19@ = car USHER1_VICTORIA struct 
19@ += 17
08C3: clear 24@ bit 4 
0A8C: write_memory 19@ size 1 value 24@ virtual_protect 0
////////////////////////////////////////////////////////////////

0A97: 22@ = car USHER1_VICTORIA struct 
0A8E: 23@ = 22@ + 5 // int 
0A8C: write_memory 23@ size 4 value 20.0 virtual_protect 0
$KANISTRA_FUEL = 0.0

car.LockInCurrentPosition(USHER1_VICTORIA,false)

$REPAIR_KIT = 0 

return

:USHER1_FAILED_NO_MORE_TOOLDICK1

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL96"
create_thread @GMV_OVR

return

:USHER1_FAILED_NO_MORE_TOOLDICK2

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL97"
create_thread @GMV_OVR

return

:USHER1_GET_BACK_IN_CAR
$DIALOG_PAUSE = 1
v$OBJECTIVE = "STRB37"
    
MISSION_CHECKPOINT = marker.CreateAboveCar(SUPPLY_QUEST_TRUCK)
07E0: set_marker MISSION_CHECKPOINT type_to 1
    
///////////////////////////////////////////////////////////////////
    
while true
wait 0

if and
0AB0:   key_pressed $KEY_USE
0AB0:   key_pressed 81
$CHEATS_ON == 1
then
036A: put_actor PLAYER_ACTOR in_car SUPPLY_QUEST_TRUCK
end

if
not actor.Dead(PLAYER_ACTOR)
jf @USHER1_GET_BACK_IN_CAR_FAILED_OTHER_REASON
if and
$CAMP_AGRED_FLAG[$QUEST_CAMP_NUMBER] == 0
not BASE_TEAMMATE_AGRED == 1
jf @USHER1_GET_BACK_IN_CAR_FAILED_OTHER_REASON
if
803A: not  LEADER_DIED_FLAG == $QUEST_CAMP_NUMBER // (int)
jf @USHER1_GET_BACK_IN_CAR_FAILED_OTHER_REASON
    
if and
056E:   car SUPPLY_QUEST_TRUCK defined
not car.Wrecked(SUPPLY_QUEST_TRUCK)
    then
    if
    actor.InCar(PLAYER_ACTOR,SUPPLY_QUEST_TRUCK)   
        then
        :USHER1_GET_BACK_IN_CAR_FAILED_OTHER_REASON
        marker.Disable(MISSION_CHECKPOINT)
        USHER1_VICTORIA_GOT_BACK_FLAG = 0            
        $DIALOG_PAUSE = 0
        return
        end
    else
    USHER1_VICTORIA_GOT_BACK_FLAG = 1
    return
    end
    
end
    
///////////////////////////////////////////////////////////////////

:USHER1_FAILED_CAR_WRECKED

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL98"
create_thread @GMV_OVR

return

:USHER1_HIDE_WEPS
$NOTSPAWN_ETC = 1
06AB: set_actor PLAYER_ACTOR all_weapons_hidden 1
0992: set_player PLAYER_CHAR weapons_scrollable 0
return

:USHER1_GTFO_TO_CAR
player.CanMove(PLAYER_CHAR,false)
random_int 0@ 1 4
0AD3: v$ST_DIALOG[0] = format "NOCAR%d" 0@    
$DIALOG_COUNT = 0
$DIALOG_NOT_SKIP = 1
create_thread @DG_SYS2

repeat
wait 0     
until $DIALOG_END == 1
            
fade 0 500
$HUD_REMOVE = 1
wait 500

actor.StorePos(PLAYER_ACTOR,0@,1@,2@)
0E27: get_angle_from_two_coords 0@ 1@ and 981.8758 -1596.6101 to 3@
actor.Angle(PLAYER_ACTOR) = 3@
0EF0: get_coord_from_angled_distance 0@ 1@ angle 3@ dist 200.0 store_to 5@ 6@
05D3: AS_actor PLAYER_ACTOR goto_point 5@ 6@ 2@ mode 7 time 999999 ms // versionA
//07CD: AS_actor PLAYER_ACTOR walk_to 5@ 6@ 2@ stop_with_angle 3@ within_radius 1.0 

repeat
wait 0
until 00A4:  actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1030.2517 -1537.0386 6.0766 cornerB 924.7707 -1766.1124 44.8855

0687: clear_actor PLAYER_ACTOR task

camera.Restore_WithJumpCut()
player.CanMove(PLAYER_CHAR,true)
0221: set_player PLAYER_CHAR apply_brakes_to_car 0    
create_thread @3D_REFR
fade 1 500
$HUD_REMOVE = 0
wait 500

return

:USHER1_FAILED_AGRO

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL5"
create_thread @GMV_OVR
mission_cleanup    
return

:USHER1_FAILED_LDEAD

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL43"
create_thread @GMV_OVR
mission_cleanup    
return

:USHER1_FAILED_PLAYER_DIED

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL80"
create_thread @GMV_OVR

return

:USHER1_FAILED_TERRY_DEAD

/////////////////////Плавное затухание/////////////////////

$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    
        
0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $MUSIC_ASSHOLE // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0
        
$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

///////////////////////////////////////////////////////////

text.ClearAll()
BLACK_POLOSKI_ON = 1
$MUSIC_TURN_OFF_FLAG = 1
v$FAILED_TEXT = "MS_FL99"
create_thread @GMV_OVR

return

:USHER_CHECK_SHKATULKA_PICKUP

if and
USHER1_SHKATULKA_PICKED_UP_FLAG == 0
0EEA: locate_char_distance_to_coordinates PLAYER_ACTOR pos 986.6162 -1612.4897 7.3406 radius 1.0
    then
    
    USHER1_SHKATULKA_PICKED_UP_FLAG = 1
    
    actor.PutAtNoOffset(PLAYER_ACTOR,986.6162, -1612.4897, 7.3406)
    actor.Angle(PLAYER_ACTOR) = 180.0788        
    
    0687: clear_actor PLAYER_ACTOR task
    0647: AS_actor PLAYER_ACTOR clear_look_task    
    
    0E69: set_player_control_pad_movement 0 0    
    cinema.Widescreen(1)
    BLACK_POLOSKI_ON = 1
    $HUD_REMOVE = 1
    $HUD_OFF_INST = 1
    
    if
    $FP_ACTIVATED == 1
    then
    repeat
    wait 0
    until $FP_ACTIVATED == 0
    end
    
    camera.SetPosition(987.471985, -1612.319458, 8.231124,0.0,0.0,0.0)
    camera.PointAt(986.810791, -1612.875488, 7.727455,2)
    
    2@ = 360.0
    
    wait 150
    
    06A9: AS_actor PLAYER_ACTOR look_at_point 986.624 -1613.13 7.41 5000 ms
    
    $SHIT_FUCK = Audiostream.Load3d("audio\sounds\music\usher_music\MISS1\ushcasket.wav")
    Audiostream.SetPosition($SHIT_FUCK,7.41, 986.624, -1613.13) //ZXY
    Audiostream.Loop($SHIT_FUCK, 0)
    Audiostream.Volume($SHIT_FUCK) = $SOUNDS_VOLUME
    Audiostream.PerformAction($SHIT_FUCK, PLAY)
    
    repeat
    wait 0
    2@ -= 2.5
    0453: set_object USHER1_SHKATULKA XY_rotation 2@ 0.0 angle 180.0
    until 2@ <= 270.0 
    
    fade 0 500
    wait 500
    
    cinema.Widescreen(1)
    0A48: enable_menu_access_in_widescreen_mode 0
        
    ////////////////////////////////////////////////////////        
    
    0A0E: disable_text_with_style 1
        
    0391: release_textures
    0390: load_txd_dictionary 'usher1' 
    wait 1
    038F: load_texture "ushphoto" as 1 // Load dictionary with 0390 first 
    wait 1    
        
    32@ = 0
    $READING_NOTE_FLAG = 1
    $SPEED_08_FLAG = 1
    
    random_int 16@ 0 to 5 
    
    if
    16@ == 0
    then
    14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll1.mp3") 
    end
        
    if
    16@ == 1
    then
    14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll2.mp3") 
    end
        
    if
    16@ == 2
    then
    14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll3.mp3") 
    end
        
    if
    16@ == 3
    then
    14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll4.mp3") 
    end
        
    if
    16@ == 4
    then
    14@ = Audiostream.Load("AUDIO\SOUNDS\PageScroll5.mp3") 
    end
           
    Audiostream.PerformAction(14@, PLAY)
    Audiostream.Volume(14@) = $SOUNDS_VOLUME
        
     repeat 
    wait 0
    03F0: enable_text_draw 1
    038D: draw_texture 1 position 320.0 224.5 size 640.0 449.0 RGBA 255 255 255 255
    03E3: set_texture_to_be_drawn_antialiased 1 
     until 0E3E: is_button_just_pressed 0 17
    
    audiostream.PerformAction(14@,STOP)
    audiostream.Release(14@)     
         
    $SPEED_08_FLAG = 0
    015D: set_gamespeed 1.0      
         
    wait 1
    03F0: enable_text_draw 0
    wait 1
    0391: release_textures 
        
    0A0E: disable_text_with_style 0
        
    //////////////////////////////////////////////////////// 
    
    $READING_NOTE_FLAG = 0    
    $SPEED_08_FLAG = 0
    
    cinema.Widescreen(0)
    BLACK_POLOSKI_ON = 1
    0A48: enable_menu_access_in_widescreen_mode 1   
        
    015D: set_gamespeed 1.0 
        
    0E69: set_player_control_pad_movement 0 1
    
    fade 1 150    
    actor.Angle(PLAYER_ACTOR) = 0.0
    camera.Restore_WithJumpCut()    
    $HUD_REMOVE = 0
    $HUD_ON_INST = 1
    
    audiostream.Release($SHIT_FUCK)
    
    v$ST_DIALOG[0] = "STR4"
    $DIALOG_COUNT = 0
    $DIALOG_NOT_SKIP = 1
    create_thread @DG_SYS2
                        
    end

return