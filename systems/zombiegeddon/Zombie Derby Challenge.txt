const
DERBY_CHECKPOINT = 15@
DERBY_CHECKPOINT_RACING = 16@
PLAYER_CHECKPOINT_NUMBER = 17@ 
ANNA_FLAG = 14@
DERBY_FALSESTART_FLAG = $CAMP_SAW_SHIT
DERBY_FLAGMAN_HANDLE = $MECHA_RESPAWN_FLAG
DERBY_FLAGMAN_OBJECT_HANDLE = $GASOLINE_OFFED_FLAG
DERBY_FLAGMAN_DEAD_FLAG = $STORY_DRIVEBY_NO_RETURN_FLAG
CARMA_DERBY_LOSS = $RNDM_HOUSE_BANKA[100]
CARMA_DERBY_LOSS_FLAG = $RNDM_HOUSE_BANKA[101]
CARMA_GLOB_CP_RUSH_BUTTHURT_LEVEL = $RNDM_HOUSE_BANKA[102]
end

const
PLAYER_RESTORE_LATEST_SAVE_X = $TRADER_A[0]
PLAYER_RESTORE_LATEST_SAVE_Y = $TRADER_A[1]
PLAYER_RESTORE_LATEST_SAVE_Z = $TRADER_A[2]
PLAYER_RESTORE_LATEST_SAVE_A1 = $TRADER_A[3]
PLAYER_RESTORE_LATEST_SAVE_A2 = $TRADER_A[4]
PLAYER_RESTORE_LATEST_SAVE_A3 = $TRADER_A[5]
PLAYER_RESTORE_LATEST_SAVE_A4 = $TRADER_A[6]
PLAYER_RESTORE_LATEST2_SAVE_X = $TRADER_A[7]
PLAYER_RESTORE_LATEST2_SAVE_Y = $TRADER_A[8]
PLAYER_RESTORE_LATEST2_SAVE_Z = $TRADER_A[9]
PLAYER_RESTORE_LATEST2_SAVE_A1 = $TRADER_A[10]
PLAYER_RESTORE_LATEST2_SAVE_A2 = $TRADER_A[11]
PLAYER_RESTORE_LATEST2_SAVE_A3 = $TRADER_A[12]
PLAYER_RESTORE_LATEST2_SAVE_A4 = $TRADER_A[13]
PLAYER_RESTORE_LATEST3_SAVE_X = $TRADER_A[14]
PLAYER_RESTORE_LATEST3_SAVE_Y = $TRADER_A[15]
PLAYER_RESTORE_LATEST3_SAVE_Z = $TRADER_A[16]
PLAYER_RESTORE_LATEST3_SAVE_A1 = $TRADER_A[17]
PLAYER_RESTORE_LATEST3_SAVE_A2 = $TRADER_A[18]
PLAYER_RESTORE_LATEST3_SAVE_A3 = $TRADER_A[19]
PLAYER_RESTORE_LATEST3_SAVE_A4 = $TRADER_X[0]
PLAYER_RESTORE_LATEST4_SAVE_X = $TRADER_X[1]
PLAYER_RESTORE_LATEST4_SAVE_Y = $TRADER_X[2]
PLAYER_RESTORE_LATEST4_SAVE_Z = $TRADER_X[3]
PLAYER_RESTORE_LATEST4_SAVE_A1 = $TRADER_X[4]
PLAYER_RESTORE_LATEST4_SAVE_A2 = $TRADER_X[5]
PLAYER_RESTORE_LATEST4_SAVE_A3 = $TRADER_X[6]
PLAYER_RESTORE_LATEST4_SAVE_A4 = $TRADER_X[7]
end

const

/////////////При раздавке зомби
CARMA_VOICE_FHAHA1 = $AMM_WEAPON[0]
CARMA_VOICE_FLAFF3 = $AMM_WEAPON[1]
CARMA_VOICE_FMESSY = $AMM_WEAPON[2]
CARMA_VOICE_FSORRY2 = $AMM_WEAPON[3]
CARMA_VOICE_FSORRY3 = $AMM_WEAPON[4]
CARMA_VOICE_FSHITHAP = $AMM_WEAPON[5]
CARMA_VOICE_FBETHRT3 = $AMM_WEAPON[6]

/////////////При ебанутой езде\полете
CARMA_VOICE_FAA02 = $AMM_WEAPON[7]
CARMA_VOICE_FAARGH3 = $AMM_WEAPON[8]
CARMA_VOICE_FAAH_WAV = $AMM_WEAPON[9]
CARMA_VOICE_FAARGH5 = $AMM_WEAPON[10]
CARMA_VOICE_FOARGH = $AMM_WEAPON[11]
CARMA_VOICE_FOHSHIT1 = $AMM_WEAPON[12]
CARMA_VOICE_FWAYHAY = $AMM_WEAPON[13]
CARMA_VOICE_FWOOHOO = $AMM_WEAPON[14]

/////////////Когда машина игрока получает урон
CARMA_VOICE_FAAH = $AMM_WEAPON[15]
CARMA_VOICE_FAH = $AMM_WEAPON[16]
CARMA_VOICE_FOOH = $AMM_WEAPON[17]
CARMA_VOICE_FOOH2 = $AMM_WEAPON[18]
CARMA_VOICE_FOW = $AMM_WEAPON[19]
CARMA_VOICE_FOW2 = $AMM_WEAPON[20]
CARMA_VOICE_FOW3 = $AMM_WEAPON[21]
CARMA_VOICE_FURGH2 = $AMM_WEAPON[22]

/////////////Ну хуй его знает
CARMA_VOICE_FALRITE2 = $AMM_WEAPON[23]
CARMA_VOICE_FALRITE3 = $AMM_WEAPON[24]

/////////////При смерти ГГ
CARMA_VOICE_FDEAD = $AMM_WEAPON[25]

/////////////Когда игрока таранит какая-то машина
CARMA_VOICE_FGETCHA = $AMM_WEAPON[26]
CARMA_VOICE_FGODDAM = $AMM_WEAPON[27]
CARMA_VOICE_FGRR4 = $AMM_WEAPON[28]
CARMA_VOICE_FGRR7 = $AMM_WEAPON[29]
CARMA_VOICE_FMUTHA = $AMM_WEAPON[30]
CARMA_VOICE_FHURT1 = $AMM_WEAPON[31]
CARMA_VOICE_FSUMVA = $AMM_WEAPON[32]

/////////////Скрежет металла
CARMA_VOICE_METAL1 = $AMM_WEAPON[33]
CARMA_VOICE_METAL2 = $AMM_WEAPON[34]
CARMA_VOICE_METAL3 = $AMM_WEAPON[35]
CARMA_VOICE_METAL4 = $AMM_WEAPON[36]
CARMA_VOICE_METAL5 = $AMM_WEAPON[37]
CARMA_VOICE_METAL6 = $AMM_WEAPON[38]
CARMA_VOICE_METAL7 = $AMM_WEAPON[39]

/////////////Звук давки зомби
CARMA_VOICE_BIGHIT02 = $AMM_WEAPON[40]
CARMA_VOICE_BIGHIT03 = $AMM_WEAPON[41]

/////////////Звуки интерфейса
CARMA_VOICE_BUTT = $AMM_WEAPON[42]
CARMA_VOICE_DONE = $AMM_WEAPON[43]
CARMA_VOICE_FART = $FRA_WEAP_SKILL

/////////////Звуки подбирания пикапа
CARMA_VOICE_BONUS = $AMM_WEAPON[44]
CARMA_VOICE_FINALLAP = $AMM_WEAPON[45]

/////////////Звуки обгона соперников
CARMA_VOICE_FYEAH1 = $AMM_WEAPON[46]
CARMA_VOICE_FYEAH2 = $AMM_WEAPON[47]
CARMA_VOICE_FYEAH3 = $AMM_WEAPON[48]
CARMA_VOICE_FYEAH4 = $AMM_WEAPON[49]  
end

:DRB_ZOM
thread 'DRB_ZOM'

0629: change_integer_stat 252 to 8
0AF1: write_int 8 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_NUMBER"
0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_PARAM"

if
ZOMBEGEDDON_TOURNAMENT == 0
then
ZOMBIEGEDDON_GAMESPEED_MULT = 1.0
else
ZOMBIEGEDDON_GAMESPEED_MULT = 0.7
end

if and
UNITED_MAP == 0
CLASSIC_CARMA_MAP < 1
then
0777: delete_objects_in_object_group "fortpost"
0777: delete_objects_in_object_group "worldxref"
0777: delete_objects_in_object_group "ladders"
0777: delete_objects_in_object_group "APGates"
0777: delete_objects_in_object_group "observatory"
0777: delete_objects_in_object_group "lsmall"
0777: delete_objects_in_object_group "treehouse"
0777: delete_objects_in_object_group "zombtech"
0777: delete_objects_in_object_group "cult_farm"
0777: delete_objects_in_object_group "extraresc"
0777: delete_objects_in_object_group "emmet"
0777: delete_objects_in_object_group "eastereggs"
0777: delete_objects_in_object_group "hideout9"
0777: delete_objects_in_object_group "hideout8"
0777: delete_objects_in_object_group "hideout7"
0777: delete_objects_in_object_group "hideout6"
0777: delete_objects_in_object_group "hideout5"
0777: delete_objects_in_object_group "hideout4"
0777: delete_objects_in_object_group "hideout3"
0777: delete_objects_in_object_group "hideout1"
0777: delete_objects_in_object_group "banditSF"
0777: delete_objects_in_object_group "banditLV"
0777: delete_objects_in_object_group "banditLV2"
0777: delete_objects_in_object_group "banditLS"
0777: delete_objects_in_object_group "banditCN"
0777: delete_objects_in_object_group "armyLV"
0777: delete_objects_in_object_group "armySF"
0777: delete_objects_in_object_group "armyCN"
0777: delete_objects_in_object_group "armyLS"
0777: delete_objects_in_object_group "cmp14"
0777: delete_objects_in_object_group "cmp13"
0777: delete_objects_in_object_group "cmp12"
0777: delete_objects_in_object_group "cmp11"
0777: delete_objects_in_object_group "cmp10"
0777: delete_objects_in_object_group "cmp9"
0777: delete_objects_in_object_group "cmp8"
0777: delete_objects_in_object_group "cmp7"
0777: delete_objects_in_object_group "cmp6"
0777: delete_objects_in_object_group "cmp5"
0777: delete_objects_in_object_group "cmp4"
0777: delete_objects_in_object_group "cmp3"
0777: delete_objects_in_object_group "cmp2"
0777: delete_objects_in_object_group "cmp1"
0777: delete_objects_in_object_group "cmp0"
0777: delete_objects_in_object_group "trdr14"
0777: delete_objects_in_object_group "trdr13"
0777: delete_objects_in_object_group "trdr12"
0777: delete_objects_in_object_group "trdr11"
0777: delete_objects_in_object_group "trdr10"
0777: delete_objects_in_object_group "trdr9"
0777: delete_objects_in_object_group "trdr8"
0777: delete_objects_in_object_group "trdr7"
0777: delete_objects_in_object_group "trdr6"
0777: delete_objects_in_object_group "trdr5"
0777: delete_objects_in_object_group "trdr4"
0777: delete_objects_in_object_group "trdr3"
0777: delete_objects_in_object_group "trdr2"
0777: delete_objects_in_object_group "trdr1"
0777: delete_objects_in_object_group "trdr0"
end

if
CLASSIC_CARMA_MAP >= 1
then
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG = 1
else
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG = 0
end

0A48: enable_menu_access_in_widescreen_mode 0
0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"

create_thread @DRB_BDR

if
ZOMBEGEDDON_TOURNAMENT == 1
then
0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
0AF1: write_int -1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_TOURNAMENT"
0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"
0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"

if and
not ZOMBIEGEDDON_GAME_TYPE == 2
CLASSIC_CARMA_MAP == 1
then
0AD3: v$FP_FILE = format "RACE%d" 0@
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "data\derby_Tournament.ini" section v$FP_FILE key "RACENUM"
if
CARMA_GLOB_RACE_NUMBER_T == 53
    then
    0@ += 1
    0AF1: write_int 0@ to_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    end
end

0629: change_integer_stat 268 to 0@
0@ += 1
0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"
0@ += 1
0629: change_integer_stat 269 to 0@
create_thread @PLD_TM5

//Умножаем скорость игры
if and
0@ > 0
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
    then
    0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"
    0093: 0@ = integer 0@ to_float
    1@ = 0.25
    0073: 1@ /= 0@ // (float)
    
    0AF0: 2@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_COMPLETED"
    0093: 2@ = integer 2@ to_float
    006B: 1@ *= 2@  // (float)
    
    005F: ZOMBIEGEDDON_GAMESPEED_MULT += 1@  // (float)
    end
    
end

create_thread @PLD_TM6

if
CARMA_GLOB_MAP_NABOR == -1
then
0AF0: CARMA_GLOB_MAP_NABOR = get_int_from_ini_file "saves\ZACM.set" section "SCR" key "CARMA_CLASSIC_MAP_NABOR"
end

if
CLASSIC_CARMA_MAP_AC_MODE == 1
then
CARMA_GLOB_MAP_NABOR = 0
end

if
CARMA_GLOB_MAP_NABOR == 0
then

if
not CLASSIC_CARMA_MAP_AC_MODE == 1
then
CARMA_GLOB_MAP_NABOR_TOTAL_MAPS = 35
else
CARMA_GLOB_MAP_NABOR_TOTAL_MAPS = 29
end

0AF1: write_int CARMA_GLOB_MAP_NABOR to_ini_file "saves\ZACM.set" section "SCR" key "CARMA_CLASSIC_MAP_NABOR"
end

if
CARMA_GLOB_MAP_NABOR == 1
then
CARMA_GLOB_MAP_NABOR_TOTAL_MAPS = 20
0AF1: write_int CARMA_GLOB_MAP_NABOR to_ini_file "saves\ZACM.set" section "SCR" key "CARMA_CLASSIC_MAP_NABOR"
end

if
CARMA_GLOB_MAP_NABOR == 2
then
CARMA_GLOB_MAP_NABOR_TOTAL_MAPS = 28
0AF1: write_int CARMA_GLOB_MAP_NABOR to_ini_file "saves\ZACM.set" section "SCR" key "CARMA_CLASSIC_MAP_NABOR"
end

$ALLOW_HAZMAT_ZOMBIE = 0
$ALLOW_PLAYER_SLOWMOTION = 0

$SAVESTATUS = 1
actor.LockInCurrentPosition(PLAYER_ACTOR,true)

if
CARMA_REPLAY_FLAG == 0
then
gosub @DERBY_RANDOM_PLAYER_MODEL
else

0AF0: $RANDOM_MODE_MODEL = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "INFO" key "ACTOR_MODEL"

model.Load($RANDOM_MODE_MODEL)
mload

09C7: change_player PLAYER_CHAR model_to $RANDOM_MODE_MODEL

0D10: set_actor PLAYER_ACTOR alpha 255 // IF and SET

v$NAME1 = "N_ME" // v$ // Sunday
0665: get_actor PLAYER_ACTOR model_to 1@
if
1@ > 10000
then
v$NAME2 = "N_" // v$ // Sunday
end
0AD3: v$NAME2 = format "%d" 1@
098B: v$NAME3 = v$NAME1 + v$NAME2 // all string variables

if
FREEMODE_CUSTOM_NAME == 1 
then
06D1: v$NAME3 = "F_NAME" // v$ = string
end
    
3@ = 0

end

0665: get_actor PLAYER_ACTOR model_to 0@
0AD3: v$EDITOR_FILE = format "%d" 0@
0AF0: 0@ = get_int_from_ini_file "data\skins.ini" section "FEMALE" key v$EDITOR_FILE

if
0@ == 1
then
ANNA_FLAG = 1
else
ANNA_FLAG = 0
end

for 0@ = 0 to 14
$PARK_CAR_DAMAGED[0@] = 0
end

CARMA_GLOB_RACE_SELECTED = 0
gosub @CARMA_GET_RACE_NUMBER_FIRST
CARMA_GLOB_PICTURE_OFF = 1
create_thread @PRATCAM
CARMA_GLOB_PLAYER_MODEL = 0

if
UNITED_MAP == 1
then
create_thread @ULOD2
end

//Выключаем сообщение про кинематографическую камеру
0A8C: write_memory 0x08CC381 size 1 value 0 virtual_protect 1

gosub @CARMA_LOAD_SOUNDS

$ONMISSION = 1

07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0
0629: change_integer_stat 229 to 1000

0662: printstring "----------Don't Burn Flipped Cars by LINK/2012----------"
0A8C: write_memory 0x6A776B size 2 value 0xD8DD virtual_protect 1
0A8C: write_memory 0x6A776D size 4 value 0x90909090 virtual_protect 1
0A8C: write_memory 0x570E7F size 2 value 0xD8DD virtual_protect 1
0A8C: write_memory 0x570E81 size 4 value 0x90909090 virtual_protect 1

0662: printstring "----------Low Mass Peds by Junior_Djjr----------"
if
ZOMBIEGEDDON_GAME_TYPE == 3
then
0A8C: write_memory 0x8D22A8 size 4 value -0.1 virtual_protect 0 
else
0A8C: write_memory 0x8D22A8 size 4 value 0.0 virtual_protect 0
end
0A8C: write_memory 0x8D22AC size 4 value 0.0 virtual_protect 0
0A8C: write_memory 0x8D22A4 size 4 value 0.0 virtual_protect 0

//Нитро у всех машин
if and
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
then
0A8C: write_memory 0x969165 size 1 value 1 virtual_protect 0
end

//Мощность нитро
if
ZOMBIEGEDDON_GAME_TYPE == 2
then
0A8C: write_memory 0x08D348C size 4 value 0.2 virtual_protect 0 //TRANSMISSION_NITROS_INERTIA_MULT
else
0A8C: write_memory 0x08D348C size 4 value 0.6 virtual_protect 0 //TRANSMISSION_NITROS_INERTIA_MULT
end

//Выключаем то, что боты пытаются объезжать педов
0E6A: make_nop 0x04328A2 size 5

//Выключаем то, что боты пытаются объезжать транспорт
if
not ZOMBIEGEDDON_GAME_TYPE == 2
then
0E6A: make_nop 0x04328E7 size 5
0E6A: make_nop 0x0432870 size 5
end

//Включаем отвал колес
if
not ZOMBIEGEDDON_GAME_TYPE == 2
then
0EFE: get_loaded_library "WheelDetach.SA.asi" store_to 0@
0@ += 0x479B8
0A8C: write_memory 0@ size 4 value 1000.0 virtual_protect 0
0EFE: get_loaded_library "WheelDetach.SA.asi" store_to 0@
0@ += 0x479A0
0A8C: write_memory 0@ size 4 value -0.5 virtual_protect 0
end

if
ZOMBIEGEDDON_GAME_TYPE == 3
then
$HAZMAT_TIMER_MIN = 25000
$HAZMAT_TIMER_MAX = 30000
random_int $HAZMAT_TIMER_SET $HAZMAT_TIMER_MIN $HAZMAT_TIMER_MAX
$HOLD_Z_TASK_SET = 300.0
end

057E: set_radar_grey 0

for 1@ = 0xBA3714 to 0xBA376F    
0A8C: write_memory 1@ size 1 value 1 virtual_protect 0
end

0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_STARTED" 

camera.Restore_WithJumpCut()

create_thread @ACQUAIN
create_thread @LOW_HEA 
create_thread @BCKP_CA
create_thread @WND_STR
create_thread @WEP_DAM 

wait 1

create_thread @C_AMB
create_thread @W_AMB
create_thread @USR_TAP  

if and
UNITED_MAP == 0
CLASSIC_CARMA_MAP < 1
then
0777: delete_objects_in_object_group "gatesC" 
end

$FPS_COUNTER_ENABLED = 0

$ZOMBIE_JUMP_TIMER = 3000

$PLAYER_SURVIVOR_SIDE = 1

$ZOMBIE_RUN_SPEED = 1.025
$ZOMBIE_PREFIGHT_SPEED = 1.025
$ZOMBIE_ATTACK_SPEED = 1.025

$ZOMBIE_HEADSHOT = 0
$ZOMBIES_ALWAYS_VISIBLE = 0

for 1@ = 0xBA3714 to 0xBA376F    
0A8C: write_memory 1@ size 1 value 1 virtual_protect 0
end

random_float 1@ 0.0 999.9
062A: change_float_stat 69 to 1@
random_float 1@ 0.0 999.9
062A: change_float_stat 70 to 1@
random_float 1@ 0.0 999.9
062A: change_float_stat 71 to 1@
random_float 1@ 0.0 999.9
062A: change_float_stat 72 to 1@
random_float 1@ 0.0 999.9
062A: change_float_stat 73 to 1@
random_float 1@ 0.0 999.9
062A: change_float_stat 74 to 1@  
random_float 1@ 0.0 999.9
062A: change_float_stat 75 to 1@ 
random_float 1@ 0.0 999.9 
062A: change_float_stat 76 to 1@
random_float 1@ 0.0 999.9
062A: change_float_stat 77 to 1@
random_float 1@ 0.0 999.9
062A: change_float_stat 78 to 1@
random_float 1@ 0.0 999.9
062A: change_float_stat 79 to 1@

0489: set_actor PLAYER_ACTOR muted 1

$ZOMBIE_DERBY_FLAG = 1
SURVIVAL_STARTED_FULLY_FLAG = 1
$NOTSPAWN_CARS = 1
$SPECIAL_INFECTED_NOT_SPAWN_FLAG = 1
$ZOMBIE_SET_PEDTYPE = 4
$ZOMBIES_COUNT = 20
$ZOMBIES_HORDE = 1
CARMA_GLOB_OPPONENT_HP = 100
$INT_ZMB_NOT = 1

:RACE_START_SEARCH

for 29@ = 0 to 99

if or
not $UNITED_VC_FLAG == 1
UNITED_MAP == 0
then
0AD3: v$EDITOR_FILE = format "RACE%d" 29@
else
0AD3: v$EDITOR_FILE = format "2RACE%d" 29@
end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AF0: 31@ = get_int_from_ini_file "data/derby.ini" section v$EDITOR_FILE key "TOTAL_CHECKPOINTS"
else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AF0: 31@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "TOTAL_CHECKPOINTS"
else
0AF0: 31@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "TOTAL_CHECKPOINTS"
end

end

if
not 31@ < -1
    then    
    else
    29@ -= 1
    break
    end

end

if or
not $UNITED_VC_FLAG == 1
UNITED_MAP == 0
then
0AD3: v$EDITOR_FILE = format "RACE%d" CARMA_GLOB_RACE_NUMBER
else
0AD3: v$EDITOR_FILE = format "2RACE%d" CARMA_GLOB_RACE_NUMBER
end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AF0: 2@ = get_int_from_ini_file "data/derby.ini" section v$EDITOR_FILE key "LAPS"
else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AF0: 2@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "LAPS"
else
0AF0: 2@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "LAPS"
end

end

if
UNITED_MAP == 0
then

if
2@ < -1
then
jump to @RACE_START_SEARCH
end

end

008A: CARMA_GLOB_RACES_TOTAL = 29@ // (int)
if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
008A: CARMA_GLOB_MAP_NABOR_TOTAL_MAPS = 29@ // (int)
end

cinema.Radar(0)
cinema.Widescreen(1)
gosub @RACE_SELECT
0629: change_integer_stat 279 to 1
cinema.Radar(1)
cinema.Widescreen(0)

if
not ZOMBIEGEDDON_GAME_TYPE == 2
then

0A8D: 0@ = read_memory 0xC2B9BC size 4 virtual_protect 0 //Handling Max Speed Mult
006F: 0@ *= ZOMBIEGEDDON_GAMESPEED_MULT // (float)
0A8C: write_memory 0xC2B9BC size 4 value 0@ virtual_protect 0

0A8D: 0@ = read_memory 0x0C2B9B4 size 4 virtual_protect 0 //Handling Acc Speed Mult
006F: 0@ *= ZOMBIEGEDDON_GAMESPEED_MULT // (float)
0A8C: write_memory 0x0C2B9B4 size 4 value 0@ virtual_protect 0

0A8D: 0@ = read_memory 0x05BFA96 size 4 virtual_protect false
0AA6: call_method 0x5BD830 cHandlingDataMgr::LoadHandlingData struct 0@ num_params 0 pop 0

end

gosub @ZOMBIEGEDDON_DO_BURNOUT_ON

if
$SPECTATING_FLAG == 1
    then
    
    CARMA_GLOB_OPPONENTS_COUNT += 1
    if
    CARMA_GLOB_OPPONENTS_COUNT > 75
        then
        CARMA_GLOB_OPPONENTS_COUNT = 75
        end
    
    0084: CARMA_GLOB_OPPONENTS_COUNT2 = CARMA_GLOB_OPPONENTS_COUNT // (int)
    CARMA_GLOB_OPPONENTS_COUNT2 += 1
    0084: CARMA_GLOB_OPPONENTS_COUNT3 = CARMA_GLOB_OPPONENTS_COUNT // (int)
    CARMA_GLOB_OPPONENTS_COUNT3 -= 1
    
    end

////////////////////////////////////////////////////////

start_mission 21

repeat
wait 0
until not CARMA_GLOB_PLAYER_MODEL == 0

gosub @ZOMBIE_DERBY_CREATE_CAR_FOR_PLAYER

if and
$SPECTATING_FLAG == 1
not CARMA_REPLAY_FLAG == 1
then
car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,false)
end
036A: put_actor PLAYER_ACTOR in_car CARMA_GLOB_DERBY_PLAYER_CAR
0840: link_car CARMA_GLOB_DERBY_PLAYER_CAR to_interior CARMA_GLOB_RACE_INTERIOR

repeat
wait 0

008B: 0@ = CARMA_GLOB_OPPONENTS_COUNT3 // (int)

if and
056E:   car $PARK_CAR[CARMA_GLOB_OPPONENTS_COUNT3] defined
not CARMA_REPLAY_FLAG == 1
    then
    break
    end
    
if and
056E:   car $PARK_CAR[8] defined
CARMA_REPLAY_FLAG == 1
    then
    break
    end   

until false

////////////////////////////////////////////////////////

for 0@ = 0 to CARMA_GLOB_OPPONENTS_COUNT3

create_thread @DRB_CAR 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0@

if
ZOMBIEGEDDON_GAME_TYPE == 2
then
create_thread @DRB_REC 0 0 0 0 0 0 0 0 0 0@
end

for 1@ = 0 to CARMA_GLOB_OPPONENTS_COUNT3
create_thread @CRMDMG 0@ 1@

end

end

////////////////////////////////////////////////////////

if
ZOMBIEGEDDON_GAME_TYPE == 2
then
create_thread @DRB_REC 0 0 0 0 0 0 0 0 0 9
end

if
ZOMBIEGEDDON_GAME_TYPE == 2
then
create_thread @CPR_TMR
end

CARMA_GLOB_PICTURE_OFF = 1

create_thread @F_PERS

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AF0: 2@ = get_int_from_ini_file "data/derby.ini" section v$EDITOR_FILE key "LAPS"
else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AF0: 2@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "LAPS"
else
0AF0: 2@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "LAPS"
end

end

if and
CARMA_GLOB_RACE_NUMBER == 3
UNITED_MAP == 0
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0750: set_object $LS_2GATE1 visibility 0
0382: set_object $LS_2GATE1 collision_detection 0
0750: set_object $LS_2GATE2 visibility 0
0382: set_object $LS_2GATE2 collision_detection 0
0750: set_object $LS_3GATE1 visibility 0
0382: set_object $LS_3GATE1 collision_detection 0
0750: set_object $LS_3GATE2 visibility 0
0382: set_object $LS_3GATE2 collision_detection 0
end  

if and
UNITED_MAP == 0
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
$ALLOW_SURVIVERS_CAMP = 0
$ALLOW_TRADERS = 0
create_thread @GTS_SWT
end                                             

CARMA_GLOB_OPPONENTS_WRECKED = 0
CARMA_GLOB_DERBY_KILLED_PLAYER = 0

0627: update_integer_stat 121 to 0

if or
not $UNITED_VC_FLAG == 1
UNITED_MAP == 0
then
0AD3: v$RACE_FILE = format "RACE%d" CARMA_GLOB_RACE_NUMBER
else
0AD3: v$RACE_FILE = format "2RACE%d" CARMA_GLOB_RACE_NUMBER
end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AF2: 1@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_X" 
0AF2: 2@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_Y" 
0AF2: 3@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_Z" 
0AF2: 4@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_A"
else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AF2: 1@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_X" 
0AF2: 2@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_Y" 
0AF2: 3@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_Z" 
0AF2: 4@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_A"
else
0AF2: 1@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_X" 
0AF2: 2@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_Y" 
0AF2: 3@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_Z" 
0AF2: 4@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_A"
end

end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AF0: CARMA_GLOB_RACE_TOTAL_CHECKPOINTS = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "TOTAL_CHECKPOINTS"
0AF0: CARMA_GLOB_RACE_TOTAL_LAPS = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "LAPS"
0AF0: CARMA_GLOB_RACE_TOTAL_ZOMBIES = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "TOTAL_ZOMBIES"
0AF0: CARMA_GLOB_RACE_INTERIOR = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "RACE_INTERIOR"
0AF0: CARMA_GLOB_RACE_STRGHT = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "STRAIGHT_CONNECT"
0AF0: CARMA_GLOB_TWO_CARRECS = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "SECOND_CARREC"
0AF2: CARMA_GLOB_CARREC_X = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "CARREC_X"
0AF2: CARMA_GLOB_CARREC_Y = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "CARREC_Y"
0AF2: CARMA_GLOB_CARREC_Z = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "CARREC_Z"
0AF0: CARMA_GLOB_TIME_MULT = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "TIME_MULT"
0AF0: CARMA_GLOB_FREEROAM_DR = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "FREEROAM_DRIVING"
0AF0: CARMA_GLOB_ZINT_FLAG_NRM = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "USUAL_ZOMBIE_SPAWN"
0AF0: CARMA_GLOB_LOS_VOICE_MAN = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "LOS_VOICE_FLAG"
0AF2: CARMA_GLOB_CARREC_PATH_SPEED = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "CARREC_SPEED_MULT"
0AF0: CARMA_GLOB_NO_NITRO_FLAG = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "NO_NITRO"
0AF0: CARMA_GLOB_FREEROAM_ALT_FLAG = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "CARMA_GLOB_FREEROAM_ALT_FLAG"
0AF0: CARMA_GLOB_DO_NOT_ALLIGN_Z_LEVEL = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "DO_NOT_ALLIGN_Z_LEVEL"

if
not CARMA_GLOB_RACE_STRGHT == 1
then
CARMA_GLOB_RACE_STRGHT = 0
end 

if
CARMA_GLOB_CARREC_PATH_SPEED < 0.5
then
CARMA_GLOB_CARREC_PATH_SPEED = 1.0
end

else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AF0: CARMA_GLOB_RACE_TOTAL_CHECKPOINTS = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "TOTAL_CHECKPOINTS"
0AF0: CARMA_GLOB_RACE_TOTAL_LAPS = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "LAPS"
0AF0: CARMA_GLOB_RACE_TOTAL_ZOMBIES = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "TOTAL_ZOMBIES"
0AF0: CARMA_GLOB_RACE_INTERIOR = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "RACE_INTERIOR"
0AF0: CARMA_GLOB_RACE_STRGHT = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "STRAIGHT_CONNECT"
0AF0: CARMA_GLOB_TWO_CARRECS = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SECOND_CARREC"
0AF2: CARMA_GLOB_CARREC_X = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARREC_X"
0AF2: CARMA_GLOB_CARREC_Y = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARREC_Y"
0AF2: CARMA_GLOB_CARREC_Z = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARREC_Z"
0AF0: CARMA_GLOB_TIME_MULT = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "TIME_MULT"
0AF0: CARMA_GLOB_FREEROAM_DR = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "FREEROAM_DRIVING"
0AF0: CARMA_GLOB_ZINT_FLAG_NRM = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "USUAL_ZOMBIE_SPAWN"
0AF0: CARMA_GLOB_LOS_VOICE_MAN = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "LOS_VOICE_FLAG"
0AF2: CARMA_GLOB_CARREC_PATH_SPEED = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARREC_SPEED_MULT"
0AF0: CARMA_GLOB_NO_NITRO_FLAG = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "NO_NITRO"
0AF0: CARMA_GLOB_FREEROAM_ALT_FLAG = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARMA_GLOB_FREEROAM_ALT_FLAG"
0AF0: CARMA_GLOB_DO_NOT_ALLIGN_Z_LEVEL = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "DO_NOT_ALLIGN_Z_LEVEL"  
else
0AF0: CARMA_GLOB_RACE_TOTAL_CHECKPOINTS = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "TOTAL_CHECKPOINTS"
0AF0: CARMA_GLOB_RACE_TOTAL_LAPS = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "LAPS"
0AF0: CARMA_GLOB_RACE_TOTAL_ZOMBIES = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "TOTAL_ZOMBIES"
0AF0: CARMA_GLOB_RACE_INTERIOR = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "RACE_INTERIOR"
0AF0: CARMA_GLOB_RACE_STRGHT = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "STRAIGHT_CONNECT"
0AF0: CARMA_GLOB_TWO_CARRECS = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SECOND_CARREC"
0AF2: CARMA_GLOB_CARREC_X = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARREC_X"
0AF2: CARMA_GLOB_CARREC_Y = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARREC_Y"
0AF2: CARMA_GLOB_CARREC_Z = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARREC_Z"
0AF0: CARMA_GLOB_TIME_MULT = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "TIME_MULT"
0AF0: CARMA_GLOB_FREEROAM_DR = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "FREEROAM_DRIVING"
0AF0: CARMA_GLOB_ZINT_FLAG_NRM = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "USUAL_ZOMBIE_SPAWN"
0AF0: CARMA_GLOB_LOS_VOICE_MAN = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "LOS_VOICE_FLAG"
0AF2: CARMA_GLOB_CARREC_PATH_SPEED = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARREC_SPEED_MULT"
0AF0: CARMA_GLOB_NO_NITRO_FLAG = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "NO_NITRO"
0AF0: CARMA_GLOB_FREEROAM_ALT_FLAG = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CARMA_GLOB_FREEROAM_ALT_FLAG"
0AF0: CARMA_GLOB_DO_NOT_ALLIGN_Z_LEVEL = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "DO_NOT_ALLIGN_Z_LEVEL" 
end

if
CARMA_GLOB_CARREC_PATH_SPEED < 0.5
then
CARMA_GLOB_CARREC_PATH_SPEED = 1.0
end

if
not CARMA_GLOB_RACE_STRGHT == 1
then
CARMA_GLOB_RACE_STRGHT = 0
end

end  

select_interior CARMA_GLOB_RACE_INTERIOR
0860: link_actor PLAYER_ACTOR to_interior CARMA_GLOB_RACE_INTERIOR

if
not CARMA_GLOB_LOS_VOICE_MAN == 1
then
27@ = Audiostream.Load("audio\sounds\other\zombiegeddon\chkpoint.wav")
26@ = Audiostream.Load("audio\sounds\other\zombiegeddon\go!.wav")
else
27@ = Audiostream.Load("audio\sounds\other\zombiegeddon\CHECKP.WAV")
26@ = Audiostream.Load("audio\sounds\other\zombiegeddon\go.wav")
end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then

for 0@ = 0 to CARMA_GLOB_RACE_TOTAL_CHECKPOINTS
0AD3: v$FP_FILE = format "CP%d_X" 0@
0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Y" 0@ 
0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Z" 0@ 
0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE
end

else

for 0@ = 0 to CARMA_GLOB_RACE_TOTAL_CHECKPOINTS

if and
ZOMBIEGEDDON_GAME_TYPE == 2
CARMA_GLOB_RACE_NUMBER == 18
    then 
    
    if or
    0@ == 5
    0@ == 6
    0@ == 7
    0@ == 8
    0@ == 19
    then
    
    if
    CLASSIC_CARMA_MAP_AC_MODE == 0
    then
    0AD3: v$FP_FILE = format "CP%dB_X" 0@
    0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%dB_Y" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%dB_Z" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    else
    0AD3: v$FP_FILE = format "CP%dB_X" 0@
    0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%dB_Y" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%dB_Z" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    end
    
    else
    
    if
    CLASSIC_CARMA_MAP_AC_MODE == 0
    then
    0AD3: v$FP_FILE = format "CP%d_X" 0@
    0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%d_Y" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%d_Z" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    else
    0AD3: v$FP_FILE = format "CP%d_X" 0@
    0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%d_Y" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%d_Z" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    end
    
    end
    
    else
    
    if
    CLASSIC_CARMA_MAP_AC_MODE == 0
    then
    0AD3: v$FP_FILE = format "CP%d_X" 0@
    0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%d_Y" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%d_Z" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    else
    0AD3: v$FP_FILE = format "CP%d_X" 0@
    0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%d_Y" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    0AD3: v$FP_FILE = format "CP%d_Z" 0@ 
    0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
    end
    
    end
    
    end

end       

PLAYER_CHECKPOINT_NUMBER = 0
LAP_NUMBER = 1

actor.PutAtNoOffset(PLAYER_ACTOR,1@,2@,3@)
actor.Angle(PLAYER_ACTOR) = 4@
renderer 1@ 2@ 
renderer2 1@ 2@ 3@
camera.Restore_WithJumpCut()

if
CARMA_REPLAY_FLAG == 0
then
gosub @DERBY_RANDOM_TIME
else
0AF0: 1@ = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "GAMEINFO" key "CURRENT_HOUR"
0AF0: 2@ = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "GAMEINFO" key "CURRENT_MINUTE"
00C0: set_current_time_hours_to 1@ minutes_to 2@
end

camera.Restore_WithJumpCut()

create_thread @REFR_3D
$WEATHER_SYNC_FLAG = 1
0084: $VERSUS_PEOPLE[9] = CARMA_GLOB_DERBY_PLAYER_CAR // (int)

gosub @CHECK_CARMA2_RESOURCES_CHANGE_AND_BACK
gosub @CARMAGEDDON_CREATE_BINARY_IPLS

repeat
wait 0
gosub @DISTANCE_CALCULATE_PLAYER
until CARMA_GLOB_PICTURE_FLAG == 0

$SAVESTATUS = 0
CARMA_GLOB_RACE_STARTED = 0
cinema.Widescreen(0)

if and
$SPECTATING_FLAG == 1
not CARMA_REPLAY_FLAG == 1
then
0338: set_car CARMA_GLOB_DERBY_PLAYER_CAR visibility 0
0337: set_actor PLAYER_ACTOR visibility 0
0619: enable_actor PLAYER_ACTOR collision_detection 0
099A: set_car CARMA_GLOB_DERBY_PLAYER_CAR collision_detection 0
car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,1@,2@,3@)
create_thread @SPECTAT

repeat
wait 0
0084: $SPEC_ACTOR = $PARK_CAR_DAMAGED[CARMA_GLOB_OPPONENTS_COUNT3] // (int)
until 056D:   actor $SPEC_ACTOR defined

CARMA_GLOB_DERBY_PLAYER_CAR = actor.CurrentCar($SPEC_ACTOR)
04C4: store_coords_to 4@ 5@ 6@ from_actor PLAYER_ACTOR with_offset 0.0 0.0 50.0
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 4@ 5@ 6@
0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position 1@ 2@ 3@
0430: put_actor PLAYER_ACTOR into_car CARMA_GLOB_DERBY_PLAYER_CAR passenger_seat 0
camera.Restore_WithJumpCut()
player.CanMove(PLAYER_CHAR) = true
car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,false)
0840: link_car CARMA_GLOB_DERBY_PLAYER_CAR to_interior $ACTIVE_INTERIOR
end

if
CARMA_REPLAY_FLAG == 1
then
0337: set_actor PLAYER_ACTOR visibility 0
0619: enable_actor PLAYER_ACTOR collision_detection 0
04C4: store_coords_to 1@ 2@ 3@ from_actor PLAYER_ACTOR with_offset 0.0 0.0 50.0
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 1@ 2@ 3@
0665: get_actor PLAYER_ACTOR model_to 1@

while not model.Available(#MALE01)
wait 0
model.Load(#MALE01)
mload
end

09C7: change_player PLAYER_CHAR model_to #MALE01
$PARK_CAR_DAMAGED[9] = actor.CreateAsDriver(26,1@,CARMA_GLOB_DERBY_PLAYER_CAR)
08AF: set_actor $PARK_CAR_DAMAGED[9] max_health_to 1000
Actor.Health($PARK_CAR_DAMAGED[9]) = 10000
Actor.SetWalkStyle($PARK_CAR_DAMAGED[9], "surv5")
0446: set_actor $PARK_CAR_DAMAGED[9] dismemberment_possible 0
060B: set_actor $PARK_CAR_DAMAGED[9] decision_maker_to $DEC_PEOPLE
07DD: set_actor $PARK_CAR_DAMAGED[9] attack_rate 80 // previously known as temper_to 
0946: set_actor $PARK_CAR_DAMAGED[9] actions_uninterupted_by_weapon_fire 1
081A: set_actor $PARK_CAR_DAMAGED[9] weapon_skill_to 2
04D8: set_actor $PARK_CAR_DAMAGED[9] drowns_in_water 0
09F6: set_actor $PARK_CAR_DAMAGED[9] get_out_of_upside_down_car 0
0982: set_actor $PARK_CAR_DAMAGED[9] stay_in_car_when_dead 1
0D10: set_char_model_alpha $PARK_CAR_DAMAGED[9] alpha 255
0337: set_actor $PARK_CAR_DAMAGED[9] visibility 1
$PARK_CAR_ENGINE[9] = 69000
create_thread @SPECTAT
0084: $SPEC_ACTOR = $PARK_CAR_DAMAGED[9] // (int)
end

if or
ZOMBIEGEDDON_GAME_TYPE == 2
ZOMBIEGEDDON_GAME_TYPE == 3
then
03AB: set_car CARMA_GLOB_DERBY_PLAYER_CAR strong 1
end

if and
$SPECTATING_FLAG == 0
ZOMBIEGEDDON_GAME_TYPE == 2
not CARMA_GLOB_NO_NITRO_FLAG == 1
then
09E9: car CARMA_GLOB_DERBY_PLAYER_CAR add_single_nitro
end

while not animation.Available("CAR")
wait 0
animation.Load("CAR")
end

008B: 0@ = CARMA_GLOB_OPPONENTS_COUNT3 // (int)
if and
$SPECTATING_FLAG == 1
not CARMA_REPLAY_FLAG == 1
then
0@ -= 1
end

if
CARMA_REPLAY_FLAG == 1
then
0@ -= 1
end

4@ = car.Angle($PARK_CAR[0@])
4@ -= 180.0
0407: store_coords_to 1@ 2@ 3@ from_car $PARK_CAR[0@] with_offset 2.7 6.5755 0.05

/////////////////////////////////////////////////////

if
UNITED_MAP == 0
then
0@ = #MALE01
else

if
STORIES_MAP == 0
then

if
$UNITED_III_SPAWN == 1
then
0@ = 15871
else
0@ = 15734
end

else

if
$UNITED_III_SPAWN == 1
then
0@ = 15760
else
0@ = 16876
end

end

end

/////////////////////////////////////////////////////

while not model.Available(0@)
wait 0
model.Load(0@)
mload
end

DERBY_FLAGMAN_HANDLE = actor.Create(26,0@,1@,2@,3@)
0E32: set_char_coordinates_simple DERBY_FLAGMAN_HANDLE coord 1@ 2@ 3@
actor.Angle(DERBY_FLAGMAN_HANDLE) = 4@  
060B: set_actor DERBY_FLAGMAN_HANDLE decision_maker_to $DEC_ZOMBIE
0860: link_actor DERBY_FLAGMAN_HANDLE to_interior $ACTIVE_INTERIOR
05C8: AS_actor DERBY_FLAGMAN_HANDLE look_around

player.CanMove(PLAYER_CHAR) = true
if or
$SPECTATING_FLAG == 0
CARMA_REPLAY_FLAG == 1
then
car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,false)

repeat
wait 0
until 8E93: not is_car_really_in_air CARMA_GLOB_DERBY_PLAYER_CAR

32@ = 0

repeat
wait 0

if and
CARMA_GLOB_PLAYER_MODEL == 15594
32@ > 500
then
32@ = 0
gosub @RECREATE_DERBY_PLAYER_CAR
036A: put_actor PLAYER_ACTOR in_car CARMA_GLOB_DERBY_PLAYER_CAR
0840: link_car CARMA_GLOB_DERBY_PLAYER_CAR to_interior CARMA_GLOB_RACE_INTERIOR
end

until 09D0:   car CARMA_GLOB_DERBY_PLAYER_CAR on_wheels

car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,true)

end  

if and
$SPECTATING_FLAG == 1
not CARMA_REPLAY_FLAG == 1
then
CARMA_GLOB_OPPONENTS_COUNT3 += 1                    
end

if and
UNITED_MAP == 0
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0@ = 2993
end

if
UNITED_MAP == 1
then
0@ = 1913
end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
then
0@ = 2993
end
  
DERBY_FLAGMAN_OBJECT_HANDLE = Object.Init(0@, 0.0, 0.0, 0.0)

//////////////////////////////////////////////////////////////////

if
CARMA_REPLAY_FLAG == 1
then

repeat
wait 0
07C0: load_path 83
until 07C1:   path 83 available

05EC: release_car CARMA_GLOB_DERBY_PLAYER_CAR from_path
05EB: assign_car CARMA_GLOB_DERBY_PLAYER_CAR to_path 83
06FD: set_car CARMA_GLOB_DERBY_PLAYER_CAR speed_on_path_to 0.0

end

//////////////////////////////////////////////////////////////////

//if
//not CARMA_REPLAY_FLAG == 1
//then
//0407: store_coords_to 1@ 2@ 3@ from_car CARMA_GLOB_DERBY_PLAYER_CAR with_offset 0.0 0.0 -1.0

//0407: store_coords_to 1@ 2@ 4@ from_car CARMA_GLOB_DERBY_PLAYER_CAR with_offset 0.0 0.0 0.0
//02CE: 4@ = ground_z_at 1@ 2@ 3@
//
//car.PutAt(CARMA_GLOB_DERBY_PLAYER_CAR,1@,2@,3@)
//0840: link_car CARMA_GLOB_DERBY_PLAYER_CAR to_interior $ACTIVE_INTERIOR
//wait 0
//if
//0E93: is_car_really_in_air CARMA_GLOB_DERBY_PLAYER_CAR
//then
//0407: store_coords_to 1@ 2@ 3@ from_car $PARK_CAR[0] with_offset 5.0 0.0 0.0
//car.PutAt(CARMA_GLOB_DERBY_PLAYER_CAR,1@,2@,3@)
//0840: link_car CARMA_GLOB_DERBY_PLAYER_CAR to_interior $ACTIVE_INTERIOR
//end

//0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position 1@ 2@ 3@
//end

create_thread @REFR_3D
$WEATHER_SYNC_FLAG = 1
wait 0

if
04C8:   actor PLAYER_ACTOR driving_flying_vehicle
    then
    car.Health(CARMA_GLOB_DERBY_PLAYER_CAR) = 10000
    end
    
if or
car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 19111
car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 15490
car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 19127
car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 18025
car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 18041
then
0397: enable_car CARMA_GLOB_DERBY_PLAYER_CAR siren 1
end           

fade 1 1000
$HUD_REMOVE = 0
wait 1000

car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,PLAYER_RESTORE_LATEST_SAVE_X,PLAYER_RESTORE_LATEST_SAVE_Y,PLAYER_RESTORE_LATEST_SAVE_Z)
07C5: get_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST_SAVE_A1 PLAYER_RESTORE_LATEST_SAVE_A2 PLAYER_RESTORE_LATEST_SAVE_A3 PLAYER_RESTORE_LATEST_SAVE_A4
car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,PLAYER_RESTORE_LATEST2_SAVE_X,PLAYER_RESTORE_LATEST2_SAVE_Y,PLAYER_RESTORE_LATEST2_SAVE_Z)
07C5: get_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST2_SAVE_A1 PLAYER_RESTORE_LATEST2_SAVE_A2 PLAYER_RESTORE_LATEST2_SAVE_A3 PLAYER_RESTORE_LATEST2_SAVE_A4    
car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,PLAYER_RESTORE_LATEST3_SAVE_X,PLAYER_RESTORE_LATEST3_SAVE_Y,PLAYER_RESTORE_LATEST3_SAVE_Z)
07C5: get_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST3_SAVE_A1 PLAYER_RESTORE_LATEST3_SAVE_A2 PLAYER_RESTORE_LATEST3_SAVE_A3 PLAYER_RESTORE_LATEST3_SAVE_A4
car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,PLAYER_RESTORE_LATEST4_SAVE_X,PLAYER_RESTORE_LATEST4_SAVE_Y,PLAYER_RESTORE_LATEST4_SAVE_Z)
07C5: get_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST4_SAVE_A1 PLAYER_RESTORE_LATEST4_SAVE_A2 PLAYER_RESTORE_LATEST4_SAVE_A3 PLAYER_RESTORE_LATEST4_SAVE_A4

0AF0: $STATS_MINUTES_PLAYED = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "DERBY_MINUTES_PLAYED" 
0AF0: $STATS_HOURS_PLAYED = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "DERBY_HOURS_PLAYED"
if and
$STATS_MINUTES_PLAYED < 19
not $STATS_HOURS_PLAYED > 0
not $SPECTATING_FLAG == 1
then
if
8A4B: not  controls_set_to_joystick
    then
    text.ShowH('HINT8',10000,1)
    else
    text.ShowH('HINT8b',10000,1)
    end
end  

Audiostream.Volume(21@) = $SOUNDS_VOLUME
Audiostream.PerformAction(21@, PLAY)
32@ = 0

while 32@ < 1000
wait 0

{$I Zombie Derby Challenge Falsestart Check.txt}

gosub @DISTANCE_CALCULATE_PLAYER

if
$SPECTATING_FLAG == 1
then
gosub @PORTRAIT_RELOAD_CHECK
//093D: lock_camera_on_cinematic_view 1
09AD: set_vehicle_camera_mode 5
//0A8C: write_memory 0xB6F0DC size 1 value 5 virtual_protect 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 2.0 4.0
0340: set_text_draw_RGBA 255 255 255 $HUD_ALPHA
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B $HUD_ALPHA
end
 
045B: draw_text_2numbers 300.0 200.0 GXT 'CRM9' numbers 5 5
end

32@ = 0

Audiostream.Volume(22@) = $SOUNDS_VOLUME  
Audiostream.PerformAction(22@, PLAY)

0@ = 0

while 32@ < 1000
wait 0

if and
32@ > 500
0@ == 0
then
0@ = 1
070A: AS_actor DERBY_FLAGMAN_HANDLE attach_to_object DERBY_FLAGMAN_OBJECT_HANDLE offset 0.062 0.027 -0.15 on_bone 5 16 perform_animation "FLAG_DROP" IFP_file "CAR" time 0
end

{$I Zombie Derby Challenge Falsestart Check.txt}

gosub @DISTANCE_CALCULATE_PLAYER

if
$SPECTATING_FLAG == 1
then
gosub @PORTRAIT_RELOAD_CHECK
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 2.0 4.0
0340: set_text_draw_RGBA 255 255 255 $HUD_ALPHA
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B $HUD_ALPHA
end
 
045B: draw_text_2numbers 300.0 200.0 GXT 'CRM9' numbers 4 5
end

32@ = 0

Audiostream.Volume(23@) = $SOUNDS_VOLUME  
Audiostream.PerformAction(23@, PLAY)

while 32@ < 1000
wait 0

{$I Zombie Derby Challenge Falsestart Check.txt}

gosub @DISTANCE_CALCULATE_PLAYER

if
$SPECTATING_FLAG == 1
then
gosub @PORTRAIT_RELOAD_CHECK
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 2.0 4.0
0340: set_text_draw_RGBA 255 255 255 $HUD_ALPHA
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B $HUD_ALPHA
end
 
045B: draw_text_2numbers 300.0 200.0 GXT 'CRM9' numbers 3 5
end

32@ = 0

Audiostream.Volume(24@) = $SOUNDS_VOLUME  
Audiostream.PerformAction(24@, PLAY)

while 32@ < 1000
wait 0

{$I Zombie Derby Challenge Falsestart Check.txt}

gosub @DISTANCE_CALCULATE_PLAYER

if
$SPECTATING_FLAG == 1
then
gosub @PORTRAIT_RELOAD_CHECK
end
 
03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 2.0 4.0
0340: set_text_draw_RGBA 255 255 255 $HUD_ALPHA
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B $HUD_ALPHA
end
 
045B: draw_text_2numbers 300.0 200.0 GXT 'CRM9' numbers 2 5
end

32@ = 0

Audiostream.Volume(25@) = $SOUNDS_VOLUME  
Audiostream.PerformAction(25@, PLAY)

while 32@ < 1000
wait 0

{$I Zombie Derby Challenge Falsestart Check.txt}

gosub @DISTANCE_CALCULATE_PLAYER

if
$SPECTATING_FLAG == 1
then
gosub @PORTRAIT_RELOAD_CHECK
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 2.0 4.0
0340: set_text_draw_RGBA 255 255 255 $HUD_ALPHA
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B $HUD_ALPHA
end
 
045B: draw_text_2numbers 300.0 200.0 GXT 'CRM9' numbers 1 5
end

Audiostream.Volume(26@) = $SOUNDS_VOLUME  
Audiostream.PerformAction(26@, PLAY)

:ZOMBIE_DEBRY_GO_JUMP

//////////////////////////////////////////////////////////////////

//if
//0AAB:   file_exists "debug\cangle.txt"
//then
//
//0AF2: 0@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_A"
//0AD3: v$FP_FILE = format "CP%d_A" CARMA_GLOB_RACE_TOTAL_CHECKPOINTS
//    
//if
//CLASSIC_CARMA_MAP_AC_MODE == 0
//then
//0AF3: write_float 0@ to_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
//else
//0AF3: write_float 0@ to_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
//end
//
//008B: 0@ = CARMA_GLOB_RACE_NUMBER // (int)
//0@ += 16
//if
//0@ > 73
//then
//0@ += 100
//end
//
//repeat
//wait 0
//07C0: load_path 0@
//until 07C1:   path 0@ available
//
//05EB: assign_car CARMA_GLOB_DERBY_PLAYER_CAR to_path 0@
//
//if
//8AB0: not  key_pressed $KEY_USE
//then
//06FD: set_car CARMA_GLOB_DERBY_PLAYER_CAR speed_on_path_to 10.0
//else
//06FD: set_car CARMA_GLOB_DERBY_PLAYER_CAR speed_on_path_to 3.0
//end
//
//end
                      
//////////////////////////////////////////////////////////////////

create_thread @HJ

if
$SPECTATING_FLAG == 0
then
car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,false)
end

player.CanMove(PLAYER_CHAR) = true

for 0@ = 0 to 74
if
056E:   car $PARK_CAR[0@] defined
    then
    03CC: enable_car $PARK_CAR[0@] stuck_check_distance_to 0.0 time_to 5000
    end
end

CARMA_GLOB_RACE_STARTED = 1

0A8C: write_memory 0x86A96B size 1 value 71 virtual_protect 0 //get back HANDLING.CFG
0A8D: 0@ = read_memory 0x05BFA96 size 4 virtual_protect false
0AA6: call_method 0x5BD830 cHandlingDataMgr::LoadHandlingData struct 0@ num_params 0 pop 0

//if
//COOP_ACTIVE_FLAG == 1
//then
//0@ = marker.CreateAboveCar(CARMA_GLOB_DERBY_PLAYER_CAR)
//07E0: set_marker 0@ type_to 1
//marker.SetIconSize(0@,2)
//0@ = marker.CreateAboveCar($PARK_CAR[0])
//0165: set_marker 0@ color_to 1
//marker.SetIconSize(0@,2)
//end

//////////////////////////////////////////////////////////////////

if
CARMA_REPLAY_FLAG == 1
then
06FD: set_car CARMA_GLOB_DERBY_PLAYER_CAR speed_on_path_to 1.0
end

//////////////////////////////////////////////////////////////////

if
$SPECTATING_FLAG == 0
then
0085: 0@ = PLAYER_CHECKPOINT_NUMBER // (int)
0@ += 1
018A: DERBY_CHECKPOINT = create_checkpoint_at $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER] 
06D5: DERBY_CHECKPOINT_RACING = create_racing_checkpoint_at $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER] point_to $RNDM_HOUSE_ITEM_X[0@] $RNDM_HOUSE_ITEM_Y[0@] $RNDM_HOUSE_ITEM_Z[0@] type 0 radius 6.0
end

if
not ZOMBIEGEDDON_GAME_TYPE == 2
then

if
not ZOMBIEGEDDON_GAME_TYPE == 3
then
CARMA_GLOB_TIME_VAR = 60000
else
008B: 0@ = CARMA_GLOB_RACE_TOTAL_ZOMBIES // (int)
0@ *= 900
008A: CARMA_GLOB_TIME_VAR = 0@ // (int)
end

else

actor.StorePos(PLAYER_ACTOR,0@,1@,2@)
050A: 3@ = distance_between_XYZ 0@ 1@ 2@ and_XYZ $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER]
0092: 3@ = float 3@ to_integer
3@ *= 40
if
CARMA_GLOB_TIME_MULT > 0
then
006E: 3@ *= CARMA_GLOB_TIME_MULT // (int)
end
005E: CARMA_GLOB_TIME_VAR += 3@  // (int)
CARMA_GLOB_TIME_VAR += 10000

end

if
CARMA_REPLAY_FLAG == 0
then
03C3: set_timer_to CARMA_GLOB_TIME_VAR type 1 GXT 'BB_19' // global_variable  // ‹peЇ¬ 
04F7: vagina_text CARMA_GLOB_DERBY_CREDITS type 0 line 2 GXT 'GAME519' // global_variable
else
CARMA_GLOB_TIME_VAR = 90000000
end

0084: CARMA_GLOB_DERBY_KILLED_PLAYER2 = CARMA_GLOB_DERBY_KILLED_PLAYER // (int)

32@ = 0
33@ = 0

create_thread @CAR_DMG_P
create_thread @BNS_CRM

if and
UNITED_MAP == 0
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then

if or
CARMA_GLOB_RACE_NUMBER == 12
CARMA_GLOB_RACE_NUMBER == 13
CARMA_GLOB_RACE_NUMBER == 14
    then    
    if or
    ZOMBIEGEDDON_GAME_TYPE == 2
    ZOMBIEGEDDON_GAME_TYPE == 3
        then
        ZOMBIE_INTERIOR_ALLOW_SPAWN = 1
        end    
    end

end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
then

if
CARMA_GLOB_RACE_INTERIOR > 0
    then    
    if or
    ZOMBIEGEDDON_GAME_TYPE == 2
    ZOMBIEGEDDON_GAME_TYPE == 3
        then
        ZOMBIE_INTERIOR_ALLOW_SPAWN = 1
        end    
    end

end

while true
wait 0

if
$CHEATS_ON == 1
then

if and
0ADC:   test_cheat "ZIMBAS"
$CHEAT_TYPE_FLAG == 1
    then
    $CHEAT_CODE_ACTIVATED = 1
    0084: CARMA_GLOB_DERBY_KILLED_PLAYER = CARMA_GLOB_RACE_TOTAL_ZOMBIES // (int)
    CARMA_GLOB_DERBY_KILLED_PLAYER -= 1
    end

if and
0E3D: is_key_just_pressed 16
0E3D: is_key_just_pressed 17
actor.Driving(PLAYER_ACTOR)
then
0A8D: 0@ = read_memory 0x05BFA96 size 4 virtual_protect false
0AA6: call_method 0x5BD830 cHandlingDataMgr::LoadHandlingData struct 0@ num_params 0 pop 0
0AD1: show_formatted_text_highpriority "Handling file reloaded and writed." time 2000

if
UNITED_MAP == 0
then
0B00: delete_file "data/handling_Andreas.cfg"  // IF and SET
0B04: copy_file "data/handling.cfg" to "data/handling_Andreas.cfg" //IF and SET
end

if and
UNITED_MAP == 1
STORIES_MAP == 0
then
0B00: delete_file "data/handling_United.cfg"  // IF and SET
0B04: copy_file "data/handling.cfg" to "data/handling_United.cfg" //IF and SET
end

if and
UNITED_MAP == 1
STORIES_MAP == 1
then
0B00: delete_file "data/handling_Stories.cfg"  // IF and SET
0B04: copy_file "data/handling.cfg" to "data/handling_Stories.cfg" //IF and SET
end

end

end

if and
ZOMBIEGEDDON_GAME_TYPE == 2
not $SPECTATING_FLAG == 1
then

0A97: 1@ = car CARMA_GLOB_DERBY_PLAYER_CAR struct 
0A8E: 2@ = 1@ + 0x8A4 // int
0A8D: 1@ = read_memory 2@ size 4 virtual_protect 0
//0AD1: show_formatted_text_highpriority "%f" time 2000 1@

if and
1@ < 0.0
1@ > -1.0
then
0423: set_car CARMA_GLOB_DERBY_PLAYER_CAR improved_handling_to 2.1 // (float)
else
0423: set_car CARMA_GLOB_DERBY_PLAYER_CAR improved_handling_to 1.05 // (float)
end

else

if
not $SPECTATING_FLAG == 1
    then
    0089: 1@ = ZOMBIEGEDDON_GAMESPEED_MULT // (float)
    1@ *= 0.35
    0423: set_car CARMA_GLOB_DERBY_PLAYER_CAR improved_handling_to 1@ // (float)
    end

end

if and
ZOMBEGEDDON_TOURNAMENT == 1
0E3E: is_button_just_pressed 0 button 15
    then
    
    //////////////////////////////

    32@ = 0
    
    while true
    wait 0
    text.ShowH('GAME887',100,1)
    
    if
    0E3E: is_button_just_pressed 0 button 11
        then
        text.ClearAll()
        
        014F: stop_timer CARMA_GLOB_TIME_VAR
        0151: remove_status_text CARMA_GLOB_DERBY_CREDITS
        0151: remove_status_text CARMA_DERBY_LOSS
        
        $HUD_REMOVE = 1
        
        cinema.Radar(0)
        cinema.Widescreen(1)   
        
        fade 0 500
        wait 500    
        
        $HUD_REMOVE = 1
        0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
        0AF1: write_int -1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
        0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
        0AF1: write_int 0 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"
        0AF1: write_int 1 to_ini_file "data\derby_Tournament.ini" section "LIST" key "PAUSED"
        0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "data\derby_Tournament.ini" section "LIST" key "MODE"
        0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_TOURNAMENT"                    
        0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
        
        end
    
    if
    0E3E: is_button_just_pressed 0 button 10
        then
        text.ClearAll()
        break
        end
    
    end
    
    //////////////////////////////
    
    end

if
$SPECTATING_FLAG == 1
then
gosub @PORTRAIT_RELOAD_CHECK
end

///////////////////////////////////////////////////////

if
02BF:   car CARMA_GLOB_DERBY_PLAYER_CAR sunk
    then
    0A8C: write_memory 0xB7CDE0 size 4 value 2650.0 virtual_protect 0
    end

///////////////////////////////////////////////////////

if
$ZOMBIE_DERBY_FLAG == 1
then

for 2@ = 0 to 19
    
    for 0@ = 0 to CARMA_GLOB_OPPONENTS_COUNT
    
    if and
    056E:   car $PARK_CAR[0@] defined
    056D:   actor $ZOMBIE[2@] defined
        then
        if and
        051B:   actor $ZOMBIE[2@] damaged_by_car $PARK_CAR[0@]
        89A8: not  actor $ZOMBIE[2@] headshoted
            then
            054E: clear_actor $ZOMBIE[2@] damage
            0321: AS_actor $ZOMBIE[2@] die_headshotted
            
            $PARK_CAR_ENGINE[0@] += 2500
            $PARK_CAR_ID[0@] += 250
                                                                    
            end    
        if and
        051B:   actor $ZOMBIE[2@] damaged_by_car CARMA_GLOB_DERBY_PLAYER_CAR
        89A8: not  actor $ZOMBIE[2@] headshoted        
            then
            054E: clear_actor $ZOMBIE[2@] damage
            0321: AS_actor $ZOMBIE[2@] die_headshotted
            
            if and
            not ZOMBIEGEDDON_GAME_TYPE == 2
            not ZOMBIEGEDDON_GAME_TYPE == 3
            then            
            CARMA_GLOB_TIME_VAR += 2500
            end
            
            CARMA_GLOB_DERBY_CREDITS += 250                
            
            0AF0: 1@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_ZKILLED"                
                            
            if
            $CHEATED_FLAG == 0 
            then   
            1@ += 1
            end        
                         
            0AF1: write_int 1@ to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_ZKILLED"
            
            if and
            CARMA_GLOB_DERBY_PLAYER_CAR_HIT_FLAG == 0
            CARMA_GLOB_DERBY_PLAYER_CAR_HIT2_FLAG == 0
                then
                
                random_int 1@ 0 to 3
                if or
                1@ == 1
                1@ == 2
                    then    
                    CARMA_GLOB_DERBY_PLAYER_LAUGH_FLAG = 1
                    end
                
                end
            
            end    
        end
    
    end
    
end

end
    
///////////////////////////////////////////////////////

gosub @DISTANCE_CALCULATE_PLAYER

CARMA_GLOB_DERBY_CAR_DAMAGE_TIMER += 5

if
DERBY_FLAGMAN_DEAD_FLAG == 0
    then
    if
    051B:   actor DERBY_FLAGMAN_HANDLE damaged_by_car CARMA_GLOB_DERBY_PLAYER_CAR
        then
        0321: AS_actor DERBY_FLAGMAN_HANDLE die_headshotted
        DERBY_FLAGMAN_DEAD_FLAG = 1
        CARMA_GLOB_DERBY_CREDITS += 2500
        
        random_int 1@ 40 to 42
        Audiostream.Loop($AMM_WEAPON[1@], 0)
        Audiostream.Volume($AMM_WEAPON[1@]) = $SOUNDS_VOLUME
        Audiostream.LinkToActor($AMM_WEAPON[1@],DERBY_FLAGMAN_HANDLE)
        Audiostream.PerformAction($AMM_WEAPON[1@], PLAY)
        
        end
    end
    
if
DERBY_FLAGMAN_DEAD_FLAG == 0
    then
    if
    actor.Dead(DERBY_FLAGMAN_HANDLE)
        then
        DERBY_FLAGMAN_DEAD_FLAG = 1
        end
    end
    
if and
ZOMBIEGEDDON_GAME_TYPE == 3 
$CHEATS_ON == 1
    then
    if
    0E3D: is_key_just_pressed 48
        then 
        0084: CARMA_GLOB_DERBY_KILLED_PLAYER = CARMA_GLOB_RACE_TOTAL_ZOMBIES // (int)
        end
    end        

if
CARMA_GLOB_RACE_STARTED2 == 0
then

while 33@ < 3000
wait 0

if
00EC:   actor PLAYER_ACTOR sphere 0 near_point $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] radius 30.0 30.0
    then
    break
    end       

if and
$CHEATS_ON == 1
ZOMBEGEDDON_TOURNAMENT == 1
    then
    if
    0E3D: is_key_just_pressed 107
        then
        015D: set_gamespeed 15.0 
        $CHEAT_CODE_ACTIVATED = 1
        jump to @CARMA_WIN
        end 
    end
    
if and
ZOMBEGEDDON_TOURNAMENT == 1
0E3E: is_button_just_pressed 0 button 15
    then
    
    //////////////////////////////

    32@ = 0
    
    while true
    wait 0
    text.ShowH('GAME887',100,1)
    
    if
    0E3E: is_button_just_pressed 0 button 11
        then
        text.ClearAll()
        
        014F: stop_timer CARMA_GLOB_TIME_VAR
        0151: remove_status_text CARMA_GLOB_DERBY_CREDITS
        0151: remove_status_text CARMA_DERBY_LOSS
        
        $HUD_REMOVE = 1
        
        cinema.Radar(0)
        cinema.Widescreen(1)   
        
        fade 0 500
        wait 500    
        
        $HUD_REMOVE = 1
        0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
        0AF1: write_int -1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
        0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
        0AF1: write_int 0 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"   
        0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
        
        end
    
    if
    0E3E: is_button_just_pressed 0 button 10
        then
        text.ClearAll()
        break
        end
    
    end
    
    //////////////////////////////
    
    end    

if
DERBY_FLAGMAN_DEAD_FLAG == 0
    then
    if
    051B:   actor DERBY_FLAGMAN_HANDLE damaged_by_car CARMA_GLOB_DERBY_PLAYER_CAR
        then
        0321: AS_actor DERBY_FLAGMAN_HANDLE die_headshotted
        DERBY_FLAGMAN_DEAD_FLAG = 1
        CARMA_GLOB_DERBY_CREDITS += 2500
        
        random_int 1@ 40 to 42
        Audiostream.Loop($AMM_WEAPON[1@], 0)
        Audiostream.Volume($AMM_WEAPON[1@]) = $SOUNDS_VOLUME
        Audiostream.LinkToActor($AMM_WEAPON[1@],DERBY_FLAGMAN_HANDLE)
        Audiostream.PerformAction($AMM_WEAPON[1@], PLAY)
        
        end
    end
    
if
DERBY_FLAGMAN_DEAD_FLAG == 0
    then
    if
    actor.Dead(DERBY_FLAGMAN_HANDLE)
        then
        DERBY_FLAGMAN_DEAD_FLAG = 1
        end
    end

if and
not actor.Animation(DERBY_FLAGMAN_HANDLE) == "FLAG_DROP"
02A0:   actor DERBY_FLAGMAN_HANDLE stopped
0E45: frame_mod 15
then
actor.StorePos(DERBY_FLAGMAN_HANDLE,1@,2@,3@)
05DA: AS_actor DERBY_FLAGMAN_HANDLE run_away_in_panic_from 1@ 2@ 3@ away_radius 1000.0 timelimit 180000
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 $HUD_ALPHA
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B $HUD_ALPHA
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text

if
DERBY_FALSESTART_FLAG == 0
then 
045B: draw_text_2numbers 320.0 200.0 GXT 'CRM10' numbers 1 5
else

if
ANNA_FLAG == 0
then
045B: draw_text_2numbers 320.0 200.0 GXT 'CRM54' numbers 1 5
else
045B: draw_text_2numbers 320.0 200.0 GXT 'CRM55' numbers 1 5
end

end

end

end

if and
33@ > 3000
CARMA_GLOB_RACE_STARTED2 == 0
then
CARMA_GLOB_RACE_STARTED2 = 1
end

Audiostream.Volume(19@) = $SOUNDS_VOLUME
Audiostream.Volume(20@) = $SOUNDS_VOLUME
Audiostream.Volume(21@) = $SOUNDS_VOLUME
Audiostream.Volume(22@) = $SOUNDS_VOLUME
Audiostream.Volume(23@) = $SOUNDS_VOLUME
Audiostream.Volume(24@) = $SOUNDS_VOLUME
Audiostream.Volume(25@) = $SOUNDS_VOLUME
Audiostream.Volume(26@) = $SOUNDS_VOLUME
Audiostream.Volume(27@) = $SOUNDS_VOLUME
Audiostream.Volume(28@) = $SOUNDS_VOLUME
Audiostream.Volume(CARMA_VOICE_FINALLAP) = $SOUNDS_VOLUME
Audiostream.Volume(30@) = $SOUNDS_VOLUME

07CC: set_player PLAYER_CHAR can_enter_exit_vehicles 0

0652: CARMA_GLOB_DERBY_KILLED_PLAYER3 = integer_stat 121
    
if
00EC:   actor PLAYER_ACTOR sphere 0 near_point $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] radius 10.0 10.0
    then
    
//    if and
//    0AAB:   file_exists "debug\cangle.txt"
//    $DEBUG_MENU_ON == 1
//    then
//    0@ = car.Angle(CARMA_GLOB_DERBY_PLAYER_CAR)
//    0AD3: v$FP_FILE = format "CP%d_A" PLAYER_CHECKPOINT_NUMBER
//    
//    if
//    CLASSIC_CARMA_MAP_AC_MODE == 0
//    then
//    0AF3: write_float 0@ to_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
//    else
//    0AF3: write_float 0@ to_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
//    end
//    
//    end
    
    if
    $SPECTATING_FLAG == 0
    then
    PLAYER_CHECKPOINT_NUMBER += 1
    008A: CARMA_GLOB_PLAYER_CHECKPOINT_NUMBER = PLAYER_CHECKPOINT_NUMBER // (int)        
    
    if
    001F:   PLAYER_CHECKPOINT_NUMBER > CARMA_GLOB_RACE_TOTAL_CHECKPOINTS // (int)
    then
    LAP_NUMBER += 1
    
    if and
    $CHEATS_ON == 1
    ZOMBIEGEDDON_GAME_TYPE == 2
    $SAVESTATUS == 0
        then 
        jump to @CARMA_WIN
        end
    
    if
    ZOMBIEGEDDON_GAME_TYPE == 2
    then
    
    0058: CARMA_GLOB_DERBY_CREDITS += CARMA_GLOB_RACE_LENGHT // (int)
    
    if or
    001C:   CARMA_CPRUSH_LAP_REC_BEST_MINUTES > CARMA_CPRUSH_LAP_REC_CURR_MINUTES // (int)
    001C:   CARMA_CPRUSH_LAP_REC_BEST_SECONDS > CARMA_CPRUSH_LAP_REC_CURR_SECONDS // (int)    
    then
    gosub @ZOMBEGEDDON_CP_RUSH_NEW_LAP_REC_WRITE
    0084: CARMA_CPRUSH_LAP_REC_BEST_MINUTES = CARMA_CPRUSH_LAP_REC_CURR_MINUTES // (int)
    0084: CARMA_CPRUSH_LAP_REC_BEST_SECONDS = CARMA_CPRUSH_LAP_REC_CURR_SECONDS // (int)
    end
    
    if and
    CARMA_CPRUSH_LAP_REC_BEST_MINUTES == 0
    CARMA_CPRUSH_LAP_REC_BEST_SECONDS == 0
    then
    gosub @ZOMBEGEDDON_CP_RUSH_NEW_LAP_REC_WRITE
    0084: CARMA_CPRUSH_LAP_REC_BEST_MINUTES = CARMA_CPRUSH_LAP_REC_CURR_MINUTES // (int)
    0084: CARMA_CPRUSH_LAP_REC_BEST_SECONDS = CARMA_CPRUSH_LAP_REC_CURR_SECONDS // (int)
    end
    
    CARMA_CPRUSH_LAP_REC_CURR_SECONDS = 0
    CARMA_CPRUSH_LAP_REC_CURR_MINUTES = 0
    
    end
    
    if
    003A:   LAP_NUMBER == CARMA_GLOB_RACE_TOTAL_LAPS // (int)
    then  
    v$CRM_TXT = "CRM16"
    create_thread @CRM_TEXT
    Audiostream.Loop(CARMA_VOICE_FINALLAP, 0)
    Audiostream.Volume(CARMA_VOICE_FINALLAP) = $SOUNDS_VOLUME
    Audiostream.PerformAction(CARMA_VOICE_FINALLAP, PLAY)
    end
    
    PLAYER_CHECKPOINT_NUMBER = 0
    008A: CARMA_GLOB_PLAYER_CHECKPOINT_NUMBER = PLAYER_CHECKPOINT_NUMBER // (int)
    
    if
    ZOMBIEGEDDON_GAME_TYPE == 2
    then
    
    if
    not CARMA_GLOB_NO_NITRO_FLAG == 1
    then
    09E9: car CARMA_GLOB_DERBY_PLAYER_CAR add_single_nitro
    end
    
    CARMA_GLOB_TIME_VAR /= 4
    actor.StorePos(PLAYER_ACTOR,0@,1@,2@)
    050A: 3@ = distance_between_XYZ 0@ 1@ 2@ and_XYZ $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER]
    0092: 3@ = float 3@ to_integer
    3@ *= 40
    if
    CARMA_GLOB_TIME_MULT > 0
    then
    006E: 3@ *= CARMA_GLOB_TIME_MULT // (int)
    end
    005E: CARMA_GLOB_TIME_VAR += 3@  // (int)
    CARMA_GLOB_TIME_VAR += 10000
    end
    
    if
    003A:   LAP_NUMBER == CARMA_GLOB_RACE_TOTAL_LAPS // (int)
    then
    jump to @DERBY_SKIP_CP_MESSAGE
    end
    
    end
    
    if
    not ZOMBIEGEDDON_GAME_TYPE == 2
    then
    v$CRM_TXT = "CRM15"    
    0459: end_thread_named 'CRMTT21'
    0459: end_thread_named 'CRMTXT2'        
    create_thread @CRM_TEXT        
    Audiostream.Volume(27@) = $SOUNDS_VOLUME
    Audiostream.PerformAction(27@, PLAY)
    else
    097A: play_audio_at 0.0 0.0 0.0 event 1058
    end
    
    :DERBY_SKIP_CP_MESSAGE
    
    marker.Disable(DERBY_CHECKPOINT)
    06D6: disable_racing_checkpoint DERBY_CHECKPOINT_RACING
    if
    001C:  LAP_NUMBER > CARMA_GLOB_RACE_TOTAL_LAPS // (int)
    then
    //ass
    else
    0085: 0@ = PLAYER_CHECKPOINT_NUMBER // (int)
    0@ += 1
    018A: DERBY_CHECKPOINT = create_checkpoint_at $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER]    
    
    if
    87D6: not  PLAYER_CHECKPOINT_NUMBER == CARMA_GLOB_RACE_TOTAL_CHECKPOINTS // @ == $ (int)
    then 
    06D5: DERBY_CHECKPOINT_RACING = create_racing_checkpoint_at $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER] point_to $RNDM_HOUSE_ITEM_X[0@] $RNDM_HOUSE_ITEM_Y[0@] $RNDM_HOUSE_ITEM_Z[0@] type 0 radius 6.0
    else
    
    if
    not CARMA_GLOB_RACE_STRGHT == 1
    then    
    02C1: store_to $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER] car_path_coords_closest_to $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER]
    end
    
    06D5: DERBY_CHECKPOINT_RACING = create_racing_checkpoint_at $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER] point_to $RNDM_HOUSE_ITEM_X[0] $RNDM_HOUSE_ITEM_Y[0] $RNDM_HOUSE_ITEM_Z[0] type 0 radius 6.0    
    end
    
    end
    
    actor.StorePos(PLAYER_ACTOR,0@,1@,2@)
    050A: 3@ = distance_between_XYZ 0@ 1@ 2@ and_XYZ $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER]
    0092: 3@ = float 3@ to_integer
    
    if
    not ZOMBIEGEDDON_GAME_TYPE == 2
    then
    3@ *= 60
    else
    
    3@ *= 40    
    if
    CARMA_GLOB_TIME_MULT > 0
    then
    006E: 3@ *= CARMA_GLOB_TIME_MULT // (int)
    end
    
    end                
    
    005E: CARMA_GLOB_TIME_VAR += 3@  // (int)
    else
    
    end
     
    end
    
if
0A4B:   controls_set_to_joystick
    then
    if and
    CARMA_GLOB_DERBY_CREDITS >= 500
    0E3E: is_button_just_pressed 0 button 8
    CARMA_GLOB_RACE_STARTED2 == 1
    $SPECTATING_FLAG == 0 
        then
        jump to @CARMA_CREDITS_REPAIR_JUMP
        end
    end    
    
if and
CARMA_GLOB_DERBY_CREDITS >= 500
0E3D:   key_pressed 90
CARMA_GLOB_RACE_STARTED2 == 1
$SPECTATING_FLAG == 0 
    then
    :CARMA_CREDITS_REPAIR_JUMP         
    0@ = Car.Health(CARMA_GLOB_DERBY_PLAYER_CAR)
    if
    0@ < 1000
        then
        CARMA_GLOB_DERBY_CREDITS -= 500
        Audiostream.Volume(20@) = $SOUNDS_VOLUME
        Audiostream.PerformAction(20@, PLAY)    
        0@ += 45
        
        if
        0@ > 1000
        then
        0@ = 1000        
        0A30: repair_car CARMA_GLOB_DERBY_PLAYER_CAR        
        end
          
        Car.Health(CARMA_GLOB_DERBY_PLAYER_CAR) = 0@
        
        for 1@ = 0 to 10
        
        random_int 0@ 0 6
        if
        09BB:   car CARMA_GLOB_DERBY_PLAYER_CAR has_visible_damage_on_component 0@
        then
        068A: set_car CARMA_GLOB_DERBY_PLAYER_CAR repair_door 0@
        end
        
        end
        
        end
    end
    
if
0E45: frame_mod 30
    then
    Car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR, 0@, 1@, 2@)
    
    9@ = 0
    
    if
    CLASSIC_CARMA_MAP == 1
    then
    
    if
    00A4:   actor PLAYER_ACTOR sphere 0 in_cube_cornerA 1986.5653 2389.9692 57.4756 cornerB 1910.4812 2492.4678 97.6511
    then
    9@ = 1
    jump to @DERBY_PLAYER_RESTORE_FREE
    end
    
    if
    CARMA_GLOB_RACE_NUMBER == 84    
    then
    if
    2@ < 59.7328
        then
        9@ = 1
        jump to @DERBY_PLAYER_RESTORE_FREE
        end
    end
    
    if or
    CARMA_GLOB_RACE_NUMBER == 47
    CARMA_GLOB_RACE_NUMBER == 52
    CARMA_GLOB_RACE_NUMBER == 56    
    then
    if
    2@ < 1420.6
        then
        9@ = 1
        jump to @DERBY_PLAYER_RESTORE_FREE
        end
    end
    
    if and
    not CARMA_GLOB_RACE_INTERIOR == 0
    CARMA_GLOB_RACE_NUMBER == 71
    2@ < 335.6
    then
    9@ = 1
    jump to @DERBY_PLAYER_RESTORE_FREE
    end
    
    if and
    not CARMA_GLOB_RACE_INTERIOR == 0
    CARMA_GLOB_RACE_NUMBER == 70
    2@ < 335.6
    then
    9@ = 1
    jump to @DERBY_PLAYER_RESTORE_FREE
    end        
    
    if and
    not CARMA_GLOB_RACE_INTERIOR == 0
    CARMA_GLOB_RACE_NUMBER == 57
    2@ < 1306.0
    then
    9@ = 1
    jump to @DERBY_PLAYER_RESTORE_FREE
    end
    
    if and
    not CARMA_GLOB_RACE_INTERIOR == 0
    not CARMA_GLOB_RACE_NUMBER == 70
    not CARMA_GLOB_RACE_NUMBER == 71
    2@ < 870.0
    then
    9@ = 1
    jump to @DERBY_PLAYER_RESTORE_FREE
    end
    
    if or
    CARMA_GLOB_RACE_NUMBER == 51
    CARMA_GLOB_RACE_NUMBER == 46
    then
    if     
    2@ < 117.6532
        then
        9@ = 1
        jump to @DERBY_PLAYER_RESTORE_FREE
        end 
    end 
    
    if or
    CARMA_GLOB_RACE_NUMBER == 17
    CARMA_GLOB_RACE_NUMBER == 14
    CARMA_GLOB_RACE_NUMBER == 49
    then
    if    
    2@ < 142.08
        then
        9@ = 1
        jump to @DERBY_PLAYER_RESTORE_FREE
        end  
    end
    
    end  
    
    end
    
if
0A4B:   controls_set_to_joystick
    then
    if and
    CARMA_GLOB_DERBY_CREDITS >= 500    
    CARMA_GLOB_RACE_STARTED2 == 1
    $SPECTATING_FLAG == 0 
        then
        if
        0E3E: is_button_just_pressed 0 button 9
            then
            
            if
            80E1: not player 0 pressed_key 4
            then            
            jump to @DERBY_PLAYER_RESTORE
            else
            jump to @DERBY_PLAYER_RESTORE_FREE_BUT_NOT_FREE
            end
            
            end
        end
    end
    
0E65: get_car_collision_intensity CARMA_GLOB_DERBY_PLAYER_CAR store_to 0@
if and
81F4: not  car CARMA_GLOB_DERBY_PLAYER_CAR flipped
09D0:   car CARMA_GLOB_DERBY_PLAYER_CAR on_wheels
82BF: not  car CARMA_GLOB_DERBY_PLAYER_CAR sunk
8E93: not is_car_really_in_air CARMA_GLOB_DERBY_PLAYER_CAR
0@ < 1.0
    then        
    
    if
    0E45: frame_mod 15
    then
    car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,PLAYER_RESTORE_LATEST_SAVE_X,PLAYER_RESTORE_LATEST_SAVE_Y,PLAYER_RESTORE_LATEST_SAVE_Z)
    07C5: get_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST_SAVE_A1 PLAYER_RESTORE_LATEST_SAVE_A2 PLAYER_RESTORE_LATEST_SAVE_A3 PLAYER_RESTORE_LATEST_SAVE_A4
    end
    
    if
    0E45: frame_mod 30
    then
    car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,PLAYER_RESTORE_LATEST2_SAVE_X,PLAYER_RESTORE_LATEST2_SAVE_Y,PLAYER_RESTORE_LATEST2_SAVE_Z)
    07C5: get_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST2_SAVE_A1 PLAYER_RESTORE_LATEST2_SAVE_A2 PLAYER_RESTORE_LATEST2_SAVE_A3 PLAYER_RESTORE_LATEST2_SAVE_A4
    end
    
    if
    0E45: frame_mod 45
    then
    car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,PLAYER_RESTORE_LATEST3_SAVE_X,PLAYER_RESTORE_LATEST3_SAVE_Y,PLAYER_RESTORE_LATEST3_SAVE_Z)
    07C5: get_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST3_SAVE_A1 PLAYER_RESTORE_LATEST3_SAVE_A2 PLAYER_RESTORE_LATEST3_SAVE_A3 PLAYER_RESTORE_LATEST3_SAVE_A4
    end
    
    if
    0E45: frame_mod 60
    then
    car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,PLAYER_RESTORE_LATEST4_SAVE_X,PLAYER_RESTORE_LATEST4_SAVE_Y,PLAYER_RESTORE_LATEST4_SAVE_Z)
    07C5: get_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST4_SAVE_A1 PLAYER_RESTORE_LATEST4_SAVE_A2 PLAYER_RESTORE_LATEST4_SAVE_A3 PLAYER_RESTORE_LATEST4_SAVE_A4
    end
        
    end   

//0AD1: show_formatted_text_highpriority "%d == %d, ZOMBIEGEDDON_GAME_TYPE %d, CARMA_GLOB_1VS1_MODE %d" time 2000 CARMA_GLOB_OPPONENTS_WRECKED CARMA_GLOB_OPPONENTS_COUNT3 ZOMBIEGEDDON_GAME_TYPE CARMA_GLOB_1VS1_MODE  
if and
ZOMBIEGEDDON_GAME_TYPE == 1
CARMA_GLOB_1VS1_MODE == 0
then
if
003A:   CARMA_GLOB_OPPONENTS_WRECKED == CARMA_GLOB_OPPONENTS_COUNT3 // (int)
    then
    CARMA_GLOB_1VS1_MODE = 1
    v$CRM_TXT = "CRM77"
    create_thread @CRM_TEXB
    end
end             
    
if and
0E3D:   key_pressed 88
CARMA_GLOB_RACE_STARTED2 == 1
$SPECTATING_FLAG == 0
    then
    
    if
    00E1:  player 0 pressed_key 4
    then            
    jump to @DERBY_PLAYER_RESTORE_FREE_BUT_NOT_FREE
    end
    
    :DERBY_PLAYER_RESTORE
    015D: set_gamespeed 0.0
    
    9@ = 0
    
    repeat
    wait 0
    9@ += 51
    03F0: enable_text_draw 1
    038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 9@
    
    if
    9@ == 255
    then
    fade 0 0
    end
        
    until 9@ == 255 
    
    fade 0 0
    9@ = 0
    099A: set_car CARMA_GLOB_DERBY_PLAYER_CAR collision_detection 0
    wait 0     
    car.SetSpeedInstantly(CARMA_GLOB_DERBY_PLAYER_CAR,0.0)
    car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,true)
    0A97: 0@ = car CARMA_GLOB_DERBY_PLAYER_CAR struct
    0@ += 0x50 //X
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Y
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Z
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position PLAYER_RESTORE_LATEST_SAVE_X PLAYER_RESTORE_LATEST_SAVE_Y PLAYER_RESTORE_LATEST_SAVE_Z
    07C6: set_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST_SAVE_A1 PLAYER_RESTORE_LATEST_SAVE_A2 PLAYER_RESTORE_LATEST_SAVE_A3 PLAYER_RESTORE_LATEST_SAVE_A4    
    wait 0
    car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,false)
    099A: set_car CARMA_GLOB_DERBY_PLAYER_CAR collision_detection 1
    
    if
    $CHEATS_ON == 1
    then
    0AD1: show_formatted_text_highpriority "first saved position restored, ~n~ X: %f, Y: %f, Z: %f ~n~ROT %f %f %f %f" time 5000 PLAYER_RESTORE_LATEST_SAVE_X PLAYER_RESTORE_LATEST_SAVE_Y PLAYER_RESTORE_LATEST_SAVE_Z PLAYER_RESTORE_LATEST_SAVE_A1 PLAYER_RESTORE_LATEST_SAVE_A2 PLAYER_RESTORE_LATEST_SAVE_A3 PLAYER_RESTORE_LATEST_SAVE_A4
    end
    
    if
    89D0: not  car CARMA_GLOB_DERBY_PLAYER_CAR on_wheels
    then
    car.SetSpeedInstantly(CARMA_GLOB_DERBY_PLAYER_CAR,0.0) 
    0A97: 0@ = car CARMA_GLOB_DERBY_PLAYER_CAR struct
    0@ += 0x50 //X
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Y
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Z
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position PLAYER_RESTORE_LATEST2_SAVE_X PLAYER_RESTORE_LATEST2_SAVE_Y PLAYER_RESTORE_LATEST2_SAVE_Z
    07C6: set_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST2_SAVE_A1 PLAYER_RESTORE_LATEST2_SAVE_A2 PLAYER_RESTORE_LATEST2_SAVE_A3 PLAYER_RESTORE_LATEST2_SAVE_A4    
    
    if
    $CHEATS_ON == 1
    then
    0AD1: show_formatted_text_highpriority "second saved position restored, ~n~ X: %f, Y: %f, Z: %f ~n~ROT %f %f %f %f" time 5000 PLAYER_RESTORE_LATEST2_SAVE_X PLAYER_RESTORE_LATEST2_SAVE_Y PLAYER_RESTORE_LATEST2_SAVE_Z PLAYER_RESTORE_LATEST2_SAVE_A1 PLAYER_RESTORE_LATEST2_SAVE_A2 PLAYER_RESTORE_LATEST2_SAVE_A3 PLAYER_RESTORE_LATEST2_SAVE_A4
    end
    
    wait 0
    
    if
    89D0: not  car CARMA_GLOB_DERBY_PLAYER_CAR on_wheels
    then
    car.SetSpeedInstantly(CARMA_GLOB_DERBY_PLAYER_CAR,0.0)
    0A97: 0@ = car CARMA_GLOB_DERBY_PLAYER_CAR struct
    0@ += 0x50 //X
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Y
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Z
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position PLAYER_RESTORE_LATEST3_SAVE_X PLAYER_RESTORE_LATEST3_SAVE_Y PLAYER_RESTORE_LATEST3_SAVE_Z
    07C6: set_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST3_SAVE_A1 PLAYER_RESTORE_LATEST3_SAVE_A2 PLAYER_RESTORE_LATEST3_SAVE_A3 PLAYER_RESTORE_LATEST3_SAVE_A4
    if
    $CHEATS_ON == 1
    then
    0AD1: show_formatted_text_highpriority "third saved position restored, ~n~ X: %f, Y: %f, Z: %f ~n~ROT %f %f %f %f" time 5000 PLAYER_RESTORE_LATEST3_SAVE_X PLAYER_RESTORE_LATEST3_SAVE_Y PLAYER_RESTORE_LATEST3_SAVE_Z PLAYER_RESTORE_LATEST3_SAVE_A1 PLAYER_RESTORE_LATEST3_SAVE_A2 PLAYER_RESTORE_LATEST3_SAVE_A3 PLAYER_RESTORE_LATEST3_SAVE_A4
    end

    end
    
    wait 0
    
    if
    89D0: not  car CARMA_GLOB_DERBY_PLAYER_CAR on_wheels
    then
    car.SetSpeedInstantly(CARMA_GLOB_DERBY_PLAYER_CAR,0.0)
    0A97: 0@ = car CARMA_GLOB_DERBY_PLAYER_CAR struct
    0@ += 0x50 //X
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Y
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Z
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position PLAYER_RESTORE_LATEST4_SAVE_X PLAYER_RESTORE_LATEST4_SAVE_Y PLAYER_RESTORE_LATEST4_SAVE_Z
    07C6: set_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to PLAYER_RESTORE_LATEST4_SAVE_A1 PLAYER_RESTORE_LATEST4_SAVE_A2 PLAYER_RESTORE_LATEST4_SAVE_A3 PLAYER_RESTORE_LATEST4_SAVE_A4    
    
    if
    $CHEATS_ON == 1
    then
    0AD1: show_formatted_text_highpriority "fourth saved position restored, ~n~ X: %f, Y: %f, Z: %f ~n~ROT %f %f %f %f" time 5000 PLAYER_RESTORE_LATEST4_SAVE_X PLAYER_RESTORE_LATEST4_SAVE_Y PLAYER_RESTORE_LATEST4_SAVE_Z PLAYER_RESTORE_LATEST4_SAVE_A1 PLAYER_RESTORE_LATEST4_SAVE_A2 PLAYER_RESTORE_LATEST4_SAVE_A3 PLAYER_RESTORE_LATEST4_SAVE_A4
    end

    end
    
    end    
    
    car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,0@,1@,2@)
    2@ += 0.35
    0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position 0@ 1@ 2@
    car.SetSpeedInstantly(CARMA_GLOB_DERBY_PLAYER_CAR,0.0)
    0A97: 0@ = car CARMA_GLOB_DERBY_PLAYER_CAR struct
    0@ += 0x50 //X
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Y
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    0@ += 4 //Z
    0A8C: write_memory 0@ size 4 value 0.0 virtual_protect 0
    
    CARMA_GLOB_DERBY_CREDITS -= 2000
    
    camera.Restore_WithJumpCut()                  
                
    wait 0
            
    if
    8ABE: not  vehicle CARMA_GLOB_DERBY_PLAYER_CAR engine_on
    then
    0918: set_car CARMA_GLOB_DERBY_PLAYER_CAR engine_operation 1
    end
        
    gosub @CARMAGEDDON_GET_PLAYER_DAMAGE    
    0@ = car.Health(CARMA_GLOB_DERBY_PLAYER_CAR)
    0A30: repair_car CARMA_GLOB_DERBY_PLAYER_CAR
    car.Health(CARMA_GLOB_DERBY_PLAYER_CAR) = 0@
    gosub @CARMAGEDDON_SET_PLAYER_DAMAGE    
    
    gosub @CARMA_RESTORE_UNFADE
    
    jump to @PLAYER_RESTORE_JUMPAFTER
    :DERBY_PLAYER_RESTORE_FREE_BUT_NOT_FREE
    CARMA_GLOB_DERBY_CREDITS -= 2000
    :DERBY_PLAYER_RESTORE_FREE
    
    015D: set_gamespeed 0.0
    
    9@ = 0
    
    repeat
    wait 0
    9@ += 51
    03F0: enable_text_draw 1
    038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 9@
    
    if
    9@ == 255
    then
    fade 0 0
    end
        
    until 9@ == 255
       
    Car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR, 0@, 1@, 2@) 
    random_int 7@ 0 2
    06F8: get_nearest_route_for 0@ 1@ 2@ in_direction 7@ store_to 3@ 4@ 5@ Z_angle_to 6@
    
    if
    9@ == 1
    then
    008B: 0@ = CARMA_GLOB_PLAYER_CHECKPOINT_NUMBER // (int)
    0@ -= 1
        
    if
    0@ < 0
    then
    008B: 0@ = CARMA_GLOB_RACE_TOTAL_CHECKPOINTS // (int)
    end
    
    0089: 3@ = $RNDM_HOUSE_ITEM_X[0@] // (float)
    0089: 4@ = $RNDM_HOUSE_ITEM_Y[0@] // (float)
    0089: 5@ = $RNDM_HOUSE_ITEM_Z[0@] // (float)
    end
            
    if
    8AE2: not 0@ = random_vehicle_near_point 3@ 4@ 5@ in_radius 5.0 find_next 0 pass_wrecked 0
        then        
        
        if
        9@ == 0
        then
        CARMA_GLOB_DERBY_CREDITS -= 2000
        else
        
        008B: 0@ = CARMA_GLOB_PLAYER_CHECKPOINT_NUMBER // (int)
        0@ -= 1
            
        if
        0@ < 0
        then
        008B: 0@ = CARMA_GLOB_RACE_TOTAL_CHECKPOINTS // (int)
        end
        
        0AD3: FUCK_CHRISTOPHER = format "CP%d_X" 0@
        0AF2: 3@ = get_float_from_ini_file "data\derby.ini" section v$RACE_FILE key FUCK_CHRISTOPHER
        0AD3: FUCK_CHRISTOPHER = format "CP%d_Y" 0@
        0AF2: 4@ = get_float_from_ini_file "data\derby.ini" section v$RACE_FILE key FUCK_CHRISTOPHER
        0AD3: FUCK_CHRISTOPHER = format "CP%d_Z" 0@                
        0AF2: 5@ = get_float_from_ini_file "data\derby.ini" section v$RACE_FILE key FUCK_CHRISTOPHER
        end
                 
        5@ += 1.0 
        Car.PutAt(CARMA_GLOB_DERBY_PLAYER_CAR, 3@, 4@, 5@)
        07C6: set_car CARMA_GLOB_DERBY_PLAYER_CAR axis_angle_relation_to 0.0 0.0 0.0 0.0
        
        008B: 0@ = CARMA_GLOB_PLAYER_CHECKPOINT_NUMBER // (int)
        0@ -= 1
            
        if
        0@ < 0
        then
        008B: 0@ = CARMA_GLOB_RACE_TOTAL_CHECKPOINTS // (int)
        end
        
        0AD3: FUCK_CHRISTOPHER = format "CP%d_A" 0@            
        if
        0AF2: 2@ = get_float_from_ini_file "data\derby.ini" section v$RACE_FILE key FUCK_CHRISTOPHER
        then
        0AF2: 6@ = get_float_from_ini_file "data\derby.ini" section v$RACE_FILE key FUCK_CHRISTOPHER                        
        car.Angle(CARMA_GLOB_DERBY_PLAYER_CAR) = 6@
        else
        Car.Angle(CARMA_GLOB_DERBY_PLAYER_CAR) = 6@  
        end          
        
        camera.Restore_WithJumpCut()                  
                
        wait 0
            
        if
        8ABE: not  vehicle CARMA_GLOB_DERBY_PLAYER_CAR engine_on
        then
        0918: set_car CARMA_GLOB_DERBY_PLAYER_CAR engine_operation 1
        end
        
        gosub @CARMA_RESTORE_UNFADE
            
        end
    end
    
:PLAYER_RESTORE_JUMPAFTER    

if and
$SPECTATING_FLAG == 0
not actor.Driving(PLAYER_ACTOR)
then    
jump to @CARMA_LOSE_JUMP
end            
    
if and
8185: not  car CARMA_GLOB_DERBY_PLAYER_CAR health >= 250
$SPECTATING_FLAG == 0
    then
    :CARMA_LOSE_JUMP        
    
    0084: CARMA_GLOB_TIME_VAR2 = CARMA_GLOB_TIME_VAR // (int)
    
    0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_FAILS"                
                    
    if
    $CHEATED_FLAG == 0 
    then   
    0@ += 1
    end        
                 
    0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_FAILS"
    gosub @TOURNAMENT_FAIL_CHECK
    
    v$CRM_TXT = "CRM3"
    create_thread @CRM_TEXT3
    
    CARMA_GLOB_CARMA_DEAD = 1    
    0E69: set_player_control_pad_movement 0 0 
    0829: actor PLAYER_ACTOR perform_animation "CAR_dead_LHS" IFP "ped" rate 4.0 time 0 and_dies
//    0A1A: actor PLAYER_ACTOR perform_walk_animation "ped" IFP "CAR_dead_LHS" framedelta 4.0 loopA 0 lockX 0 lockY 0 lockF 0 30000 ms
    
    Audiostream.Loop($AMM_WEAPON[25], 0)
    Audiostream.Volume($AMM_WEAPON[25]) = $SOUNDS_VOLUME
    Audiostream.PerformAction($AMM_WEAPON[25], PLAY)
    
    014F: stop_timer CARMA_GLOB_TIME_VAR
    0151: remove_status_text CARMA_GLOB_DERBY_CREDITS
    0151: remove_status_text CARMA_DERBY_LOSS
    
    $HUD_REMOVE = 1    
    
    gosub @ZOMBIEGEDDON_MUSIC_OFF    
     
    32@ = 0 
    
    repeat
    wait 0
    cinema.Radar(0)
    cinema.Widescreen(1)
    
    if
    016B:   fading
        then
        
        if
        SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
        then
        $HUD_REMOVE = 1
        0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_CRASH"
        0AF1: write_int 8 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_NUMBER"
        0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_PARAM"
        0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
        0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
        else
        $HUD_REMOVE = 1
        0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
        0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
        0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
        0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
        0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
        end
        
        end
    
    until 32@ > 5499   
    
    fade 0 100
    wait 100
    
    CLASSIC_MUSIC = 2        
    
    wait 1500
    
    $LOADING_THEME = Audiostream.Load("AUDIO\SOUNDS\loading_theme.wav") 
    
    Audiostream.PerformAction($LOADING_THEME, PLAY)
    Audiostream.Loop($LOADING_THEME, 1)
    0086: $MUSIC_VOLUME22 = $MUSIC_VOLUME // (float)
    $MUSIC_VOLUME22 *= 0.5
    Audiostream.Volume($LOADING_THEME) = $MUSIC_VOLUME22
    
    if
    SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
    then
    $HUD_REMOVE = 1
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_CRASH"
    0AF1: write_int 8 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_NUMBER"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_PARAM"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    else
    $HUD_REMOVE = 1
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end
    
    end
    
if and
CARMA_GLOB_TIME_VAR == 0
$SPECTATING_FLAG == 0
$SAVESTATUS == 0
    then
    
    0084: CARMA_GLOB_TIME_VAR2 = CARMA_GLOB_TIME_VAR // (int)
    
    0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_FAILS"                
                    
    if
    $CHEATED_FLAG == 0 
    then   
    0@ += 1
    end        
                 
    0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_FAILS"
    gosub @TOURNAMENT_FAIL_CHECK        
    
    v$CRM_TXT = "CRM4"
    create_thread @CRM_TEXT3
    
    player.CanMove(PLAYER_CHAR) = false
    
    Audiostream.Loop(19@, 0)
    Audiostream.Volume(19@) = $SOUNDS_VOLUME
    Audiostream.PerformAction(19@, PLAY)
    
    014F: stop_timer CARMA_GLOB_TIME_VAR
    0151: remove_status_text CARMA_GLOB_DERBY_CREDITS
    0151: remove_status_text CARMA_DERBY_LOSS
    
    $HUD_REMOVE = 1    
    
    gosub @ZOMBIEGEDDON_MUSIC_OFF    
     
    32@ = 0 
    
    repeat
    wait 0
    cinema.Radar(0)
    cinema.Widescreen(1)
    until 32@ > 5499
    
    fade 0 100
    wait 100
    
    CLASSIC_MUSIC = 2
    
    wait 1500
    
    $LOADING_THEME = Audiostream.Load("AUDIO\SOUNDS\loading_theme.wav") 
    
    Audiostream.PerformAction($LOADING_THEME, PLAY)
    Audiostream.Loop($LOADING_THEME, 1)
    0086: $MUSIC_VOLUME22 = $MUSIC_VOLUME // (float)
    $MUSIC_VOLUME22 *= 0.5
    Audiostream.Volume($LOADING_THEME) = $MUSIC_VOLUME22
    
    if
    SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
    then
    $HUD_REMOVE = 1
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_CRASH"
    0AF1: write_int 8 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_NUMBER"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_PARAM"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    else
    $HUD_REMOVE = 1
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end
    
    end
    
if and
not ZOMBIEGEDDON_GAME_TYPE == 2
002C:   CARMA_GLOB_DERBY_KILLED_PLAYER >= CARMA_GLOB_RACE_TOTAL_ZOMBIES  // (int)
$SAVESTATUS == 0
not CARMA_GLOB_1VS1_MODE == 1 
then

if
$ZOMBIES_PROCENT > 1.0
then
$ZOMBIES_PROCENT = 0.0
v$CRM_TXT = "CRM51"
create_thread @CRM_TEXT
CARMA_GLOB_TIME_VAR += 60000
end

if
$ZOMBIE_SPAWNED_COUNT == 0
    then
    jump to @CARMA_WIN
    end
end

if and
001C:   LAP_NUMBER > CARMA_GLOB_RACE_TOTAL_LAPS // (int)
not ZOMBIEGEDDON_GAME_TYPE == 3
$SAVESTATUS == 0
not CARMA_GLOB_1VS1_MODE == 1
    then 
    jump to @CARMA_WIN
    end
    
if and
ZOMBIEGEDDON_SOME_BOT_FINISHED_FLAG == 1
ZOMBIEGEDDON_GAME_TYPE == 1
$SAVESTATUS == 0
    then
    ZOMBIEGEDDON_SOME_BOT_FINISHED_FLAG = 0
    
    //////////////////////////////////////////////////////////////////////////////
    
    1@ = 1
    
    008B: 5@ = CARMA_GLOB_DERBY_CREDITS // (int)
    006E: 5@ *= CARMA_GLOB_TIME_VAR // (int)
    008B: 6@ = $PARK_CAR_ID[ZOMBIEGEDDON_SOME_BOT_FINISHED_NUMBER] // (int)
    006E: 6@ *= $PARK_CAR_ENGINE[ZOMBIEGEDDON_SOME_BOT_FINISHED_NUMBER] // (int)
    
    if
    001D:   5@ > 6@  // (int)
    then
    1@ = 0
    end
    
    for 2@ = 0 to CARMA_GLOB_OPPONENTS_COUNT
    
    if
    07D6:   2@ == ZOMBIEGEDDON_SOME_BOT_FINISHED_NUMBER // @ == $ (int) 
    then
    else
    
    008B: 5@ = $PARK_CAR_ID[ZOMBIEGEDDON_SOME_BOT_FINISHED_NUMBER] // (int)
    006E: 5@ *= $PARK_CAR_ENGINE[ZOMBIEGEDDON_SOME_BOT_FINISHED_NUMBER] // (int)
    008B: 6@ = $PARK_CAR_ID[2@] // (int)
    006E: 6@ *= $PARK_CAR_ENGINE[2@] // (int)
    
    if
    801D: not  5@ > 6@  // (int)
        then
        1@ = 0
        end
    
    end
    
    end
    
    /////////////////////////////////////////////////////////////////////////////
    
    if
    1@ == 1
    then
    
    0084: CARMA_GLOB_TIME_VAR2 = CARMA_GLOB_TIME_VAR // (int)
    
    0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_FAILS"                
                    
    if
    $CHEATED_FLAG == 0 
    then   
    0@ += 1
    end        
                 
    0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_FAILS"
    gosub @TOURNAMENT_FAIL_CHECK        
    
    v$2NAME1 = "N_ME" // v$ // Sunday
    0665: get_actor $PARK_CAR_DAMAGED[ZOMBIEGEDDON_SOME_BOT_FINISHED_NUMBER] model_to 2@
    if
    2@ > 10000
    then
    v$2NAME1 = "N_" // v$ // Sunday
    end
    0AD3: v$2NAME2 = format "%d" 2@
    098B: v$2NAME3 = v$2NAME1 + v$2NAME2 // all string variables
        
    create_thread @CRM_TEXT28
    
    player.CanMove(PLAYER_CHAR) = false
    
    Audiostream.Loop(19@, 0)
    Audiostream.Volume(19@) = $SOUNDS_VOLUME
    Audiostream.PerformAction(19@, PLAY)
    
    014F: stop_timer CARMA_GLOB_TIME_VAR
    0151: remove_status_text CARMA_GLOB_DERBY_CREDITS
    0151: remove_status_text CARMA_DERBY_LOSS
    
    $HUD_REMOVE = 1    
    
    gosub @ZOMBIEGEDDON_MUSIC_OFF    
     
    32@ = 0 
    
    repeat
    wait 0
    cinema.Radar(0)
    cinema.Widescreen(1)
    until 32@ > 5499
    
    fade 0 100
    wait 100
    
    CLASSIC_MUSIC = 2
    
    wait 1500
    
    $LOADING_THEME = Audiostream.Load("AUDIO\SOUNDS\loading_theme.wav") 
    
    Audiostream.PerformAction($LOADING_THEME, PLAY)
    Audiostream.Loop($LOADING_THEME, 1)
    0086: $MUSIC_VOLUME22 = $MUSIC_VOLUME // (float)
    $MUSIC_VOLUME22 *= 0.5
    Audiostream.Volume($LOADING_THEME) = $MUSIC_VOLUME22
    
    if
    SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
    then
    $HUD_REMOVE = 1
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_CRASH"
    0AF1: write_int 8 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_NUMBER"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_PARAM"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    else
    $HUD_REMOVE = 1
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end
    
    else
    
    v$2NAME1 = "N_ME" // v$ // Sunday
    0665: get_actor $PARK_CAR_DAMAGED[ZOMBIEGEDDON_SOME_BOT_FINISHED_NUMBER] model_to 2@
    if
    2@ > 10000
    then
    v$2NAME1 = "N_" // v$ // Sunday
    end
    0AD3: v$2NAME2 = format "%d" 2@
    098B: v$2NAME3 = v$2NAME1 + v$2NAME2 // all string variables
        
    create_thread @CRM_TEXT29
    
    end
    
    end
    
if and
ZOMBIEGEDDON_SOME_BOT_FINISHED_FLAG == 1
ZOMBIEGEDDON_GAME_TYPE == 2
$SAVESTATUS == 0
$SPECTATING_FLAG == 0
    then
    ZOMBIEGEDDON_SOME_BOT_FINISHED_FLAG = 0
        
    /////////////////////////////////////////////////////////////////////////////    
    
    0084: CARMA_GLOB_TIME_VAR2 = CARMA_GLOB_TIME_VAR // (int)
    
    0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_FAILS"                
                    
    if
    $CHEATED_FLAG == 0 
    then   
    0@ += 1
    end        
                 
    0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_FAILS"
    gosub @TOURNAMENT_FAIL_CHECK        
    
    v$2NAME1 = "N_ME" // v$ // Sunday
    0665: get_actor $PARK_CAR_DAMAGED[ZOMBIEGEDDON_SOME_BOT_FINISHED_NUMBER] model_to 2@
    if
    2@ > 10000
    then
    v$2NAME1 = "N_" // v$ // Sunday
    end
    0AD3: v$2NAME2 = format "%d" 2@
    098B: v$2NAME3 = v$2NAME1 + v$2NAME2 // all string variables
        
    create_thread @CRM_TEXT28
    
    player.CanMove(PLAYER_CHAR) = false    
    
    014F: stop_timer CARMA_GLOB_TIME_VAR
    0151: remove_status_text CARMA_GLOB_DERBY_CREDITS
    0151: remove_status_text CARMA_DERBY_LOSS
    
    $HUD_REMOVE = 1    
    
    gosub @ZOMBIEGEDDON_MUSIC_OFF    
     
    32@ = 0 
    
    repeat
    wait 0
    cinema.Radar(0)
    cinema.Widescreen(1)
    until 32@ > 5499
    
    fade 0 100
    wait 100
    
    CLASSIC_MUSIC = 2
    
    wait 1500
    
    $LOADING_THEME = Audiostream.Load("AUDIO\SOUNDS\loading_theme.wav") 
    
    Audiostream.PerformAction($LOADING_THEME, PLAY)
    Audiostream.Loop($LOADING_THEME, 1)
    0086: $MUSIC_VOLUME22 = $MUSIC_VOLUME // (float)
    $MUSIC_VOLUME22 *= 0.5
    Audiostream.Volume($LOADING_THEME) = $MUSIC_VOLUME22
    
    if
    SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
    then
    $HUD_REMOVE = 1
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_CRASH"
    0AF1: write_int 8 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_NUMBER"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_PARAM"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    else
    $HUD_REMOVE = 1
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end    
    
    end
    
if and
$CHEATS_ON == 1
ZOMBEGEDDON_TOURNAMENT == 1
    then
    if
    0E3D: is_key_just_pressed 107
        then
        015D: set_gamespeed 15.0 
        $CHEAT_CODE_ACTIVATED = 1
        jump to @CARMA_WIN
        end 
    end                            
    
if and
CARMA_GLOB_OPPONENTS_WRECKED >= CARMA_GLOB_OPPONENTS_COUNT
$SPECTATING_FLAG == 0
$SAVESTATUS == 0
    then
    :CARMA_WIN
    CARMA_GLOB_CARMA_WIN = 1
    car.SetImmunities(CARMA_GLOB_DERBY_PLAYER_CAR,1,1,1,1,1)
    
    if
    ZOMBEGEDDON_TOURNAMENT == 0
    then
    $STATS_SHOW_GAMEMODE = 6
    $STATS_DONT_SHOW_FLAG = 1
    create_thread @STS_SHW
    end
    
    0084: CARMA_GLOB_TIME_VAR2 = CARMA_GLOB_TIME_VAR // (int)
    
    0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_WINS"                
                    
    if
    $CHEATED_FLAG == 0 
    then   
    0@ += 1
    end        
                 
    0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_WINS"
    gosub @TOURNAMENT_ADVANCE
    
    if
    CARMA_GLOB_OPPONENTS_WRECKED >= CARMA_GLOB_OPPONENTS_COUNT
    then
    v$CRM_TXT = "CRM5"
    create_thread @CRM_TEXT3
    
    /////////////////////////////////////////////////////////////
    if
    UNITED_MAP == 0
    then
    
    if
    ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
    then
    0AD3: v$LADDER_FILE2 = format "COPP%d" CARMA_GLOB_RACE_NUMBER
    else
    
    if
    CLASSIC_CARMA_MAP_AC_MODE == 0
    then
    0AD3: v$LADDER_FILE2 = format "3OPP%d" CARMA_GLOB_RACE_NUMBER
    else
    0AD3: v$LADDER_FILE2 = format "4OPP%d" CARMA_GLOB_RACE_NUMBER
    end
    
    end
    
    else
    
    if
    $UNITED_III_SPAWN == 1
    then
    0AD3: v$LADDER_FILE2 = format "1COPP%d" CARMA_GLOB_RACE_NUMBER
    else
    0AD3: v$LADDER_FILE2 = format "2COPP%d" CARMA_GLOB_RACE_NUMBER
    end
    
    end
    /////////////////////////////////////////////////////////////
    
    if
    ZOMBEGEDDON_TOURNAMENT == 0
    then
    0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
    if
    not 0@ == 2
        then
        0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
        end    
    else
    0AF1: write_int 2 to_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
    end
    
    end
    
    if
    002C:   CARMA_GLOB_DERBY_KILLED_PLAYER >= CARMA_GLOB_RACE_TOTAL_ZOMBIES  // (int)
    then
    v$CRM_TXT = "CRM11"
    create_thread @CRM_TEXT3
    
    /////////////////////////////////////////////////////////////
    if
    UNITED_MAP == 0
    then
    
    if
    ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
    then
    0AD3: v$LADDER_FILE2 = format "CPPL%d" CARMA_GLOB_RACE_NUMBER
    else
    
    if
    CLASSIC_CARMA_MAP_AC_MODE == 0
    then
    0AD3: v$LADDER_FILE2 = format "3PPL%d" CARMA_GLOB_RACE_NUMBER
    else
    0AD3: v$LADDER_FILE2 = format "4PPL%d" CARMA_GLOB_RACE_NUMBER
    end
    
    end
    
    else
    
    if
    $UNITED_III_SPAWN == 1
    then
    0AD3: v$LADDER_FILE2 = format "1PPL%d" CARMA_GLOB_RACE_NUMBER
    else
    0AD3: v$LADDER_FILE2 = format "2PPL%d" CARMA_GLOB_RACE_NUMBER
    end
    
    end
    /////////////////////////////////////////////////////////////
    
    if
    ZOMBEGEDDON_TOURNAMENT == 0
    then
    0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
    if
    not 0@ == 2
        then
        0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
        end    
    else
    0AF1: write_int 2 to_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
    end
    
    end
    
    if
    001C:   LAP_NUMBER > CARMA_GLOB_RACE_TOTAL_LAPS // (int)
    then
    
    if
    not ZOMBIEGEDDON_GAME_TYPE == 2
    then
    v$CRM_TXT = "CRM13"
    else
    v$CRM_TXT = "CRM53"
    end
    
    create_thread @CRM_TEXT3
    
    /////////////////////////////////////////////////////////////
    if
    UNITED_MAP == 0
    then
    
    if
    ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
    then
    0AD3: v$LADDER_FILE2 = format "CRACE%d" CARMA_GLOB_RACE_NUMBER
    else
    
    if
    CLASSIC_CARMA_MAP_AC_MODE == 0
    then
    0AD3: v$LADDER_FILE2 = format "3RACE%d" CARMA_GLOB_RACE_NUMBER
    else
    0AD3: v$LADDER_FILE2 = format "4RACE%d" CARMA_GLOB_RACE_NUMBER
    end
    
    end
    
    else
    
    if
    $UNITED_III_SPAWN == 1
    then
    0AD3: v$LADDER_FILE2 = format "1CRACE%d" CARMA_GLOB_RACE_NUMBER
    else
    0AD3: v$LADDER_FILE2 = format "2CRACE%d" CARMA_GLOB_RACE_NUMBER
    end
    
    end
    /////////////////////////////////////////////////////////////
    
    if
    ZOMBEGEDDON_TOURNAMENT == 0
    then
    0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
    if
    not 0@ == 2
        then
        0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
        end    
    else
    0AF1: write_int 2 to_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2
    end
    
    end
    
    create_thread @CRM_CAM    
    
    0084: LAP_NUMBER = CARMA_GLOB_RACE_TOTAL_LAPS // (int)
    014F: stop_timer CARMA_GLOB_TIME_VAR
    0151: remove_status_text CARMA_GLOB_DERBY_CREDITS
    0151: remove_status_text CARMA_DERBY_LOSS
    
    Audiostream.Volume(28@) = $SOUNDS_VOLUME
    Audiostream.PerformAction(28@, PLAY)
    
    $HUD_REMOVE = 1
    cinema.Radar(0)
    
//    if and
//    $CHEATS_ON == 1
//    ZOMBIEGEDDON_GAME_TYPE == 2
//    then
//    
//    car.StorePos(ZOMBIEGEDDON_PATH_CAR,0@,1@,2@)
//    
//    repeat
//    wait 0
//    until 00EC:   actor PLAYER_ACTOR sphere 0 near_point 0@ 1@ radius 12.5 12.5
//    
//    car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,true)
//     
//    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME    
//    wait 9999999
//    end
    
    if
    $SPECTATING_FLAG == 0
    then
//    06A2: get_car CARMA_GLOB_DERBY_PLAYER_CAR velocity_in_direction_XYZ 8@ 9@ 10@
//    8@ *= 0.02
//    9@ *= 0.02
//    10@ *= 0.02
//    car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,true)    
//    player.CanMove(PLAYER_CHAR) = false
//    wait 0
//    car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,true)
//    car.SetSpeedInstantly(CARMA_GLOB_DERBY_PLAYER_CAR,0.0)
//    car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,false)            
//    07D5: set_car CARMA_GLOB_DERBY_PLAYER_CAR velocity_in_direction_XYZ 8@ 9@ 10@ rotation_velocitiesXY 0.0 0.0 unk 0.0
    else
    player.CanMove(PLAYER_CHAR) = false
    end 
    
    if and
    ZOMBIEGEDDON_GAME_TYPE == 2
    $SPECTATING_FLAG == 0
    then
    
    if
    $FP_ACTIVATED == 1
    then
    $FP_ON = 0
    
    repeat
    wait 0
    until $FP_ACTIVATED == 0
    
    end
    
    0430: put_actor PLAYER_ACTOR into_car CARMA_GLOB_DERBY_PLAYER_CAR passenger_seat 0
    0337: set_actor PLAYER_ACTOR visibility 0
    
    0665: get_actor PLAYER_ACTOR model_to 4@    
    while not model.Available(4@)    
    model.Load(4@)
    mload
    if
    not model.Available(4@)
    then
    wait 0
    end
    
    end
    
    2@ = actor.CreateAsDriver(26,4@,CARMA_GLOB_DERBY_PLAYER_CAR)
    09F6: set_actor 2@ get_out_of_upside_down_car 0
    
    Car.SetToNormalDriver(CARMA_GLOB_DERBY_PLAYER_CAR)
    00AE: set_car CARMA_GLOB_DERBY_PLAYER_CAR traffic_behaviour_to 2  
    0423: set_car CARMA_GLOB_DERBY_PLAYER_CAR improved_handling_to 3.0 // (float)
    car.SetMaxSpeed(CARMA_GLOB_DERBY_PLAYER_CAR,100.0)
    
    end               
    
    text.ClearAll()     
    32@ = 0
    4@ = 1                
    
    repeat
    wait 0
    gosub @DERBYGEDDON_CP_RUSH_AFTERDRIVE
    until 32@ > 1199
    
    Audiostream.Volume(30@) = $SOUNDS_VOLUME
    Audiostream.PerformAction(30@, PLAY)
    
    if
    ZOMBEGEDDON_TOURNAMENT == 1
    then
    0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    0AF0: 1@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"
    
    if
    003B:   0@ == 1@  // (int)
        then        
        0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
        0AF1: write_int -1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
        0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_TOURNAMENT"
        
        0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_TOURNAMENT_WINS"                
                        
        if
        $CHEATED_FLAG == 0 
        then   
        0@ += 1
        end        
                     
        0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_TOURNAMENT_WINS"
        
        random_int 0@ 23 to 25
        Audiostream.Loop($AMM_WEAPON[0@], 0)
        Audiostream.Volume($AMM_WEAPON[0@]) = $SOUNDS_VOLUME
        Audiostream.PerformAction($AMM_WEAPON[0@], PLAY)
        
        end
    
    end
    
    0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    0AF0: 1@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"
    
    repeat
    wait 0
    
    gosub @DERBYGEDDON_CP_RUSH_AFTERDRIVE        
    
    if
    ZOMBEGEDDON_TOURNAMENT == 1
        then
        0AF0: 29@ = get_int_from_ini_file "data\derby_Tournament.ini" section "PLAYED_TIME" key "DERBY_MINUTES" 
        0AF0: 30@ = get_int_from_ini_file "data\derby_Tournament.ini" section "PLAYED_TIME" key "DERBY_HOURS"
        end
    
    if
    ZOMBEGEDDON_TOURNAMENT == 1
        then        

        03F0: enable_text_draw 1
        0340: set_text_draw_RGBA 255 255 255 255
        03E0: draw_text_behind_textures 1
        03E3: set_texture_to_be_drawn_antialiased 1
        0349: set_text_draw_font 2
        if
        DIRECTFONT_INSTALLED == 1
        then    
        0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
        end
         
        033F: set_text_draw_letter_size 0.4 1.15 
        081C: draw_text_outline 1 RGBA 0 0 0 255
        0342: set_text_draw_centered 1
        0344: set_text_draw_linewidth 640.0 for_centered_text
        
        if
        002D:   0@ >= 1@  // (int)
        then
        033E: set_draw_text_position 320.0 10.0 GXT 'CRM57'  // Push
        else 
        045B: draw_text_2numbers 320.0 10.0 GXT 'CRM56' numbers 0@ 1@  // ~1~:~1~
        end
                         
        if
        002D:   0@ >= 1@  // (int)
        then
        
        03F0: enable_text_draw 1
        0340: set_text_draw_RGBA 255 255 255 255
        03E0: draw_text_behind_textures 1
        03E3: set_texture_to_be_drawn_antialiased 1
        0349: set_text_draw_font 2
        if
        DIRECTFONT_INSTALLED == 1
        then    
        0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
        end
         
        033F: set_text_draw_letter_size 0.4 1.15 
        081C: draw_text_outline 1 RGBA 0 0 0 255
        0342: set_text_draw_centered 1
        0344: set_text_draw_linewidth 640.0 for_centered_text
        
        045B: draw_text_2numbers 320.0 24.0 GXT 'CRM59' numbers 30@ 29@  // ~1~:~1~
        end
        
        end
    
    until CAMP_RAID_FLAG == 1
        
    if
    ZOMBEGEDDON_TOURNAMENT == 1
    then
    0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    0AF0: 1@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"    
    if
    003B:   0@ == 1@  // (int)
        then
        $STATS_SHOW_GAMEMODE = 61
        $STATS_DONT_SHOW_FLAG = 1
        create_thread @STS_SHW
        
        repeat
        wait 0
        until $STATS_SHOW_END == 1
        
        0B00: delete_file "data\derby_Tournament.ini"  // IF and SET
        end    
    end
     
    fade 0 100
    wait 100
    015D: set_gamespeed 1.0
    $SPEED_08_FLAG = 0
    $HUD_REMOVE = 1
    
    gosub @ZOMBIEGEDDON_MUSIC_OFF
    
    CLASSIC_MUSIC = 2  
    
    wait 1500
    
    $LOADING_THEME = Audiostream.Load("AUDIO\SOUNDS\loading_theme.wav") 
    
    Audiostream.PerformAction($LOADING_THEME, PLAY)
    Audiostream.Loop($LOADING_THEME, 1)
    0086: $MUSIC_VOLUME22 = $MUSIC_VOLUME // (float)
    $MUSIC_VOLUME22 *= 0.5
    Audiostream.Volume($LOADING_THEME) = $MUSIC_VOLUME22  
    
    if
    ZOMBEGEDDON_TOURNAMENT == 0
    then
    
    if
    SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
    then
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_CRASH"
    0AF1: write_int 8 to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_NUMBER"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "GAMEMODE_AUTOSELECT_PARAM"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    else
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end
    
    else
    
    if and
    ZOMBEGEDDON_TOURNAMENT == 1
    8AAB: not  file_exists "data\derby_Tournament.ini"
    then
    0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int -1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 0 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"    
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    else
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    end
    
    end
    
    end

008B: 0@ = CARMA_GLOB_OPPONENTS_COUNT3 // (int)
0@ -= 1    
if and
002E:   CARMA_GLOB_OPPONENTS_WRECKED >= 0@  // (int)
$SPECTATING_FLAG == 1
    then
    
    fade 0 100
    wait 100
    015D: set_gamespeed 1.0
    $SPEED_08_FLAG = 0
    $HUD_REMOVE = 1
        
    gosub @ZOMBIEGEDDON_MUSIC_OFF
    
    CLASSIC_MUSIC = 2  
        
    wait 1500
        
    $LOADING_THEME = Audiostream.Load("AUDIO\SOUNDS\loading_theme.wav") 
        
    Audiostream.PerformAction($LOADING_THEME, PLAY)
    Audiostream.Loop($LOADING_THEME, 1)
    0086: $MUSIC_VOLUME22 = $MUSIC_VOLUME // (float)
    $MUSIC_VOLUME22 *= 0.5
    Audiostream.Volume($LOADING_THEME) = $MUSIC_VOLUME22  
        
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    
    end
    
if and
ZOMBIEGEDDON_SOME_BOT_FINISHED_FLAG == 1
ZOMBIEGEDDON_GAME_TYPE == 2
$SAVESTATUS == 0
$SPECTATING_FLAG == 1
    then
    
    fade 0 100
    wait 100
    015D: set_gamespeed 1.0
    $SPEED_08_FLAG = 0
    $HUD_REMOVE = 1
        
    gosub @ZOMBIEGEDDON_MUSIC_OFF
    
    CLASSIC_MUSIC = 2  
        
    wait 1500
        
    $LOADING_THEME = Audiostream.Load("AUDIO\SOUNDS\loading_theme.wav") 
        
    Audiostream.PerformAction($LOADING_THEME, PLAY)
    Audiostream.Loop($LOADING_THEME, 1)
    0086: $MUSIC_VOLUME22 = $MUSIC_VOLUME // (float)
    $MUSIC_VOLUME22 *= 0.5
    Audiostream.Volume($LOADING_THEME) = $MUSIC_VOLUME22  
        
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
    0AF1: write_int ZOMBIEGEDDON_GAME_TYPE to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
    0AF1: write_int $SPECTATING_FLAG to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_SPECTATE"
    0AF1: write_int 1 to_ini_file "saves\ZACM.set" section "SCR" key "NO_INIT_TEXT_FLAG"
    0A8C: write_memory 0xBA67A5 size 4 value 1 virtual_protect 0 // RESTART GAME
    
    end                               

end

end_thread

:PORTRAIT_RELOAD_CHECK

if or
803A: not  ANNA_FLAG == ANNA_FLAG_PREV // (int)
0AB0:   key_pressed 49
    then
    
//    0AD1: show_formatted_text_highpriority "PORTRAIT RELOAD START" time 2000
    
    PORTRAIT_RELOAD_FLAG = 1
    
    for 0@ = 0 to 32
    audiostream.Release($AMM_WEAPON[0@])
    end
    
    gosub @CARMA_LOAD_SOUNDS2    
    
    end

return

:CARMA_RESTORE_UNFADE

text.ShowStyled('CRM76',1500,5)

9@ = 255
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 9@
fade 1 0
wait 0
create_thread @3D_REFR
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 9@

repeat
wait 0
9@ -= 51
03F0: enable_text_draw 1
038E: draw_box_position 320.0 224.0 size 640.0 448.0 RGBA 0 0 0 9@
until 9@ == 0

9@ = 0

repeat
wait 0
9@ += 15
until 9@ == 15

015D: set_gamespeed 1.0 

return

:DISTANCE_CALCULATE_PLAYER

///////////////////////

if and
ZOMBIEGEDDON_GAME_TYPE == 2
CARMA_GLOB_RACE_STARTED == 1
not CARMA_REPLAY_FLAG == 1
then

03F0: enable_text_draw 1
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
if
CLASSIC_CARMA_MAP > 0
then
081C: draw_text_outline 2 RGBA 0 0 0 255
else
081C: draw_text_outline 1 RGBA 0 0 0 255
end

//0AF2: 3@ = get_float_from_ini_file "debug\timerass.ini" section "FUCK" key "X"
//0AF2: 2@ = get_float_from_ini_file "debug\timerass.ini" section "FUCK" key "Y"
033F: set_text_draw_letter_size 0.325 1.55
03E0: draw_text_behind_textures 1

if or
CARMA_CPRUSH_LAP_REC_BEST_MINUTES > 0
CARMA_CPRUSH_LAP_REC_BEST_SECONDS > 0
then
 
if
CARMA_CPRUSH_LAP_REC_BEST_SECONDS < 10
then
045B: draw_text_2numbers 570.0 152.5 GXT 'AME996B' numbers CARMA_CPRUSH_LAP_REC_BEST_MINUTES CARMA_CPRUSH_LAP_REC_BEST_SECONDS  // ~1~:~1~
else
045B: draw_text_2numbers 570.0 152.5 GXT 'GAME996' numbers CARMA_CPRUSH_LAP_REC_BEST_MINUTES CARMA_CPRUSH_LAP_REC_BEST_SECONDS  // ~1~:~1~
end

else
033E: set_draw_text_position 570.0 152.5 GXT 'AME996C'  // Push
end

03F0: enable_text_draw 1
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
if
CLASSIC_CARMA_MAP > 0
then
081C: draw_text_outline 2 RGBA 0 0 0 255
else
081C: draw_text_outline 1 RGBA 0 0 0 255
end

033F: set_text_draw_letter_size 0.325 1.55
03E0: draw_text_behind_textures 1

if or
CARMA_CPRUSH_LAP_REC_CURR_MINUTES > 0
CARMA_CPRUSH_LAP_REC_CURR_SECONDS > 0
then
 
if
CARMA_CPRUSH_LAP_REC_CURR_SECONDS < 10
then
045B: draw_text_2numbers 570.0 169.5 GXT 'AME997B' numbers CARMA_CPRUSH_LAP_REC_CURR_MINUTES CARMA_CPRUSH_LAP_REC_CURR_SECONDS  // ~1~:~1~
else
045B: draw_text_2numbers 570.0 169.5 GXT 'GAME997' numbers CARMA_CPRUSH_LAP_REC_CURR_MINUTES CARMA_CPRUSH_LAP_REC_CURR_SECONDS  // ~1~:~1~
end

else
033E: set_draw_text_position 570.0 169.5 GXT 'AME997C'  // Push
end

end

///////////////////////

008B: 3@ = CARMA_GLOB_OPPONENTS_COUNT2 // (int)
0064: 3@ -= CARMA_GLOB_OPPONENTS_WRECKED  // (int)

////////////////////////////////////////////////////////////////////////////

for 2@ = 0 to CARMA_GLOB_OPPONENTS_COUNT

if
056E:   car $PARK_CAR[2@] defined
    then
    
    if
    not car.Wrecked($PARK_CAR[2@])
        then
        
        /////////////////////////////////////////////////////////////////////////////
        
        if
        001C:   LAP_NUMBER > $PARK_CAR_H_MAX[2@] // (int)
            then
            3@ -= 1
            else
                
            /////////////////////
                
            if
            003A:   LAP_NUMBER == $PARK_CAR_H_MAX[2@] // (int)
                then                    
                if
                001F:   PLAYER_CHECKPOINT_NUMBER > $PARK_CAR_H_MIN[2@] // (int)
                    then
                    3@ -= 1
                    else
                        
                    if
                    003A:   PLAYER_CHECKPOINT_NUMBER == $PARK_CAR_H_MIN[2@] // (int)
                    then
                    
                    car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,4@,5@,6@)
                    050A: 7@ = distance_between_XYZ 4@ 5@ 6@ and_XYZ $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER]
                    car.StorePos($PARK_CAR[2@],4@,5@,6@)
                    050A: 8@ = distance_between_XYZ 4@ 5@ 6@ and_XYZ $RNDM_HOUSE_ITEM_X[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Y[PLAYER_CHECKPOINT_NUMBER] $RNDM_HOUSE_ITEM_Z[PLAYER_CHECKPOINT_NUMBER]
                        
                    if
                    0025:   8@ > 7@  // (float)
                        then
                        3@ -= 1
                        end
                        
                    end
                        
                    end                                        
                end
                    
            /////////////////////
                
            end
            
        /////////////////////////////////////////////////////////////////////////////    
            
        end
    
    end    

end

////////////////////////////////////////////////////////////////////////////

if
CARMA_REPLAY_FLAG == 1
then
3@ -= 1
end 

0084: $VERSUS_PEOPLE[3@] = CARMA_GLOB_DERBY_PLAYER_CAR // (int)
0085: CARMA_PLAYER_POSITION = 3@ // (int)

//0AD1: show_formatted_text_highpriority "PLA_DIST: %f" time 2000 CARMA_PLAYER_CAR_DISTANCE

return

:DERBY_RANDOM_TIME
if and
CARMA_GLOB_RACE_NUMBER == 14
not ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
then
return
end 
0209: 10@ = random_int_in_ranges 0 23
0209: 11@ = random_int_in_ranges 0 59
00C0: set_current_time_hours_to 10@ minutes_to 11@

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
CARMA_GLOB_RACE_NUMBER == 0
then
00C0: set_current_time_hours_to 0 minutes_to 0
end
 
return

:DERBY_RANDOM_PLAYER_MODEL
wait 0                      

if
UNITED_MAP == 0
then
0209: $RANDOM_MODE_MODEL = random_int_in_ranges 7 285
else

if
$UNITED_III_SPAWN == 0
then

if
STORIES_MAP == 0
then
0209: $RANDOM_MODE_MODEL = random_int_in_ranges MINID_VC_SKIN MAXID_VC_SKIN
else
0209: $RANDOM_MODE_MODEL = random_int_in_ranges MINID_VCS_SKIN MAXID_VCS_SKIN
end

else

if
STORIES_MAP == 0
then
0209: $RANDOM_MODE_MODEL = random_int_in_ranges MINID_III_SKIN MAXID_III_SKIN
else
0209: $RANDOM_MODE_MODEL = random_int_in_ranges MINID_LCS_SKIN MAXID_LCS_SKIN
end

end

end
 
if
07DE:   model $RANDOM_MODE_MODEL exists  // versionB
jf @DERBY_RANDOM_PLAYER_MODEL

0AD3: v$FP_FILE = format "%d" $RANDOM_MODE_MODEL
0AF0: 1@ = get_int_from_ini_file "data/skins.ini" section "LOCKED" key v$FP_FILE
if
not 1@ == 1
jf @DERBY_RANDOM_PLAYER_MODEL

model.Load($RANDOM_MODE_MODEL)
mload

09C7: change_player PLAYER_CHAR model_to $RANDOM_MODE_MODEL

0D10: set_actor PLAYER_ACTOR alpha 255 // IF and SET

v$NAME1 = "N_ME" // v$ // Sunday
0665: get_actor PLAYER_ACTOR model_to 1@
if
1@ > 10000
then
v$NAME2 = "N_" // v$ // Sunday
end
0AD3: v$NAME2 = format "%d" 1@
098B: v$NAME3 = v$NAME1 + v$NAME2 // all string variables

if
FREEMODE_CUSTOM_NAME == 1 
then
06D1: v$NAME3 = "F_NAME" // v$ = string
end
    
3@ = 0
return

:ZOMBIE_DERBY_CREATE_CAR_FOR_PLAYER

if
model.Available(CARMA_GLOB_PLAYER_MODEL)
then

actor.StorePos(PLAYER_ACTOR,9@,10@,11@)
CARMA_GLOB_DERBY_PLAYER_CAR = car.Create(CARMA_GLOB_PLAYER_MODEL,9@, 10@, 11@)
0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position 9@ 10@ 11@ 

if
CARMA_REPLAY_FLAG == 1
then
0AF0: 0@ = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "INFO" key "CAR_COLOR1"
0AF0: 1@ = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "INFO" key "CAR_COLOR2"
0229: set_car CARMA_GLOB_DERBY_PLAYER_CAR primary_color_to 0@ secondary_color_to 1@
end

car.Health(CARMA_GLOB_DERBY_PLAYER_CAR) = 1000

0@ = actor.Angle(PLAYER_ACTOR)
car.Angle(CARMA_GLOB_DERBY_PLAYER_CAR) = 0@ 
Car.DoorStatus(CARMA_GLOB_DERBY_PLAYER_CAR) = 2

//if
//UNITED_MAP == 0
//then
//
//if and
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 15496
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 444
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 556
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 557
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 15497
//then 
//07FF: set_car CARMA_GLOB_DERBY_PLAYER_CAR hydraulics 1
//end
//
//end

if
model.Available(CARMA_GLOB_PLAYER_MODEL)
then
//model.Destroy(CARMA_GLOB_PLAYER_MODEL)
end

else
model.Load(CARMA_GLOB_PLAYER_MODEL)
mload
wait 0
jump to @ZOMBIE_DERBY_CREATE_CAR_FOR_PLAYER
end   

return

:RECREATE_DERBY_PLAYER_CAR

car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,9@,10@,11@)
11@ += 1.25
12@ = car.Angle(CARMA_GLOB_DERBY_PLAYER_CAR)
04C4: store_coords_to 4@ 5@ 6@ from_actor PLAYER_ACTOR with_offset 0.0 0.0 50.0
0362: remove_actor PLAYER_ACTOR from_car_and_place_at 4@ 5@ 6@
car.Destroy(CARMA_GLOB_DERBY_PLAYER_CAR)

:RECREATE_DERBY_PLAYER_CAR2

if
model.Available(CARMA_GLOB_PLAYER_MODEL)
then

CARMA_GLOB_DERBY_PLAYER_CAR = car.Create(CARMA_GLOB_PLAYER_MODEL,9@, 10@, 11@)
0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position 9@ 10@ 11@ 

if
CARMA_REPLAY_FLAG == 1
then
0AF0: 0@ = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "INFO" key "CAR_COLOR1"
0AF0: 1@ = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "INFO" key "CAR_COLOR2"
0229: set_car CARMA_GLOB_DERBY_PLAYER_CAR primary_color_to 0@ secondary_color_to 1@
end

car.Health(CARMA_GLOB_DERBY_PLAYER_CAR) = 1000

car.Angle(CARMA_GLOB_DERBY_PLAYER_CAR) = 12@ 
Car.DoorStatus(CARMA_GLOB_DERBY_PLAYER_CAR) = 2

//if
//UNITED_MAP == 0
//then
//
//if and
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 15496
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 444
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 556
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 557
//not car.Model(CARMA_GLOB_DERBY_PLAYER_CAR) == 15497
//then 
//07FF: set_car CARMA_GLOB_DERBY_PLAYER_CAR hydraulics 1
//end
//
//end

if
model.Available(CARMA_GLOB_PLAYER_MODEL)
then
//model.Destroy(CARMA_GLOB_PLAYER_MODEL)
end

else
model.Load(CARMA_GLOB_PLAYER_MODEL)
mload
wait 0
jump to @RECREATE_DERBY_PLAYER_CAR2
end   

return

:ZOMBIEGEDDON_MUSIC_OFF 

$DELETE_SOUND = 1
 
$MUSIC_FADE_NUMBER += 1
if
$MUSIC_FADE_NUMBER > 4
    then
    $MUSIC_FADE_NUMBER = 0 
    end    

0084: $MUSIC_FADE1[$MUSIC_FADE_NUMBER] = $SELECT_MUSIC // (int)
$MUSIC_FADE_END_VOLUME[$MUSIC_FADE_NUMBER] = 0.0

$MUSIC_FADE_TIME[$MUSIC_FADE_NUMBER] = 250
$MUSIC_FADE_FLAG[$MUSIC_FADE_NUMBER] = 0  
$MUSIC_FADE_COUNT[$MUSIC_FADE_NUMBER] = 1 
create_thread @MUS_FAD

wait 1

while $MUSIC_FADE_ENDED[$MUSIC_FADE_NUMBER] == 0
wait 0
cinema.Radar(0)
cinema.Widescreen(1)
end

return

:RACE_SELECT

/////////Звук давки зомби
CARMA_VOICE_BUTT = Audiostream.Load("audio\sounds\other\zombiegeddon\BUTT.wav")
CARMA_VOICE_DONE = Audiostream.Load("audio\sounds\other\zombiegeddon\DONE.wav")
CARMA_VOICE_FART = Audiostream.Load("audio\sounds\other\zombiegeddon\PARTNO.WAV")

actor.LockInCurrentPosition(PLAYER_ACTOR,true)

///////////////////////////////////////////////////////////////////////////////////////////////////

gosub @CARMA_TELEPORT_ACTOR
actor.LockInCurrentPosition(PLAYER_ACTOR,true)
0337: set_actor PLAYER_ACTOR visibility 0
cinema.Widescreen(1)

if
CLASSIC_CARMA_MAP >= 1
then
008B: 29@ = CARMA_GLOB_MAP_NABOR_TOTAL_MAPS // (int)
end

if and
CARMA_REPLAY_FLAG == 0
GAMEMODE_AUTOSELECT == -1
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
then
CARMA_GLOB_PICTURE_OFF = 1
09C1: add_next_text_to_brief_history 0

if
ZOMBEGEDDON_TOURNAMENT == 0
then

if and
CARMA_REPLAY_FLAG == 0
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
then   
0512: show_permanent_text_box 'CRM61'
else
if or
ZOMBIEGEDDON_GAME_TYPE == 2
ZOMBIEGEDDON_GAME_TYPE == 3
    then
    if and
    CARMA_REPLAY_FLAG == 0
    not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
        then
        0512: show_permanent_text_box 'CRM61C'
        end
    else
    0512: show_permanent_text_box 'CRM61B'
    end
end

end

fade 1 1000  
end

33@ = 0

while true
wait 0

if
00E1:   player 0 pressed_key 14
then
Audiostream.PerformAction(CARMA_VOICE_DONE, PLAY)
Audiostream.Loop(CARMA_VOICE_DONE, 0)
Audiostream.Volume(CARMA_VOICE_DONE) = $SOUNDS_VOLUME
fade 0 150
wait 150
SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE = 1
end

if and
CARMA_REPLAY_FLAG == 0
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
then

if and
8A2A: not  text_box 'CRM61' displayed
ZOMBEGEDDON_TOURNAMENT == 0
then
09C1: add_next_text_to_brief_history 0
0512: show_permanent_text_box 'CRM61' 
end

else

if and
8A2A: not  text_box 'CRM61B' displayed
ZOMBEGEDDON_TOURNAMENT == 0
then
09C1: add_next_text_to_brief_history 0
0512: show_permanent_text_box 'CRM61B' 
end

end

09C1: add_next_text_to_brief_history 0

if or
ZOMBIEGEDDON_GAME_TYPE == 0
ZOMBIEGEDDON_GAME_TYPE == 1
then          
text.Show4Number('CRM18',18@,CARMA_GLOB_RACE_TOTAL_LAPS,CARMA_GLOB_RACE_TOTAL_ZOMBIES,CARMA_GLOB_OPPONENTS_COUNT,200,1)
else
text.Show3Number('CRM18B',18@,CARMA_GLOB_RACE_TOTAL_LAPS,CARMA_GLOB_RACE_TOTAL_ZOMBIES,500,1)
end 

0619: enable_actor PLAYER_ACTOR collision_detection 0
actor.LockInCurrentPosition(PLAYER_ACTOR,false)

//0AD1: show_formatted_text_highpriority "RACES COUNT: %d" time 2000 29@

if
SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
then
0085: 0@ = 29@ // (int)
0@ += 1
random_int CARMA_GLOB_RACE_NUMBER_T 0 0@
gosub @MAP_GET_NUMBER
gosub @CARMA_TELEPORT_ACTOR
end

00E2: get_player 0 key 1 state_to 0@
if
0@ == 0
then
00E2: get_player 1 key 0 state_to 0@
end

if and
00E1:   player 0 pressed_key 10
0A4B:   controls_set_to_joystick
    then
    0@ = 1
    end
    
if and
00E1:   player 0 pressed_key 11
0A4B:   controls_set_to_joystick
    then
    0@ = -1
    end    

if and
0@ > 0
33@ > 150
ZOMBEGEDDON_TOURNAMENT == 0
CARMA_REPLAY_FLAG == 0
GAMEMODE_AUTOSELECT == -1
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
then
:CARMA_RANDOM_MAP_UPDATE
33@ = 0
CARMA_GLOB_RACE_NUMBER_T -= 1
gosub @MAP_GET_NUMBER
gosub @MAP_SKIP_CHECK_MINUS
gosub @MAP_GET_NUMBER
gosub @MAP_SKIP_CHECK_MINUS
gosub @MAP_GET_NUMBER

if
001E:   CARMA_GLOB_RACE_NUMBER_T > 29@ // (int)
then
CARMA_GLOB_RACE_NUMBER_T = 0
gosub @MAP_GET_NUMBER
gosub @MAP_SKIP_CHECK_MINUS
end

if
CARMA_GLOB_RACE_NUMBER_T < 0
then
008A: CARMA_GLOB_RACE_NUMBER_T = 29@ // (int)
gosub @MAP_GET_NUMBER
gosub @MAP_SKIP_CHECK_MINUS
end

Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
Audiostream.Loop(CARMA_VOICE_BUTT, 0)
Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
gosub @CARMA_TELEPORT_ACTOR
end

if and
0@ < 0
33@ > 150
ZOMBEGEDDON_TOURNAMENT == 0
CARMA_REPLAY_FLAG == 0
GAMEMODE_AUTOSELECT == -1
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
then
33@ = 0
CARMA_GLOB_RACE_NUMBER_T += 1
gosub @MAP_GET_NUMBER
gosub @MAP_SKIP_CHECK_PLUS
gosub @MAP_GET_NUMBER
gosub @MAP_SKIP_CHECK_PLUS
gosub @MAP_GET_NUMBER

if
001E:   CARMA_GLOB_RACE_NUMBER_T > 29@ // (int)
then
CARMA_GLOB_RACE_NUMBER_T = 0
gosub @MAP_GET_NUMBER
gosub @MAP_SKIP_CHECK_PLUS
end

if
CARMA_GLOB_RACE_NUMBER_T < 0
then
008A: CARMA_GLOB_RACE_NUMBER_T = 29@ // (int)
gosub @MAP_GET_NUMBER
gosub @MAP_SKIP_CHECK_PLUS
end

Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
Audiostream.Loop(CARMA_VOICE_BUTT, 0)
Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
gosub @CARMA_TELEPORT_ACTOR
end

00E2: get_player 0 key 0 state_to 0@
if
0@ == 0
then
00E2: get_player 1 key 0 state_to 0@
end

if and
00E1:   player 0 pressed_key 8
0A4B:   controls_set_to_joystick
    then
    0@ = 1
    end
    
if and
00E1:   player 0 pressed_key 9
0A4B:   controls_set_to_joystick
    then
    0@ = -1
    end

if and
0@ > 0
33@ > 50
ZOMBEGEDDON_TOURNAMENT == 0
CARMA_REPLAY_FLAG == 0
GAMEMODE_AUTOSELECT == -1
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
then

33@ = 0

CARMA_GLOB_OPPONENTS_COUNT += 1
0084: CARMA_GLOB_OPPONENTS_COUNT2 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT2 += 1
0084: CARMA_GLOB_OPPONENTS_COUNT3 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT3 -= 1
if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AF0: 1@ = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AF0: 1@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
else
0AF0: 1@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
end

end

if
001E:   CARMA_GLOB_OPPONENTS_COUNT > 1@ // (int)
then
008A: CARMA_GLOB_OPPONENTS_COUNT = 1@ // (int)
0084: CARMA_GLOB_OPPONENTS_COUNT2 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT2 += 1
0084: CARMA_GLOB_OPPONENTS_COUNT3 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT3 -= 1
Audiostream.PerformAction(CARMA_VOICE_FART, PLAY)
Audiostream.Loop(CARMA_VOICE_FART, 0)
Audiostream.Volume(CARMA_VOICE_FART) = $SOUNDS_VOLUME
33@ = -500
else
Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
Audiostream.Loop(CARMA_VOICE_BUTT, 0)
Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
end

end

if
0A4B:   controls_set_to_joystick
then

if or
0E3E:   player 0 pressed_key 7
0E3E:   player 1 pressed_key 7
then
if and
ZOMBEGEDDON_TOURNAMENT == 0
CARMA_REPLAY_FLAG == 0
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
    then
    ZOMBIEGEDDON_GAMESPEED_MULT += 0.05
    
    if
    ZOMBIEGEDDON_GAMESPEED_MULT > 2.0
    then
    ZOMBIEGEDDON_GAMESPEED_MULT = 2.0
    Audiostream.PerformAction(CARMA_VOICE_FART, PLAY)
    Audiostream.Loop(CARMA_VOICE_FART, 0)
    Audiostream.Volume(CARMA_VOICE_FART) = $SOUNDS_VOLUME
    else
    Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
    Audiostream.Loop(CARMA_VOICE_BUTT, 0)
    Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
    end
    
    end
end

if or
0E3E:   player 0 pressed_key 5
0E3E:   player 1 pressed_key 5
then    
if and
ZOMBEGEDDON_TOURNAMENT == 0
CARMA_REPLAY_FLAG == 0
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
    then
    ZOMBIEGEDDON_GAMESPEED_MULT -= 0.05
    
    if
    ZOMBIEGEDDON_GAMESPEED_MULT < 0.7
    then
    ZOMBIEGEDDON_GAMESPEED_MULT = 0.7
    Audiostream.PerformAction(CARMA_VOICE_FART, PLAY)
    Audiostream.Loop(CARMA_VOICE_FART, 0)
    Audiostream.Volume(CARMA_VOICE_FART) = $SOUNDS_VOLUME
    else
    Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
    Audiostream.Loop(CARMA_VOICE_BUTT, 0)
    Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
    end
    
    end
end

else

if or
0E3E:   player 0 pressed_key 5
0E3E:   player 1 pressed_key 5
then
if and
ZOMBEGEDDON_TOURNAMENT == 0
CARMA_REPLAY_FLAG == 0
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
    then
    ZOMBIEGEDDON_GAMESPEED_MULT += 0.05
    
    if
    ZOMBIEGEDDON_GAMESPEED_MULT > 2.0
    then
    ZOMBIEGEDDON_GAMESPEED_MULT = 2.0
    Audiostream.PerformAction(CARMA_VOICE_FART, PLAY)
    Audiostream.Loop(CARMA_VOICE_FART, 0)
    Audiostream.Volume(CARMA_VOICE_FART) = $SOUNDS_VOLUME
    else
    Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
    Audiostream.Loop(CARMA_VOICE_BUTT, 0)
    Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
    end
    
    end
end

if or
0E3E:   player 0 pressed_key 7
0E3E:   player 1 pressed_key 7
then    
if and
ZOMBEGEDDON_TOURNAMENT == 0
CARMA_REPLAY_FLAG == 0
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
    then
    ZOMBIEGEDDON_GAMESPEED_MULT -= 0.05
    
    if
    ZOMBIEGEDDON_GAMESPEED_MULT < 0.7
    then
    ZOMBIEGEDDON_GAMESPEED_MULT = 0.7
    Audiostream.PerformAction(CARMA_VOICE_FART, PLAY)
    Audiostream.Loop(CARMA_VOICE_FART, 0)
    Audiostream.Volume(CARMA_VOICE_FART) = $SOUNDS_VOLUME
    else
    Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
    Audiostream.Loop(CARMA_VOICE_BUTT, 0)
    Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
    end
    
    end
end
    
end        

if and
0@ < 0
33@ > 50
ZOMBEGEDDON_TOURNAMENT == 0
CARMA_REPLAY_FLAG == 0
GAMEMODE_AUTOSELECT == -1
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not ZOMBIEGEDDON_GAME_TYPE == 2
not ZOMBIEGEDDON_GAME_TYPE == 3
then

33@ = 0

CARMA_GLOB_OPPONENTS_COUNT -= 1
0084: CARMA_GLOB_OPPONENTS_COUNT2 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT2 += 1
0084: CARMA_GLOB_OPPONENTS_COUNT3 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT3 -= 1

if
CARMA_GLOB_OPPONENTS_COUNT < 1
then
CARMA_GLOB_OPPONENTS_COUNT = 1
0084: CARMA_GLOB_OPPONENTS_COUNT2 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT2 += 1
0084: CARMA_GLOB_OPPONENTS_COUNT3 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT3 -= 1
Audiostream.PerformAction(CARMA_VOICE_FART, PLAY)
Audiostream.Loop(CARMA_VOICE_FART, 0)
Audiostream.Volume(CARMA_VOICE_FART) = $SOUNDS_VOLUME
33@ = -500
else
Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
Audiostream.Loop(CARMA_VOICE_BUTT, 0)
Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
end

end

if and
ZOMBEGEDDON_TOURNAMENT == 1
33@ > 3000
    then
    jump to @ZOMBIEGEDDON_TOURNAMENT_MAP_AUTOSELECT
    end
    
if or
CARMA_REPLAY_FLAG == 1
GAMEMODE_AUTOSELECT == 1
SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
    then
    jump to @ZOMBIEGEDDON_TOURNAMENT_MAP_AUTOSELECT
    end    
    
//0x0081214A test, do invert
if or
00E1:   player 0 pressed_key 16
00E1:   player 1 pressed_key 16
    then
    :ZOMBIEGEDDON_TOURNAMENT_MAP_AUTOSELECT        
    
    if and
    CARMA_REPLAY_FLAG == 0
    GAMEMODE_AUTOSELECT == -1
    not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
    then
    Audiostream.PerformAction(CARMA_VOICE_DONE, PLAY)
    Audiostream.Loop(CARMA_VOICE_DONE, 0)
    Audiostream.Volume(CARMA_VOICE_DONE) = $SOUNDS_VOLUME
    end
    
    CARMA_GLOB_PICTURE_OFF = 0
    CARMA_GLOB_RACE_SELECTED = 1
    
    if and
    CARMA_REPLAY_FLAG == 0
    GAMEMODE_AUTOSELECT == -1
    not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
    then
    fade 0 250
    wait 250
    end
    
    text.ClearAll()
    text.RemoveTextBox()
    camera.Restore_WithJumpCut()
    camera.SetBehindPlayer()
    0337: set_actor PLAYER_ACTOR visibility 1
    actor.LockInCurrentPosition(PLAYER_ACTOR,false)
    0619: enable_actor PLAYER_ACTOR collision_detection 1
    
    //////////////////////////////////////////////////////////////    
    
    if
    UNITED_MAP == 0
    then
    
    if
    ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
    then
    0AF1: write_int CARMA_GLOB_OPPONENTS_COUNT to_ini_file "data/derby_Andreas.ini" section v$RACE_FILE key "OPPONENTS_USER_LAST_COUNT"
    0B00: delete_file "data/derby.ini"  // IF and SET
    0B04: copy_file "data/derby_Andreas.ini" to "data/derby.ini" //IF and SET
    else
    
    if
    CLASSIC_CARMA_MAP_AC_MODE == 0
    then
    0AF1: write_int CARMA_GLOB_OPPONENTS_COUNT to_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_USER_LAST_COUNT"
    else
    0AF1: write_int CARMA_GLOB_OPPONENTS_COUNT to_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_USER_LAST_COUNT"
    end
    
    end
        
    end
            
    if and
    UNITED_MAP == 1
    STORIES_MAP == 0
    then
    0AF1: write_int CARMA_GLOB_OPPONENTS_COUNT to_ini_file "data/derby_United.ini" section v$RACE_FILE key "OPPONENTS_USER_LAST_COUNT"
    0B00: delete_file "data/derby.ini"  // IF and SET
    0B04: copy_file "data/derby_United.ini" to "data/derby.ini" //IF and SET
    end
            
    if and
    UNITED_MAP == 1
    STORIES_MAP == 1
    then
    0AF1: write_int CARMA_GLOB_OPPONENTS_COUNT to_ini_file "data/derby_Stories.ini" section v$RACE_FILE key "OPPONENTS_USER_LAST_COUNT"
    0B00: delete_file "data/derby.ini"  // IF and SET
    0B04: copy_file "data/derby_Stories.ini" to "data/derby.ini" //IF and SET
    end
    
    //////////////////////////////////////////////////////////////
            
    break
    end       

end

return

:CARMA_TELEPORT_ACTOR
if and
CARMA_GLOB_PICTURE_OFF == 1
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
then
fade 0 150
wait 150

if
not CLASSIC_CARMA_MAP_AC_MODE == 1
then

////////////////////////////////////////////////////////////////

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
not CARMA_CURR_MUSIC_SET == 3
not CLASSIC_CARMA_MAP_AC_MODE == 1
then

if and
CARMA_GLOB_RACE_NUMBER > 57
CARMA_GLOB_RACE_NUMBER < 77
then
jump to @CARMA_THIRD_MUSIC_SET
end

if and
CARMA_GLOB_RACE_NUMBER > 20
CARMA_GLOB_RACE_NUMBER < 31
    then
    :CARMA_THIRD_MUSIC_SET
    CARMA_END_MUS_FLAG = 1
    wait 5
    create_thread @DRB_MU3
    end
    
end

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
not CARMA_CURR_MUSIC_SET == 2
not CLASSIC_CARMA_MAP_AC_MODE == 1
then

if and
CARMA_GLOB_RACE_NUMBER > 44
CARMA_GLOB_RACE_NUMBER < 58
then
jump to @CARMA_SECOND_MUSIC_SET
end

if
CARMA_GLOB_RACE_NUMBER == 77
then
jump to @CARMA_SECOND_MUSIC_SET
end

if and
CARMA_GLOB_RACE_NUMBER > 13
CARMA_GLOB_RACE_NUMBER < 21
    then
    :CARMA_SECOND_MUSIC_SET
    CARMA_END_MUS_FLAG = 1
    wait 5
    create_thread @DRB_MU2
    end
end

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
not CARMA_CURR_MUSIC_SET == 1
not CLASSIC_CARMA_MAP_AC_MODE == 1
then

if
CARMA_GLOB_RACE_NUMBER > 77
    then
    jump to @CARMA_FIRST_MUSIC_SET
    end

if and
CARMA_GLOB_RACE_NUMBER > 30
CARMA_GLOB_RACE_NUMBER < 45
    then
    jump to @CARMA_FIRST_MUSIC_SET
    end

if
CARMA_GLOB_RACE_NUMBER < 14
    then
    :CARMA_FIRST_MUSIC_SET
    CARMA_END_MUS_FLAG = 1
    wait 5
    create_thread @DRB_MUS
    end
    
end

////////////////////////////////////////////////////////////////

end

end
gosub @DERBY_RANDOM_TIME
text.ClearAll()

/////////////////////////////////////////////////////////////////////////////////////////////////////

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
UNITED_MAP == 0
then 
0AF1: write_int CARMA_GLOB_RACE_NUMBER_T to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED"
else

if
UNITED_MAP == 0
then

if
CARMA_GLOB_MAP_NABOR == 0
then
0AF1: write_int CARMA_GLOB_RACE_NUMBER_T to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED2"
end

if
CARMA_GLOB_MAP_NABOR == 1
then
0AF1: write_int CARMA_GLOB_RACE_NUMBER_T to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED2B"
end

if
CARMA_GLOB_MAP_NABOR == 2
then
0AF1: write_int CARMA_GLOB_RACE_NUMBER_T to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED2C"
end

else

if
$UNITED_III_SPAWN == 1
then
0AF1: write_int CARMA_GLOB_RACE_NUMBER_T to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED_III"
else
0AF1: write_int CARMA_GLOB_RACE_NUMBER_T to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED_VC"
end

end

end

/////////////////////////////////////////////////////////////////////////////////////////////////////

if or
not $UNITED_VC_FLAG == 1
UNITED_MAP == 0
then
0AD3: v$RACE_FILE = format "RACE%d" CARMA_GLOB_RACE_NUMBER
else
0AD3: v$RACE_FILE = format "2RACE%d" CARMA_GLOB_RACE_NUMBER
end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AF2: 1@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_X" 
0AF2: 2@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_Y" 
0AF2: 3@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_Z"
0AF2: 4@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_A"
else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AF2: 1@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_X" 
0AF2: 2@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_Y" 
0AF2: 3@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_Z"
0AF2: 4@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_A"
else
0AF2: 1@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_X" 
0AF2: 2@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_Y" 
0AF2: 3@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_Z"
0AF2: 4@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_A"
end

end

3@ -= 2.5
actor.PutAtNoOffset(PLAYER_ACTOR,1@,2@,3@)
actor.Angle(PLAYER_ACTOR) = 4@
04C4: store_coords_to 10@ 11@ 12@ from_actor PLAYER_ACTOR with_offset 0.0 0.0 5.0
04C4: store_coords_to 5@ 6@ 7@ from_actor PLAYER_ACTOR with_offset 0.0 5.0 4.8
camera.SetPosition(10@,11@,12@,0.0,0.0,0.0)
camera.PointAt(5@,6@,7@,2)
create_thread @REFR_3D
$WEATHER_SYNC_FLAG = 1 

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

if or
not $UNITED_VC_FLAG == 1
UNITED_MAP == 0
then
0AD3: v$EDITOR_FILE = format "RACE%d" CARMA_GLOB_RACE_NUMBER
else
0AD3: v$EDITOR_FILE = format "2RACE%d" CARMA_GLOB_RACE_NUMBER
end

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AF0: CARMA_GLOB_RACE_TOTAL_CHECKPOINTS = get_int_from_ini_file "data/derby.ini" section v$EDITOR_FILE key "TOTAL_CHECKPOINTS"
0AF0: CARMA_GLOB_RACE_TOTAL_ZOMBIES = get_int_from_ini_file "data/derby.ini" section v$EDITOR_FILE key "TOTAL_ZOMBIES"
0AF0: CARMA_GLOB_RACE_TOTAL_LAPS = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "LAPS"
0AF0: CARMA_GLOB_RACE_INTERIOR = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "RACE_INTERIOR"
0AF0: CARMA_GLOB_CP_RUSH_BUTTHURT_LEVEL = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "CP_RUSH_BUTTHURT_LEVEL" 
0AF0: CARMA_GLOB_CP_RUSH_NO_NITRO_BCP = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "CP_RUSH_NO_NITRO_BCP"
0AF0: CARMA_GLOB_NO_NITRO_FLAG = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "NO_NITRO"

if
CARMA_GLOB_CP_RUSH_NO_NITRO_BCP < 0
then
CARMA_GLOB_CP_RUSH_NO_NITRO_BCP = 0
end

if and
$CHEATS_ON == 1
$DEBUG_MENU_ON == 1
0AB0:   key_pressed 81
then
0AF0: CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
else

if or
8AF0: not CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "OPPONENTS_USER_LAST_COUNT"
ZOMBEGEDDON_TOURNAMENT == 1
then
0AF0: CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "OPPONENTS_COUNT"

if
ZOMBEGEDDON_TOURNAMENT == 1
    then    
    0AF0: 2@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_COMPLETED"
    
    if
    2@ >= 5
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 10
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 15
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 20
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 25
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 30
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    2@ /= 3
    005E: CARMA_GLOB_OPPONENTS_COUNT += 2@  // (int)
    
    0AF0: 2@ = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
    if
    001E:   CARMA_GLOB_OPPONENTS_COUNT > 2@ // (int)
        then
        008A: CARMA_GLOB_OPPONENTS_COUNT = 2@ // (int)
        end
    
    end

end

end

if or
CARMA_GLOB_OPPONENTS_COUNT < -1
ZOMBIEGEDDON_GAME_TYPE == 2
ZOMBIEGEDDON_GAME_TYPE == 3
then
CARMA_GLOB_OPPONENTS_COUNT = 9
end

0084: CARMA_GLOB_OPPONENTS_COUNT2 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT2 += 1
0084: CARMA_GLOB_OPPONENTS_COUNT3 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT3 -= 1

else

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then

0AF0: CARMA_GLOB_RACE_TOTAL_CHECKPOINTS = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "TOTAL_CHECKPOINTS"
0AF0: CARMA_GLOB_RACE_TOTAL_ZOMBIES = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "TOTAL_ZOMBIES"
0AF0: CARMA_GLOB_RACE_TOTAL_LAPS = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "LAPS"
0AF0: CARMA_GLOB_RACE_INTERIOR = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "RACE_INTERIOR"
0AF0: CARMA_GLOB_CP_RUSH_BUTTHURT_LEVEL = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CP_RUSH_BUTTHURT_LEVEL"
0AF0: CARMA_GLOB_CP_RUSH_NO_NITRO_BCP = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CP_RUSH_NO_NITRO_BCP"
0AF0: CARMA_GLOB_NO_NITRO_FLAG = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "NO_NITRO"

if
CARMA_GLOB_CP_RUSH_NO_NITRO_BCP < 0
then
CARMA_GLOB_CP_RUSH_NO_NITRO_BCP = 0
end

if and
$CHEATS_ON == 1
$DEBUG_MENU_ON == 1
0AB0:   key_pressed 81
then
0AF0: CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
else

if or
8AF0: not CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_USER_LAST_COUNT"
ZOMBEGEDDON_TOURNAMENT == 1
then
0AF0: CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_COUNT"

if
ZOMBEGEDDON_TOURNAMENT == 1
    then    
    0AF0: 2@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_COMPLETED"
    
    if
    2@ >= 5
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 10
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 15
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 20
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 25
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 30
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    2@ /= 3
    005E: CARMA_GLOB_OPPONENTS_COUNT += 2@  // (int)
    
    0AF0: 2@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
    if
    001E:   CARMA_GLOB_OPPONENTS_COUNT > 2@ // (int)
        then
        008A: CARMA_GLOB_OPPONENTS_COUNT = 2@ // (int)
        end
    
    end

end

end

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

else

0AF0: CARMA_GLOB_RACE_TOTAL_CHECKPOINTS = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "TOTAL_CHECKPOINTS"
0AF0: CARMA_GLOB_RACE_TOTAL_ZOMBIES = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$EDITOR_FILE key "TOTAL_ZOMBIES"
0AF0: CARMA_GLOB_RACE_TOTAL_LAPS = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "LAPS"
0AF0: CARMA_GLOB_RACE_INTERIOR = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "RACE_INTERIOR"
0AF0: CARMA_GLOB_CP_RUSH_BUTTHURT_LEVEL = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CP_RUSH_BUTTHURT_LEVEL"
0AF0: CARMA_GLOB_CP_RUSH_NO_NITRO_BCP = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "CP_RUSH_NO_NITRO_BCP"
0AF0: CARMA_GLOB_NO_NITRO_FLAG = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "NO_NITRO"

if
CARMA_GLOB_CP_RUSH_NO_NITRO_BCP < 0
then
CARMA_GLOB_CP_RUSH_NO_NITRO_BCP = 0
end

if and
$CHEATS_ON == 1
$DEBUG_MENU_ON == 1
0AB0:   key_pressed 81
then
0AF0: CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
else

if or
8AF0: not CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_USER_LAST_COUNT"
ZOMBEGEDDON_TOURNAMENT == 1
then
0AF0: CARMA_GLOB_OPPONENTS_COUNT = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_COUNT"

if
ZOMBEGEDDON_TOURNAMENT == 1
    then    
    0AF0: 2@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_COMPLETED"
    
    if
    2@ >= 5
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 10
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 15
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 20
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 25
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    if
    2@ >= 30
    then
    CARMA_GLOB_OPPONENTS_COUNT += 1
    end
    
    2@ /= 3
    005E: CARMA_GLOB_OPPONENTS_COUNT += 2@  // (int)
    
    0AF0: 2@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "OPPONENTS_COUNT_MAX"
    if
    001E:   CARMA_GLOB_OPPONENTS_COUNT > 2@ // (int)
        then
        008A: CARMA_GLOB_OPPONENTS_COUNT = 2@ // (int)
        end
    
    end

end

end

end

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

if or
CARMA_GLOB_OPPONENTS_COUNT < -1
ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_OPPONENTS_COUNT = 9
end

0084: CARMA_GLOB_OPPONENTS_COUNT2 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT2 += 1
0084: CARMA_GLOB_OPPONENTS_COUNT3 = CARMA_GLOB_OPPONENTS_COUNT // (int)
CARMA_GLOB_OPPONENTS_COUNT3 -= 1
end

select_interior CARMA_GLOB_RACE_INTERIOR
0860: link_actor PLAYER_ACTOR to_interior CARMA_GLOB_RACE_INTERIOR
18@ = 0.0

for 0@ = 0 to CARMA_GLOB_RACE_TOTAL_CHECKPOINTS

if
87D6: not  0@ == CARMA_GLOB_RACE_TOTAL_CHECKPOINTS // @ == $ (int)
then

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then

0AD3: v$FP_FILE = format "CP%d_X" 0@
0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Y" 0@ 
0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Z" 0@ 
0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE

0085: 1@ = 0@ // (int)
1@ += 1

0AD3: v$FP_FILE = format "CP%d_X" 1@
0AF2: $RNDM_HOUSE_ITEM_X[1@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Y" 1@ 
0AF2: $RNDM_HOUSE_ITEM_Y[1@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Z" 1@ 
0AF2: $RNDM_HOUSE_ITEM_Z[1@] = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key v$FP_FILE

else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then

0AD3: v$FP_FILE = format "CP%d_X" 0@
0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Y" 0@ 
0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Z" 0@ 
0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE

0085: 1@ = 0@ // (int)
1@ += 1

0AD3: v$FP_FILE = format "CP%d_X" 1@
0AF2: $RNDM_HOUSE_ITEM_X[1@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Y" 1@ 
0AF2: $RNDM_HOUSE_ITEM_Y[1@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Z" 1@ 
0AF2: $RNDM_HOUSE_ITEM_Z[1@] = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE

else

0AD3: v$FP_FILE = format "CP%d_X" 0@
0AF2: $RNDM_HOUSE_ITEM_X[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Y" 0@ 
0AF2: $RNDM_HOUSE_ITEM_Y[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Z" 0@ 
0AF2: $RNDM_HOUSE_ITEM_Z[0@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE

0085: 1@ = 0@ // (int)
1@ += 1

0AD3: v$FP_FILE = format "CP%d_X" 1@
0AF2: $RNDM_HOUSE_ITEM_X[1@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Y" 1@ 
0AF2: $RNDM_HOUSE_ITEM_Y[1@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE
0AD3: v$FP_FILE = format "CP%d_Z" 1@ 
0AF2: $RNDM_HOUSE_ITEM_Z[1@] = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key v$FP_FILE

end

end

050A: 2@ = distance_between_XYZ $RNDM_HOUSE_ITEM_X[0@] $RNDM_HOUSE_ITEM_Y[0@] $RNDM_HOUSE_ITEM_Z[0@] and_XYZ $RNDM_HOUSE_ITEM_X[1@] $RNDM_HOUSE_ITEM_Y[1@] $RNDM_HOUSE_ITEM_Z[1@]
005B: 18@ += 2@  // (float) 

end

end

if
ENGLISH_MEASURMENTS == 1
then
18@ *= 0.621371
end
0092: 18@ = float 18@ to_integer
008A: CARMA_GLOB_RACE_LENGHT = 18@ // (int)

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

text.ClearAll()
09C1: add_next_text_to_brief_history 0

if or
ZOMBIEGEDDON_GAME_TYPE == 0
ZOMBIEGEDDON_GAME_TYPE == 1
then
text.Show4Number('CRM18',18@,CARMA_GLOB_RACE_TOTAL_LAPS,CARMA_GLOB_RACE_TOTAL_ZOMBIES,CARMA_GLOB_OPPONENTS_COUNT,500,1)
else
text.Show3Number('CRM18B',18@,CARMA_GLOB_RACE_TOTAL_LAPS,CARMA_GLOB_RACE_TOTAL_ZOMBIES,500,1)
end

if and
CARMA_GLOB_PICTURE_OFF == 1
not SELECT_RANDOM_MAP_AFTER_SELECT_GAMEMODE == 1
not CARMA_REPLAY_FLAG == 1
then
wait 50
fade 1 150
wait 150
end
return

:MAP_SKIP_CHECK_PLUS
0AD3: v$RACE_FILE = format "RACE%d" CARMA_GLOB_RACE_NUMBER

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then

if
0AF0: 0@ = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "SKIP_THIS_MAP"
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

if and
0AF0: 0@ = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "SKIP_THIS_MAP2"
not ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

if and
0AF0: 0@ = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "SKIP_THIS_MAP3"
ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then

if
0AF0: 0@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP"
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

if and
0AF0: 0@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP2"
not ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

if and
0AF0: 0@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP3"
ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

else

if
0AF0: 0@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP"
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

if and
0AF0: 0@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP2"
not ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

if and
0AF0: 0@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP3"
ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T += 1
end

end

end

return

:MAP_SKIP_CHECK_MINUS
0AD3: v$RACE_FILE = format "RACE%d" CARMA_GLOB_RACE_NUMBER

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then

if
0AF0: 0@ = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "SKIP_THIS_MAP"
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

if and
0AF0: 0@ = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "SKIP_THIS_MAP2"
not ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

if and
0AF0: 0@ = get_int_from_ini_file "data/derby.ini" section v$RACE_FILE key "SKIP_THIS_MAP3"
ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then

if
0AF0: 0@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP"
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

if and
0AF0: 0@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP2"
not ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

if and
0AF0: 0@ = get_int_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP3"
ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

else

if
0AF0: 0@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP"
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

if and
0AF0: 0@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP2"
not ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

if and
0AF0: 0@ = get_int_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "SKIP_THIS_MAP3"
ZOMBIEGEDDON_GAME_TYPE == 2
then
CARMA_GLOB_RACE_NUMBER_T -= 1
end

end

end

return

:MAP_GET_NUMBER

if or
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
ZOMBEGEDDON_TOURNAMENT == 1
then
0084: CARMA_GLOB_RACE_NUMBER = CARMA_GLOB_RACE_NUMBER_T // (int)
return
end

if
CARMA_REPLAY_FLAG == 1
then
0AF0: CARMA_GLOB_RACE_NUMBER = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "GAMEINFO" key "RACE_NUM"
return
end

///////////////////////////////////////////////////////////

if
CARMA_GLOB_MAP_NABOR == 0
then

if
CARMA_GLOB_RACE_NUMBER_T == 0
then
CARMA_GLOB_RACE_NUMBER = 0 //1
end

if
CARMA_GLOB_RACE_NUMBER_T == 1
then
CARMA_GLOB_RACE_NUMBER = 1 //2
end

if
CARMA_GLOB_RACE_NUMBER_T == 2
then
CARMA_GLOB_RACE_NUMBER = 2 //3
end

if
CARMA_GLOB_RACE_NUMBER_T == 3
then
CARMA_GLOB_RACE_NUMBER = 3 //4
end

if
CARMA_GLOB_RACE_NUMBER_T == 4
then
CARMA_GLOB_RACE_NUMBER = 31 //5
end

if
CARMA_GLOB_RACE_NUMBER_T == 5
then
CARMA_GLOB_RACE_NUMBER = 32 //6
end

if
CARMA_GLOB_RACE_NUMBER_T == 6
then
CARMA_GLOB_RACE_NUMBER = 4 //7
end

if
CARMA_GLOB_RACE_NUMBER_T == 7
then
CARMA_GLOB_RACE_NUMBER = 5 //8
end

if
CARMA_GLOB_RACE_NUMBER_T == 8
then
CARMA_GLOB_RACE_NUMBER = 6 //9
end

if
CARMA_GLOB_RACE_NUMBER_T == 9
then
CARMA_GLOB_RACE_NUMBER = 7 //10
end

if
CARMA_GLOB_RACE_NUMBER_T == 10
then
CARMA_GLOB_RACE_NUMBER = 78 //11
end

if
CARMA_GLOB_RACE_NUMBER_T == 11
then
CARMA_GLOB_RACE_NUMBER = 8 //12
end

if
CARMA_GLOB_RACE_NUMBER_T == 12
then
CARMA_GLOB_RACE_NUMBER = 33 //13
end

if
CARMA_GLOB_RACE_NUMBER_T == 13
then
CARMA_GLOB_RACE_NUMBER = 34 //14
end

if
CARMA_GLOB_RACE_NUMBER_T == 14
then
CARMA_GLOB_RACE_NUMBER = 10 //15
end

if
CARMA_GLOB_RACE_NUMBER_T == 15
then
CARMA_GLOB_RACE_NUMBER = 35 //16
end

if
CARMA_GLOB_RACE_NUMBER_T == 16
then
CARMA_GLOB_RACE_NUMBER = 36 //17
end

if
CARMA_GLOB_RACE_NUMBER_T == 17
then
CARMA_GLOB_RACE_NUMBER = 9 //18
end

if
CARMA_GLOB_RACE_NUMBER_T == 18
then
CARMA_GLOB_RACE_NUMBER = 37 //22
end

if
CARMA_GLOB_RACE_NUMBER_T == 19
then
CARMA_GLOB_RACE_NUMBER = 79 //19
end

if
CARMA_GLOB_RACE_NUMBER_T == 20
then
CARMA_GLOB_RACE_NUMBER = 38 //20
end

if
CARMA_GLOB_RACE_NUMBER_T == 21
then
CARMA_GLOB_RACE_NUMBER = 12 //21
end

if
CARMA_GLOB_RACE_NUMBER_T == 22
then
CARMA_GLOB_RACE_NUMBER = 39 //26
end

if
CARMA_GLOB_RACE_NUMBER_T == 23
then
CARMA_GLOB_RACE_NUMBER = 40 //23
end

if
CARMA_GLOB_RACE_NUMBER_T == 24
then
CARMA_GLOB_RACE_NUMBER = 13 //24
end

if
CARMA_GLOB_RACE_NUMBER_T == 25
then
CARMA_GLOB_RACE_NUMBER = 41 //25
end

if
CARMA_GLOB_RACE_NUMBER_T == 26
then
CARMA_GLOB_RACE_NUMBER = 80 //27
end

if
CARMA_GLOB_RACE_NUMBER_T == 27
then
CARMA_GLOB_RACE_NUMBER = 84 //28
end

if
CARMA_GLOB_RACE_NUMBER_T == 28
then
CARMA_GLOB_RACE_NUMBER = 42 //29
end

if
CARMA_GLOB_RACE_NUMBER_T == 29
then
CARMA_GLOB_RACE_NUMBER = 86 //30
end

if
CARMA_GLOB_RACE_NUMBER_T == 30
then
CARMA_GLOB_RACE_NUMBER = 81 //31
end

if
CARMA_GLOB_RACE_NUMBER_T == 31
then
CARMA_GLOB_RACE_NUMBER = 82 //32
end

if
CARMA_GLOB_RACE_NUMBER_T == 32
then
CARMA_GLOB_RACE_NUMBER = 83 //33
end

if
CARMA_GLOB_RACE_NUMBER_T == 33
then
CARMA_GLOB_RACE_NUMBER = 85 //34
end

if
CARMA_GLOB_RACE_NUMBER_T == 34
then
CARMA_GLOB_RACE_NUMBER = 43 //35
end

if
CARMA_GLOB_RACE_NUMBER_T == 35
then
CARMA_GLOB_RACE_NUMBER = 44 //36
end

end

///////////////////////////////////////////////////////////

if
CARMA_GLOB_MAP_NABOR == 1
then

if
CARMA_GLOB_RACE_NUMBER_T == 0
then
CARMA_GLOB_RACE_NUMBER = 14 //1
end

if
CARMA_GLOB_RACE_NUMBER_T == 1
then
CARMA_GLOB_RACE_NUMBER = 45 //2
end

if
CARMA_GLOB_RACE_NUMBER_T == 2
then
CARMA_GLOB_RACE_NUMBER = 46 //3
end

if
CARMA_GLOB_RACE_NUMBER_T == 3
then
CARMA_GLOB_RACE_NUMBER = 15 //4
end

if
CARMA_GLOB_RACE_NUMBER_T == 4
then
CARMA_GLOB_RACE_NUMBER = 47 //5
end

if
CARMA_GLOB_RACE_NUMBER_T == 5
then
CARMA_GLOB_RACE_NUMBER = 48 //6
end

if
CARMA_GLOB_RACE_NUMBER_T == 6
then
CARMA_GLOB_RACE_NUMBER = 16 //7
end

if
CARMA_GLOB_RACE_NUMBER_T == 7
then
CARMA_GLOB_RACE_NUMBER = 49 //8
end

if
CARMA_GLOB_RACE_NUMBER_T == 8
then
CARMA_GLOB_RACE_NUMBER = 50 //9
end

if
CARMA_GLOB_RACE_NUMBER_T == 9
then
CARMA_GLOB_RACE_NUMBER = 51 //10
end

if
CARMA_GLOB_RACE_NUMBER_T == 10
then
CARMA_GLOB_RACE_NUMBER = 18 //11
end

if
CARMA_GLOB_RACE_NUMBER_T == 11
then
CARMA_GLOB_RACE_NUMBER = 52 //12
end

if
CARMA_GLOB_RACE_NUMBER_T == 12
then
CARMA_GLOB_RACE_NUMBER = 77 //13
end

if
CARMA_GLOB_RACE_NUMBER_T == 13
then
CARMA_GLOB_RACE_NUMBER = 17 //14
end

if
CARMA_GLOB_RACE_NUMBER_T == 14
then
CARMA_GLOB_RACE_NUMBER = 53 //15
end

if
CARMA_GLOB_RACE_NUMBER_T == 15
then
CARMA_GLOB_RACE_NUMBER = 54 //16
end

if
CARMA_GLOB_RACE_NUMBER_T == 16
then
CARMA_GLOB_RACE_NUMBER = 20 //17
end

if
CARMA_GLOB_RACE_NUMBER_T == 17
then
CARMA_GLOB_RACE_NUMBER = 55 //18
end

if
CARMA_GLOB_RACE_NUMBER_T == 18
then
CARMA_GLOB_RACE_NUMBER = 19 //19
end

if
CARMA_GLOB_RACE_NUMBER_T == 19
then
CARMA_GLOB_RACE_NUMBER = 56 //20
end

if
CARMA_GLOB_RACE_NUMBER_T == 20
then
CARMA_GLOB_RACE_NUMBER = 57 //21
end

end

///////////////////////////////////////////////////////////

if
CARMA_GLOB_MAP_NABOR == 2
then

if
CARMA_GLOB_RACE_NUMBER_T == 0
then
CARMA_GLOB_RACE_NUMBER = 21 //1
end

if
CARMA_GLOB_RACE_NUMBER_T == 1
then
CARMA_GLOB_RACE_NUMBER = 22 //2
end

if
CARMA_GLOB_RACE_NUMBER_T == 2
then
CARMA_GLOB_RACE_NUMBER = 27 //3
end

if
CARMA_GLOB_RACE_NUMBER_T == 3
then
CARMA_GLOB_RACE_NUMBER = 60 //4
end

if
CARMA_GLOB_RACE_NUMBER_T == 4
then
CARMA_GLOB_RACE_NUMBER = 30 //5
end

if
CARMA_GLOB_RACE_NUMBER_T == 5
then
CARMA_GLOB_RACE_NUMBER = 61 //6
end

if
CARMA_GLOB_RACE_NUMBER_T == 6
then
CARMA_GLOB_RACE_NUMBER = 24 //7
end

if
CARMA_GLOB_RACE_NUMBER_T == 7
then
CARMA_GLOB_RACE_NUMBER = 23 //8
end

if
CARMA_GLOB_RACE_NUMBER_T == 8
then
CARMA_GLOB_RACE_NUMBER = 62 //9
end

if
CARMA_GLOB_RACE_NUMBER_T == 9
then
CARMA_GLOB_RACE_NUMBER = 26 //10
end

if
CARMA_GLOB_RACE_NUMBER_T == 10
then
CARMA_GLOB_RACE_NUMBER = 59 //11
end

if
CARMA_GLOB_RACE_NUMBER_T == 11
then
CARMA_GLOB_RACE_NUMBER = 63 //12
end

if
CARMA_GLOB_RACE_NUMBER_T == 12
then
CARMA_GLOB_RACE_NUMBER = 64 //13
end

if
CARMA_GLOB_RACE_NUMBER_T == 13
then
CARMA_GLOB_RACE_NUMBER = 67 //14
end

if
CARMA_GLOB_RACE_NUMBER_T == 14
then
CARMA_GLOB_RACE_NUMBER = 58 //15
end

if
CARMA_GLOB_RACE_NUMBER_T == 15
then
CARMA_GLOB_RACE_NUMBER = 29 //16
end

if
CARMA_GLOB_RACE_NUMBER_T == 16
then
CARMA_GLOB_RACE_NUMBER = 65 //17
end

if
CARMA_GLOB_RACE_NUMBER_T == 17
then
CARMA_GLOB_RACE_NUMBER = 68 //18
end

if
CARMA_GLOB_RACE_NUMBER_T == 18
then
CARMA_GLOB_RACE_NUMBER = 70 //19
end

if
CARMA_GLOB_RACE_NUMBER_T == 19
then
CARMA_GLOB_RACE_NUMBER = 72 //20
end

if
CARMA_GLOB_RACE_NUMBER_T == 20
then
CARMA_GLOB_RACE_NUMBER = 66 //21
end

if
CARMA_GLOB_RACE_NUMBER_T == 21
then
CARMA_GLOB_RACE_NUMBER = 25 //22
end

if
CARMA_GLOB_RACE_NUMBER_T == 22
then
CARMA_GLOB_RACE_NUMBER = 71 //23
end

if
CARMA_GLOB_RACE_NUMBER_T == 23
then
CARMA_GLOB_RACE_NUMBER = 73 //24
end

if
CARMA_GLOB_RACE_NUMBER_T == 24
then
CARMA_GLOB_RACE_NUMBER = 74 //25
end

if
CARMA_GLOB_RACE_NUMBER_T == 25
then
CARMA_GLOB_RACE_NUMBER = 28 //26
end

if
CARMA_GLOB_RACE_NUMBER_T == 26
then
CARMA_GLOB_RACE_NUMBER = 75 //27
end

if
CARMA_GLOB_RACE_NUMBER_T == 27
then
CARMA_GLOB_RACE_NUMBER = 76 //28
end

if
CARMA_GLOB_RACE_NUMBER_T == 28
then
CARMA_GLOB_RACE_NUMBER = 69 //29
end

end

return

:CARMA_GET_RACE_NUMBER_FIRST

/////////////////////////////////////////////////////////////////////////////////////////////////////

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
UNITED_MAP == 0
then
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED"
else

if
UNITED_MAP == 0
then

if
CARMA_GLOB_MAP_NABOR == 0
then
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED2"
end

if
CARMA_GLOB_MAP_NABOR == 1
then
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED2B"
end

if
CARMA_GLOB_MAP_NABOR == 2
then
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED2C"
end

else

if
$UNITED_III_SPAWN == 1
then
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED_III"
else
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIEGEDDON_LAST_MAP_SELECTED_VC"
end

end

end

if
ZOMBEGEDDON_TOURNAMENT == 1
then
0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
0AD3: v$FP_FILE = format "RACE%d" 0@
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "data\derby_Tournament.ini" section v$FP_FILE key "RACENUM"
end

if
CARMA_REPLAY_FLAG == 1
then
0AF0: CARMA_GLOB_RACE_NUMBER_T = get_int_from_ini_file "modloader\MODLOADER GLOBAL FILES\ExtraContent\Zombiegeddon Replay\9.dat" section "GAMEINFO" key "RACE_NUM"
end

gosub @MAP_GET_NUMBER

if
not CLASSIC_CARMA_MAP_AC_MODE == 1
then

/////////////////////////////////////////////////////////////////////////////////////////////////////

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
not CARMA_CURR_MUSIC_SET == 3
then

if and
CARMA_GLOB_RACE_NUMBER > 57
CARMA_GLOB_RACE_NUMBER < 77
then
jump to @CARMA_THIRD_MUSIC_SET_FIRST
end

if and
CARMA_GLOB_RACE_NUMBER > 20
CARMA_GLOB_RACE_NUMBER < 31
    then
    :CARMA_THIRD_MUSIC_SET_FIRST
    CARMA_END_MUS_FLAG = 1
    wait 5
    create_thread @DRB_MU3
    end
end

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
not CARMA_CURR_MUSIC_SET == 2
then

if and
CARMA_GLOB_RACE_NUMBER > 44
CARMA_GLOB_RACE_NUMBER < 58
then
jump to @CARMA_SECOND_MUSIC_SET_FIRST
end

if 
CARMA_GLOB_RACE_NUMBER == 77
then
jump to @CARMA_SECOND_MUSIC_SET_FIRST
end

if and
CARMA_GLOB_RACE_NUMBER > 13
CARMA_GLOB_RACE_NUMBER < 21
    then
    :CARMA_SECOND_MUSIC_SET_FIRST
    CARMA_END_MUS_FLAG = 1
    wait 5
    create_thread @DRB_MU2
    end
end

if and
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 1
not CARMA_CURR_MUSIC_SET == 1
then

if
CARMA_GLOB_RACE_NUMBER > 77
    then
    jump to @CARMA_FIRST_MUSIC_SET_FIRST
    end

if and
CARMA_GLOB_RACE_NUMBER > 30
CARMA_GLOB_RACE_NUMBER < 45
    then
    jump to @CARMA_FIRST_MUSIC_SET_FIRST
    end

if
CARMA_GLOB_RACE_NUMBER < 14
    then
    :CARMA_FIRST_MUSIC_SET_FIRST
    CARMA_END_MUS_FLAG = 1
    wait 5
    create_thread @DRB_MUS
    end
    
end

/////////////////////////////////////////////////////////////////////////////////////////////////////

end

return

:CARMA_LOAD_SOUNDS

///////////////////////////////////////////////////////////////////////////////////////////////////////////

19@ = Audiostream.Load("audio\sounds\other\zombiegeddon\OUTOTIM2.WAV")
20@ = Audiostream.Load("audio\sounds\other\zombiegeddon\REPAIR2.wav")
21@ = Audiostream.Load("audio\sounds\other\zombiegeddon\five.wav")
22@ = Audiostream.Load("audio\sounds\other\zombiegeddon\four.wav")
23@ = Audiostream.Load("audio\sounds\other\zombiegeddon\three.wav")
24@ = Audiostream.Load("audio\sounds\other\zombiegeddon\two.wav")
25@ = Audiostream.Load("audio\sounds\other\zombiegeddon\one.wav")
28@ = Audiostream.Load("audio\sounds\other\zombiegeddon\RACECPLT.wav")
CARMA_VOICE_FINALLAP = Audiostream.Load("audio\sounds\other\zombiegeddon\FINALLAP.WAV")
30@ = Audiostream.Load("audio\sounds\other\zombiegeddon\THECLAP.WAV")

Audiostream.Loop(19@, 0)
Audiostream.Loop(20@, 0)
Audiostream.Loop(21@, 0)
Audiostream.Loop(22@, 0)
Audiostream.Loop(23@, 0)
Audiostream.Loop(24@, 0)
Audiostream.Loop(25@, 0)
Audiostream.Loop(26@, 0)
Audiostream.Loop(27@, 0)
Audiostream.Loop(28@, 0)
Audiostream.Loop(CARMA_VOICE_FINALLAP, 0)
Audiostream.Loop(30@, 0)

:CARMA_LOAD_SOUNDS2

/////////////При раздавке зомби

if
ANNA_FLAG == 0
then

////////////////////////////////////////////////////////////////////////////////////

CARMA_VOICE_FHAHA1 = Audiostream.Load("audio\sounds\other\zombiegeddon\FHAHA1.wav")
CARMA_VOICE_FLAFF3 = Audiostream.Load("audio\sounds\other\zombiegeddon\FLAFF3.wav")
CARMA_VOICE_FMESSY = Audiostream.Load("audio\sounds\other\zombiegeddon\FMESSY.wav")
CARMA_VOICE_FSORRY2 = Audiostream.Load("audio\sounds\other\zombiegeddon\FSORRY2.wav")
CARMA_VOICE_FSORRY3 = Audiostream.Load("audio\sounds\other\zombiegeddon\FSORRY3.wav")
CARMA_VOICE_FSHITHAP = Audiostream.Load("audio\sounds\other\zombiegeddon\FSHITHAP.wav")
CARMA_VOICE_FBETHRT3 = Audiostream.Load("audio\sounds\other\zombiegeddon\FBETHRT3.wav")

/////////При ебанутой езде\полете
CARMA_VOICE_FAA02 = Audiostream.Load("audio\sounds\other\zombiegeddon\FAA02.wav")
CARMA_VOICE_FAARGH3 = Audiostream.Load("audio\sounds\other\zombiegeddon\FAARGH3.wav")
CARMA_VOICE_FAAH_WAV = Audiostream.Load("audio\sounds\other\zombiegeddon\FAAH.wav")
CARMA_VOICE_FAARGH5 = Audiostream.Load("audio\sounds\other\zombiegeddon\FAARGH5.wav")
CARMA_VOICE_FOARGH = Audiostream.Load("audio\sounds\other\zombiegeddon\FOARGH.wav")
CARMA_VOICE_FOHSHIT1 = Audiostream.Load("audio\sounds\other\zombiegeddon\FOHSHIT1.wav")
CARMA_VOICE_FWAYHAY = Audiostream.Load("audio\sounds\other\zombiegeddon\FWAYHAY.wav")
CARMA_VOICE_FWOOHOO = Audiostream.Load("audio\sounds\other\zombiegeddon\FWOOHOO.wav")

/////////Когда машина игрока получает урон
CARMA_VOICE_FAAH = Audiostream.Load("audio\sounds\other\zombiegeddon\FAAH.wav")
CARMA_VOICE_FAH = Audiostream.Load("audio\sounds\other\zombiegeddon\FAH.wav")
CARMA_VOICE_FOOH = Audiostream.Load("audio\sounds\other\zombiegeddon\FOOH.wav")
CARMA_VOICE_FOOH2 = Audiostream.Load("audio\sounds\other\zombiegeddon\FOOH2.wav")
CARMA_VOICE_FOW = Audiostream.Load("audio\sounds\other\zombiegeddon\FOW.wav")
CARMA_VOICE_FOW2 = Audiostream.Load("audio\sounds\other\zombiegeddon\FOW2.wav")
CARMA_VOICE_FOW3 = Audiostream.Load("audio\sounds\other\zombiegeddon\FOW3.wav")
CARMA_VOICE_FURGH2 = Audiostream.Load("audio\sounds\other\zombiegeddon\FURGH2.wav")

/////////Ну хуй его знает
CARMA_VOICE_FALRITE2 = Audiostream.Load("audio\sounds\other\zombiegeddon\FALRITE2.wav")
CARMA_VOICE_FALRITE3 = Audiostream.Load("audio\sounds\other\zombiegeddon\FALRITE3.wav")

/////////При смерти ГГ
CARMA_VOICE_FDEAD = Audiostream.Load("audio\sounds\other\zombiegeddon\FDEAD.wav")

/////////Когда игрока таранит какая-то машина
CARMA_VOICE_FGETCHA = Audiostream.Load("audio\sounds\other\zombiegeddon\FGETCHA.wav")
CARMA_VOICE_FGODDAM = Audiostream.Load("audio\sounds\other\zombiegeddon\FGODDAM.wav")
CARMA_VOICE_FGRR4 = Audiostream.Load("audio\sounds\other\zombiegeddon\FGRR4.wav")
CARMA_VOICE_FGRR7 = Audiostream.Load("audio\sounds\other\zombiegeddon\FGRR7.wav")
CARMA_VOICE_FMUTHA = Audiostream.Load("audio\sounds\other\zombiegeddon\FMUTHA.wav")
CARMA_VOICE_FHURT1 = Audiostream.Load("audio\sounds\other\zombiegeddon\FHURT1.wav")
CARMA_VOICE_FSUMVA = Audiostream.Load("audio\sounds\other\zombiegeddon\FSUMVA.wav")

/////////////Звуки обгона соперников
CARMA_VOICE_FYEAH1 = Audiostream.Load("audio\sounds\other\zombiegeddon\FYEAH1.wav")
CARMA_VOICE_FYEAH2 = Audiostream.Load("audio\sounds\other\zombiegeddon\FYEAH2.wav")
CARMA_VOICE_FYEAH3 = Audiostream.Load("audio\sounds\other\zombiegeddon\FALRITE2.WAV")
CARMA_VOICE_FYEAH4 = Audiostream.Load("audio\sounds\other\zombiegeddon\FALRITE3.WAV")

else

////////////////////////////////////////////////////////////////////////////////////

CARMA_VOICE_FHAHA1 = Audiostream.Load("audio\sounds\other\zombiegeddon\EVILLAFF.WAV")
CARMA_VOICE_FLAFF3 = Audiostream.Load("audio\sounds\other\zombiegeddon\EVILLAF2.WAV")
CARMA_VOICE_FMESSY = Audiostream.Load("audio\sounds\other\zombiegeddon\EVILLAF3.WAV")
CARMA_VOICE_FSORRY2 = Audiostream.Load("audio\sounds\other\zombiegeddon\SORRY2.WAV")
CARMA_VOICE_FSORRY3 = Audiostream.Load("audio\sounds\other\zombiegeddon\SORRY5.WAV")
CARMA_VOICE_FSHITHAP = Audiostream.Load("audio\sounds\other\zombiegeddon\GIGGLE.WAV")
CARMA_VOICE_FBETHRT3 = Audiostream.Load("audio\sounds\other\zombiegeddon\EVILLAF3.WAV")

/////////При ебанутой езде\полете
CARMA_VOICE_FAA02 = Audiostream.Load("audio\sounds\other\zombiegeddon\WOOHOO1.WAV")
CARMA_VOICE_FAARGH3 = Audiostream.Load("audio\sounds\other\zombiegeddon\WOOO.WAV")
CARMA_VOICE_FAAH_WAV = Audiostream.Load("audio\sounds\other\zombiegeddon\WOOHOO1.WAV")
CARMA_VOICE_FAARGH5 = Audiostream.Load("audio\sounds\other\zombiegeddon\WOOO.WAV")
CARMA_VOICE_FOARGH = Audiostream.Load("audio\sounds\other\zombiegeddon\WOOHOO1.WAV")
CARMA_VOICE_FOHSHIT1 = Audiostream.Load("audio\sounds\other\zombiegeddon\WOOO.WAV")
CARMA_VOICE_FWAYHAY = Audiostream.Load("audio\sounds\other\zombiegeddon\WOOHOO1.WAV")
CARMA_VOICE_FWOOHOO = Audiostream.Load("audio\sounds\other\zombiegeddon\WOOO.WAV")

/////////Когда машина игрока получает урон
CARMA_VOICE_FAAH = Audiostream.Load("audio\sounds\other\zombiegeddon\OOF1.WAV")
CARMA_VOICE_FAH = Audiostream.Load("audio\sounds\other\zombiegeddon\OOF2.WAV")
CARMA_VOICE_FOOH = Audiostream.Load("audio\sounds\other\zombiegeddon\OOP1.WAV")
CARMA_VOICE_FOOH2 = Audiostream.Load("audio\sounds\other\zombiegeddon\URGH.WAV")
CARMA_VOICE_FOW = Audiostream.Load("audio\sounds\other\zombiegeddon\UUUGH1.WAV")
CARMA_VOICE_FOW2 = Audiostream.Load("audio\sounds\other\zombiegeddon\UUUGH3.WAV")
CARMA_VOICE_FOW3 = Audiostream.Load("audio\sounds\other\zombiegeddon\EEUUW.WAV")
CARMA_VOICE_FURGH2 = Audiostream.Load("audio\sounds\other\zombiegeddon\BEHIND1.WAV")

/////////Ну хуй его знает
CARMA_VOICE_FALRITE2 = Audiostream.Load("audio\sounds\other\zombiegeddon\ALRIGHT3.WAV")
CARMA_VOICE_FALRITE3 = Audiostream.Load("audio\sounds\other\zombiegeddon\ALRIGHT4.WAV")

/////////При смерти ГГ
CARMA_VOICE_FDEAD = Audiostream.Load("audio\sounds\other\zombiegeddon\GRRRRRR1.WAV")

/////////Когда игрока таранит какая-то машина
CARMA_VOICE_FGETCHA = Audiostream.Load("audio\sounds\other\zombiegeddon\GETYOU.WAV")
CARMA_VOICE_FGODDAM = Audiostream.Load("audio\sounds\other\zombiegeddon\BEHIND1.WAV")
CARMA_VOICE_FGRR4 = Audiostream.Load("audio\sounds\other\zombiegeddon\OOF2.WAV")
CARMA_VOICE_FGRR7 = Audiostream.Load("audio\sounds\other\zombiegeddon\UUUGH1.WAV")
CARMA_VOICE_FMUTHA = Audiostream.Load("audio\sounds\other\zombiegeddon\OOF1.WAV")
CARMA_VOICE_FHURT1 = Audiostream.Load("audio\sounds\other\zombiegeddon\OWHURT.WAV")
CARMA_VOICE_FSUMVA = Audiostream.Load("audio\sounds\other\zombiegeddon\EEUUW3.WAV")

/////////////Звуки обгона соперников
CARMA_VOICE_FYEAH1 = Audiostream.Load("audio\sounds\other\zombiegeddon\YEAH2.wav")
CARMA_VOICE_FYEAH2 = Audiostream.Load("audio\sounds\other\zombiegeddon\YEAH4.wav")
CARMA_VOICE_FYEAH3 = Audiostream.Load("audio\sounds\other\zombiegeddon\ALRIGHT3.WAV")
CARMA_VOICE_FYEAH4 = Audiostream.Load("audio\sounds\other\zombiegeddon\ALRIGHT4.WAV")

////////////////////////////////////////////////////////////////////////////////////

end

/////////Скрежет металла
CARMA_VOICE_METAL1 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\METAL1.wav")
CARMA_VOICE_METAL2 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\METAL2.wav")
CARMA_VOICE_METAL3 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\METAL3.wav")
CARMA_VOICE_METAL4 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\METAL4.wav")
CARMA_VOICE_METAL5 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\METAL5.wav")
CARMA_VOICE_METAL6 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\METAL6.wav")
CARMA_VOICE_METAL7 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\METAL7.wav")

/////////Звук давки зомби
CARMA_VOICE_BIGHIT02 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\BIGHIT02.wav")
CARMA_VOICE_BIGHIT03 = Audiostream.Load3d("audio\sounds\other\zombiegeddon\BIGHIT03.wav")

/////////Звук подбирания бонуса
CARMA_VOICE_BONUS = Audiostream.Load("audio\sounds\other\zombiegeddon\PUPXPLOD.WAV")

/////////Звук подбирания бонуса соперником
CARMA_OPP_BONUS_SOUND = Audiostream.Load3D("audio\sounds\other\zombiegeddon\PUPXPLOD.WAV")

/////////Звук починки соперника
CARMA_OPP_REPAIR_SOUND = Audiostream.Load3D("audio\sounds\other\zombiegeddon\REPAIR2.wav")

/////////Звук пустого бонуса
CARMA_BONUS_EMPTY_SOUND = Audiostream.Load("audio\sounds\other\zombiegeddon\PARTNO.WAV")

for 0@ = 0 to 44
Audiostream.Loop($AMM_WEAPON[0@], 0)
end

///////////////////////////////////////////////////////////////////////////////////////////////////////////

return

:TOURNAMENT_FAIL_CHECK

if
not ZOMBEGEDDON_TOURNAMENT == 1
then
return
end

0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_START"
0AF1: write_int -1 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_MODE"
0AF1: write_int 0 to_ini_file "saves/ZACM.set" section "SCR" key "CARMAGEDDON_TOURNAMENT"

0B00: delete_file "data\derby_Tournament.ini"  // IF and SET

return

:TOURNAMENT_ADVANCE

if
not ZOMBEGEDDON_TOURNAMENT == 1
then
return
end

0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
0@ += 1
0AF1: write_int 0@ to_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"

0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_COMPLETED"
0@ += 1
0AF1: write_int 0@ to_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_COMPLETED"

return

:ZOMBEGEDDON_CP_RUSH_NEW_LAP_REC_WRITE

/////////////////////////////////////////////////////////////
if
UNITED_MAP == 0
then

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AD3: v$LADDER_FILE2 = format "CLAPRM%d" CARMA_GLOB_RACE_NUMBER
else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AD3: v$LADDER_FILE2 = format "3LAPRM%d" CARMA_GLOB_RACE_NUMBER
else
0AD3: v$LADDER_FILE2 = format "4LAPRM%d" CARMA_GLOB_RACE_NUMBER
end

end

else

if
$UNITED_III_SPAWN == 1
then
0AD3: v$LADDER_FILE2 = format "1CLAPRM%d" CARMA_GLOB_RACE_NUMBER
else
0AD3: v$LADDER_FILE2 = format "2CLAPRM%d" CARMA_GLOB_RACE_NUMBER
end

end
/////////////////////////////////////////////////////////////

0AF1: write_int CARMA_CPRUSH_LAP_REC_CURR_MINUTES to_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2

/////////////////////////////////////////////////////////////
if
UNITED_MAP == 0
then

if
ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
then
0AD3: v$LADDER_FILE2 = format "CLAPRS%d" CARMA_GLOB_RACE_NUMBER
else

if
CLASSIC_CARMA_MAP_AC_MODE == 0
then
0AD3: v$LADDER_FILE2 = format "3LAPRS%d" CARMA_GLOB_RACE_NUMBER
else
0AD3: v$LADDER_FILE2 = format "4LAPRS%d" CARMA_GLOB_RACE_NUMBER
end

end

else

if
$UNITED_III_SPAWN == 1
then
0AD3: v$LADDER_FILE2 = format "1CLAPRS%d" CARMA_GLOB_RACE_NUMBER
else
0AD3: v$LADDER_FILE2 = format "2CLAPRS%d" CARMA_GLOB_RACE_NUMBER
end

end
/////////////////////////////////////////////////////////////

0AF1: write_int CARMA_CPRUSH_LAP_REC_CURR_SECONDS to_ini_file "saves/ZACM.set" section "SCR" key v$LADDER_FILE2

return

:DERBYGEDDON_CP_RUSH_AFTERDRIVE

if and
ZOMBIEGEDDON_GAME_TYPE == 2
$SPECTATING_FLAG == 0
    then
    
    if
    860E: not  car CARMA_GLOB_DERBY_PLAYER_CAR assigned_to_path
    then
    
    car.StorePos(ZOMBIEGEDDON_PATH_CAR,6@,2@,3@)
    
    if
    4@ == 1
    then
    4@ = 0
    0704: car CARMA_GLOB_DERBY_PLAYER_CAR drive_to 6@ 2@ 3@
//    0EB4: set_car_coordinates_simple CARMA_GLOB_DERBY_PLAYER_CAR position 1@ 2@ 3@
//    0840: link_car CARMA_GLOB_DERBY_PLAYER_CAR to_interior $ACTIVE_INTERIOR    
    
    if
    ZOMBIEGEDDON_CLASSIC_ADDON_FLAG == 0
    then
    0AF2: 5@ = get_float_from_ini_file "data/derby.ini" section v$RACE_FILE key "PLAYER_CAR_A"
    else
    
    if
    CLASSIC_CARMA_MAP_AC_MODE == 0
    then 
    0AF2: 5@ = get_float_from_ini_file CLASSIC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_A"
    else
    0AF2: 5@ = get_float_from_ini_file AC_CARMAGEDDON_RACES_INI_PATH section v$RACE_FILE key "PLAYER_CAR_A"
    end
    
    end
    
//    car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,true)
//    car.SetSpeedInstantly(CARMA_GLOB_DERBY_PLAYER_CAR,0.0)
//    car.LockInCurrentPosition(CARMA_GLOB_DERBY_PLAYER_CAR,false)            
//    
//    0A97: 25@ = car CARMA_GLOB_DERBY_PLAYER_CAR struct
//    25@ += 0x50 //X
//    0A8C: write_memory 25@ size 4 value 0.0 virtual_protect 0
//    25@ += 4 //Y
//    0A8C: write_memory 25@ size 4 value 0.0 virtual_protect 0
//    25@ += 4 //Z
//    0A8C: write_memory 25@ size 4 value 0.0 virtual_protect 0
//    
//    car.Angle(CARMA_GLOB_DERBY_PLAYER_CAR) = 5@
//    02E3: 5@ = car CARMA_GLOB_DERBY_PLAYER_CAR speed
//    if
//    5@ < 25.0
//    then
//    car.SetSpeedInstantly(CARMA_GLOB_DERBY_PLAYER_CAR,25.0)
//    end
                 
    end                                    
    
    if and
    01AD:   car CARMA_GLOB_DERBY_PLAYER_CAR sphere 0 near_point 6@ 2@ radius 5.0 5.0
    860E: not  car CARMA_GLOB_DERBY_PLAYER_CAR assigned_to_path
    then        
    
    008B: 7@ = CARMA_GLOB_RACE_NUMBER // (int)
    7@ += 16
    if
    7@ > 73
    then
    7@ += 100
    end    
    
    repeat
    wait 0
    07C0: load_path 7@
    until 07C1:   path 7@ available
    
    0705: car CARMA_GLOB_DERBY_PLAYER_CAR assign_to_path 7@ and_drive_normal
    06FD: set_car CARMA_GLOB_DERBY_PLAYER_CAR speed_on_path_to 1.2 
    car.SetMaxSpeed(CARMA_GLOB_DERBY_PLAYER_CAR,100.0)
    
    end
    
    end
    
    end
    
return

:ZOMBIEGEDDON_DO_BURNOUT_ON

if
UNITED_MAP == 0
then
0A8C: write_memory 0x086A96B size 1 value 50 virtual_protect 0
end

if and
UNITED_MAP == 1
STORIES_MAP == 0
then
0A8C: write_memory 0x086A96B size 1 value 51 virtual_protect 0
end

if and
UNITED_MAP == 1
STORIES_MAP == 1
then
0A8C: write_memory 0x086A96B size 1 value 52 virtual_protect 0
end

0A8D: 0@ = read_memory 0x05BFA96 size 4 virtual_protect false
0AA6: call_method 0x5BD830 cHandlingDataMgr::LoadHandlingData struct 0@ num_params 0 pop 0

0A8C: write_memory 0x086A96B size 1 value 71 virtual_protect 0

return 

:CHECK_CARMA2_RESOURCES_CHANGE_AND_BACK

//////////////////////////////////////////////////////

if
CARMA_GLOB_MAP_NABOR == 2
then

0AF0: 0@ = get_int_from_ini_file "modloader\modloader.ini" section "Profiles.Default.Priority" key "MODLOADER GTC FILES 2"
if
not 0@ == 100
    then    
    
    wait 250
    0AF1: write_int 100 to_ini_file "modloader\modloader.ini" section "Profiles.Default.Priority" key "MODLOADER GTC FILES 2"
    
    repeat
    wait 0
    03F0: enable_text_draw 1
    038D: draw_texture 127 position 320.0 224.5 size 640.0 449.0 RGBA 255 255 255 255
    03E3: set_texture_to_be_drawn_antialiased 1
    09FD: get_gxt_string "CARMA2C" width_to 9@
    until 9@ > 0
    
    32@ = 0
    repeat
    wait 0
    03F0: enable_text_draw 1
    038D: draw_texture 127 position 320.0 224.5 size 640.0 449.0 RGBA 255 255 255 255
    03E3: set_texture_to_be_drawn_antialiased 1
    until 32@ >= 1000
    //wait 1000
    CLASSIC_CARMA_CHECKED_CARMA2_RSC = 1
    else
    CLASSIC_CARMA_CHECKED_CARMA2_RSC = 1
    end

else

0AF0: 0@ = get_int_from_ini_file "modloader\modloader.ini" section "Profiles.Default.Priority" key "MODLOADER GTC FILES 2"
if
0@ == 100
    then   
    
    wait 250
    0AF1: write_int 0 to_ini_file "modloader\modloader.ini" section "Profiles.Default.Priority" key "MODLOADER GTC FILES 2"
    
    repeat
    wait 0
    03F0: enable_text_draw 1
    038D: draw_texture 127 position 320.0 224.5 size 640.0 449.0 RGBA 255 255 255 255
    03E3: set_texture_to_be_drawn_antialiased 1 
    09FD: get_gxt_string "CARMA2C" width_to 9@
    until 9@ == 0
    
    32@ = 0
    repeat
    wait 0
    03F0: enable_text_draw 1
    038D: draw_texture 127 position 320.0 224.5 size 640.0 449.0 RGBA 255 255 255 255
    03E3: set_texture_to_be_drawn_antialiased 1
    until 32@ >= 1000
    //wait 1000
    CLASSIC_CARMA_CHECKED_CARMA2_RSC = 1
    else
    CLASSIC_CARMA_CHECKED_CARMA2_RSC = 1
    end

end

//////////////////////////////////////////////////////

return

:CARMAGEDDON_CREATE_BINARY_IPLS

//////////////////////////////////////////////////////

if
CLASSIC_CARMA_MAP >= 1
then

if
CARMA_GLOB_RACE_NUMBER == 0
then 
0776: create_objects_in_object_group "cmap01"
end

if
CARMA_GLOB_RACE_NUMBER == 1
then
0776: create_objects_in_object_group "cmap02"
end
    
if
CARMA_GLOB_RACE_NUMBER == 2
then
0776: create_objects_in_object_group "cmap03"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end
    
if
CARMA_GLOB_RACE_NUMBER == 3
then
0776: create_objects_in_object_group "cmap04"
end

if
CARMA_GLOB_RACE_NUMBER == 4
then
0776: create_objects_in_object_group "cmap05"
end

if
CARMA_GLOB_RACE_NUMBER == 5
then
0776: create_objects_in_object_group "cmap06"
end

if
CARMA_GLOB_RACE_NUMBER == 6
then
0776: create_objects_in_object_group "cmap07"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end

if
CARMA_GLOB_RACE_NUMBER == 7
then
0776: create_objects_in_object_group "cmap08"
end

if
CARMA_GLOB_RACE_NUMBER == 8
then
0776: create_objects_in_object_group "cmap09"
end

if
CARMA_GLOB_RACE_NUMBER == 9
then
0776: create_objects_in_object_group "cmap10"
end

if
CARMA_GLOB_RACE_NUMBER == 10
then
0776: create_objects_in_object_group "cmap11"
end

if
CARMA_GLOB_RACE_NUMBER == 11
then
0776: create_objects_in_object_group "cmap12"
end

if
CARMA_GLOB_RACE_NUMBER == 12
then
0776: create_objects_in_object_group "cmap13"
end

if
CARMA_GLOB_RACE_NUMBER == 13
then
0776: create_objects_in_object_group "cmap14"
end

if
CARMA_GLOB_RACE_NUMBER == 14
then
0776: create_objects_in_object_group "cmap15"
end

if
CARMA_GLOB_RACE_NUMBER == 15
then
0776: create_objects_in_object_group "cmap16"
end

if
CARMA_GLOB_RACE_NUMBER == 16
then
0776: create_objects_in_object_group "cmap17"
end

if
CARMA_GLOB_RACE_NUMBER == 17
then
0776: create_objects_in_object_group "cmap18"
end

if
CARMA_GLOB_RACE_NUMBER == 18
then

if
ZOMBIEGEDDON_GAME_TYPE == 2
then
0776: create_objects_in_object_group "cmap19b"
else
0776: create_objects_in_object_group "cmap19"
end

end

if
CARMA_GLOB_RACE_NUMBER == 19
then
0776: create_objects_in_object_group "cmap20"
end

if
CARMA_GLOB_RACE_NUMBER == 20
then
0776: create_objects_in_object_group "cmap21"
end

if
CARMA_GLOB_RACE_NUMBER == 21
then
0776: create_objects_in_object_group "cmap22"
end

if
CARMA_GLOB_RACE_NUMBER == 22
then
0776: create_objects_in_object_group "cmap23"
end

if
CARMA_GLOB_RACE_NUMBER == 23
then
0776: create_objects_in_object_group "cmap24"
end

if
CARMA_GLOB_RACE_NUMBER == 24
then
0776: create_objects_in_object_group "cmap25"
end

if
CARMA_GLOB_RACE_NUMBER == 25
then
0776: create_objects_in_object_group "cmap26"
end

if
CARMA_GLOB_RACE_NUMBER == 26
then
0776: create_objects_in_object_group "cmap27"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end

if
CARMA_GLOB_RACE_NUMBER == 27
then
0776: create_objects_in_object_group "cmap28"
end

if
CARMA_GLOB_RACE_NUMBER == 28
then
0776: create_objects_in_object_group "cmap29"
end

if
CARMA_GLOB_RACE_NUMBER == 29
then
0776: create_objects_in_object_group "cmap30"
end

if
CARMA_GLOB_RACE_NUMBER == 30
then
0776: create_objects_in_object_group "cmap31"
end

if
CARMA_GLOB_RACE_NUMBER == 31
then
0776: create_objects_in_object_group "cmap32"
end

if
CARMA_GLOB_RACE_NUMBER == 32
then
0776: create_objects_in_object_group "cmap33"
end

if
CARMA_GLOB_RACE_NUMBER == 33
then
0776: create_objects_in_object_group "cmap34"
end

if
CARMA_GLOB_RACE_NUMBER == 34
then
0776: create_objects_in_object_group "cmap35"
end

if
CARMA_GLOB_RACE_NUMBER == 35
then
0776: create_objects_in_object_group "cmap36"
end

if
CARMA_GLOB_RACE_NUMBER == 36
then
0776: create_objects_in_object_group "cmap37"
end

if
CARMA_GLOB_RACE_NUMBER == 37
then
0776: create_objects_in_object_group "cmap38"
end

if
CARMA_GLOB_RACE_NUMBER == 38
then
0776: create_objects_in_object_group "cmap39"
end

if
CARMA_GLOB_RACE_NUMBER == 39
then
0776: create_objects_in_object_group "cmap40"
end

if
CARMA_GLOB_RACE_NUMBER == 40
then 
0776: create_objects_in_object_group "cmap41"
end

if
CARMA_GLOB_RACE_NUMBER == 41
then 
0776: create_objects_in_object_group "cmap42"
end

if
CARMA_GLOB_RACE_NUMBER == 42
then
0776: create_objects_in_object_group "cmap43"
end

if
CARMA_GLOB_RACE_NUMBER == 43
then
0776: create_objects_in_object_group "cmap44"
end

if
CARMA_GLOB_RACE_NUMBER == 44
then
0776: create_objects_in_object_group "cmap45"
end

if
CARMA_GLOB_RACE_NUMBER == 45
then
0776: create_objects_in_object_group "cmap46"
end

if
CARMA_GLOB_RACE_NUMBER == 46
then
0776: create_objects_in_object_group "cmap47"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end

if
CARMA_GLOB_RACE_NUMBER == 47
then
0776: create_objects_in_object_group "cmap48"
end

if
CARMA_GLOB_RACE_NUMBER == 48
then
0776: create_objects_in_object_group "cmap49"
end

if
CARMA_GLOB_RACE_NUMBER == 49
then
0776: create_objects_in_object_group "cmap50"
end

if
CARMA_GLOB_RACE_NUMBER == 50
then
0776: create_objects_in_object_group "cmap51"
end

if
CARMA_GLOB_RACE_NUMBER == 51
then
0776: create_objects_in_object_group "cmap52"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end

if
CARMA_GLOB_RACE_NUMBER == 52
then 
0776: create_objects_in_object_group "cmap53"
end

if
CARMA_GLOB_RACE_NUMBER == 53
then
0776: create_objects_in_object_group "cmap54"
end

if
CARMA_GLOB_RACE_NUMBER == 54
then
0776: create_objects_in_object_group "cmap55"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end

if
CARMA_GLOB_RACE_NUMBER == 55
then 
0776: create_objects_in_object_group "cmap56"
end

if
CARMA_GLOB_RACE_NUMBER == 56
then
0776: create_objects_in_object_group "cmap57"
end

if
CARMA_GLOB_RACE_NUMBER == 57
then
0776: create_objects_in_object_group "cmap58"
02CF: 0@ = create_fire_at 1710.0945 2201.8176 1632.0 propagation 0 size 3
02CF: 0@ = create_fire_at 1705.7252 2193.1445 1632.0 propagation 0 size 3
02CF: 0@ = create_fire_at 1710.3335 2158.6677 1632.0 propagation 0 size 3
02CF: 0@ = create_fire_at 1704.5525 2141.9246 1632.0 propagation 0 size 3
02CF: 0@ = create_fire_at 1710.9716 2126.8503 1632.0 propagation 0 size 3
02CF: 0@ = create_fire_at 1704.2686 2113.322 1632.0 propagation 0 size 3
02CF: 0@ = create_fire_at 1706.5012 2174.6233 1632.0 propagation 0 size 3
end

if
CARMA_GLOB_RACE_NUMBER == 58
then
0776: create_objects_in_object_group "cmap59"
end

if
CARMA_GLOB_RACE_NUMBER == 59
then
0776: create_objects_in_object_group "cmap60"
end

if
CARMA_GLOB_RACE_NUMBER == 60
then
0776: create_objects_in_object_group "cmap61"
end

if
CARMA_GLOB_RACE_NUMBER == 61
then
0776: create_objects_in_object_group "cmap62"
end

if
CARMA_GLOB_RACE_NUMBER == 62
then
0776: create_objects_in_object_group "cmap63"
end

if
CARMA_GLOB_RACE_NUMBER == 63
then
0776: create_objects_in_object_group "cmap64"
end

if
CARMA_GLOB_RACE_NUMBER == 64
then
0776: create_objects_in_object_group "cmap65"
end

if
CARMA_GLOB_RACE_NUMBER == 65
then
0776: create_objects_in_object_group "cmap66"
end

if
CARMA_GLOB_RACE_NUMBER == 66
then
0776: create_objects_in_object_group "cmap67"
end

if
CARMA_GLOB_RACE_NUMBER == 67
then
0776: create_objects_in_object_group "cmap68"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end

if
CARMA_GLOB_RACE_NUMBER == 68
then
0776: create_objects_in_object_group "cmap69"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end

if
CARMA_GLOB_RACE_NUMBER == 69
then
0776: create_objects_in_object_group "cmap70"
end

if
CARMA_GLOB_RACE_NUMBER == 70
then
0776: create_objects_in_object_group "cmap71"
end

if
CARMA_GLOB_RACE_NUMBER == 71
then
0776: create_objects_in_object_group "cmap72"
end

if
CARMA_GLOB_RACE_NUMBER == 72
then
0776: create_objects_in_object_group "cmap73"
end

if
CARMA_GLOB_RACE_NUMBER == 73
then
0776: create_objects_in_object_group "cmap74"
end

if
CARMA_GLOB_RACE_NUMBER == 74
then
0776: create_objects_in_object_group "cmap75"
end

if
CARMA_GLOB_RACE_NUMBER == 75
then
0776: create_objects_in_object_group "cmap76"
end

if
CARMA_GLOB_RACE_NUMBER == 76
then
0776: create_objects_in_object_group "cmap77"
end

if
CARMA_GLOB_RACE_NUMBER == 77
then
0776: create_objects_in_object_group "cmap78"
02CF: 0@ = create_fire_at 1377.2241 -2358.627 79.0 propagation 2 size 4   
02CF: 0@ = create_fire_at 1397.5221 -2358.6772 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1388.1469 -2370.9023 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1387.8063 -2349.8716 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1377.7284 -2362.4324 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1377.7266 -2355.188 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1397.3728 -2355.1377 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1398.8302 -2362.2859 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1383.5223 -2369.7627 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1390.9631 -2369.2693 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1390.7991 -2349.5181 79.0 propagation 2 size 4
02CF: 0@ = create_fire_at 1384.4546 -2347.8884 79.0 propagation 2 size 4
end

if
CARMA_GLOB_RACE_NUMBER == 78
then
0776: create_objects_in_object_group "cmap79"
end

if
CARMA_GLOB_RACE_NUMBER == 79
then
0776: create_objects_in_object_group "cmap80"
end

if
CARMA_GLOB_RACE_NUMBER == 80
then
0776: create_objects_in_object_group "cmap81"
0A8C: write_memory 0x00B70155 size 1 value 12 virtual_protect 0 //Month
end

if
CARMA_GLOB_RACE_NUMBER == 81
then
0776: create_objects_in_object_group "cmap82"
end

if
CARMA_GLOB_RACE_NUMBER == 82
then
0776: create_objects_in_object_group "cmap83"
end

if
CARMA_GLOB_RACE_NUMBER == 83
then
0776: create_objects_in_object_group "cmap84"
end

if
CARMA_GLOB_RACE_NUMBER == 84
then
0776: create_objects_in_object_group "cmap85"
end

if
CARMA_GLOB_RACE_NUMBER == 85
then
0776: create_objects_in_object_group "cmap86"
end

if
CARMA_GLOB_RACE_NUMBER == 86
then
0776: create_objects_in_object_group "cmap87"
end

end

//////////////////////////////////////////////////////

if and
UNITED_MAP == 0
CLASSIC_CARMA_MAP < 1
then

//////////////////////////////////////////////////////

if
CARMA_GLOB_RACE_NUMBER == 0
then
0776: create_objects_in_object_group "cmap01"
end

if
CARMA_GLOB_RACE_NUMBER == 1
then
0776: create_objects_in_object_group "cmap02"
end
    
if
CARMA_GLOB_RACE_NUMBER == 2
then
0776: create_objects_in_object_group "cmap03"
end
    
if
CARMA_GLOB_RACE_NUMBER == 3
then
0776: create_objects_in_object_group "cmap04"
end

if
CARMA_GLOB_RACE_NUMBER == 4
then
0776: create_objects_in_object_group "cmap05"
end

if
CARMA_GLOB_RACE_NUMBER == 5
then
0776: create_objects_in_object_group "cmap06"
end

if
CARMA_GLOB_RACE_NUMBER == 6
then
0776: create_objects_in_object_group "cmap07"
end

if
CARMA_GLOB_RACE_NUMBER == 7
then
0776: create_objects_in_object_group "cmap08"
end

if
CARMA_GLOB_RACE_NUMBER == 8
then
0776: create_objects_in_object_group "cmap09"
end

if
CARMA_GLOB_RACE_NUMBER == 9
then
0776: create_objects_in_object_group "cmap10"
end

if
CARMA_GLOB_RACE_NUMBER == 10
then
0776: create_objects_in_object_group "cmap11"
end

if
CARMA_GLOB_RACE_NUMBER == 11
then
0776: create_objects_in_object_group "cmap12"
end

if
CARMA_GLOB_RACE_NUMBER == 12
then
0776: create_objects_in_object_group "cmap13"
end

if
CARMA_GLOB_RACE_NUMBER == 13
then
0776: create_objects_in_object_group "cmap14"
end

if
CARMA_GLOB_RACE_NUMBER == 14
then
0776: create_objects_in_object_group "cmap15"
end

if
CARMA_GLOB_RACE_NUMBER == 15
then
0776: create_objects_in_object_group "cmap16"
end

if
CARMA_GLOB_RACE_NUMBER == 16
then
0776: create_objects_in_object_group "cmap17"
end

if
CARMA_GLOB_RACE_NUMBER == 17
then
0776: create_objects_in_object_group "cmap18"
end

if
CARMA_GLOB_RACE_NUMBER == 18
then
0776: create_objects_in_object_group "cmap19"
end

//////////////////////////////////////////////////////        

end  

if
UNITED_MAP == 1
then

if
$UNITED_III_SPAWN == 1
then

if
CARMA_GLOB_RACE_NUMBER == 0
then
0776: create_objects_in_object_group "cmap01"
end

if
CARMA_GLOB_RACE_NUMBER == 1
then
0776: create_objects_in_object_group "cmap02"
end
    
if
CARMA_GLOB_RACE_NUMBER == 2
then
0776: create_objects_in_object_group "cmap03"
end

else

if
CARMA_GLOB_RACE_NUMBER == 0
then
0776: create_objects_in_object_group "2cmap01"
end

if
CARMA_GLOB_RACE_NUMBER == 1
then
0776: create_objects_in_object_group "2cmap02"
end
    
if
CARMA_GLOB_RACE_NUMBER == 2
then
0776: create_objects_in_object_group "2cmap03"
end

end

end

//////////////////////////////////////////////////////

return

:CARMAGEDDON_GET_PLAYER_DAMAGE

if
09BB:   car CARMA_GLOB_DERBY_PLAYER_CAR has_visible_damage_on_component 0
    then        
    $SAVE_CAR_COMPONENT1_DAMAGE_FLAG[0] = 1
    end
 
if
09BB:   car CARMA_GLOB_DERBY_PLAYER_CAR has_visible_damage_on_component 1
    then
    $SAVE_CAR_COMPONENT2_DAMAGE_FLAG[0] = 1
    end

if
09BB:   car CARMA_GLOB_DERBY_PLAYER_CAR has_visible_damage_on_component 2
    then    
    095F: get_car CARMA_GLOB_DERBY_PLAYER_CAR door 2 angle_to 0@
    if
    0@ >= 0.0
        then
        $SAVE_CAR_COMPONENT3_DAMAGE_FLAG[0] = 1        
        end    
    end

if
09BB:   car CARMA_GLOB_DERBY_PLAYER_CAR has_visible_damage_on_component 3
    then
    095F: get_car CARMA_GLOB_DERBY_PLAYER_CAR door 3 angle_to 0@
    if
    0@ >= 0.0
        then
        $SAVE_CAR_COMPONENT4_DAMAGE_FLAG[0] = 1
        end
    end
    
if
856E: not  car CARMA_GLOB_DERBY_PLAYER_CAR defined
then
return
end    
    
if
8D0D: not 0@ = get_car CARMA_GLOB_DERBY_PLAYER_CAR component "door_lr_dummy" // IF and SET 
    then
    return
    end    

if
09BB:   car CARMA_GLOB_DERBY_PLAYER_CAR has_visible_damage_on_component 4
    then
    095F: get_car CARMA_GLOB_DERBY_PLAYER_CAR door 4 angle_to 0@
    if
    0@ >= 0.0
        then
        $SAVE_CAR_COMPONENT5_DAMAGE_FLAG[0] = 1
        end
    end

if
09BB:   car CARMA_GLOB_DERBY_PLAYER_CAR has_visible_damage_on_component 5
    then
    095F: get_car CARMA_GLOB_DERBY_PLAYER_CAR door 5 angle_to 0@
    if
    0@ >= 0.0
        then
        $SAVE_CAR_COMPONENT6_DAMAGE_FLAG[0] = 1
        end
    end
    
return

:CARMAGEDDON_SET_PLAYER_DAMAGE

0@ = car.Model(CARMA_GLOB_DERBY_PLAYER_CAR)
if and
881E: not model 0@ boat
881F: not model 0@ plane
8820: not model 0@ heli
8A01: not model 0@ car
    then  
    return
    end

if or
0@ == 581
0@ == 462
0@ == 463
0@ == 521
0@ == 448
0@ == 461
0@ == 468
0@ == 586
    then
    return
    end
    
if or
0@ == 521
0@ == 471
0@ == 523
    then
    return
    end
    
if
UNITED_MAP == 1
then

if or    
0@ == 15293
0@ == 15296
0@ == 15319
0@ == 15322
0@ == 15332
    then
    return
    end    
    
if or
0@ == 15418
0@ == 15421
0@ == 15428
0@ == 15430
0@ == 15435
0@ == 15507
0@ == 15510
0@ == 15523
    then
    return
    end

if or    
0@ == 15526
0@ == 15532
0@ == 15299
    then
    return
    end
    
if or
0@ == 15454
0@ == 15455
0@ == 15456
0@ == 15457
0@ == 15426
0@ == 15558 
    then
    return
    end
    
if or
0@ == 15550
0@ == 15552
0@ == 15565
0@ == 15556
0@ == 15558
0@ == 15566 
    then
    return
    end
   
end        

if
$SAVE_CAR_COMPONENT1_DAMAGE_FLAG[0] == 1
    then
    073C: car CARMA_GLOB_DERBY_PLAYER_CAR damage_componentB 0
    end

if
$SAVE_CAR_COMPONENT2_DAMAGE_FLAG[0] == 1
    then
    073C: car CARMA_GLOB_DERBY_PLAYER_CAR damage_componentB 1
    end

if
$SAVE_CAR_COMPONENT3_DAMAGE_FLAG[0] == 1
    then
    073C: car CARMA_GLOB_DERBY_PLAYER_CAR damage_componentB 2
    end

if
$SAVE_CAR_COMPONENT4_DAMAGE_FLAG[0] == 1
    then
    073C: car CARMA_GLOB_DERBY_PLAYER_CAR damage_componentB 3
    end
    
if
8D0D: not 0@ = get_car CARMA_GLOB_DERBY_PLAYER_CAR component "door_lr_dummy" // IF and SET 
    then
    return
    end    

if
$SAVE_CAR_COMPONENT5_DAMAGE_FLAG[0] == 1
    then
    073C: car CARMA_GLOB_DERBY_PLAYER_CAR damage_componentB 4
    end

if
$SAVE_CAR_COMPONENT6_DAMAGE_FLAG[0] == 1
    then
    073C: car CARMA_GLOB_DERBY_PLAYER_CAR damage_componentB 5 
    end

return   

:CRM_TEXT
thread 'CRM_TEXT'

0@ = 0
1@ = 0
33@ = 0

while true
wait 0

if
33@ > 2
then
0@ += 10
33@ = 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 200.0 GXT v$CRM_TXT

if or
0@ == 250
$HUD_REMOVE == 1
    then
    break
    end

end

/////////////////////////////////////

end_thread

:CRM_TEXB
thread 'CRM_TEXB'

0@ = 0
1@ = 0
33@ = 0

while true
wait 0

0459: end_thread_named 'CRMTXT2'
0459: end_thread_named 'CRMTT21'

if and
33@ > 2
not 0@ == 250
then
0@ += 10
33@ = 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 0.75 1.5
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 400.0 for_centered_text 
033E: set_draw_text_position 320.0 50.0 GXT v$CRM_TXT

if and
0@ == 250
33@ > 7500
    then
    break
    end

end

/////////////////////////////////////

end_thread

:CRMTXT2
thread 'CRMTXT2'

0@ = 0
1@ = 0
33@ = 0

while true
wait 0

if and
33@ > 2
not 0@ == 250
then
0@ += 10
33@ = 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 180.0 GXT v$2NAME3

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 200.0 GXT 'CRM17'

if and
0@ == 250
33@ > 2000
    then
    break
    end
    
if
$HUD_REMOVE == 1
    then
    break
    end            

end    

/////////////////////////////////////

end_thread

:CRMTT21
thread 'CRMTT21'

0@ = 0
1@ = 0
33@ = 0

while true
wait 0

if and
33@ > 2
not 0@ == 250
then
0@ += 10
33@ = 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 180.0 GXT v$2NAME3

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 200.0 GXT 'CRM48'

if and
0@ == 250
33@ > 2000
    then
    break
    end        

end    

/////////////////////////////////////

end_thread

:CRM_TEXT28
thread 'CRM_TEXT28'

0@ = 0
1@ = 0
33@ = 0

while true
wait 0

if and
33@ > 2
not 0@ == 250
then
0@ += 10
33@ = 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 180.0 GXT v$2NAME3

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text
if
not ZOMBIEGEDDON_GAME_TYPE == 2
then 
033E: set_draw_text_position 320.0 200.0 GXT 'CRM46'
else
033E: set_draw_text_position 320.0 200.0 GXT 'CRM52'
end

if and
0@ == 250
33@ > 5000
    then
    break
    end        

end    

/////////////////////////////////////

end_thread

:CRM_TEXT29
thread 'CRM_TEXT29'

0@ = 0
1@ = 0
33@ = 0

while true
wait 0

if and
33@ > 2
not 0@ == 250
then
0@ += 10
33@ = 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 180.0 GXT v$2NAME3

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 200.0 GXT 'CRM47'

if and
0@ == 250
33@ > 3500
    then
    break
    end        

end    

/////////////////////////////////////

end_thread

:CRM_TEXT3
thread 'CRM_TEXT3'

0@ = 0
1@ = 0
33@ = 0

while true
wait 0

if and
33@ > 2
not 0@ == 250
then
0@ += 10
33@ = 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 100.0 GXT v$CRM_TXT

if and
0@ == 250
33@ > 5000
    then
    break
    end        

end    

/////////////////////////////////////

end_thread

:BNS_TEXT
thread 'BNS_TEXT'

if
not 0@ == 1
then

0AF0: 0@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_BONUSES_GOT"                
                    
if
$CHEATED_FLAG == 0 
then   
0@ += 1
end              
                 
0AF1: write_int 0@ to_ini_file "saves/ZACM.set" section "SCR" key "ZOMBIGEDDON_BONUSES_GOT"
    
0AF0: 1@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT135_GOT"
if and
1@ == 0
0@ >= 300
$CHEATED_FLAG == 0
    then                            
    v$ACHIEVEMNT = "ACH135"
    $ACHIEVEMENT_GOT_FLAG = 1                                    
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT135_GOT"
    end
    
end    

0@ = 0
1@ = 0
33@ = 0

while true
wait 0

if and
33@ > 2
not 0@ == 250
then
0@ += 10
33@ = 0
end

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 0@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 0@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 280.0 for_centered_text 
033E: set_draw_text_position 320.0 100.0 GXT v$BNS_TXT

if and
0@ == 250
33@ > 1500
    then
    break
    end        

end    

/////////////////////////////////////

end_thread

:CAR_DMG_P
thread 'CAR_DMG_P'

while true
0@ = car.Health(CARMA_GLOB_DERBY_PLAYER_CAR)
wait 5
1@ = car.Health(CARMA_GLOB_DERBY_PLAYER_CAR)

if and
803B: not  1@ == 0@  // (int)
851D: not  car CARMA_GLOB_DERBY_PLAYER_CAR damaged_by_car -1
851C: not  car CARMA_GLOB_DERBY_PLAYER_CAR damaged_by_actor -1
89CB: not  vehicle CARMA_GLOB_DERBY_PLAYER_CAR colliding_with_vehicle -1
    then            
    0062: 0@ -= 1@  // (int)
    if
    0@ > 15
        then
        CARMA_GLOB_DERBY_PLAYER_CAR_HIT2_FLAG = 1                    
        end    
    end                

end

end_thread

:CRM_CAM
thread 'CRM_CAM'

const
CARMA_FINAL_CAM_X = 4@
CARMA_FINAL_CAM_Y = 5@
end

if
$ZOMBIE_DERBY_FLAG == 1
then
CARMA_GLOB_DERBY_PLAYER_CAR = actor.CurrentCar(PLAYER_ACTOR)
else
car.StorePos(CARMA_GLOB_DERBY_PLAYER_CAR,6@,7@,8@)
end

CARMA_FINAL_CAM_X = -5.0
CARMA_FINAL_CAM_Y = -5.0

if
$ZOMBIE_DERBY_FLAG == 1
then
create_thread @CRM_STATS
else
jump to @CRM_CAM_START
end

if
ZOMBIEGEDDON_GAME_TYPE == 2
then
093D: lock_camera_on_cinematic_view 1
end_thread
end

0E60: set_camera_control 0
0E69: set_player_control_pad_movement 0 0 
if
$ZOMBIE_DERBY_FLAG == 1 
then
0221: set_player PLAYER_CHAR apply_brakes_to_car 1
end

0@ = 0.0
  
while true
wait 0
0@ += 0.05
0A25: set_camera_on_players_X_angle -0.55 Z_angle 0@
end

///////////////////////////////////////////////////////////////////////////////

:CRM_CAM_START

repeat
wait 0

if
056E:   car CARMA_GLOB_DERBY_PLAYER_CAR defined
then
CARMA_FINAL_CAM_X -= 0.1
CARMA_FINAL_CAM_Y += 0.1
0407: store_coords_to 0@ 1@ 2@ from_car CARMA_GLOB_DERBY_PLAYER_CAR with_offset CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y 3.0      
camera.SetPosition(0@,1@,2@,0.0,0.0,0.0)

if
$ZOMBIE_DERBY_FLAG == 1 
then
camera.OnVehicle(CARMA_GLOB_DERBY_PLAYER_CAR,15,2)
else
camera.PointAt(6@,7@,8@,2)
end

//0AD1: show_formatted_text_highpriority "X: %f, Y: %f" time 2000 CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y
end

if and
CARMA_FINAL_CAM_X <= -10.0
CARMA_FINAL_CAM_Y >= 0.0
    then
    break
    end

until false

///////////////////////////////////////////////////////////////////////////////

repeat
wait 0

if
056E:   car CARMA_GLOB_DERBY_PLAYER_CAR defined
then
CARMA_FINAL_CAM_X += 0.1
CARMA_FINAL_CAM_Y += 0.1 
0407: store_coords_to 0@ 1@ 2@ from_car CARMA_GLOB_DERBY_PLAYER_CAR with_offset CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y 3.0       
camera.SetPosition(0@,1@,2@,0.0,0.0,0.0)

if
$ZOMBIE_DERBY_FLAG == 1 
then
camera.OnVehicle(CARMA_GLOB_DERBY_PLAYER_CAR,15,2)
else
camera.PointAt(6@,7@,8@,2)
end

//0AD1: show_formatted_text_highpriority "X: %f, Y: %f" time 2000 CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y
end

if and
CARMA_FINAL_CAM_Y >= 10.0
CARMA_FINAL_CAM_X >= 0.0
    then
    break
    end

until false

///////////////////////////////////////////////////////////////////////////////

repeat
wait 0

if
056E:   car CARMA_GLOB_DERBY_PLAYER_CAR defined
then
CARMA_FINAL_CAM_X += 0.1
CARMA_FINAL_CAM_Y -= 0.1  
0407: store_coords_to 0@ 1@ 2@ from_car CARMA_GLOB_DERBY_PLAYER_CAR with_offset CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y 3.0
camera.SetPosition(0@,1@,2@,0.0,0.0,0.0)

if
$ZOMBIE_DERBY_FLAG == 1 
then
camera.OnVehicle(CARMA_GLOB_DERBY_PLAYER_CAR,15,2)
else
camera.PointAt(6@,7@,8@,2)
end

//0AD1: show_formatted_text_highpriority "X: %f, Y: %f" time 2000 CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y
end

if and
CARMA_FINAL_CAM_Y <= 0.0
CARMA_FINAL_CAM_X >= 10.0
    then
    break
    end

until false

///////////////////////////////////////////////////////////////////////////////

repeat
wait 0

if
056E:   car CARMA_GLOB_DERBY_PLAYER_CAR defined
then
CARMA_FINAL_CAM_X -= 0.1
CARMA_FINAL_CAM_Y -= 0.1  
0407: store_coords_to 0@ 1@ 2@ from_car CARMA_GLOB_DERBY_PLAYER_CAR with_offset CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y 3.0
camera.SetPosition(0@,1@,2@,0.0,0.0,0.0)

if
$ZOMBIE_DERBY_FLAG == 1 
then
camera.OnVehicle(CARMA_GLOB_DERBY_PLAYER_CAR,15,2)
else
camera.PointAt(6@,7@,8@,2)
end

//0AD1: show_formatted_text_highpriority "X: %f, Y: %f" time 2000 CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y
end

if and
CARMA_FINAL_CAM_Y <= -10.0
CARMA_FINAL_CAM_X <= 0.0
    then
    break
    end

until false

///////////////////////////////////////////////////////////////////////////////

repeat
wait 0

if
056E:   car CARMA_GLOB_DERBY_PLAYER_CAR defined
then
CARMA_FINAL_CAM_X -= 0.1
CARMA_FINAL_CAM_Y += 0.1
0407: store_coords_to 0@ 1@ 2@ from_car CARMA_GLOB_DERBY_PLAYER_CAR with_offset CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y 3.0 
camera.SetPosition(0@,1@,2@,0.0,0.0,0.0)

if
$ZOMBIE_DERBY_FLAG == 1 
then
camera.OnVehicle(CARMA_GLOB_DERBY_PLAYER_CAR,15,2)
else
camera.PointAt(6@,7@,8@,2)
end

//0AD1: show_formatted_text_highpriority "X: %f, Y: %f" time 2000 CARMA_FINAL_CAM_X CARMA_FINAL_CAM_Y
end

if and
CARMA_FINAL_CAM_Y >= 0.0
CARMA_FINAL_CAM_X <= -10.0
    then
    break
    end

until false

jump to @CRM_CAM_START

///////////////////////////////////////////////////////////////////////////////

end_thread    

:CRM_STATS
thread 'CRM_STATS'

32@ = 0

repeat
wait 0
until 32@ > 6500

if
ZOMBEGEDDON_TOURNAMENT == 1
    then
    
    0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "OPPONENTS_WRECKED_BY_PLAYER"                                        
                                
    if
    $CHEATED_FLAG == 0 
    then   
    005C: 0@ += CARMA_GLOB_OPPONENTS_WRECKED_BY_PLAYER // (int)
    end                    
                             
    0AF1: write_int 0@ to_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "OPPONENTS_WRECKED_BY_PLAYER"
    
    end
 
008B: 1@ = CARMA_GLOB_OPPONENTS_WRECKED_BY_PLAYER // (int)

if
ZOMBEGEDDON_TOURNAMENT == 1
    then
    0AF0: 30@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    0AF0: 31@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"    
    if
    003B:   30@ == 31@  // (int)
        then
        0AF0: 1@ = get_int_from_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "OPPONENTS_WRECKED_BY_PLAYER"
        end    
    end

5@ = 1
3@ = 200
v$CRM_TXT = "CRM36"
gosub @CRM_STAT_SHOWCASE

wait 500

if
ZOMBEGEDDON_TOURNAMENT == 1
    then
    
    0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_CREDITS"                                        
                                
    if
    $CHEATED_FLAG == 0 
    then   
    005C: 0@ += CARMA_GLOB_DERBY_CREDITS // (int)
    end                    
                             
    0AF1: write_int 0@ to_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_CREDITS"
    
    end       

008B: 1@ = CARMA_GLOB_DERBY_CREDITS // (int)

if
ZOMBEGEDDON_TOURNAMENT == 1
    then
    0AF0: 30@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    0AF0: 31@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"    
    if
    003B:   30@ == 31@  // (int)
        then
        0AF0: 1@ = get_int_from_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_CREDITS"
        end    
    end

5@ = 50
3@ = 0
v$CRM_TXT = "CRM40"
gosub @CRM_STAT_SHOWCASE

wait 500

008B: 0@ = CARMA_GLOB_TIME_VAR2 // (int)
3@ = 0
v$CRM_TXT = "CRM41"
gosub @CRM_STAT_SHOWCASE_TIME_BONUS

wait 500

if
ZOMBEGEDDON_TOURNAMENT == 1
    then
    
    0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_KILLED_PLAYER"                                        
                                
    if
    $CHEATED_FLAG == 0 
    then   
    005C: 0@ += CARMA_GLOB_DERBY_KILLED_PLAYER // (int)
    end                    
                             
    0AF1: write_int 0@ to_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_KILLED_PLAYER"
    
    end        

008B: 1@ = CARMA_GLOB_DERBY_KILLED_PLAYER // (int)

if
ZOMBEGEDDON_TOURNAMENT == 1
    then
    0AF0: 30@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    0AF0: 31@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"    
    if
    003B:   30@ == 31@  // (int)
        then
        0AF0: 1@ = get_int_from_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_KILLED_PLAYER"
        end    
    end

5@ = 1
3@ = 5
v$CRM_TXT = "CRM42"
gosub @CRM_STAT_SHOWCASE

wait 500

CAMP_RAID_FLAG = 1

end_thread

:CRM_STAT_SHOWCASE

if
1@ < 1
then
return
end

0@ = 0
4@ = 0
32@ = 0
33@ = 0

repeat
wait 0

if and
33@ > 2
not 4@ == 250
then
4@ += 10
33@ = 0
end

if or
001D:   32@ > 3@  // (int)
3@ == 0
then
32@ = 0
005A: 0@ += 5@  // (int)

if
3@ == 0
then
005A: 0@ += 5@  // (int)
005A: 0@ += 5@  // (int)
005A: 0@ += 5@  // (int)
005A: 0@ += 5@  // (int)
end

if
001D:   0@ > 1@  // (int)
then
0085: 0@ = 1@ // (int)
end

Audiostream.Loop(CARMA_VOICE_BUTT,0)
Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
end 

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 4@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 4@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 640.0 for_centered_text 
045A: draw_text_1number 320.0 200.0 GXT v$CRM_TXT number 0@  // ALL RACES WON!~n~~w~$~1~

if
00E1: key_pressed 0 17
    then
    break    
    end

until 002D:   0@ >= 1@  // (int)

Audiostream.Loop(CARMA_VOICE_DONE,0)
Audiostream.PerformAction(CARMA_VOICE_DONE, PLAY)
Audiostream.Volume(CARMA_VOICE_DONE) = $SOUNDS_VOLUME

0085: 0@ = 1@ // (int)
4@ = 250

32@ = 0
while 32@ < 1200
wait 0

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 4@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 4@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 640.0 for_centered_text 
045A: draw_text_1number 320.0 200.0 GXT v$CRM_TXT number 0@  // ALL RACES WON!~n~~w~$~1~
end

return

:CRM_STAT_SHOWCASE_TIME_BONUS

1@ = 0
4@ = 0
32@ = 0
33@ = 0

repeat
wait 0

if and
33@ > 2
not 4@ == 250
then
4@ += 10
33@ = 0
end

if or
001D:   32@ > 3@  // (int)
32@ == 0
then
32@ = 0
0@ -= 10000
1@ += 1000
Audiostream.Loop(CARMA_VOICE_BUTT,0)
Audiostream.PerformAction(CARMA_VOICE_BUTT, PLAY)
Audiostream.Volume(CARMA_VOICE_BUTT) = $SOUNDS_VOLUME
end 

03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 4@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 4@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 640.0 for_centered_text 
045A: draw_text_1number 320.0 200.0 GXT v$CRM_TXT number 1@  // ALL RACES WON!~n~~w~$~1~

if
00E1: key_pressed 0 17
    then
    
    repeat
    0@ -= 100
    1@ += 25
    until 0@ <= 0
    
    break    
    end

until 0@ <= 0

4@ = 250

Audiostream.Loop(CARMA_VOICE_DONE,0)
Audiostream.PerformAction(CARMA_VOICE_DONE, PLAY)
Audiostream.Volume(CARMA_VOICE_DONE) = $SOUNDS_VOLUME

if
ZOMBEGEDDON_TOURNAMENT == 1
    then
    0AF0: 30@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    0AF0: 31@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"    
    if
    003B:   30@ == 31@  // (int)
        then                    
        0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_TIME_BONUS"                                        
                                        
        if
        $CHEATED_FLAG == 0 
        then   
        005A: 0@ += 1@  // (int)
        end                    
                                     
        0AF1: write_int 0@ to_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_TIME_BONUS"
            
        005A: 1@ += 0@  // (int)                                    
        end    
    end

32@ = 0
while 32@ < 1200
wait 0
03F0: enable_text_draw 1 
033F: set_text_draw_letter_size 1.0 2.0
0340: set_text_draw_RGBA 255 255 255 4@
03E0: draw_text_behind_textures 1
03E3: set_texture_to_be_drawn_antialiased 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 4@
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 640.0 for_centered_text 
045A: draw_text_1number 320.0 200.0 GXT v$CRM_TXT number 1@  // ALL RACES WON!~n~~w~$~1~
end

if
ZOMBEGEDDON_TOURNAMENT == 1
    then
    0AF0: 30@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "CURRENT_MAP"
    0AF0: 31@ = get_int_from_ini_file "data\derby_Tournament.ini" section "LIST" key "MAPS_TOTAL"    
    if
    803B: not  30@ == 31@  // (int)
        then
        if
        ZOMBEGEDDON_TOURNAMENT == 1
            then
            
            0AF0: 0@ = get_int_from_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_TIME_BONUS"                                        
                                        
            if
            $CHEATED_FLAG == 0 
            then   
            005A: 0@ += 1@  // (int)
            end                    
                                     
            0AF1: write_int 0@ to_ini_file "data\derby_Tournament.ini" section "GLOB_STATS" key "DERBY_TIME_BONUS"
            
            end            
        end    
    end

return

:DRB_BDR
thread 'DRB_BDR'

0EFE: get_loaded_library "skygfx.asi" store_to 1@
1@ += 0x004361C //Neo Water Drops
0085: 2@ = 1@ // (int)
2@ += 0x4

while true
wait 0  

if
$FP_ACTIVATED == 1
then
0A8C: write_memory 1@ size 1 value 1 virtual_protect 0
0A8C: write_memory 2@ size 1 value 1 virtual_protect 0
else
0A8C: write_memory 1@ size 1 value 0 virtual_protect 0
0A8C: write_memory 2@ size 1 value 0 virtual_protect 0
end
  
end     

end_thread