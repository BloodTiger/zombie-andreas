const
REQUIED_PERKS_POINTS = 28@
PERK_THEME_AUDIOSTREAM_FLAG = 26@
REQUIED_PERK_PLAYER_LEVEL = 25@
HEALTH_PERK_2P_HEAL_FLAG = 24@
PERKS_INSTALLED_FOR_SURV = 23@
end

:PERK_SH
thread 'PERK_SH'

create_thread @ORG_ABL

$PERK_TOTAL_GOT = 0
    
$PERK_NUMBER = 1

if
USHER_STORY_FLAG == 1
then  
$PERK_TOTAL_GOT += 3
gosub @PERK_GUDDRIVER1_INSTALL
gosub @PERK_GUDDRIVER2_INSTALL
gosub @PERK_CARPILLOW_INSTALL
jump to @PERK_SHOW_START
end

if and
SURVIVAL_CUSTOM_WEAPON_NABOR == 0
$FREEMODE == 1
not USHER_STORY_FLAG == 1
then
jump to @RANDOM_PERKS_SURV_FREEMODE_INSTALL
end

//////////////////////////////////////////////////////////////////

if and
$FREEMODE == 0
not $EXPE_FLAG == 1
not $GAMEMODE_EDITOR == 1
then

:RANDOM_PERKS_SURV_FREEMODE_INSTALL

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then

random_int PERK_WEAPON_SKILL 1 4

if or
$FREEMODE == 1
PERK_WEAPON_SKILL == 1
then
gosub @PERK_WEAPON_SKILL1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_WEAPON_SKILL == 2
then
gosub @PERK_WEAPON_SKILL2_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_WEAPON_SKILL == 3
then
gosub @PERK_WEAPON_SKILL3_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

end

/////////////////////////////////////

random_int 1@ 0 3
if or
1@ == 2
REALISM_MODE == 1
$ALLOW_PLAYER_SLOWMOTION == 0
then
random_int PERK_SLOWMODE 1 4

if or
PERK_SLOWMODE == 1
REALISM_MODE == 1
$ALLOW_PLAYER_SLOWMOTION == 0
$FREEMODE == 1
then
gosub @PERK_SLOWMODE1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if or
PERK_SLOWMODE == 2
REALISM_MODE == 1
$ALLOW_PLAYER_SLOWMOTION == 0
then
gosub @PERK_SLOWMODE2_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if or
PERK_SLOWMODE == 3
REALISM_MODE == 1
$ALLOW_PLAYER_SLOWMOTION == 0
then
gosub @PERK_SLOWMODE3_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

end

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then
random_int PERK_WEIGHT 1 4

if or
PERK_WEIGHT == 1
$FREEMODE == 1
then
gosub @PERK_WEIGHT1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_WEIGHT == 2
then
gosub @PERK_WEIGHT2_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_WEIGHT == 3
then
gosub @PERK_WEIGHT3_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

end

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then
random_int PERK_AMMO 1 4

if or
PERK_AMMO == 1
$FREEMODE == 1
then
gosub @PERK_AMMO1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_AMMO == 2
then
gosub @PERK_AMMO2_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_AMMO == 3
then
gosub @PERK_AMMO3_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

end

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then
random_int PERK_ATHLET 1 4

if or
PERK_AMMO == 1
$FREEMODE == 1
then
gosub @PERK_ATHLET1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_AMMO == 2
then
gosub @PERK_ATHLET2_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_AMMO == 3
then
gosub @PERK_ATHLET3_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

end

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then

if
$FREEMODE == 0
then
random_int PERK_HUNGER 1 4
else
random_int PERK_HUNGER 1 3
end

if or
PERK_HUNGER == 1
$FREEMODE == 1
then
gosub @PERK_HUNGER1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_HUNGER == 2
then
gosub @PERK_HUNGER2_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_HUNGER == 3
then
gosub @PERK_HUNGER3_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

end

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then
random_int PERK_HEALTH 1 4

if or
PERK_HEALTH == 1
$FREEMODE == 1
then
gosub @PERK_HEALTH1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
$FALL_HITS += 1
end

if
PERK_HEALTH == 2
then
gosub @PERK_HEALTH2_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
$FALL_HITS += 2
end

if
PERK_HEALTH == 3
then
gosub @PERK_HEALTH3_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
$FALL_HITS += 3
end

end

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_HACKER_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

/////////////////////////////////////

random_int 1@ 0 3
if and
1@ == 2
$FREEMODE == 0
then
random_int PERK_RUNSPEED 1 3

if or
PERK_RUNSPEED == 1
$FREEMODE == 1
then
gosub @PERK_RUNSPEED1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_RUNSPEED == 2
then
gosub @PERK_RUNSPEED2_INSTALL 
end

end

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then 
random_int PERK_MELEE 1 3

if or
PERK_MELEE == 1
$FREEMODE == 1
then
gosub @PERK_MELEE_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_MELEE == 2
then
gosub @PERK_MELEE2_INSTALL
end

end

/////////////////////////////////////

random_int 1@ 0 3
if
1@ == 2
then

random_int PERK_GOODRIVER 1 3

if or
PERK_GOODRIVER == 1
$FREEMODE == 1
then
gosub @PERK_GUDDRIVER1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_GOODRIVER == 2
then
gosub @PERK_GUDDRIVER2_INSTALL
end

end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_DEVIATOR_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

random_int 1@ 0 3
if
1@ == 2
then

random_int PERK_FINDGOODS 1 3

if or
PERK_FINDGOODS == 1
$FREEMODE == 1
then
gosub @PERK_FINDGOODS1_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
PERK_FINDGOODS == 2
then
gosub @PERK_FINDGOODS2_INSTALL
end

end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_GASOLINEFIND_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_CARPILLOW_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_GOODBLOOD_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

random_int 1@ 0 3
if and
1@ == 2
$FREEMODE == 0
then
gosub @PERK_REGENHP_INSTALL
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_TOUGHMAN_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_CHARISMA_INSTALL
PERKS_INSTALLED_FOR_SURV += 1
end

if
$FREEMODE == 0
then

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_EAGLE_INSTALL
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_FIREFIGHTER_INSTALL
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_ANTIFALL_INSTALL
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_PANZER_INSTALL
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_TITAN_INSTALL
end

random_int 1@ 0 3
if
1@ == 2
then
gosub @PERK_LASTCHANCE_INSTALL
end

end

end

//////////////////////////////////////////////////////////////////

32@ = 0

if
SURVIVAL_CUSTOM_WEAPON_NABOR == 6
then
gosub @PERK_WEAPON_SKILL1_INSTALL
gosub @PERK_WEAPON_SKILL2_INSTALL
gosub @PERK_WEAPON_SKILL3_INSTALL
$PERK_TOTAL_GOT += 3
end

if
SURVIVAL_CUSTOM_WEAPON_NABOR == 2
then
gosub @PERK_WEAPON_SKILL1_INSTALL
gosub @PERK_WEAPON_SKILL2_INSTALL
$PERK_TOTAL_GOT += 2
end

if
SURVIVAL_CUSTOM_WEAPON_NABOR == 8
then
gosub @PERK_HEALTH1_INSTALL
$FALL_HITS += 1
gosub @PERK_HEALTH2_INSTALL
$FALL_HITS += 2
gosub @PERK_HEALTH3_INSTALL
$FALL_HITS += 3
$PERK_TOTAL_GOT += 3
end

if
SURVIVAL_CUSTOM_WEAPON_NABOR == 9
then
gosub @PERK_HUNGER1_INSTALL
gosub @PERK_HUNGER2_INSTALL
gosub @PERK_HUNGER3_INSTALL
$PERK_TOTAL_GOT += 3
end

if
SURVIVAL_CUSTOM_WEAPON_NABOR == 10
then
gosub @PERK_CHARISMA_INSTALL
gosub @PERK_CHARISMA2_INSTALL
$PERK_TOTAL_GOT += 2
end

//////////////////////////////////////////////////////////////////

if or
REALISM_MODE == 1
$ALLOW_PLAYER_SLOWMOTION == 0
then
gosub @PERK_SLOWMODE1_INSTALL
gosub @PERK_SLOWMODE2_INSTALL
gosub @PERK_SLOWMODE3_INSTALL
$PERK_TOTAL_GOT += 3
end

//////////////////////////////////////////////////////////////////

if and
SURVIVAL_CUSTOM_WEAPON_NABOR == 0
$FREEMODE == 1
then
if
PERKS_INSTALLED_FOR_SURV < 3
    then
    jump to @RANDOM_PERKS_SURV_FREEMODE_INSTALL
    else
    005E: $PERK_TOTAL_GOT += PERKS_INSTALLED_FOR_SURV  // (int)
    end
end

//////////////////////////////////////////////////////////////////

:PERK_SHOW_START

repeat
wait 0

if
PLAYER_RESIST_MULT > 0.85
then
PLAYER_RESIST_MULT = 0.85
end

if
PERK_REGENHP == 1
then

if and
32@ > 8000
$SATIETY_LEVEL >= 31.0
$FATIGUE_LEVEL < 80.0
not $TEMP_BREATH <= 0
UNITED_MAP == 0
$PLAYER_BLEEDING == 0
$PLAYER_DYING == 0
AFTERSAVE_TIME_COUNT < PLAYER_UPTIME_BEFORE_VERYSLEEP
    then
    32@ = 0
    0@ = actor.Health(PLAYER_ACTOR)
    0D39: 1@ = actor PLAYER_ACTOR max_health
    0092: 1@ = float 1@ to_integer
    if and
    802D: not  0@ >= 1@  // (int)
    not actor.Animation(PLAYER_ACTOR) == "BOM_PLANT"
        then
        0093: 1@ = integer 1@ to_float
        1@ /= 100.0
        0092: 1@ = float 1@ to_integer
        0@ = actor.Health(PLAYER_ACTOR)
        005A: 0@ += 1@  // (int)
        actor.Health(PLAYER_ACTOR) = 0@ 
        end
    end
    
if and
32@ > 8000
$SATIETY_LEVEL >= 31.0
$FATIGUE_LEVEL < 80.0
UNITED_MAP == 1
$PLAYER_BLEEDING == 0
$PLAYER_DYING == 0
AFTERSAVE_TIME_COUNT < PLAYER_UPTIME_BEFORE_VERYSLEEP
    then
    32@ = 0
    0@ = actor.Health(PLAYER_ACTOR)
    0D39: 1@ = actor PLAYER_ACTOR max_health
    0092: 1@ = float 1@ to_integer
    if and
    802D: not  0@ >= 1@  // (int)
    not actor.Animation(PLAYER_ACTOR) == "BOM_PLANT"
        then
        0093: 1@ = integer 1@ to_float
        1@ /= 100.0
        0092: 1@ = float 1@ to_integer
        0@ = actor.Health(PLAYER_ACTOR)
        005A: 0@ += 1@  // (int)
        actor.Health(PLAYER_ACTOR) = 0@ 
        end
    end
    
if and
056D:   actor COOP_ACTOR defined
not COOP_ACTOR == -69
    then
        
    if and
    33@ > 2000
    $SURVIVOR_SATIETY[COOP_ACTOR_SURV_NUM] >= 31.0
    not $TEMP_BREATH <= 0
    UNITED_MAP == 0
    $SURVIVOR_BLEEDING_FLAG[COOP_ACTOR_SURV_NUM] == 0
    AFTERSAVE_TIME_COUNT < PLAYER_UPTIME_BEFORE_VERYSLEEP
        then
        33@ = 0
        0@ = actor.Health(COOP_ACTOR)
        0D39: 1@ = actor COOP_ACTOR max_health
        0092: 1@ = float 1@ to_integer
        if and
        802D: not  0@ >= 1@  // (int)
        not actor.Animation(COOP_ACTOR) == "BOM_PLANT"
            then
            0093: 1@ = integer 1@ to_float
            1@ /= 100.0
            0092: 1@ = float 1@ to_integer
            0@ = actor.Health(COOP_ACTOR)
            005A: 0@ += 1@  // (int)
            actor.Health(COOP_ACTOR) = 0@
            end
        end
        
    if and
    33@ > 2000
    $SURVIVOR_SATIETY[COOP_ACTOR_SURV_NUM] >= 31.0
    UNITED_MAP == 1
    $SURVIVOR_BLEEDING_FLAG[COOP_ACTOR_SURV_NUM] == 0
    AFTERSAVE_TIME_COUNT < PLAYER_UPTIME_BEFORE_VERYSLEEP
        then
        33@ = 0
        0@ = actor.Health(COOP_ACTOR)
        0D39: 1@ = actor COOP_ACTOR max_health
        0092: 1@ = float 1@ to_integer
        if and
        802D: not  0@ >= 1@  // (int)
        not actor.Animation(COOP_ACTOR) == "BOM_PLANT"
            then
            0093: 1@ = integer 1@ to_float
            1@ /= 100.0
            0092: 1@ = float 1@ to_integer
            0@ = actor.Health(COOP_ACTOR)
            005A: 0@ += 1@  // (int)
            actor.Health(COOP_ACTOR) = 0@
            end
        end
                
    end        
    
end        

if and
PERK_THEME_AUDIOSTREAM_FLAG == 0
$SAVESTATUS_TRUE == 0
    then
    PERK_THEME_AUDIOSTREAM = Audiostream.Load("AUDIO\SOUNDS\PerkMenuTheme.mp3")
    Audiostream.PerformAction(PERK_THEME_AUDIOSTREAM, PLAY)
    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME   
    Audiostream.Loop(PERK_THEME_AUDIOSTREAM,1)
    PERK_THEME_AUDIOSTREAM_FLAG = 1
    end
    
if and
PERK_THEME_AUDIOSTREAM_FLAG == 1
not $READING_STAT_FLAG == 1
$SAVESTATUS_TRUE == 0
    then
    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME
    end    
    
if and
PERK_THEME_AUDIOSTREAM_FLAG == 1
$SAVESTATUS_TRUE == 1
    then
    audiostream.Release(PERK_THEME_AUDIOSTREAM)
    PERK_THEME_AUDIOSTREAM_FLAG = 0
    end    

if
$SAVING_DELAY == 1
then

while $SAVING_DELAY == 1  
wait 100    
gosub @PERKS_NUMBER_GET
end

end

if or
$FREEMODE == 1
$EXPE_FLAG == 1
    then
    if
    player.Controllable(PLAYER_CHAR)
        then
        if or
        0E3D:   key_pressed 80
        OPEN_PERKS_MENU_FLAG == 1
            then
            OPEN_PERKS_MENU_FLAG = 0
            
            0A8D: 1@ = read_memory 0xB7CB64 size 4 virtual_protect 0
            if
            $SPEED_099_FLAG == 1
            then
            1@ = 1.0
            end
            
            if and         
            $HUD_REMOVE == 0
            $GAMEMODE_HOLD == 0
            $CHEAT_TYPE_FLAG == 0
            1@ == 1.0
            not USHER_STORY_FEATRUES_LOCKED == 1
                then        
                if and
                not Actor.Dead(PLAYER_ACTOR)
                not Actor.Driving(PLAYER_ACTOR)         
                044B:   actor PLAYER_ACTOR on_foot 
                09E7:   player PLAYER_CHAR not_frozen
                02A0:   actor PLAYER_ACTOR stopped
                8597:   actor PLAYER_ACTOR crouching
                    then            
                    break
                    end
                end
            end
        end
    end
    
if and
$FREEMODE == 1
not $CARL_STORY == 1
not $MIKE_STORY == 1
not MCS_FLAG == 1
not PLAYER_NO_ITEMS_FLAG == 1
    then
    if
    player.Controllable(PLAYER_CHAR)
        then
        if or
        0E3D:   key_pressed 219
        OPEN_NOTES_MENU_FLAG == 1
            then
            OPEN_NOTES_MENU_FLAG = 0
            
            0A8D: 0@ = read_memory 0xB7CB64 size 4 virtual_protect 0
            if
            $SPEED_099_FLAG == 1
            then
            0@ = 1.0
            end
            
            0AF0: 1@ = get_int_from_ini_file "data/notes.ini" section "NOTES" key "FORCED_ON"
            if and
            UNITED_MAP == 1
            not 1@ == 1 
            then
            0@ = 0.0
            end
            
            if and         
            $HUD_REMOVE == 0
            $GAMEMODE_HOLD == 0
            $CHEAT_TYPE_FLAG == 0
            0@ == 1.0
                then        
                if and
                not Actor.Dead(PLAYER_ACTOR)
                not Actor.Driving(PLAYER_ACTOR) 
                044B:   actor PLAYER_ACTOR on_foot 
                09E7:   player PLAYER_CHAR not_frozen
                02A0:   actor PLAYER_ACTOR stopped
                8597:   actor PLAYER_ACTOR crouching
                    then
                    
                    $SPEED_08_FLAG = 1
                    $MUTE_MUSIC_FLAG = 1
                    BLACK_MENU_OPENED_FLAG = 1
                    
        //            player.CanMove(PLAYER_CHAR) = false
                    0E68: set_player_control_pad 0 1 
                    0E69: set_player_control_pad_movement 0 0
                    
                    0EAC: get_char_proofs PLAYER_ACTOR bullet $CIM_BUL fire $CIM_FIR explosion $CIM_EXP collision $CIM_COL melee $CIM_MEL
                    actor.SetImmunities(PLAYER_ACTOR,1,1,1,1,1)
                    
                    $HUD_REMOVE = 1
                    fade 0 50
                    wait 50  
                    
                    cinema.Widescreen(1)
                    0A48: enable_menu_access_in_widescreen_mode 0
                    if and
                    not MAIN_QUEST_MUSIC_FLAG == 1
                    not USER_TAPE_TURNED_ON_FLAG == 1
                    not $CASETTE_PLAYING_FLAG == 1
                    then
                    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = $MUSIC_VOLUME
                    end
                    
                    32@ = 0            
                    
                    $ACHIV_TOTAL_SHOW_LIST_FLAG = 1
                    create_thread @NT_SHOW
                    
                    repeat
                    wait 0
                    
                    if and
                    ENGLISH_TRANSLATE == 1
                    REALLY_READING_NOW_NOTE_FLAG == 1
                    then 
                    fade 1 0  
                    else
                    fade 0 0
                    end
                    
                    if and
                    $READING_NOTE_FLAG == 0
                    00E1: player 0 pressed_key 15
                        then
                        break
                        end 
                    
                    until false
                       
                    $ACHIV_TOTAL_SHOW_OFF_FLAG = 1
                    wait 1
                    
                    cinema.Widescreen(0)
                    0A48: enable_menu_access_in_widescreen_mode 1            
                    
        //            player.CanMove(PLAYER_CHAR) = true
                    0E68: set_player_control_pad 1 1 
                    0E69: set_player_control_pad_movement 0 1
                    
                    actor.SetImmunities(PLAYER_ACTOR,$CIM_BUL,$CIM_FIR,$CIM_EXP,$CIM_COL,$CIM_MEL)
                    
                    $MUTE_MUSIC_FLAG = 0    
                    $SPEED_08_FLAG = 0
                    BLACK_MENU_OPENED_FLAG = 0
                    015D: set_gamespeed 1.0
                    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME
                    
                    fade 1 500
                    $HUD_REMOVE = 0    
                    wait 500  
                    
                    end
                end
            end
        end
    end  
    
if and
$FREEMODE == 1
not $CARL_STORY == 1
not $MIKE_STORY == 1
$CASETTE_PLAYING_FLAG == 0
USER_TAPE_TURNED_ON_FLAG == 0
RADIO_TEXTURE_RENDER_NUMBER == 0
not $MUSIC_TURN_OFF_FLAG == 1
not PLAYER_NO_ITEMS_FLAG == 1
    then
    if or
    0E3D:   key_pressed 221
    OPEN_NOTES_MENU_FLAG == 2
        then  
        
        0A8D: 0@ = read_memory 0xB7CB64 size 4 virtual_protect 0
        if
        $SPEED_099_FLAG == 1
        then
        0@ = 1.0
        end
        OPEN_NOTES_MENU_FLAG = 0
         
        if and         
        $HUD_REMOVE == 0
        $GAMEMODE_HOLD == 0
        $CHEAT_TYPE_FLAG == 0
        $SAVESTATUS_TRUE == 0  
        MAIN_QUEST_MUSIC_FLAG == 0
        0@ == 1.0
            then        
            if and
            not Actor.Dead(PLAYER_ACTOR)
            not Actor.Driving(PLAYER_ACTOR)
            player.Controllable(PLAYER_CHAR) 
            044B:   actor PLAYER_ACTOR on_foot 
            09E7:   player PLAYER_CHAR not_frozen            
            8597:   actor PLAYER_ACTOR crouching
                then
                if or
                02A0:   actor PLAYER_ACTOR stopped
                $CASETTE_PLAYING_FLAG == 2
                    then 
                                                            
                    $SPEED_08_FLAG = 1
                    $MUTE_MUSIC_FLAG = 1
                    BLACK_MENU_OPENED_FLAG = 1
                    
        //            player.CanMove(PLAYER_CHAR) = false
                    0E68: set_player_control_pad 0 1 
                    0E69: set_player_control_pad_movement 0 0
                    
                    $HUD_REMOVE = 1
                    fade 0 50
                    wait 50  
                    
                    cinema.Widescreen(1)
                    0A48: enable_menu_access_in_widescreen_mode 0
                    if and
                    not MAIN_QUEST_MUSIC_FLAG == 1
                    not USER_TAPE_TURNED_ON_FLAG == 1
                    not $CASETTE_PLAYING_FLAG == 1
                    then
                    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = $MUSIC_VOLUME
                    end
                    32@ = 0            
                    
                    $ACHIV_TOTAL_SHOW_LIST_FLAG = 1
                    create_thread @CAS_SHW
                    
                    repeat
                    wait 0
                    
                    if
                    OPEN_NOTES_MENU_FLAG == -111
                    then             
                    OPEN_NOTES_MENU_FLAG = 0 
                    jump to @SKIP_CASSETTE_SHIT
                    end
                    
                    until 00E1: player 0 pressed_key 15
                    
                    Audiostream.PerformAction($MENU_BACK_SOUND, PLAY)
                    Audiostream.Loop($MENU_BACK_SOUND, 0)
                    Audiostream.Volume($MENU_BACK_SOUND) = $SOUNDS_VOLUME   
                    $ACHIV_TOTAL_SHOW_OFF_FLAG = 1
                    wait 1  
                    
                    cinema.Widescreen(0)
                    0A48: enable_menu_access_in_widescreen_mode 1            
                    
        //            player.CanMove(PLAYER_CHAR) = true
                    0E68: set_player_control_pad 1 1 
                    0E69: set_player_control_pad_movement 0 1
                    
                    $MUTE_MUSIC_FLAG = 0    
                    $SPEED_08_FLAG = 0
                    BLACK_MENU_OPENED_FLAG = 0
                    015D: set_gamespeed 1.0
                    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME
                    
                    fade 1 500
                    $HUD_REMOVE = 0    
                    wait 500  
                    
                    :SKIP_CASSETTE_SHIT
                    
                    end
                end
            end
        end
    else
    if and
    $CASETTE_PLAYING_FLAG == 1
    PLAYER_IN_CANALS_FLAG == 0
    not $ACTIVE_INTERIOR == 6
    not $DELETE_SOUND == 1
    not INT_ZMB_MALLV_VC_FLAG == 1
    not ZAME_SURV_LAUNCH_FLAG == 1
        then
        
        if or
        $SAVESTATUS_TRUE == 1  
        MAIN_QUEST_MUSIC_FLAG == 1
        $MUSIC_TURN_OFF_FLAG == 1
        actor.Dead(PLAYER_ACTOR)
            then
            jump to @TAPE_DISABLE
            end                 
        
        0A8D: 0@ = read_memory 0xB7CB64 size 4 virtual_protect 0
        if
        $SPEED_099_FLAG == 1
        then
        0@ = 1.0
        end
             
        if and
        $HUD_REMOVE == 0
        $GAMEMODE_HOLD == 0
        $CHEAT_TYPE_FLAG == 0
        0@ == 1.0
            then        
            if and
            not Actor.Dead(PLAYER_ACTOR)
//            not Actor.Driving(PLAYER_ACTOR)
//            player.Controllable(PLAYER_CHAR) 
//            044B:   actor PLAYER_ACTOR on_foot 
            09E7:   player PLAYER_CHAR not_frozen            
                then
        
                if or
                0E3D:   key_pressed 221
                OPEN_NOTES_MENU_FLAG == 2
                    then            
                                                                        
                    $SPEED_08_FLAG = 1
                    $MUTE_MUSIC_FLAG = 1
                    BLACK_MENU_OPENED_FLAG = 1
                    OPEN_NOTES_MENU_FLAG = 0
                                
//                    player.CanMove(PLAYER_CHAR) = false
                    0E68: set_player_control_pad 0 1 
                    0E69: set_player_control_pad_movement 0 0
                                
                    $HUD_REMOVE = 1
                    fade 0 50
                    wait 50  
                                
                    cinema.Widescreen(1)
                    0A48: enable_menu_access_in_widescreen_mode 0
                    if and
                    not MAIN_QUEST_MUSIC_FLAG == 1
                    not USER_TAPE_TURNED_ON_FLAG == 1
                    not $CASETTE_PLAYING_FLAG == 1
                    then
                    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = $MUSIC_VOLUME
                    end
                    32@ = 0            
                                
                    $ACHIV_TOTAL_SHOW_LIST_FLAG = 1
                    create_thread @CAS_SHW
                                
                    repeat
                    wait 0
                                
                    if
                    OPEN_NOTES_MENU_FLAG == -111
                    then             
                    OPEN_NOTES_MENU_FLAG = 0 
                    jump to @2SKIP_CASSETTE_SHIT
                    end
                                
                    until 00E1: player 0 pressed_key 15
                                
                    Audiostream.PerformAction($MENU_BACK_SOUND, PLAY)
                    Audiostream.Loop($MENU_BACK_SOUND, 0)
                    Audiostream.Volume($MENU_BACK_SOUND) = $SOUNDS_VOLUME   
                    $ACHIV_TOTAL_SHOW_OFF_FLAG = 1
                    wait 1  
                                
                    cinema.Widescreen(0)
                    0A48: enable_menu_access_in_widescreen_mode 1            
                                
//                    player.CanMove(PLAYER_CHAR) = true
                    0E68: set_player_control_pad 1 1 
                    0E69: set_player_control_pad_movement 0 1
                                
                    $MUTE_MUSIC_FLAG = 0    
                    $SPEED_08_FLAG = 0
                    BLACK_MENU_OPENED_FLAG = 0
                    015D: set_gamespeed 1.0
                    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME
                                
                    fade 1 500
                    $HUD_REMOVE = 0    
                    wait 500  
                                
                    :2SKIP_CASSETTE_SHIT
                                
                    end                
                if or
                0E3D: is_key_just_pressed 190
                0E3D: is_key_just_pressed 188
                    then
                    $CASETTE_PLAYING_FLAG = 2
                    create_thread @CAS_SHW
                    wait 3000
                    end
                if and
                0E3D: is_key_just_pressed 191 
                not CASSETTE_TURNED_ON_LOCALLY == 1
                    then
                    :TAPE_DISABLE
                    audiostream.PerformAction($CASETTE_AUDIO,STOP)
                    audiostream.Release($CASETTE_AUDIO)
                    gosub @TAPES_AUD_OFF
                    $CASETTE_PLAYING_FLAG = 0
                    end                    
                end
            end            
        end
    end
    
if
$FREEMODE == 1
    then
    if or
    0E3D:   key_pressed 222
    OPEN_NOTES_MENU_FLAG == 3
        then
        
        0A8D: 0@ = read_memory 0xB7CB64 size 4 virtual_protect 0
        if
        $SPEED_099_FLAG == 1
        then
        0@ = 1.0
        end
        OPEN_NOTES_MENU_FLAG = 0
          
        if and         
        $HUD_REMOVE == 0
        $GAMEMODE_HOLD == 0
        $CHEAT_TYPE_FLAG == 0
        0@ == 1.0
            then        
            if and
            not Actor.Dead(PLAYER_ACTOR)
            not Actor.Driving(PLAYER_ACTOR)
            player.Controllable(PLAYER_CHAR) 
            044B:   actor PLAYER_ACTOR on_foot 
            09E7:   player PLAYER_CHAR not_frozen
            02A0:   actor PLAYER_ACTOR stopped
            8597:   actor PLAYER_ACTOR crouching
                then
                
                $SPEED_08_FLAG = 1
                $MUTE_MUSIC_FLAG = 1
                BLACK_MENU_OPENED_FLAG = 1
                
    //            player.CanMove(PLAYER_CHAR) = false
                0E68: set_player_control_pad 0 1 
                0E69: set_player_control_pad_movement 0 0
                
                $HUD_REMOVE = 1
                fade 0 50
                wait 50  
                
                cinema.Widescreen(1)
                0A48: enable_menu_access_in_widescreen_mode 0
                if and
                not MAIN_QUEST_MUSIC_FLAG == 1
                not USER_TAPE_TURNED_ON_FLAG == 1
                not $CASETTE_PLAYING_FLAG == 1
                then
                Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = $MUSIC_VOLUME
                end
                32@ = 0            
                
                $ACHIV_TOTAL_SHOW_LIST_FLAG = 1
                create_thread @ACHIV_S
                
                repeat
                wait 0
                until 00E1: player 0 pressed_key 15
                
                Audiostream.PerformAction($MENU_BACK_SOUND, PLAY)
                Audiostream.Loop($MENU_BACK_SOUND, 0)
                Audiostream.Volume($MENU_BACK_SOUND) = $SOUNDS_VOLUME   
                $ACHIV_TOTAL_SHOW_OFF_FLAG = 1
                wait 1  
                
                cinema.Widescreen(0)
                0A48: enable_menu_access_in_widescreen_mode 1            
                
    //            player.CanMove(PLAYER_CHAR) = true
                0E68: set_player_control_pad 1 1 
                0E69: set_player_control_pad_movement 0 1
                
                $MUTE_MUSIC_FLAG = 0    
                $SPEED_08_FLAG = 0
                BLACK_MENU_OPENED_FLAG = 0
                015D: set_gamespeed 1.0
                Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME
                
                fade 1 500
                $HUD_REMOVE = 0    
                wait 500  
                
                end
            end
        end
    end    
    
if and
$FREEMODE == 1
not $CARL_STORY == 1
not $MIKE_STORY == 1
not MCS_FLAG == 1
//UNITED_MAP == 0
//not CUSTOM_MODE_TURN_OFF_STORY_THINGS == 1
    then
    if
    player.Controllable(PLAYER_CHAR)
        then
        if or
        0E3D:   key_pressed 79
        OPEN_NOTES_MENU_FLAG == 5
        OPEN_NOTES_MENU_FLAG == 6
            then
            
            0A8D: 0@ = read_memory 0xB7CB64 size 4 virtual_protect 0
            if
            $SPEED_099_FLAG == 1
            then
            0@ = 1.0
            end
            
            if
            OPEN_NOTES_MENU_FLAG == 6
            then
            OPEN_NOTES_MENU_FLAG = 0
            jump to @POSFKDOPSKF
            end
            
            OPEN_NOTES_MENU_FLAG = 0
                
            if and         
            $HUD_REMOVE == 0
            $GAMEMODE_HOLD == 0
            $CHEAT_TYPE_FLAG == 0
//            not CARMA_VERY_BAD_FLAG == 1
            not CARMA_OUTCAST_FLAG == 1
            0@ == 1.0           
                then        
                if and
                not Actor.Dead(PLAYER_ACTOR)
                not Actor.Driving(PLAYER_ACTOR) 
                044B:   actor PLAYER_ACTOR on_foot 
                09E7:   player PLAYER_CHAR not_frozen
                02A0:   actor PLAYER_ACTOR stopped
                8597:   actor PLAYER_ACTOR crouching
                    then
                    
                    :POSFKDOPSKF
                    $SPEED_08_FLAG = 1
                    $MUTE_MUSIC_FLAG = 1
                    BLACK_MENU_OPENED_FLAG = 1
                    
        //            player.CanMove(PLAYER_CHAR) = false
                    0E68: set_player_control_pad 0 1 
                    0E69: set_player_control_pad_movement 0 0
                    
                    0EAC: get_char_proofs PLAYER_ACTOR bullet $CIM_BUL fire $CIM_FIR explosion $CIM_EXP collision $CIM_COL melee $CIM_MEL
                    actor.SetImmunities(PLAYER_ACTOR,1,1,1,1,1)
                    
                    $HUD_REMOVE = 1
                    fade 0 50
                    wait 50  
                    
                    cinema.Widescreen(1)
                    0A48: enable_menu_access_in_widescreen_mode 0
                    if and
                    not MAIN_QUEST_MUSIC_FLAG == 1
                    not USER_TAPE_TURNED_ON_FLAG == 1
                    not $CASETTE_PLAYING_FLAG == 1
                    then
                    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = $MUSIC_VOLUME
                    end
                    
                    32@ = 0            
                    
                    $ACHIV_TOTAL_SHOW_LIST_FLAG = 1
                    create_thread @GQUES_S
                    
                    repeat
                    wait 0
                    fade 0 0
                    
                    if and
                    $READING_NOTE_FLAG == 0
                    0E3E: player 0 pressed_key 15
                        then
                        break
                        end 
                    
                    until false
                    
                    03F0: enable_text_draw 0
                    wait 0
                    0391: release_textures
                       
                    $ACHIV_TOTAL_SHOW_OFF_FLAG = 1
                    wait 1
                    
                    cinema.Widescreen(0)
                    0A48: enable_menu_access_in_widescreen_mode 1            
                    
        //            player.CanMove(PLAYER_CHAR) = true
                    0E68: set_player_control_pad 1 1 
                    0E69: set_player_control_pad_movement 0 1
                    
                    actor.SetImmunities(PLAYER_ACTOR,$CIM_BUL,$CIM_FIR,$CIM_EXP,$CIM_COL,$CIM_MEL)
                    
                    $MUTE_MUSIC_FLAG = 0    
                    $SPEED_08_FLAG = 0
                    BLACK_MENU_OPENED_FLAG = 0
                    015D: set_gamespeed 1.0
                    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME
                    
                    fade 1 500
                    $HUD_REMOVE = 0    
                    wait 500  
                    
                    end
                end
            end
        end
    end            
    
if
$CHEATS_ON == 0
    then
    if
    player.Controllable(PLAYER_CHAR)
        then  
        
        0A8D: 0@ = read_memory 0xB7CB64 size 4 virtual_protect 0
        if
        $SPEED_099_FLAG == 1
        then
        0@ = 1.0
        end
              
        if and
        0E3D:   key_pressed 112 
        $HUD_REMOVE == 0
        $GAMEMODE_HOLD == 0
        $CHEAT_TYPE_FLAG == 0
        0@ == 1.0
            then        
            if and
            not Actor.Dead(PLAYER_ACTOR)
            not Actor.Driving(PLAYER_ACTOR) 
            044B:   actor PLAYER_ACTOR on_foot 
            09E7:   player PLAYER_CHAR not_frozen
            02A0:   actor PLAYER_ACTOR stopped
            8597:   actor PLAYER_ACTOR crouching
                then
                
                $SPEED_08_FLAG = 1
                $MUTE_MUSIC_FLAG = 1
                BLACK_MENU_OPENED_FLAG = 1
                
    //            player.CanMove(PLAYER_CHAR) = false
                0E68: set_player_control_pad 0 1 
                0E69: set_player_control_pad_movement 0 0
                
                0EAC: get_char_proofs PLAYER_ACTOR bullet $CIM_BUL fire $CIM_FIR explosion $CIM_EXP collision $CIM_COL melee $CIM_MEL
                actor.SetImmunities(PLAYER_ACTOR,1,1,1,1,1)
                
                $HUD_REMOVE = 1
                fade 0 50
                wait 50  
                
                cinema.Widescreen(1)
                0A48: enable_menu_access_in_widescreen_mode 0
                $SPEED_08_FLAG = 0
    //            if
    //            not MAIN_QUEST_MUSIC_FLAG == 1
    //            then
    //            Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = $MUSIC_VOLUME
    //            end
                
                /////////////////////////////////////////////////////////////////            
                
                wait 1
                03F0: enable_text_draw 0
                wait 1
                0391: release_textures 
                
                wait 1
                
                0A0E: disable_text_with_style 1
                
                0390: load_txd_dictionary 'control'
                
                wait 1
                038F: load_texture 'keyboard1p' as 1 // Load dictionary with 0390 first
                if
                not PLAYSTATION_BUTTONS == 1
                then
                038F: load_texture 'gamepad1p' as 2 // Load dictionary with 0390 first
                else
                038F: load_texture 'gamepad2p' as 2 // Load dictionary with 0390 first
                end
                 
                wait 1            
                
                /////////////////////////////////////////////////////////////////
                
                $SPEED_08_FLAG = 1
                
                0@ = 0        
                
                repeat
                
                if
                0@ == 0
                then
                03F0: enable_text_draw 1
                038D: draw_texture 1 position 320.0 224.5 size 640.0 449.0 RGBA 255 255 255 0
                03E3: set_texture_to_be_drawn_antialiased 1
                else                
                03F0: enable_text_draw 1
                038D: draw_texture 2 position 320.0 224.5 size 640.0 449.0 RGBA 255 255 255 0
                03E3: set_texture_to_be_drawn_antialiased 1           
                end
                
                wait 0                        
                
                if or
                0E3E: is_button_just_pressed 0 17
                0E3E: is_button_just_pressed 0 0
                0E3E: is_button_just_pressed 0 1
                0E3E: is_button_just_pressed 0 14
                0E3E: is_button_just_pressed 0 15
                0E3E: is_button_just_pressed 0 16
                0E3D: is_key_just_pressed 27
                    then
                    0@ += 1
                    if
                    0@ == 2
                        then
                        
                        wait 1
                        03F0: enable_text_draw 0
                        wait 1
                        0391: release_textures 
                        
                        wait 1  
                        
                        0A0E: disable_text_with_style 0
                                                             
                        break
                        
                        end
                     
                    end
                
                until false
                
                /////////////////////////////////////////////////////////////////  
                
                cinema.Widescreen(0)
                0A48: enable_menu_access_in_widescreen_mode 1            
                
    //            player.CanMove(PLAYER_CHAR) = true
                0E68: set_player_control_pad 1 1 
                0E69: set_player_control_pad_movement 0 1
                
                actor.SetImmunities(PLAYER_ACTOR,$CIM_BUL,$CIM_FIR,$CIM_EXP,$CIM_COL,$CIM_MEL)
                
                $MUTE_MUSIC_FLAG = 0    
                $SPEED_08_FLAG = 0
                BLACK_MENU_OPENED_FLAG = 0
                015D: set_gamespeed 1.0
    //            Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME
                
                fade 1 500
                $HUD_REMOVE = 0    
                wait 500  
                
                end
            end
        end
    end                    

until false

gosub @PERK_MENU_VARS_SET    

//gosub @ACHIV_TOTAL_NUMBER

0AF0: 1@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT125_GOT"
if and
$PERK_TOTAL_GOT == 50
1@ == 0
then
0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT125_GOT"
v$ACHIEVEMNT = "ACH125"
$ACHIEVEMENT_GOT_FLAG = 1
end

$SPEED_08_FLAG = 1
$MUTE_MUSIC_FLAG = 1
OPEN_PERK_MENU_PLEASE_FLAG = 0
BLACK_MENU_OPENED_FLAG = 1

//player.CanMove(PLAYER_CHAR) = false
0E68: set_player_control_pad 0 1 
0E69: set_player_control_pad_movement 0 0

0EAC: get_char_proofs PLAYER_ACTOR bullet $CIM_BUL fire $CIM_FIR explosion $CIM_EXP collision $CIM_COL melee $CIM_MEL
actor.SetImmunities(PLAYER_ACTOR,1,1,1,1,1)

0089: 0@ = PLAYER_EXTRDM_MULT // (float)
0@ *= 100.0
0AD3: 20@v = format "%.1f" 0@
0AE0: remove_dynamic_GXT_entry "_EXTRDM"
0ADF: add_dynamic_GXT_entry "_EXTRDM" text 20@v

0089: 0@ = PLAYER_RESIST_MULT // (float)
0@ *= 100.0
0AD3: 20@v = format "%.1f" 0@
0AE0: remove_dynamic_GXT_entry "_RESIST"
0ADF: add_dynamic_GXT_entry "_RESIST" text 20@v

0@ = 1.0
0065: 0@ -= MEDS_EFFECTIVETY  // (float)
0@ *= 100.0
0AD3: 20@v = format "%.1f" 0@
0AE0: remove_dynamic_GXT_entry "_MEDSPR"
0ADF: add_dynamic_GXT_entry "_MEDSPR" text 20@v

$HUD_REMOVE = 1
fade 0 50
wait 50  

cinema.Widescreen(1)
0A48: enable_menu_access_in_widescreen_mode 0
if and
not MAIN_QUEST_MUSIC_FLAG == 1
not USER_TAPE_TURNED_ON_FLAG == 1
not $CASETTE_PLAYING_FLAG == 1
then
Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = $MUSIC_VOLUME
end
32@ = 0

wait 0
0390: load_txd_dictionary 'PERKS'
for 1@ = 1 to 50
0AD3: v$PHRASE2 = format "PRK%d" 1@
038F: load_texture v$PHRASE2 as 1@ // Load dictionary with 0390 first
end

:PERK_SHOW_IDLE
wait 0
fade 0 0

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y

if
0A4B:   controls_set_to_joystick
then   
033E: set_draw_text_position 320.0 60.0 GXT 'GM1443B'  // Push
else
033E: set_draw_text_position 320.0 60.0 GXT 'GME1443'  // Push
end

if and
HEALTH_PERK_2P_HEAL_FLAG > 0
0800:   in_two_players_mode
    then
    HEALTH_PERK_2P_HEAL_FLAG -= 1
    0@ = actor.Health(PLAYER_ACTOR)
    1@ = actor.Health(COOP_ACTOR)
    005A: 1@ += 0@  // (int)
    actor.Health(COOP_ACTOR) = 1@
    end

if
29@ == 1
then
Actor.Health(PLAYER_ACTOR) = 1000
29@ = 0
end

if or
$ACHIV_TOTAL_SHOW_OFF_FLAG == 1
0E3E:   player 0 pressed_key 15
    then    

    03F0: enable_text_draw 0
    wait 0
    0391: release_textures

    cinema.Widescreen(0)
    0A48: enable_menu_access_in_widescreen_mode 1            
    
//    player.CanMove(PLAYER_CHAR) = true
    0E68: set_player_control_pad 1 1 
    0E69: set_player_control_pad_movement 0 1
    
    actor.SetImmunities(PLAYER_ACTOR,$CIM_BUL,$CIM_FIR,$CIM_EXP,$CIM_COL,$CIM_MEL)
    
    $MUTE_MUSIC_FLAG = 0    
    $SPEED_08_FLAG = 0
    BLACK_MENU_OPENED_FLAG = 0
    015D: set_gamespeed 1.0
    Audiostream.Volume(PERK_THEME_AUDIOSTREAM) = VERO_TIPA_VOLUME
    
    if
    CURRENT_USHER_TUTORIAL_NUM == 5
    then
    CURRENT_USHER_TUTORIAL_NUM = 0
    end
    
    fade 1 500
    $HUD_REMOVE = 0    
    wait 500  
    
    0AF0: 1@ = get_int_from_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT125_GOT"
    if and
    $PERK_TOTAL_GOT == 50
    1@ == 0
    then
    0AF1: write_int 1 to_ini_file "saves/ZACM.set" section "SCR" key "ACHIEVEMENT125_GOT"
    v$ACHIEVEMNT = "ACH125"
    $ACHIEVEMENT_GOT_FLAG = 1
    end      
    
    jump to @PERK_SHOW_START
    end
    
if
0A4B:   controls_set_to_joystick
then    

00E2: get_player 0 key 0 state_to 0@

if
00E1:   player 0 pressed_key 11
    then
    0@ = 1
    end
if
00E1:   player 0 pressed_key 10
    then
    0@ = -1
    end
    
if or
00E1:   player 0 pressed_key 7
0@ > 0
    then
    0@ = -1
    
    if and
    0@ < 0
    32@ > 8
    then
    32@ = 0        
    $PERK_NUMBER += 1       
    Audiostream.PerformAction($MENU_FOCUS_SOUND, PLAY)
    Audiostream.Loop($MENU_FOCUS_SOUND, 0)
    Audiostream.Volume($MENU_FOCUS_SOUND) = $SOUNDS_VOLUME    
    end
         
    end 

if or
00E1:   player 0 pressed_key 5
0@ < 0
    then
    0@ = 1
    
    if and
    0@ > 0
    32@ > 8
    then
    32@ = 0           
    $PERK_NUMBER -= 1         
    Audiostream.PerformAction($MENU_FOCUS_SOUND, PLAY)
    Audiostream.Loop($MENU_FOCUS_SOUND, 0)
    Audiostream.Volume($MENU_FOCUS_SOUND) = $SOUNDS_VOLUME
    end
             
    end

else        
    
00E2: get_player 0 key 1 state_to 0@    
if or
00E1:   player 0 pressed_key 5
0@ < 0
    then
    
    if and
    0@ < 0
    32@ < 8
    then
    else
    32@ = 0        
    $PERK_NUMBER += 1       
    Audiostream.PerformAction($MENU_FOCUS_SOUND, PLAY)
    Audiostream.Loop($MENU_FOCUS_SOUND, 0)
    Audiostream.Volume($MENU_FOCUS_SOUND) = $SOUNDS_VOLUME
    end
         
    end 

if or
00E1:   player 0 pressed_key 7
0@ > 0
    then
    
    if and
    0@ == 128
    32@ < 8
    then
    else
    32@ = 0           
    $PERK_NUMBER -= 1         
    Audiostream.PerformAction($MENU_FOCUS_SOUND, PLAY)
    Audiostream.Loop($MENU_FOCUS_SOUND, 0)
    Audiostream.Volume($MENU_FOCUS_SOUND) = $SOUNDS_VOLUME
    end
             
    end
    
end             
    
if       
$PERK_NUMBER < 1  
    then
    0084: $PERK_NUMBER = $ACHIV_TOTAL // (int)
    end  
    
if 
001C:   $PERK_NUMBER > $ACHIV_TOTAL // (int)
    then
    $PERK_NUMBER = 1
    end           

gosub @PERK_TEXT_OFFSET_ACHIV

////////////////////////////////////////////////////////////////////////////////////////////////////////

03F0: enable_text_draw 1
0349: set_text_draw_font 0
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT0_R DIRECTFONT_FONT0_G DIRECTFONT_FONT0_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size 0.8 1.75 

v$ACHIV_NAME1 = "PRK" // v$ // Sunday  

0AD3: v$ACHIV_NAME2 = format "%d" $PERK_NUMBER 
098B: v$ACHIV_NAME3 = v$ACHIV_NAME1 + v$ACHIV_NAME2 // all string variables

0084: $ACHIV_NUMBER_GET = $PERK_NUMBER // (int)

gosub @PERKS_NUMBER_GET 

if
$PERK_GOT_FLAG == 1
then
0340: set_text_draw_RGBA 255 255 255 255
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT0_R DIRECTFONT_FONT0_G DIRECTFONT_FONT0_B 255
end

else
0340: set_text_draw_RGBA 255 255 255 100
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT0_R DIRECTFONT_FONT0_G DIRECTFONT_FONT0_B 100
end

end

045A: draw_text_1number $ACHIV_TEXT_X $ACHIV_TEXT_Y GXT v$ACHIV_NAME3 number $ACHIV_NUMBER_SHOW  // ALL RACES WON!~n~~w~$~1~

03F0: enable_text_draw 1
if
$PERK_GOT_FLAG == 1
then
038D: draw_texture $PERK_NUMBER position 322.5 162.5 size 50.0 50.0 RGBA 255 255 255 255 
else  
038D: draw_texture $PERK_NUMBER position 322.5 162.5 size 50.0 50.0 RGBA 255 255 255 155 
end 

////////////////////////////////////////////////////////////////////////////////////////////////////////

gosub @PERK_TEXT_OFFSET_ACHIV2

03F0: enable_text_draw 1
0349: set_text_draw_font 1
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT0_R DIRECTFONT_FONT0_G DIRECTFONT_FONT0_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y 

if
$PERK_GOT_FLAG == 1
then                    
0340: set_text_draw_RGBA 255 255 255 255
else
0340: set_text_draw_RGBA 255 255 255 100
end

v$ACHIV_NAME1 = "2PRK" // v$ // Sunday  

0AD3: v$ACHIV_NAME2 = format "%d" $PERK_NUMBER 
098B: v$ACHIV_NAME3 = v$ACHIV_NAME1 + v$ACHIV_NAME2 // all string variables

0084: $ACHIV_NUMBER_GET = $PERK_NUMBER // (int)

045A: draw_text_1number $ACHIV_TEXT2_X $ACHIV_TEXT2_Y GXT v$ACHIV_NAME3 number $ACHIV_NUMBER_SHOW  // ALL RACES WON!~n~~w~$~1~

////////////////////////////////////////////////////////////////////////////////////////////////////////

gosub @PERK_TEXT_OFFSET_TOTAL

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TOTAL_ACHIV_TEXT_SIZE_X $ACHIV_TOTAL_ACHIV_TEXT_SIZE_Y   

if
not $PERK_TOTAL_GOT == 50
then 
045A: draw_text_1number $ACHIV_TOTAL_ACHIV_TEXT_X 380.0 GXT 'GAME530' number $PLAYER_PERKS_POINTS
else
045A: draw_text_1number $ACHIV_TOTAL_ACHIV_TEXT_X 380.0 GXT 'AME530B' number $PLAYER_PERKS_POINTS
end

////////////////////////////////////////////////////////////////////////////////////////////////////////

if
CURRENT_USHER_TUTORIAL_NUM == 4
then

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y   
033E: set_draw_text_position 320.0 20.0 GXT 'STRB45'  // Push

end

if
CURRENT_USHER_TUTORIAL_NUM == 5
then

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y   
033E: set_draw_text_position 320.0 20.0 GXT 'STRB47'  // Push

end


////////////////////////////////////////////////////////////////////////////////////////////////////////

if
KARMA_SYS_ON_FLAG == 1
then

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y   

if
CARMA_VERY_BAD_FLAG == 0
then 
045A: draw_text_1number 100.0 20.0 GXT 'GAME807' number CARMA_BAD_POINTS
else

008B: 0@ = CARMA_BAD_POINTS // (int)
0@ -= 100
if
0@ < 0
then
0@ = 0
end

045A: draw_text_1number 100.0 20.0 GXT 'GAME808' number 0@

end

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y   

if
CARMA_VERY_BAD_FLAG == 0
then 
045A: draw_text_1number 540.0 20.0 GXT 'GAME806' number CARMA_GOOD_POINTS
else
045A: draw_text_1number 540.0 20.0 GXT 'GAME809' number CARMA_GOOD_POINTS
end

end

////////////////////////////////////////////////////////////////////////////////////////////////////////

if
PLAYER_EXTRDM_MULT > 0.0
then

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y

033E: set_draw_text_position 100.0 420.0 GXT 'GAME999'  // Push

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y

033E: set_draw_text_position 190.0 430.5 GXT "_EXTRDM"  // Push

end

////////////////////////////////////////////////////////////////////////////////////////////////////////

if
PLAYER_RESIST_MULT > 0.0
then

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y

033E: set_draw_text_position 505.0 420.0 GXT 'GME1000'  // Push

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y

033E: set_draw_text_position 590.0 430.5 GXT "_RESIST"  // Push

end

////////////////////////////////////////////////////////////////////////////////////////////////////////

if
MEDS_EFFECTIVETY < 1.0
then

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y

033E: set_draw_text_position 305.0 420.0 GXT 'GME1450'  // Push

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y

033E: set_draw_text_position 400.0 430.5 GXT "_MEDSPR"  // Push

end

////////////////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_GOT_FLAG == 0
then

gosub @PERK_TEXT_OFFSET_TOTAL

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TOTAL_ACHIV_TEXT_SIZE_X $ACHIV_TOTAL_ACHIV_TEXT_SIZE_Y   
 
045A: draw_text_1number $ACHIV_TOTAL_ACHIV_TEXT_X 340.0 GXT 'GAME529' number REQUIED_PERKS_POINTS

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TOTAL_ACHIV_TEXT_SIZE_X $ACHIV_TOTAL_ACHIV_TEXT_SIZE_Y   
 
045A: draw_text_1number $ACHIV_TOTAL_ACHIV_TEXT_X 320.0 GXT 'GAME586' number REQUIED_PERK_PLAYER_LEVEL

end

////////////////////////////////////////////////////////////////////////////////////////////////////////

gosub @PERK_TEXT_OFFSET_TOTAL

03F0: enable_text_draw 1
0349: set_text_draw_font 2
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255 
033F: set_text_draw_letter_size $ACHIV_TOTAL_ACHIV_TEXT_SIZE_X $ACHIV_TOTAL_ACHIV_TEXT_SIZE_Y   
 
045B: draw_text_2numbers $ACHIV_TOTAL_ACHIV_TEXT_X $ACHIV_TOTAL_ACHIV_TEXT_Y GXT 'GAME528' numbers $PERK_TOTAL_GOT $ACHIV_TOTAL  // ~1~:~1~

//////////////////////////////////////////////////////////////////////////////////////////////////////// 

gosub @PERK_TEXT_OFFSET_TOTAL

03F0: enable_text_draw 1
0349: set_text_draw_font 2
0342: set_text_draw_centered 1
0344: set_text_draw_linewidth 500.0 for_centered_text
081C: draw_text_outline 1 RGBA 0 0 0 255  

if
$PERK_GOT_FLAG == 1
then                    
0340: set_text_draw_RGBA 255 255 255 255
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 255
end

else
0340: set_text_draw_RGBA 255 255 255 100
if
DIRECTFONT_INSTALLED == 1
then    
0340: set_text_draw_RGBA DIRECTFONT_FONT2_R DIRECTFONT_FONT2_G DIRECTFONT_FONT2_B 100
end

end

033F: set_text_draw_letter_size $ACHIV_TOTAL3_ACHIV_TEXT_SIZE_X $ACHIV_TOTAL3_ACHIV_TEXT_SIZE_Y   
 
045B: draw_text_2numbers $ACHIV_TOTAL3_ACHIV_TEXT_X $ACHIV_TOTAL3_ACHIV_TEXT_Y GXT 'DISP5' numbers $PERK_NUMBER $ACHIV_TOTAL  // ~1~:~1~

////////////////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_GOT_FLAG == 0
0E3E: is_button_just_pressed 0 button 16
then

if and
002E:   $PLAYER_PERKS_POINTS >= REQUIED_PERKS_POINTS  // (int)
002E:   $PLAYER_LEVEL >= REQUIED_PERK_PLAYER_LEVEL  // (int)
    then
    
    gosub @PERK_INSTALL
    
    if
    6@ == 1
        then
        0066: $PLAYER_PERKS_POINTS -= REQUIED_PERKS_POINTS  // (int)
        Audiostream.Volume($MENU_GUITARRIFF_SOUND) = $SOUNDS_VOLUME 
        Audiostream.Loop($MENU_GUITARRIFF_SOUND, 0)
        Audiostream.PerformAction($MENU_GUITARRIFF_SOUND, PLAY)
        $PERK_TOTAL_GOT += 1
        
        if
        CURRENT_USHER_TUTORIAL_NUM == 4
            then
            CURRENT_USHER_TUTORIAL_NUM = 5
            end
        
        end
    
    else
    Audiostream.Volume($MENU_INVALID_SOUND) = $SOUNDS_VOLUME 
    Audiostream.Loop($MENU_INVALID_SOUND, 0)
    Audiostream.PerformAction($MENU_INVALID_SOUND, PLAY)
    end

end

////////////////////////////////////////////////////////////////////////////////////////////////////////

if and
$FREEMODE == 1
not $CARL_STORY == 1
not $MIKE_STORY == 1
not MCS_FLAG == 1
UNITED_MAP == 0
    then    
    if and
    not CARMA_VERY_BAD_FLAG == 1
    0A4B:   controls_set_to_joystick    
        then
                        
        03F0: enable_text_draw 1
        0349: set_text_draw_font 1
        if
        DIRECTFONT_INSTALLED == 1
        then    
        0340: set_text_draw_RGBA DIRECTFONT_FONT0_R DIRECTFONT_FONT0_G DIRECTFONT_FONT0_B 255
        end
        
        0342: set_text_draw_centered 1
        0344: set_text_draw_linewidth 500.0 for_centered_text
        081C: draw_text_outline 1 RGBA 0 0 0 255 
        033F: set_text_draw_letter_size $ACHIV_TEXT2_SIZE_X $ACHIV_TEXT2_SIZE_Y    
        033E: set_draw_text_position 320.0 50.0 GXT 'GME1217'  // Push                                            
        
        if
        0E3E: player 0 pressed_key 4
            then
            
            03F0: enable_text_draw 0
            wait 0
            0391: release_textures
            
            create_thread @GQUES_S
                        
            repeat
            wait 0
            fade 0 0
                            
            if
            00E1: player 0 pressed_key 15
                then
                break
                end 
                            
            until false
            
            gosub @PERK_MENU_VARS_SET
            wait 0
            
            0390: load_txd_dictionary 'PERKS'
            for 1@ = 1 to 50
            0AD3: v$PHRASE2 = format "PRK%d" 1@
            038F: load_texture v$PHRASE2 as 1@ // Load dictionary with 0390 first
            end
             
            end                  
        end                
    end         

jump to @PERK_SHOW_IDLE 

:PERK_TEXT_OFFSET_ACHIV

0A8D: 1@ = read_memory 0xB7CB64 size 4 virtual_protect 0
if
not 1@ == 1.0
    then
    return
    end

random_float 0@ 0.025 -0.025
random_float 1@ -0.025 0.025

005F: $ACHIV_TEXT_X += 0@  // (float)
005F: $ACHIV_TEXT_Y += 1@  // (float)

005F: $ACHIV_TEXT_X += 0@  // (float)
005F: $ACHIV_TEXT_Y += 1@  // (float)

return

:PERK_TEXT_OFFSET_ACHIV2

0A8D: 1@ = read_memory 0xB7CB64 size 4 virtual_protect 0
if
not 1@ == 1.0
    then
    return
    end
                           
random_float 0@ 0.025 -0.025
random_float 1@ -0.025 0.025

005F: $ACHIV_TEXT2_X += 0@  // (float)
005F: $ACHIV_TEXT2_Y += 1@  // (float)

005F: $ACHIV_TEXT2_X += 0@  // (float)
005F: $ACHIV_TEXT2_Y += 1@  // (float)

return

:PERK_TEXT_OFFSET_TOTAL

0A8D: 1@ = read_memory 0xB7CB64 size 4 virtual_protect 0
if
not 1@ == 1.0
    then
    return
    end

random_float 0@ 0.0010 -0.0010
random_float 1@ -0.0010 0.0010

005F: $ACHIV_TOTAL_ACHIV_TEXT_X += 0@  // (float)
005F: $ACHIV_TOTAL_ACHIV_TEXT_Y += 1@  // (float)

005F: $ACHIV_TOTAL_ACHIV_TEXT_X += 0@  // (float)
005F: $ACHIV_TOTAL_ACHIV_TEXT_Y += 1@  // (float)

return

:PERK_TEXT_OFFSET_TOTAL2

0A8D: 1@ = read_memory 0xB7CB64 size 4 virtual_protect 0
if
not 1@ == 1.0
    then
    return
    end

random_float 0@ 0.0010 -0.0010
random_float 1@ -0.0010 0.0010

005F: $ACHIV_TOTAL2_ACHIV_TEXT_X += 0@  // (float)
005F: $ACHIV_TOTAL2_ACHIV_TEXT_Y += 1@  // (float)

005F: $ACHIV_TOTAL2_ACHIV_TEXT_X += 0@  // (float)
005F: $ACHIV_TOTAL2_ACHIV_TEXT_Y += 1@  // (float)

return

:PERKS_NUMBER_GET

$PERK_GOT_FLAG = 0

/////////////////////////////////////////

if
$PERK_NUMBER == 1
then

REQUIED_PERKS_POINTS = 3
REQUIED_PERK_PLAYER_LEVEL = 2

if or
PERK_WEAPON_SKILL == 1
PERK_WEAPON_SKILL == 2
PERK_WEAPON_SKILL == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 2
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 6

if or
PERK_WEAPON_SKILL == 2
PERK_WEAPON_SKILL == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 3
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 13

if
PERK_WEAPON_SKILL == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 4
then

REQUIED_PERKS_POINTS = 3
REQUIED_PERK_PLAYER_LEVEL = 4

if or
PERK_SLOWMODE == 1
PERK_SLOWMODE == 2
PERK_SLOWMODE == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 5
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 8

if or
PERK_SLOWMODE == 2
PERK_SLOWMODE == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 6
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 14

if
PERK_SLOWMODE == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 7
then

REQUIED_PERKS_POINTS = 3
REQUIED_PERK_PLAYER_LEVEL = 1

if or
PERK_WEIGHT == 1
PERK_WEIGHT == 2
PERK_WEIGHT == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 8
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 3

if or
PERK_WEIGHT == 2
PERK_WEIGHT == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 9
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 5

if
PERK_WEIGHT == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 10
then

REQUIED_PERKS_POINTS = 3
REQUIED_PERK_PLAYER_LEVEL = 1

if or
PERK_AMMO == 1
PERK_AMMO == 2
PERK_AMMO == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 11
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 3

if or
PERK_AMMO == 2
PERK_AMMO == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 12
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 5

if
PERK_AMMO == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 13
then

REQUIED_PERKS_POINTS = 3
REQUIED_PERK_PLAYER_LEVEL = 1

if or
PERK_ATHLET == 1
PERK_ATHLET == 2
PERK_ATHLET == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 14
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 3

if or
PERK_ATHLET == 2
PERK_ATHLET == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 15
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 5

if
PERK_ATHLET == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 16
then

REQUIED_PERKS_POINTS = 3
REQUIED_PERK_PLAYER_LEVEL = 3

if or
PERK_HUNGER == 1
PERK_HUNGER == 2
PERK_HUNGER == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 17
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 5

if or
PERK_HUNGER == 2
PERK_HUNGER == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 18
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 10

if
PERK_HUNGER == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 19
then

REQUIED_PERKS_POINTS = 3
REQUIED_PERK_PLAYER_LEVEL = 2

if or
PERK_HEALTH == 1
PERK_HEALTH == 2
PERK_HEALTH == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 20
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 6

if or
PERK_HEALTH == 2
PERK_HEALTH == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 21
then

REQUIED_PERKS_POINTS = 8
REQUIED_PERK_PLAYER_LEVEL = 12

if
PERK_HEALTH == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 22
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 5

if
PERK_HACKER == 1
then
$PERK_GOT_FLAG = 1
PERK_HACKER = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 23
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 5

if or
PERK_RUNSPEED == 1
PERK_RUNSPEED == 2
PERK_RUNSPEED == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 24
then

REQUIED_PERKS_POINTS = 10
REQUIED_PERK_PLAYER_LEVEL = 10

if or
PERK_RUNSPEED == 2
PERK_RUNSPEED == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 25
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 4

if or
PERK_GOODRIVER == 1
PERK_GOODRIVER == 2
then
$PERK_GOT_FLAG = 1 
end

end

///////////////////////////////////////// 

if
$PERK_NUMBER == 26
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 4

if
PERK_DEVIATOR == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 27
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 8

if or
PERK_FINDGOODS == 1
PERK_FINDGOODS == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 28
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 3

if
PERK_GASOLINEFIND == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 29
then

REQUIED_PERKS_POINTS = 4
REQUIED_PERK_PLAYER_LEVEL = 2

if
PERK_CARPILLOW == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 30
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 3

if
PERK_GOODBLOOD == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 31
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 10

if
PERK_REGENHP == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 32
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 8

if
PERK_TOUGHMAN == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 33
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 10

if or
PERK_GOLDEXP == 1
PERK_GOLDEXP == 2
PERK_GOLDEXP == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 34
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 15

if or
PERK_GOLDEXP == 2
PERK_GOLDEXP == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 35
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 8

if or
PERK_CHARISMA == 1
PERK_CHARISMA == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 36
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 16

if
PERK_CHARISMA == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 37
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 5

if or
PERK_MELEE == 1
PERK_MELEE == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 38
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 12

if
PERK_MELEE == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 39
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 15

if
PERK_EAGLE == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 40
then

REQUIED_PERKS_POINTS = 5
REQUIED_PERK_PLAYER_LEVEL = 15

if
PERK_FIREFIGHTER == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 41
then

REQUIED_PERKS_POINTS = 6
REQUIED_PERK_PLAYER_LEVEL = 20

if or
PERK_MERCHANT == 1
PERK_MERCHANT == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 42
then

REQUIED_PERKS_POINTS = 8
REQUIED_PERK_PLAYER_LEVEL = 24

if
PERK_MERCHANT == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 43
then

REQUIED_PERKS_POINTS = 6
REQUIED_PERK_PLAYER_LEVEL = 23

if
PERK_GOLDEXP == 3
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 44
then

REQUIED_PERKS_POINTS = 8
REQUIED_PERK_PLAYER_LEVEL = 21

if
PERK_STEELSTOMACH == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 45
then

REQUIED_PERKS_POINTS = 6
REQUIED_PERK_PLAYER_LEVEL = 22

if
PERK_ANTIFALL == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 46
then

REQUIED_PERKS_POINTS = 8
REQUIED_PERK_PLAYER_LEVEL = 25

if
PERK_GOODRIVER == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 47
then

REQUIED_PERKS_POINTS = 8
REQUIED_PERK_PLAYER_LEVEL = 25

if
PERK_PANZER == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 48
then

REQUIED_PERKS_POINTS = 10
REQUIED_PERK_PLAYER_LEVEL = 25

if
PERK_FINDGOODS == 2
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 49
then

REQUIED_PERKS_POINTS = 12
REQUIED_PERK_PLAYER_LEVEL = 26

if
PERK_TITAN == 1
then
$PERK_GOT_FLAG = 1 
end

end

/////////////////////////////////////////

if
$PERK_NUMBER == 50
then

REQUIED_PERKS_POINTS = 15
REQUIED_PERK_PLAYER_LEVEL = 28

if
PERK_LASTCHANCE == 1
then
$PERK_GOT_FLAG = 1 
end

end

///////////////////////////////////////// 

return

:PERK_INSTALL

6@ = 0

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 1
PERK_WEAPON_SKILL == 0
then
6@ = 1
:PERK_WEAPON_SKILL1_INSTALL
PERK_WEAPON_SKILL = 1
1@ = 200.0
062A: change_float_stat 69 to 1@
062A: change_float_stat 70 to 1@
062A: change_float_stat 71 to 1@
062A: change_float_stat 72 to 1@
062A: change_float_stat 73 to 1@
062A: change_float_stat 74 to 1@  
062A: change_float_stat 75 to 1@  
062A: change_float_stat 76 to 1@
062A: change_float_stat 77 to 1@
062A: change_float_stat 78 to 1@
062A: change_float_stat 79 to 1@

0AF2: 0@ = get_float_from_ini_file "scripts/WeaponRecoilRE.ini" section "WeaponRecoilRE" key "fRecoilMultiplier Global"    
if
not 0@ == 1.485
then
0AF3: write_float 1.485 to_ini_file "scripts/WeaponRecoilRE.ini" section "WeaponRecoilRE" key "fRecoilMultiplier Global"
0A8C: write_memory 0x0969110 size 6 value "RRWSR" virtual_protect 0
end

end

if and
$PERK_NUMBER == 2
PERK_WEAPON_SKILL == 1
then
6@ = 1
:PERK_WEAPON_SKILL2_INSTALL
PERK_WEAPON_SKILL = 2

0AF2: 0@ = get_float_from_ini_file "scripts/WeaponRecoilRE.ini" section "WeaponRecoilRE" key "fRecoilMultiplier Global"    
if
not 0@ == 1.32
then
0AF3: write_float 1.32 to_ini_file "scripts/WeaponRecoilRE.ini" section "WeaponRecoilRE" key "fRecoilMultiplier Global"
0A8C: write_memory 0x0969110 size 6 value "RRWSR" virtual_protect 0
end

end

if and
$PERK_NUMBER == 3
PERK_WEAPON_SKILL == 2
then
6@ = 1
:PERK_WEAPON_SKILL3_INSTALL
PERK_WEAPON_SKILL = 3

0AF2: 0@ = get_float_from_ini_file "scripts/WeaponRecoilRE.ini" section "WeaponRecoilRE" key "fRecoilMultiplier Global"    
if
not 0@ == 1.155
then
0AF3: write_float 1.155 to_ini_file "scripts/WeaponRecoilRE.ini" section "WeaponRecoilRE" key "fRecoilMultiplier Global"
0A8C: write_memory 0x0969110 size 6 value "RRWSR" virtual_protect 0
end

1@ = 1000.0
062A: change_float_stat 69 to 1@
062A: change_float_stat 70 to 1@
062A: change_float_stat 71 to 1@
062A: change_float_stat 72 to 1@
062A: change_float_stat 73 to 1@
062A: change_float_stat 74 to 1@  
062A: change_float_stat 75 to 1@  
062A: change_float_stat 76 to 1@
062A: change_float_stat 77 to 1@
062A: change_float_stat 78 to 1@
062A: change_float_stat 79 to 1@
end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 4
PERK_SLOWMODE == 0
then
6@ = 1
:PERK_SLOWMODE1_INSTALL
PERK_SLOWMODE = 1
$SLOW_BAR_MINUS *= 0.90
end

if and
$PERK_NUMBER == 5
PERK_SLOWMODE == 1
then
6@ = 1
:PERK_SLOWMODE2_INSTALL
PERK_SLOWMODE = 2
$SLOW_BAR_MINUS *= 0.80
end

if and
$PERK_NUMBER == 6
PERK_SLOWMODE == 2
then
6@ = 1
:PERK_SLOWMODE3_INSTALL
PERK_SLOWMODE = 3
$SLOW_BAR_MINUS *= 0.70
end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 7
PERK_WEIGHT == 0
then
6@ = 1
:PERK_WEIGHT1_INSTALL
PERK_WEIGHT = 1
v$WEIGHT_STRING = "INV249" // v$ // Sunday

if or
SURVIVAL_CUSTOM_WEAPON_NABOR == 5
SURVIVAL_CUSTOM_WEAPON_NABOR == 7
then
v$WEIGHT_STRING = "JNV249" // v$ // Sunday
end

end

if and
$PERK_NUMBER == 8
PERK_WEIGHT == 1
then
6@ = 1
:PERK_WEIGHT2_INSTALL
PERK_WEIGHT = 2
v$WEIGHT_STRING = "INV250" // v$ // Sunday

if or
SURVIVAL_CUSTOM_WEAPON_NABOR == 5
SURVIVAL_CUSTOM_WEAPON_NABOR == 7
then
v$WEIGHT_STRING = "JNV250" // v$ // Sunday
end
 
end

if and
$PERK_NUMBER == 9
PERK_WEIGHT == 2
then
6@ = 1
:PERK_WEIGHT3_INSTALL
PERK_WEIGHT = 3
v$WEIGHT_STRING = "INV251" // v$ // Sunday

if or
SURVIVAL_CUSTOM_WEAPON_NABOR == 5
SURVIVAL_CUSTOM_WEAPON_NABOR == 7
then
v$WEIGHT_STRING = "JNV251" // v$ // Sunday
end

end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 10
PERK_AMMO == 0
then
6@ = 1
:PERK_AMMO1_INSTALL
PERK_AMMO = 1
end

if and
$PERK_NUMBER == 11
PERK_AMMO == 1
then
6@ = 1
:PERK_AMMO2_INSTALL
PERK_AMMO = 2
end

if and
$PERK_NUMBER == 12
PERK_AMMO == 2
then
6@ = 1
:PERK_AMMO3_INSTALL
PERK_AMMO = 3
end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 13
PERK_ATHLET == 0
then
6@ = 1
:PERK_ATHLET1_INSTALL
PERK_ATHLET = 1
end

if and
$PERK_NUMBER == 14
PERK_ATHLET == 1
then
6@ = 1
:PERK_ATHLET2_INSTALL
PERK_ATHLET = 2
end

if and
$PERK_NUMBER == 15
PERK_ATHLET == 2
then
6@ = 1
:PERK_ATHLET3_INSTALL
PERK_ATHLET = 3
end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 16
PERK_HUNGER == 0
then
6@ = 1
:PERK_HUNGER1_INSTALL
PERK_HUNGER = 1
end

if and
$PERK_NUMBER == 17
PERK_HUNGER == 1
then
6@ = 1
:PERK_HUNGER2_INSTALL
PERK_HUNGER = 2
end

if and
$PERK_NUMBER == 18
PERK_HUNGER == 2
then
6@ = 1
:PERK_HUNGER3_INSTALL
PERK_HUNGER = 3
end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 19
PERK_HEALTH == 0
then
6@ = 1
:PERK_HEALTH1_INSTALL
PERK_HEALTH = 1
$FALL_HITS += 1
0A8C: write_memory 0xB793E0 size 4 value 1200.0 virtual_protect 1
29@ = 1
HEALTH_PERK_2P_HEAL_FLAG = 3
end

if and
$PERK_NUMBER == 20
PERK_HEALTH == 1
then
6@ = 1
:PERK_HEALTH2_INSTALL
PERK_HEALTH = 2
$FALL_HITS += 1
0A8C: write_memory 0xB793E0 size 4 value 1300.0 virtual_protect 1
29@ = 1
HEALTH_PERK_2P_HEAL_FLAG = 3
end

if and
$PERK_NUMBER == 21
PERK_HEALTH == 2
then
6@ = 1
:PERK_HEALTH3_INSTALL
PERK_HEALTH = 3
$FALL_HITS += 1
0A8C: write_memory 0xB793E0 size 4 value 1450.0 virtual_protect 1
29@ = 1
HEALTH_PERK_2P_HEAL_FLAG = 3
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 22
then
6@ = 1
:PERK_HACKER_INSTALL
PERK_HACKER = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 23
PERK_RUNSPEED == 0
then
6@ = 1
:PERK_RUNSPEED1_INSTALL
PERK_RUNSPEED = 1
end

if and
$PERK_NUMBER == 24
PERK_RUNSPEED == 1
then
6@ = 1
:PERK_RUNSPEED2_INSTALL
PERK_RUNSPEED = 2
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 25
then
6@ = 1
:PERK_GUDDRIVER1_INSTALL
PERK_GOODRIVER = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 26
then
6@ = 1
:PERK_DEVIATOR_INSTALL
PERK_DEVIATOR = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 27
then
6@ = 1
:PERK_FINDGOODS1_INSTALL
PERK_FINDGOODS = 1
$W_FIND_AMMO_MIN += 5
$W_FIND_AMMO_MAX += 15
$W2_FIND_AMMO_MIN += 5
$W2_FIND_AMMO_MAX += 15
$W3_FIND_AMMO_MIN += 5
$W3_FIND_AMMO_MAX += 15
$W_AMM_FIND_AMMO_MIN += 5
$W_AMM_FIND_AMMO_MAX += 15
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 28
then
6@ = 1
:PERK_GASOLINEFIND_INSTALL
PERK_GASOLINEFIND = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 29
then
6@ = 1
:PERK_CARPILLOW_INSTALL
PERK_CARPILLOW = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 30
then
6@ = 1
:PERK_GOODBLOOD_INSTALL
PERK_GOODBLOOD = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 31
then
6@ = 1
:PERK_REGENHP_INSTALL
PERK_REGENHP = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 32
then
6@ = 1
:PERK_TOUGHMAN_INSTALL
PERK_TOUGHMAN = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 33
PERK_GOLDEXP == 0
then
6@ = 1
:PERK_GOLDEXP1_INSTALL
PERK_GOLDEXP = 1
$XP_COEFF += 0.15
end

///////////////////////////////////////////////////////////////////////////////////////////////

if and
$PERK_NUMBER == 34
PERK_GOLDEXP == 1
then
6@ = 1
:PERK_GOLDEXP2_INSTALL
PERK_GOLDEXP = 2
$XP_COEFF += 0.25
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 35
then
6@ = 1
:PERK_CHARISMA_INSTALL
PERK_CHARISMA = 1

////////////////////////////////////////////

for 0@ = 0 to 4

if and
$SURVIVOR_BETRAY_CAN[0@] == 1
$SURVIVOR_IN_PLAYER_TEAM[0@] == 1
0E4D: random_percent 70
then
$SURVIVOR_BETRAY_CAN[0@] = 0
$SURVIVOR_BETRAY_TIMER[0@] = 0
$SURVIVOR_BETRAY_TIMER2[0@] = 999999
end

end

////////////////////////////////////////////

end

if and
$PERK_NUMBER == 36
PERK_CHARISMA == 1
then
6@ = 1
:PERK_CHARISMA2_INSTALL
PERK_CHARISMA = 2
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 37
then
6@ = 1
:PERK_MELEE_INSTALL
PERK_MELEE = 1 
end

if and
$PERK_NUMBER == 38
PERK_MELEE == 1
then
6@ = 1
:PERK_MELEE2_INSTALL
PERK_MELEE = 2 
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 39
then
6@ = 1
:PERK_EAGLE_INSTALL
PERK_EAGLE = 1
end

///////////////////////////////////////////////////////////////////////////////////////////////

if
$PERK_NUMBER == 40
then
6@ = 1
:PERK_FIREFIGHTER_INSTALL
PERK_FIREFIGHTER = 1
end

if
$PERK_NUMBER == 41
then
6@ = 1
:PERK_MERCHANT1_INSTALL
PERK_MERCHANT = 1
$ADDITIONAL_PRICE_COEFF = -0.15
end

if and
$PERK_NUMBER == 42
PERK_MERCHANT == 1
then
6@ = 1
:PERK_MERCHANT2_INSTALL
PERK_MERCHANT = 2
$ADDITIONAL_PRICE_COEFF = -0.30
end

if and
$PERK_NUMBER == 43
PERK_GOLDEXP == 2
then
6@ = 1
:PERK_GOLDEXP3_INSTALL
PERK_GOLDEXP = 3
$XP_COEFF += 0.35
end

if
$PERK_NUMBER == 44
then
6@ = 1
:PERK_STEELSTOMACH_INSTALL
PERK_STEELSTOMACH = 1
end

if
$PERK_NUMBER == 45
then
6@ = 1
:PERK_ANTIFALL_INSTALL
PERK_ANTIFALL = 1
end

if and
$PERK_NUMBER == 46
PERK_GOODRIVER == 1
then
6@ = 1
:PERK_GUDDRIVER2_INSTALL
PERK_GOODRIVER = 2
end

if and
$PERK_NUMBER == 47
PERK_PANZER == 0
then
6@ = 1
:PERK_PANZER_INSTALL
PERK_PANZER = 1
end

if and
$PERK_NUMBER == 48
PERK_FINDGOODS == 1
then
6@ = 1
:PERK_FINDGOODS2_INSTALL
PERK_FINDGOODS = 2
$W_FIND_AMMO_MIN += 5
$W_FIND_AMMO_MAX += 15
$W2_FIND_AMMO_MIN += 5
$W2_FIND_AMMO_MAX += 15
$W3_FIND_AMMO_MIN += 5
$W3_FIND_AMMO_MAX += 15
$W_AMM_FIND_AMMO_MIN += 5
$W_AMM_FIND_AMMO_MAX += 15
end

if and
$PERK_NUMBER == 49
PERK_TITAN == 0
then
6@ = 1
:PERK_TITAN_INSTALL
PERK_TITAN = 1
PLAYER_RESIST_MULT += 0.25
0089: 0@ = PLAYER_RESIST_MULT // (float)
0@ *= 100.0
0AD3: 16@v = format "%.1f" 0@
0AE0: remove_dynamic_GXT_entry "_RESIST"
0ADF: add_dynamic_GXT_entry "_RESIST" text 16@v
end

if and
$PERK_NUMBER == 50
PERK_LASTCHANCE == 0
then
6@ = 1
:PERK_LASTCHANCE_INSTALL
PERK_LASTCHANCE = 1
end

return

:PERK_MENU_VARS_SET

$ACHIV_TEXT_SIZE_X = 0.6
$ACHIV_TEXT_SIZE_Y = 1.35
$ACHIV_TEXT_X = 330.0 
$ACHIV_TEXT_Y = 200.0 

$ACHIV_TEXT2_SIZE_X = 0.4
$ACHIV_TEXT2_SIZE_Y = 1.15
$ACHIV_TEXT2_X = 330.0 
$ACHIV_TEXT2_Y = 220.0 

$ACHIV_TOTAL_ACHIV_TEXT_SIZE_X = 0.5
$ACHIV_TOTAL_ACHIV_TEXT_SIZE_Y = 1.25
$ACHIV_TOTAL_ACHIV_TEXT_X = 330.0
$ACHIV_TOTAL_ACHIV_TEXT_Y = 400.0    

$ACHIV_TOTAL2_ACHIV_TEXT_SIZE_X = 0.5
$ACHIV_TOTAL2_ACHIV_TEXT_SIZE_Y = 1.25
$ACHIV_TOTAL2_ACHIV_TEXT_X = 330.0
$ACHIV_TOTAL2_ACHIV_TEXT_Y = 240.0    

$ACHIV_TOTAL3_ACHIV_TEXT_SIZE_X = 0.5
$ACHIV_TOTAL3_ACHIV_TEXT_SIZE_Y = 1.25
$ACHIV_TOTAL3_ACHIV_TEXT_X = 325.0
$ACHIV_TOTAL3_ACHIV_TEXT_Y = 189.0

$ACHIV_TOTAL_SHOW_OFF_FLAG = 0

$ACHIV_TOTAL = 50

return  